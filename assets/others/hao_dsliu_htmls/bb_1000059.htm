<html><head><meta http-equiv="Content-Type" content="text/html; charset=utf8"><title>163 blogs的博客：[转] windbg远程调试方法</title>
<style type="text/css">
a{color: #000000;text-decoration : none;font-size: 10pt;}
a:hover {color: red;text-decoration : underline;}
.replyBox{padding:4px;border:1px solid #D8D8D8;}
</style></head><body><h2>[转] windbg远程调试方法</h2>
<p align="right">发布时间：2014-4-22 13:46
<br>分类名称：Debug_Crack</p><br>
<p><span style="color:#454545;"   ><strong><span style=" background-color:white;font-family:Arial;"   >From: http://blog.csdn.net/ytfrdfiw/article/details/8865527<br>WinDBG</span><span style=" background-color:white;font-family:宋体;"   >的远程调试由服务端和客户端组成，和</span></strong><span style="color:#333333;"   ><strong><span style="font-family:Arial;"   >visualstudio</span><span style="font-family:宋体;"   >类似。</span><span style="font-family:Arial;"   >
</span><span style="font-family:宋体;"   >被调试的机器是服务端（</span><span style="font-family:Arial;"   >server</span><span style="font-family:宋体;"   >），</span><span style="font-family:Arial;"   >
</span><span style="font-family:宋体;"   >我们做调试的机器是客户端</span><span style="font-family:Arial;"   >(client)</span><span style="font-family:宋体;"   >。</span><span style="font-family:Arial;"   >
</span><span style="font-family:宋体;"   >两台机器都需要安装</span><span style="font-family:Arial;"   >WinDBG</span></strong><span style="color:#454545;"   ><span style=" background-color:white;font-family:宋体;"   ><strong>。</strong></span><span style="color:#333333;"   ><span style="font-family:Arial;"   ><br></span><span style="color:#454545;"   ><strong><span style="font-family:宋体;"   >第一步，</span><span style="font-family:Arial;"   >
</span><span style="font-family:宋体;"   >建立</span><span style="font-family:Arial;"   >WinDBG server </span><span style="font-family:宋体;"   >端。</span></strong><span style="color:#333333;"   ><span style="font-family:Arial;"   ><br></span><span style="color:#454545;"   ><strong><span style="font-family:宋体;"   >使用</span><span style="font-family:Arial;"   > -server</span><span style="font-family:宋体;"   >参数可以使</span><span style="font-family:Arial;"   >WinDBG</span><span style="font-family:宋体;"   >以服务器方式启动。</span><span style="font-family:Arial;"   > WinDBG</span><span style="font-family:宋体;"   >可以用多种连接协议让客户端连接，比如命名管道（</span><span style="font-family:Arial;"   >named pipe</span><span style="font-family:宋体;"   >），安全管道（</span><span style="font-family:Arial;"   >secure pipe</span><span style="font-family:宋体;"   >），</span><span style="font-family:Arial;"   > TCP</span><span style="font-family:宋体;"   >协议（</span><span style="font-family:Arial;"   >socket</span><span style="font-family:宋体;"   >），</span><span style="font-family:Arial;"   > SSL</span><span style="font-family:宋体;"   >协议，串口</span><span style="font-family:Arial;"   >/</span><span style="font-family:宋体;"   >并口</span><span style="font-family:Arial;"   >(COM port)</span><span style="font-family:宋体;"   >等等。</span></strong><span style="color:#333333;"   ><span style="font-family:Arial;"   ><br></span><span style="color:#454545;"   ><span style="font-size:10pt;"   ><span style="font-family:宋体;"   >第二步，</span><span style="font-family:Arial;"   >
</span><span style="font-family:宋体;"   >用</span><span style="font-family:Arial;"   >WinDBG client </span><span style="font-family:宋体;"   >端连接服务端</span></span><span style="color:#333333;"   ><span style="font-family:Arial;"   ><span style="font-size:10pt;"   ><br></span><span style="color:#454545;"   ><strong>&nbsp;&nbsp; </strong></span></span><span style="font-family:宋体;"   ><strong>使用</strong></span><span style="color:#454545;"   ><strong><span style="font-family:Arial;"   > -remote</span><span style="font-family:宋体;"   >参数可以使</span><span style="font-family:Arial;"   >WinDBG</span><span style="font-family:宋体;"   >以客户端方式启动去连接服务端，可以指定不同的连接方式：比如命名管道（</span><span style="font-family:Arial;"   >named pipe</span><span style="font-family:宋体;"   >），安全管道（</span><span style="font-family:Arial;"   >secure pipe</span><span style="font-family:宋体;"   >），</span><span style="font-family:Arial;"   > TCP</span><span style="font-family:宋体;"   >协议（</span><span style="font-family:Arial;"   >socket</span><span style="font-family:宋体;"   >），</span><span style="font-family:Arial;"   > SSL</span><span style="font-family:宋体;"   >协议，串口</span><span style="font-family:Arial;"   >/</span><span style="font-family:宋体;"   >并口</span><span style="font-family:Arial;"   >(COM port)</span><span style="font-family:宋体;"   >等等。</span></strong><span style="color:#333333;"   ><span style=" font-size:12pt;font-family:Arial;"   ><br></span><span style="color:#454545;"   ><span style="font-size:10pt;"   ><span style="font-family:宋体;"   >我这里以</span><span style="font-family:Arial;"   >tcp</span><span style="font-family:宋体;"   >协议为例，用管道或其他我暂时没有试验成功。</span></span><span style="color:#333333;"   ><span style="font-size:10pt;"   ><span style="font-family:Arial;"   ><br><span style="color:red;"   >PC1</span></span><span style="font-family:宋体;"   >：被调试主机</span></span><span style="font-family:Arial;"   ><span style="font-size:10pt;"   ><br></span><span style="color:red;"   ><strong>PC2:</strong></span></span><span style="font-family:宋体;"   ><strong>调试机客户端</strong></span><span style="font-family:Arial;"   ><span style="font-size:12pt;"   ><br></span><span style="font-size:10pt;"   >PC1</span></span><span style=" font-size:10pt;font-family:宋体;"   >执行的步骤如下：</span><span style="font-family:Arial;"   ><span style="font-size:10pt;"   ><br></span><strong>1</strong></span><span style="font-family:宋体;"   ><strong>）、运行</strong></span><span style="font-family:Arial;"   ><strong>cmd.exe</strong><span style="font-size:12pt;"   ><br></span><span style="font-size:10pt;"   >2)</span></span><span style="font-size:10pt;"   ><span style="font-family:宋体;"   >、进入</span><span style="font-family:Arial;"   >windbg</span><span style="font-family:宋体;"   >的安装目录</span></span><span style="font-family:Arial;"   ><span style="font-size:10pt;"   ><br></span><strong>3</strong></span><span style="font-family:宋体;"   ><strong>）、运行以下命令</strong></span><span style="font-family:Arial;"   ><span style="font-size:12pt;"   ><br></span><strong>(1)</strong></span><span style="font-family:宋体;"   ><strong>、</strong></span><span style="font-family:Arial;"   ><strong>windbg–server tcp:port=5005 c:\aa.exe&nbsp;&nbsp; </strong><br></span><span style="font-size:10pt;"   ><span style="font-family:宋体;"   >一般会出现下图所示界面：</span><span style="font-family:Arial;"   ><br><img title="[转] windbg远程调试方法 - Howie - Dspace"   src="pic/img2.ph.126.net_kj4K0bCF7HvkNP8VlAXrBg==_4871768897008229342.jpg"   alt=""   /><br></span><span style="font-family:宋体;"   >注意红色部分，如果此时，你输入</span><span style="font-family:Arial;"   >g</span><span style="font-family:宋体;"   >命令，则</span><span style="font-family:Arial;"   >aa.exe</span><span style="font-family:宋体;"   >程序正常运行，你将不能调试程序的初始化流程如（</span><span style="font-family:Arial;"   >dllmain</span><span style="font-family:宋体;"   >或</span><span style="font-family:Arial;"   >main</span><span style="font-family:宋体;"   >）</span><span style="font-family:Arial;"   >,</span><span style="font-family:宋体;"   >此时如果用客户端调试</span><span style="font-family:Arial;"   >PC1</span><span style="font-family:宋体;"   >，则相当于我们平时的</span><span style="font-family:Arial;"   >attatchprocess</span><span style="font-family:宋体;"   >的动作。反之，此时，你不做任何事情，直接到</span><span style="font-family:Arial;"   >PC2</span><span style="font-family:宋体;"   >上，执行调试流程，则可以调试</span><span style="font-family:Arial;"   >PC1</span><span style="font-family:宋体;"   >上的</span><span style="font-family:Arial;"   >aa.exe</span><span style="font-family:宋体;"   >初始化流程，此时相当于我们在</span><span style="font-family:Arial;"   >vs</span><span style="font-family:宋体;"   >里</span><span style="font-family:Arial;"   >F5</span><span style="font-family:宋体;"   >调试。</span><span style="font-family:Arial;"   ><br></span></span><span style="font-family:宋体;"   >（</span><span style="font-family:Arial;"   >2</span><span style="font-family:宋体;"   >）、</span><span style="font-family:Arial;"   >windbg–server tcp:port=5005 &nbsp;–p 1002&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="font-size:12pt;"   ><br></span></span><span style="font-family:宋体;"   >这也是一种调试方法，其中，</span><span style="font-family:Arial;"   >-p 1002 </span><span style="font-family:宋体;"   >中的</span><span style="font-family:Arial;"   >1002</span><span style="font-family:宋体;"   >是我们想调试的进程</span><span style="font-family:Arial;"   >ID </span><span style="font-family:宋体;"   >，这种调试模式相当于</span><span style="font-family:Arial;"   >attatch toprocess</span><span style="font-family:宋体;"   >的模式，不能调试</span><span style="font-family:Arial;"   >dllmain</span><span style="font-family:宋体;"   >或</span><span style="font-family:Arial;"   >main</span><span style="font-family:宋体;"   >函数</span><span style="font-family:Arial;"   >.<br><span style="font-size:10pt;"   >PC2</span></span><span style=" font-size:10pt;font-family:宋体;"   >执行的步骤如下：</span><span style="font-family:Arial;"   ><span style="font-size:10pt;"   ><br></span>1</span><span style="font-family:宋体;"   >）、运行</span><span style="font-family:Arial;"   >cmd.exe<span style="font-size:12pt;"   ><br></span><span style="font-size:10pt;"   >2)</span></span><span style="font-size:10pt;"   ><span style="font-family:宋体;"   >、进入</span><span style="font-family:Arial;"   >windbg</span><span style="font-family:宋体;"   >的安装目录</span></span><span style="font-family:Arial;"   ><span style="font-size:10pt;"   ><br></span>3</span><span style="font-family:宋体;"   >）、运行以下命令</span><span style="font-family:Arial;"   ><span style="font-size:12pt;"   ><br></span><strong>windbg –remote tcp:port=5005,server=192.168.33.11</strong><br></span><span style="color:red;"   ><strong><span style="font-family:宋体;"   >另外，要注意，</span><span style="font-family:Arial;"   >pdb</span><span style="font-family:宋体;"   >文件一定放置在</span><span style="font-family:Arial;"   >PC1</span><span style="font-family:宋体;"   >上面，在</span><span style="font-family:Arial;"   >PC2</span><span style="font-family:宋体;"   >的</span><span style="font-family:Arial;"   >windbg</span><span style="font-family:宋体;"   >里设置的符号文件路径也一定设置</span><span style="font-family:Arial;"   >PC1</span><span style="font-family:宋体;"   >的路径，否则在</span><span style="font-family:Arial;"   >PC2</span><span style="font-family:宋体;"   >的调试器中会出现无法打开路径的警告。</span></strong><span style="color:#333333; font-family:Arial;"   ><br></span><br></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></p>
</body></html>