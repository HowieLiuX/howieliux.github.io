<html><head><meta http-equiv="Content-Type" content="text/html; charset=utf8"><title>163 blogs的博客：[转] Scriptable Plugin</title>
<style type="text/css">
a{color: #000000;text-decoration : none;font-size: 10pt;}
a:hover {color: red;text-decoration : underline;}
.replyBox{padding:4px;border:1px solid #D8D8D8;}
</style></head><body><h2>[转] Scriptable Plugin</h2>
<p align="right">发布时间：2011-2-12 13:58
<br>分类名称：Plugins</p><br>
<p style="margin-top: 0cm; margin-right: 0cm; margin-bottom: 0.0001pt; margin-left: 0cm; font-family: Calibri, sans-serif; text-align: justify;"   ><span style="line-height: normal;"   ><b><span lang="EN-US"   style="font-size: 14pt;"   >NPAPI &amp; NPRuntime&nbsp;</span></b><b><span style="font-size: 14pt; font-family: 宋体;"   >简介</span></b></span></p><p style="margin-top: 0cm; margin-right: 0cm; margin-bottom: 7.8pt; margin-left: 0cm; line-height: normal; font-size: 10.5pt; font-family: Calibri, sans-serif; text-align: justify;"   ><b><span lang="EN-US"   >Netscape Plugin Application Programming Interface (NPAPI)</span></b></p><p style="margin-top: 0cm; margin-right: 0cm; margin-bottom: 0.0001pt; margin-left: 0cm; line-height: normal; font-size: 10.5pt; font-family: Calibri, sans-serif; text-align: justify;"   ><span lang="EN-US"   >NPAPI&nbsp;</span><span style="font-family: 宋体;"   >原本是由</span><span lang="EN-US"   >&nbsp;Netscape&nbsp;</span><span style="font-family: 宋体;"   >所制定的一组单纯的</span><span lang="EN-US"   >&nbsp;C Plugin API</span><span style="font-family: 宋体;"   >，起初是无法支持</span><span lang="EN-US"   >Scriptability</span><span style="font-family: 宋体;"   >；于是到了</span><span lang="EN-US"   >&nbsp;2004&nbsp;</span><span style="font-family: 宋体;"   >年底时，各家</span><span lang="EN-US"   >&nbsp;Browser (IE, Opera, Mozilla&nbsp;</span><span style="font-family: 宋体;"   >等</span><span lang="EN-US"   >)&nbsp;</span><span style="font-family: 宋体;"   >都同意支持</span><span lang="EN-US"   >NPRuntime&nbsp;</span><span style="font-family: 宋体;"   >延伸</span>&nbsp;<span lang="EN-US"   >API&nbsp;</span><span style="font-family: 宋体;"   >以支持</span><span lang="EN-US"   >&nbsp;Scriptability</span><span style="font-family: 宋体;"   >，所以目前若是想写</span><span lang="EN-US"   >&nbsp;Plugin&nbsp;</span><span style="font-family: 宋体;"   >则应该以</span><span lang="EN-US"   >&nbsp;NPRuntime API&nbsp;</span><span style="font-family: 宋体;"   >才能跨不同的</span><span lang="EN-US"   >&nbsp;Browsers</span><span style="font-family: 宋体;"   >。</span></p><p style="margin-top: 0cm; margin-right: 0cm; margin-bottom: 0.0001pt; margin-left: 0cm; line-height: normal; font-size: 10.5pt; font-family: Calibri, sans-serif; text-align: justify;"   ><b><span lang="EN-US"   style="font-size: 14pt;"   >Plugin Life Cycle</span></b></p><p align="left"   style="margin-top: 7.2pt; margin-right: 0cm; margin-bottom: 3.6pt; margin-left: 0cm; text-align: left;"   ><font face="宋体"   size="2"   ><span style="line-height: 20px;"   ></span></font></p><div><font face="宋体"   size="2"   ><img title="2011年02月12日 - Dsliu - Dspace"   alt="2011年02月12日 - Dsliu - Dspace"   style="margin:0 10px 0 0;"   src="pic/img686.ph.126.net_CCOMt8XeOGsq-RpZ1DIY7w==_1142506930469842736.png"   ></font></div><font face="宋体"   size="2"   >&nbsp;</font><p></p><p style="margin-top: 0cm; margin-right: 0cm; margin-bottom: 0.0001pt; margin-left: 0cm; line-height: normal; font-size: 10.5pt; font-family: Calibri, sans-serif; text-align: justify;"   ><span style="font-family: 宋体;"   >上面的</span><span lang="EN-US"   >&nbsp;Sequence Diagram&nbsp;</span><span style="font-family: 宋体;"   >说明了</span><span lang="EN-US"   >&nbsp;Browser&nbsp;</span><span style="font-family: 宋体;"   >与</span><span lang="EN-US"   >&nbsp;Plugin&nbsp;</span><span style="font-family: 宋体;"   >之间的调用过程：</span></p><p style="margin-top: 0cm; margin-right: 0cm; margin-bottom: 7.8pt; margin-left: 21pt; line-height: normal; font-size: 10.5pt; font-family: Calibri, sans-serif; text-align: justify; text-indent: -21pt;"   ><span lang="EN-US"   >1.<span style="font: normal normal normal 7pt/normal 'Times New Roman';"   >&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></span><span lang="EN-US"   >Browser lookup Plugin (.so, .dll) and load it.</span></p><p style="margin-top: 0cm; margin-right: 0cm; margin-bottom: 0.0001pt; margin-left: 21pt; line-height: normal; font-size: 10.5pt; font-family: Calibri, sans-serif; text-align: justify; text-indent: -21pt;"   ><span lang="EN-US"   >2.<span style="font: normal normal normal 7pt/normal 'Times New Roman';"   >&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></span><span lang="EN-US"   >Browser&nbsp;</span><span style="font-family: 宋体;"   >调用</span><span lang="EN-US"   >&nbsp;Plugin&nbsp;</span><span style="font-family: 宋体;"   >的</span><span lang="EN-US"   >&nbsp;NP_Initialize()&nbsp;</span><span style="font-family: 宋体;"   >来交换彼此所需的</span><span lang="EN-US"   >&nbsp;API Function Pointers</span><span style="font-family: 宋体;"   >。</span></p><p style="margin-top: 0cm; margin-right: 0cm; margin-bottom: 0.0001pt; margin-left: 42pt; line-height: normal; font-size: 10.5pt; font-family: Calibri, sans-serif; text-align: justify; text-indent: -21pt;"   ><span lang="EN-US"   style="font-family: Wingdings;"   >l<span style="font: normal normal normal 7pt/normal 'Times New Roman';"   >&nbsp;&nbsp;</span></span><span style="font-family: 宋体;"   >将</span><span lang="EN-US"   >&nbsp;Browser Side&nbsp;</span><span style="font-family: 宋体;"   >的</span><span lang="EN-US"   >&nbsp;NPN_API function table (NPNetscapeFuncs *aNPNFuncs)&nbsp;</span><span style="font-family: 宋体;"   >传给</span><span lang="EN-US"   >&nbsp;Plugin (Binding)</span><span style="font-family: 宋体;"   >。</span></p><p style="margin-top: 0cm; margin-right: 0cm; margin-bottom: 7.8pt; margin-left: 42pt; line-height: normal; font-size: 10.5pt; font-family: Calibri, sans-serif; text-align: justify; text-indent: -21pt;"   ><span lang="EN-US"   style="font-family: Wingdings;"   >l<span style="font: normal normal normal 7pt/normal 'Times New Roman';"   >&nbsp;&nbsp;</span></span><span lang="EN-US"   >Plugin&nbsp;</span><span style="font-family: 宋体;"   >应将其自身所定义好的</span><span lang="EN-US"   >&nbsp;NPP API functions&nbsp;</span><span style="font-family: 宋体;"   >填入</span><span lang="EN-US"   >&nbsp;NPPluginFuncs *aNPPFuncs&nbsp;</span><span style="font-family: 宋体;"   >中，好让</span><span lang="EN-US"   >&nbsp;Browser&nbsp;</span><span style="font-family: 宋体;"   >得到</span><span lang="EN-US"   >&nbsp;Plugin Side&nbsp;</span><span style="font-family: 宋体;"   >的</span><span lang="EN-US"   >&nbsp;Function pointers</span><span style="font-family: 宋体;"   >。</span></p><p style="margin-top: 0cm; margin-right: 0cm; margin-bottom: 7.8pt; margin-left: 21pt; line-height: normal; font-size: 10.5pt; font-family: Calibri, sans-serif; text-align: justify; text-indent: -21pt;"   ><span lang="EN-US"   >3.<span style="font: normal normal normal 7pt/normal 'Times New Roman';"   >&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></span><span lang="EN-US"   >Browser&nbsp;</span><span style="font-family: 宋体;"   >呼叫</span><span lang="EN-US"   >&nbsp;Plugin&nbsp;</span><span style="font-family: 宋体;"   >的</span><span lang="EN-US"   >&nbsp;NP_GetValue()&nbsp;</span><span style="font-family: 宋体;"   >来得到</span><span lang="EN-US"   >&nbsp;Plugin&nbsp;</span><span style="font-family: 宋体;"   >的信息，例如：版本资讯与是否支持</span><span lang="EN-US"   >&nbsp;Scriptability&nbsp;</span><span style="font-family: 宋体;"   >等。</span></p><p style="margin-top: 0cm; margin-right: 0cm; margin-bottom: 7.8pt; margin-left: 21pt; line-height: normal; font-size: 10.5pt; font-family: Calibri, sans-serif; text-align: justify; text-indent: -21pt;"   ><span lang="EN-US"   >4.<span style="font: normal normal normal 7pt/normal 'Times New Roman';"   >&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></span><span lang="EN-US"   >Browser&nbsp;</span><span style="font-family: 宋体;"   >在网页中发现</span><span lang="EN-US"   >&nbsp;Plugin&nbsp;</span><span style="font-family: 宋体;"   >所支持的</span><span lang="EN-US"   >&nbsp;Mime Type&nbsp;</span><span style="font-family: 宋体;"   >时，调用</span><span lang="EN-US"   >&nbsp;Plugin&nbsp;</span><span style="font-family: 宋体;"   >的</span><span lang="EN-US"   >&nbsp;NPP_New()&nbsp;</span><span style="font-family: 宋体;"   >来建立新的</span><span lang="EN-US"   >&nbsp;Plugin instance&nbsp;</span><span style="font-family: 宋体;"   >来处理。</span></p><p style="margin-top: 0cm; margin-right: 0cm; margin-bottom: 7.8pt; margin-left: 21pt; line-height: normal; font-size: 10.5pt; font-family: Calibri, sans-serif; text-align: justify; text-indent: -21pt;"   ><span lang="EN-US"   >5.<span style="font: normal normal normal 7pt/normal 'Times New Roman';"   >&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></span><span style="font-family: 宋体;"   >当网页被</span><span lang="EN-US"   >&nbsp;Unload&nbsp;</span><span style="font-family: 宋体;"   >前，</span><span lang="EN-US"   >Browser&nbsp;</span><span style="font-family: 宋体;"   >则会调用</span><span lang="EN-US"   >&nbsp;Plugin NPP_Destroy()&nbsp;</span><span style="font-family: 宋体;"   >来通知</span><span lang="EN-US"   >&nbsp;Plugin&nbsp;</span><span style="font-family: 宋体;"   >应</span><span lang="EN-US"   >&nbsp;Destroy&nbsp;</span><span style="font-family: 宋体;"   >所对应的</span><span lang="EN-US"   >&nbsp;Plugin instance&nbsp;</span><span style="font-family: 宋体;"   >。</span></p><p style="margin-top: 0cm; margin-right: 0cm; margin-bottom: 7.8pt; margin-left: 21pt; line-height: normal; font-size: 10.5pt; font-family: Calibri, sans-serif; text-align: justify; text-indent: -21pt;"   ><span lang="EN-US"   >6.<span style="font: normal normal normal 7pt/normal 'Times New Roman';"   >&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></span><span style="font-family: 宋体;"   >当</span><span lang="EN-US"   >&nbsp;Browser&nbsp;</span><span style="font-family: 宋体;"   >程式结束前会调用</span><span lang="EN-US"   >&nbsp;Plugin&nbsp;</span><span style="font-family: 宋体;"   >的</span><span lang="EN-US"   >&nbsp;NP_Shutdown()&nbsp;</span><span style="font-family: 宋体;"   >做</span><span lang="EN-US"   >&nbsp;Destruction</span><span style="font-family: 宋体;"   >，结束整个</span><span lang="EN-US"   >&nbsp;Plugin Life Cycle&nbsp;</span><span style="font-family: 宋体;"   >。</span></p><p style="margin-top: 0cm; margin-right: 0cm; margin-bottom: 7.8pt; margin-left: 0cm; line-height: normal; font-size: 10.5pt; font-family: Calibri, sans-serif; text-align: justify;"   ><span style="font-family: 宋体;"   >以下为</span><span lang="EN-US"   >&nbsp;API&nbsp;</span><span style="font-family: 宋体;"   >宣告：</span></p><p style="margin-top: 0cm; margin-right: 0cm; margin-bottom: 0.0001pt; margin-left: 0cm; line-height: normal; font-size: 10.5pt; font-family: Calibri, sans-serif; text-align: justify;"   ><span lang="EN-US"   style="font-family: 'Courier New';"   >char* NP_GetMIMEDescription()&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; // Unix only</span></p><p style="margin-top: 0cm; margin-right: 0cm; margin-bottom: 0.0001pt; margin-left: 0cm; line-height: normal; font-size: 10.5pt; font-family: Calibri, sans-serif; text-align: justify;"   ><span lang="EN-US"   style="font-family: 'Courier New';"   >NPError NP_GetValue(void*, NPPVariable, void* out)</span></p><p style="margin-top: 0cm; margin-right: 0cm; margin-bottom: 0.0001pt; margin-left: 0cm; line-height: normal; font-size: 10.5pt; font-family: Calibri, sans-serif; text-align: justify;"   ></p><p style="margin-top: 0cm; margin-right: 0cm; margin-bottom: 0.0001pt; margin-left: 0cm; line-height: normal; font-size: 10.5pt; font-family: Calibri, sans-serif; text-align: justify;"   ><span lang="EN-US"   style="font-family: 'Courier New';"   >NPError NP_Initialize(NPNetscapeFuncs*, NPPluginFuncs*)</span></p><p style="margin-top: 0cm; margin-right: 0cm; margin-bottom: 0.0001pt; margin-left: 0cm; line-height: normal; font-size: 10.5pt; font-family: Calibri, sans-serif; text-align: justify;"   ><span lang="EN-US"   style="font-family: 'Courier New';"   >NPError OSCALL NP_Shutdown()</span></p><p style="margin-top: 0cm; margin-right: 0cm; margin-bottom: 0.0001pt; margin-left: 0cm; line-height: normal; font-size: 10.5pt; font-family: Calibri, sans-serif; text-align: justify;"   ><span lang="EN-US"   >&nbsp;</span></p><p style="margin-top: 0cm; margin-right: 0cm; margin-bottom: 0.0001pt; margin-left: 0cm; line-height: normal; font-size: 10.5pt; font-family: Calibri, sans-serif; text-align: justify;"   ><b><span lang="EN-US"   style="font-size: 14pt;"   >NPNetscapeFuncs (NPN_XXXXX API)</span></b></p><p style="margin-top: 0cm; margin-right: 0cm; margin-bottom: 0.0001pt; margin-left: 0cm; line-height: normal; font-size: 10.5pt; font-family: Calibri, sans-serif; text-align: justify;"   ><span lang="EN-US"   >NPNetscapeFuncs&nbsp;</span><span style="font-family: 宋体;"   >是一个</span><span lang="EN-US"   >&nbsp;Function pointer table</span><span style="font-family: 宋体;"   >，是</span><span lang="EN-US"   >&nbsp;Browser&nbsp;</span><span style="font-family: 宋体;"   >传给</span><span lang="EN-US"   >&nbsp;Plugin&nbsp;</span><span style="font-family: 宋体;"   >使用的</span><span lang="EN-US"   >&nbsp;NPN_XXXXX API</span><span style="font-family: 宋体;"   >。</span></p><p style="margin-top: 0cm; margin-right: 0cm; margin-bottom: 0.0001pt; margin-left: 0cm; line-height: normal; font-size: 10.5pt; font-family: Calibri, sans-serif; text-align: justify;"   ><span style="font-family: 宋体;"   >声明如下：</span></p><p style="margin-top: 0cm; margin-right: 0cm; margin-bottom: 0.0001pt; margin-left: 0cm; line-height: normal; font-size: 10.5pt; font-family: Calibri, sans-serif; text-align: justify;"   ><span lang="EN-US"   style="font-family: 'Courier New';"   >typedef struct _NPNetscapeFuncs {</span></p><p style="margin-top: 0cm; margin-right: 0cm; margin-bottom: 0.0001pt; margin-left: 21pt; line-height: normal; font-size: 10.5pt; font-family: Calibri, sans-serif; text-align: justify;"   ><span lang="EN-US"   style="font-family: 'Courier New';"   >uint16 size;</span></p><p style="margin-top: 0cm; margin-right: 0cm; margin-bottom: 0.0001pt; margin-left: 21pt; line-height: normal; font-size: 10.5pt; font-family: Calibri, sans-serif; text-align: justify;"   ><span lang="EN-US"   style="font-family: 'Courier New';"   >uint16 version;</span></p><p style="margin-top: 0cm; margin-right: 0cm; margin-bottom: 0.0001pt; margin-left: 21pt; line-height: normal; font-size: 10.5pt; font-family: Calibri, sans-serif; text-align: justify;"   ><span lang="EN-US"   style="font-family: 'Courier New';"   >&nbsp;</span></p><p style="margin-top: 0cm; margin-right: 0cm; margin-bottom: 0.0001pt; margin-left: 21pt; line-height: normal; font-size: 10.5pt; font-family: Calibri, sans-serif; text-align: justify;"   ><span lang="EN-US"   style="font-family: 'Courier New';"   >NPN_GetURLProcPtr geturl;</span></p><p style="margin-top: 0cm; margin-right: 0cm; margin-bottom: 0.0001pt; margin-left: 21pt; line-height: normal; font-size: 10.5pt; font-family: Calibri, sans-serif; text-align: justify;"   ><span lang="EN-US"   style="font-family: 'Courier New';"   >NPN_PostURLProcPtr posturl;</span></p><p style="margin-top: 0cm; margin-right: 0cm; margin-bottom: 0.0001pt; margin-left: 21pt; line-height: normal; font-size: 10.5pt; font-family: Calibri, sans-serif; text-align: justify;"   ><span lang="EN-US"   style="font-family: 'Courier New';"   >NPN_RequestReadProcPtr requestread;</span></p><p style="margin-top: 0cm; margin-right: 0cm; margin-bottom: 0.0001pt; margin-left: 21pt; line-height: normal; font-size: 10.5pt; font-family: Calibri, sans-serif; text-align: justify;"   ><span lang="EN-US"   style="font-family: 'Courier New';"   >NPN_NewStreamProcPtr newstream;</span></p><p style="margin-top: 0cm; margin-right: 0cm; margin-bottom: 0.0001pt; margin-left: 21pt; line-height: normal; font-size: 10.5pt; font-family: Calibri, sans-serif; text-align: justify;"   ><span lang="EN-US"   style="font-family: 'Courier New';"   >NPN_WriteProcPtr write;</span></p><p style="margin-top: 0cm; margin-right: 0cm; margin-bottom: 0.0001pt; margin-left: 21pt; line-height: normal; font-size: 10.5pt; font-family: Calibri, sans-serif; text-align: justify;"   ><span lang="EN-US"   style="font-family: 'Courier New';"   >NPN_DestroyStreamProcPtr destroystream;</span></p><p style="margin-top: 0cm; margin-right: 0cm; margin-bottom: 0.0001pt; margin-left: 21pt; line-height: normal; font-size: 10.5pt; font-family: Calibri, sans-serif; text-align: justify;"   ><span lang="EN-US"   style="font-family: 'Courier New';"   >NPN_StatusProcPtr status;</span></p><p style="margin-top: 0cm; margin-right: 0cm; margin-bottom: 0.0001pt; margin-left: 21pt; line-height: normal; font-size: 10.5pt; font-family: Calibri, sans-serif; text-align: justify;"   ><span lang="EN-US"   style="font-family: 'Courier New';"   >NPN_UserAgentProcPtr uagent;</span></p><p style="margin-top: 0cm; margin-right: 0cm; margin-bottom: 0.0001pt; margin-left: 21pt; line-height: normal; font-size: 10.5pt; font-family: Calibri, sans-serif; text-align: justify;"   ><span lang="EN-US"   style="font-family: 'Courier New';"   >NPN_MemAllocProcPtr memalloc;</span></p><p style="margin-top: 0cm; margin-right: 0cm; margin-bottom: 0.0001pt; margin-left: 21pt; line-height: normal; font-size: 10.5pt; font-family: Calibri, sans-serif; text-align: justify;"   ><span lang="EN-US"   style="font-family: 'Courier New';"   >NPN_MemFreeProcPtr memfree;</span></p><p style="margin-top: 0cm; margin-right: 0cm; margin-bottom: 0.0001pt; margin-left: 21pt; line-height: normal; font-size: 10.5pt; font-family: Calibri, sans-serif; text-align: justify;"   ><span lang="EN-US"   style="font-family: 'Courier New';"   >NPN_MemFlushProcPtr memflush;</span></p><p style="margin-top: 0cm; margin-right: 0cm; margin-bottom: 0.0001pt; margin-left: 21pt; line-height: normal; font-size: 10.5pt; font-family: Calibri, sans-serif; text-align: justify;"   ><span lang="EN-US"   style="font-family: 'Courier New';"   >NPN_ReloadPluginsProcPtr reloadplugins;</span></p><p style="margin-top: 0cm; margin-right: 0cm; margin-bottom: 0.0001pt; margin-left: 21pt; line-height: normal; font-size: 10.5pt; font-family: Calibri, sans-serif; text-align: justify;"   ><span lang="EN-US"   style="font-family: 'Courier New';"   >NPN_GetJavaEnvProcPtr getJavaEnv;</span></p><p style="margin-top: 0cm; margin-right: 0cm; margin-bottom: 0.0001pt; margin-left: 21pt; line-height: normal; font-size: 10.5pt; font-family: Calibri, sans-serif; text-align: justify;"   ><span lang="EN-US"   style="font-family: 'Courier New';"   >NPN_GetJavaPeerProcPtr getJavaPeer;</span></p><p style="margin-top: 0cm; margin-right: 0cm; margin-bottom: 0.0001pt; margin-left: 21pt; line-height: normal; font-size: 10.5pt; font-family: Calibri, sans-serif; text-align: justify;"   ><span lang="EN-US"   style="font-family: 'Courier New';"   >NPN_GetURLNotifyProcPtr geturlnotify;</span></p><p style="margin-top: 0cm; margin-right: 0cm; margin-bottom: 0.0001pt; margin-left: 21pt; line-height: normal; font-size: 10.5pt; font-family: Calibri, sans-serif; text-align: justify;"   ><span lang="EN-US"   style="font-family: 'Courier New';"   >NPN_PostURLNotifyProcPtr posturlnotify;</span></p><p style="margin-top: 0cm; margin-right: 0cm; margin-bottom: 0.0001pt; margin-left: 21pt; line-height: normal; font-size: 10.5pt; font-family: Calibri, sans-serif; text-align: justify;"   ><span lang="EN-US"   style="font-family: 'Courier New';"   >NPN_GetValueProcPtr getvalue;</span></p><p style="margin-top: 0cm; margin-right: 0cm; margin-bottom: 0.0001pt; margin-left: 21pt; line-height: normal; font-size: 10.5pt; font-family: Calibri, sans-serif; text-align: justify;"   ><span lang="EN-US"   style="font-family: 'Courier New';"   >NPN_SetValueProcPtr setvalue;</span></p><p style="margin-top: 0cm; margin-right: 0cm; margin-bottom: 0.0001pt; margin-left: 21pt; line-height: normal; font-size: 10.5pt; font-family: Calibri, sans-serif; text-align: justify;"   ><span lang="EN-US"   style="font-family: 'Courier New';"   >NPN_InvalidateRectProcPtr invalidaterect;</span></p><p style="margin-top: 0cm; margin-right: 0cm; margin-bottom: 0.0001pt; margin-left: 21pt; line-height: normal; font-size: 10.5pt; font-family: Calibri, sans-serif; text-align: justify;"   ><span lang="EN-US"   style="font-family: 'Courier New';"   >NPN_InvalidateRegionProcPtr invalidateregion;</span></p><p style="margin-top: 0cm; margin-right: 0cm; margin-bottom: 0.0001pt; margin-left: 21pt; line-height: normal; font-size: 10.5pt; font-family: Calibri, sans-serif; text-align: justify;"   ><span lang="EN-US"   style="font-family: 'Courier New';"   >NPN_ForceRedrawProcPtr forceredraw;</span></p><p style="margin-top: 0cm; margin-right: 0cm; margin-bottom: 0.0001pt; margin-left: 21pt; line-height: normal; font-size: 10.5pt; font-family: Calibri, sans-serif; text-align: justify;"   ><span lang="EN-US"   style="font-family: 'Courier New';"   >&nbsp;</span></p><p style="margin-top: 0cm; margin-right: 0cm; margin-bottom: 0.0001pt; margin-left: 21pt; line-height: normal; font-size: 10.5pt; font-family: Calibri, sans-serif; text-align: justify;"   ><span lang="EN-US"   style="font-family: 'Courier New';"   >NPN_GetStringIdentifierProcPtr getstringidentifier;</span></p><p style="margin-top: 0cm; margin-right: 0cm; margin-bottom: 0.0001pt; margin-left: 21pt; line-height: normal; font-size: 10.5pt; font-family: Calibri, sans-serif; text-align: justify;"   ><span lang="EN-US"   style="font-family: 'Courier New';"   >NPN_GetStringIdentifiersProcPtr getstringidentifiers;</span></p><p style="margin-top: 0cm; margin-right: 0cm; margin-bottom: 0.0001pt; margin-left: 21pt; line-height: normal; font-size: 10.5pt; font-family: Calibri, sans-serif; text-align: justify;"   ><span lang="EN-US"   style="font-family: 'Courier New';"   >NPN_GetIntIdentifierProcPtr getintidentifier;</span></p><p style="margin-top: 0cm; margin-right: 0cm; margin-bottom: 0.0001pt; margin-left: 21pt; line-height: normal; font-size: 10.5pt; font-family: Calibri, sans-serif; text-align: justify;"   ><span lang="EN-US"   style="font-family: 'Courier New';"   >NPN_IdentifierIsStringProcPtr identifierisstring;</span></p><p style="margin-top: 0cm; margin-right: 0cm; margin-bottom: 0.0001pt; margin-left: 21pt; line-height: normal; font-size: 10.5pt; font-family: Calibri, sans-serif; text-align: justify;"   ><span lang="EN-US"   style="font-family: 'Courier New';"   >NPN_UTF8FromIdentifierProcPtr utf8fromidentifier;</span></p><p style="margin-top: 0cm; margin-right: 0cm; margin-bottom: 0.0001pt; margin-left: 21pt; line-height: normal; font-size: 10.5pt; font-family: Calibri, sans-serif; text-align: justify;"   ><span lang="EN-US"   style="font-family: 'Courier New';"   >NPN_IntFromIdentifierProcPtr intfromidentifier;</span></p><p style="margin-top: 0cm; margin-right: 0cm; margin-bottom: 0.0001pt; margin-left: 21pt; line-height: normal; font-size: 10.5pt; font-family: Calibri, sans-serif; text-align: justify;"   ><span lang="EN-US"   style="font-family: 'Courier New';"   >NPN_CreateObjectProcPtr createobject;</span></p><p style="margin-top: 0cm; margin-right: 0cm; margin-bottom: 0.0001pt; margin-left: 21pt; line-height: normal; font-size: 10.5pt; font-family: Calibri, sans-serif; text-align: justify;"   ><span lang="EN-US"   style="font-family: 'Courier New';"   >NPN_RetainObjectProcPtr retainobject;</span></p><p style="margin-top: 0cm; margin-right: 0cm; margin-bottom: 0.0001pt; margin-left: 21pt; line-height: normal; font-size: 10.5pt; font-family: Calibri, sans-serif; text-align: justify;"   ><span lang="EN-US"   style="font-family: 'Courier New';"   >NPN_ReleaseObjectProcPtr releaseobject;</span></p><p style="margin-top: 0cm; margin-right: 0cm; margin-bottom: 0.0001pt; margin-left: 21pt; line-height: normal; font-size: 10.5pt; font-family: Calibri, sans-serif; text-align: justify;"   ><span lang="EN-US"   style="font-family: 'Courier New';"   >NPN_InvokeProcPtr invoke;</span></p><p style="margin-top: 0cm; margin-right: 0cm; margin-bottom: 0.0001pt; margin-left: 21pt; line-height: normal; font-size: 10.5pt; font-family: Calibri, sans-serif; text-align: justify;"   ><span lang="EN-US"   style="font-family: 'Courier New';"   >NPN_InvokeDefaultProcPtr invokeDefault;</span></p><p style="margin-top: 0cm; margin-right: 0cm; margin-bottom: 0.0001pt; margin-left: 21pt; line-height: normal; font-size: 10.5pt; font-family: Calibri, sans-serif; text-align: justify;"   ><span lang="EN-US"   style="font-family: 'Courier New';"   >NPN_EvaluateProcPtr evaluate;</span></p><p style="margin-top: 0cm; margin-right: 0cm; margin-bottom: 0.0001pt; margin-left: 21pt; line-height: normal; font-size: 10.5pt; font-family: Calibri, sans-serif; text-align: justify;"   ><span lang="EN-US"   style="font-family: 'Courier New';"   >NPN_GetPropertyProcPtr getproperty;</span></p><p style="margin-top: 0cm; margin-right: 0cm; margin-bottom: 0.0001pt; margin-left: 21pt; line-height: normal; font-size: 10.5pt; font-family: Calibri, sans-serif; text-align: justify;"   ><span lang="EN-US"   style="font-family: 'Courier New';"   >NPN_SetPropertyProcPtr setproperty;</span></p><p style="margin-top: 0cm; margin-right: 0cm; margin-bottom: 0.0001pt; margin-left: 21pt; line-height: normal; font-size: 10.5pt; font-family: Calibri, sans-serif; text-align: justify;"   ><span lang="EN-US"   style="font-family: 'Courier New';"   >NPN_RemovePropertyProcPtr removeproperty;</span></p><p style="margin-top: 0cm; margin-right: 0cm; margin-bottom: 0.0001pt; margin-left: 21pt; line-height: normal; font-size: 10.5pt; font-family: Calibri, sans-serif; text-align: justify;"   ><span lang="EN-US"   style="font-family: 'Courier New';"   >NPN_HasPropertyProcPtr hasproperty;</span></p><p style="margin-top: 0cm; margin-right: 0cm; margin-bottom: 0.0001pt; margin-left: 21pt; line-height: normal; font-size: 10.5pt; font-family: Calibri, sans-serif; text-align: justify;"   ><span lang="EN-US"   style="font-family: 'Courier New';"   >NPN_HasMethodProcPtr hasmethod;</span></p><p style="margin-top: 0cm; margin-right: 0cm; margin-bottom: 0.0001pt; margin-left: 21pt; line-height: normal; font-size: 10.5pt; font-family: Calibri, sans-serif; text-align: justify;"   ><span lang="EN-US"   style="font-family: 'Courier New';"   >NPN_ReleaseVariantValueProcPtr releasevariantvalue;</span></p><p style="margin-top: 0cm; margin-right: 0cm; margin-bottom: 0.0001pt; margin-left: 21pt; line-height: normal; font-size: 10.5pt; font-family: Calibri, sans-serif; text-align: justify;"   ><span lang="EN-US"   style="font-family: 'Courier New';"   >NPN_SetExceptionProcPtr setexception;</span></p><p style="margin-top: 0cm; margin-right: 0cm; margin-bottom: 0.0001pt; margin-left: 21pt; line-height: normal; font-size: 10.5pt; font-family: Calibri, sans-serif; text-align: justify;"   ><span lang="EN-US"   style="font-family: 'Courier New';"   >NPN_PushPopupsEnabledStateProcPtr pushpopupsenabledstate;</span></p><p style="margin-top: 0cm; margin-right: 0cm; margin-bottom: 0.0001pt; margin-left: 21pt; line-height: normal; font-size: 10.5pt; font-family: Calibri, sans-serif; text-align: justify;"   ><span lang="EN-US"   style="font-family: 'Courier New';"   >NPN_PopPopupsEnabledStateProcPtr poppopupsenabledstate;</span></p><p style="margin-top: 0cm; margin-right: 0cm; margin-bottom: 0.0001pt; margin-left: 21pt; line-height: normal; font-size: 10.5pt; font-family: Calibri, sans-serif; text-align: justify;"   ><span lang="EN-US"   style="font-family: 'Courier New';"   >NPN_EnumerateProcPtr enumerate;</span></p><p style="margin-top: 0cm; margin-right: 0cm; margin-bottom: 0.0001pt; margin-left: 21pt; line-height: normal; font-size: 10.5pt; font-family: Calibri, sans-serif; text-align: justify;"   ><span lang="EN-US"   style="font-family: 'Courier New';"   >NPN_PluginThreadAsyncCallProcPtr pluginthreadasynccall;</span></p><p style="margin-top: 0cm; margin-right: 0cm; margin-bottom: 0.0001pt; margin-left: 21pt; line-height: normal; font-size: 10.5pt; font-family: Calibri, sans-serif; text-align: justify;"   ><span lang="EN-US"   style="font-family: 'Courier New';"   >NPN_ConstructProcPtr construct;</span></p><p style="margin-top: 0cm; margin-right: 0cm; margin-bottom: 0.0001pt; margin-left: 21pt; line-height: normal; font-size: 10.5pt; font-family: Calibri, sans-serif; text-align: justify;"   ><span lang="EN-US"   style="font-family: 'Courier New';"   >NPN_ScheduleTimerProcPtr scheduletimer;</span></p><p style="margin-top: 0cm; margin-right: 0cm; margin-bottom: 0.0001pt; margin-left: 21pt; line-height: normal; font-size: 10.5pt; font-family: Calibri, sans-serif; text-align: justify;"   ><span lang="EN-US"   style="font-family: 'Courier New';"   >NPN_UnscheduleTimerProcPtr unscheduletimer;</span></p><p style="margin-top: 0cm; margin-right: 0cm; margin-bottom: 0.0001pt; margin-left: 21pt; line-height: normal; font-size: 10.5pt; font-family: Calibri, sans-serif; text-align: justify;"   ><span lang="EN-US"   style="font-family: 'Courier New';"   >NPN_PopUpContextMenuProcPtr popupcontextmenu;</span></p><p style="margin-top: 0cm; margin-right: 0cm; margin-bottom: 0.0001pt; margin-left: 0cm; line-height: normal; font-size: 10.5pt; font-family: Calibri, sans-serif; text-align: justify;"   ><span lang="EN-US"   style="font-family: 'Courier New';"   >}&nbsp;&nbsp; NPNetscapeFuncs;</span></p><p style="margin-top: 0cm; margin-right: 0cm; margin-bottom: 0.0001pt; margin-left: 0cm; line-height: normal; font-size: 10.5pt; font-family: Calibri, sans-serif; text-align: justify;"   ><span lang="EN-US"   style="font-family: 'Courier New';"   >&nbsp;</span></p><p style="margin-top: 0cm; margin-right: 0cm; margin-bottom: 0.0001pt; margin-left: 0cm; line-height: normal; font-size: 10.5pt; font-family: Calibri, sans-serif; text-align: justify;"   ><b><span lang="EN-US"   style="font-size: 14pt;"   >NPPluginFuncs (NPP_XXXX API)</span></b></p><p style="margin-top: 0cm; margin-right: 0cm; margin-bottom: 0.0001pt; margin-left: 0cm; line-height: normal; font-size: 10.5pt; font-family: Calibri, sans-serif; text-align: justify;"   ><span lang="EN-US"   >NPPluginFuncs&nbsp;</span><span style="font-family: 宋体;"   >也是一个</span><span lang="EN-US"   >&nbsp;Function pointer table</span><span style="font-family: 宋体;"   >，是由</span><span lang="EN-US"   >&nbsp;Plugin&nbsp;</span><span style="font-family: 宋体;"   >传回给</span><span lang="EN-US"   >&nbsp;Browser&nbsp;</span><span style="font-family: 宋体;"   >使用的</span><span lang="EN-US"   >&nbsp;NPP_XXXXX API</span><span style="font-family: 宋体;"   >。</span></p><p style="margin-top: 0cm; margin-right: 0cm; margin-bottom: 0.0001pt; margin-left: 0cm; line-height: normal; font-size: 10.5pt; font-family: Calibri, sans-serif; text-align: justify;"   ><span style="font-family: 宋体;"   >声明如下：</span></p><p align="left"   style="margin-top: 0cm; margin-right: 0cm; margin-bottom: 0.0001pt; margin-left: 0cm; line-height: 13.2pt; font-size: 10.5pt; font-family: Calibri, sans-serif; text-align: left; background-image: initial; background-attachment: initial; background-origin: initial; background-clip: initial; background-color: white; vertical-align: baseline;"   ><span lang="EN-US"   style="font-size: 10pt; font-family: Consolas; color: rgb(78, 78, 78);"   >&nbsp;</span></p><p style="margin-top: 0cm; margin-right: 0cm; margin-bottom: 0.0001pt; margin-left: 0cm; line-height: normal; font-size: 10.5pt; font-family: Calibri, sans-serif; text-align: justify;"   ><span lang="EN-US"   style="font-family: 'Courier New';"   >typedef struct _NPPluginFuncs {</span></p><p style="margin-top: 0cm; margin-right: 0cm; margin-bottom: 0.0001pt; margin-left: 21pt; line-height: normal; font-size: 10.5pt; font-family: Calibri, sans-serif; text-align: justify;"   ><span lang="EN-US"   style="font-family: 'Courier New';"   >uint16 size;</span></p><p style="margin-top: 0cm; margin-right: 0cm; margin-bottom: 0.0001pt; margin-left: 21pt; line-height: normal; font-size: 10.5pt; font-family: Calibri, sans-serif; text-align: justify;"   ><span lang="EN-US"   style="font-family: 'Courier New';"   >uint16 version;</span></p><p style="margin-top: 0cm; margin-right: 0cm; margin-bottom: 0.0001pt; margin-left: 21pt; line-height: normal; font-size: 10.5pt; font-family: Calibri, sans-serif; text-align: justify;"   ><span lang="EN-US"   style="font-family: 'Courier New';"   >NPP_NewProcPtr newp;</span></p><p style="margin-top: 0cm; margin-right: 0cm; margin-bottom: 0.0001pt; margin-left: 21pt; line-height: normal; font-size: 10.5pt; font-family: Calibri, sans-serif; text-align: justify;"   ><span lang="EN-US"   style="font-family: 'Courier New';"   >NPP_DestroyProcPtr destroy;</span></p><p style="margin-top: 0cm; margin-right: 0cm; margin-bottom: 0.0001pt; margin-left: 21pt; line-height: normal; font-size: 10.5pt; font-family: Calibri, sans-serif; text-align: justify;"   ><span lang="EN-US"   style="font-family: 'Courier New';"   >NPP_SetWindowProcPtr setwindow;</span></p><p style="margin-top: 0cm; margin-right: 0cm; margin-bottom: 0.0001pt; margin-left: 21pt; line-height: normal; font-size: 10.5pt; font-family: Calibri, sans-serif; text-align: justify;"   ><span lang="EN-US"   style="font-family: 'Courier New';"   >NPP_NewStreamProcPtr newstream;</span></p><p style="margin-top: 0cm; margin-right: 0cm; margin-bottom: 0.0001pt; margin-left: 21pt; line-height: normal; font-size: 10.5pt; font-family: Calibri, sans-serif; text-align: justify;"   ><span lang="EN-US"   style="font-family: 'Courier New';"   >NPP_DestroyStreamProcPtr destroystream;</span></p><p style="margin-top: 0cm; margin-right: 0cm; margin-bottom: 0.0001pt; margin-left: 21pt; line-height: normal; font-size: 10.5pt; font-family: Calibri, sans-serif; text-align: justify;"   ><span lang="EN-US"   style="font-family: 'Courier New';"   >NPP_StreamAsFileProcPtr asfile;</span></p><p style="margin-top: 0cm; margin-right: 0cm; margin-bottom: 0.0001pt; margin-left: 21pt; line-height: normal; font-size: 10.5pt; font-family: Calibri, sans-serif; text-align: justify;"   ><span lang="EN-US"   style="font-family: 'Courier New';"   >NPP_WriteReadyProcPtr writeready;</span></p><p style="margin-top: 0cm; margin-right: 0cm; margin-bottom: 0.0001pt; margin-left: 21pt; line-height: normal; font-size: 10.5pt; font-family: Calibri, sans-serif; text-align: justify;"   ><span lang="EN-US"   style="font-family: 'Courier New';"   >NPP_WriteProcPtr write;</span></p><p style="margin-top: 0cm; margin-right: 0cm; margin-bottom: 0.0001pt; margin-left: 21pt; line-height: normal; font-size: 10.5pt; font-family: Calibri, sans-serif; text-align: justify;"   ><span lang="EN-US"   style="font-family: 'Courier New';"   >NPP_PrintProcPtr print;</span></p><p style="margin-top: 0cm; margin-right: 0cm; margin-bottom: 0.0001pt; margin-left: 21pt; line-height: normal; font-size: 10.5pt; font-family: Calibri, sans-serif; text-align: justify;"   ><span lang="EN-US"   style="font-family: 'Courier New';"   >NPP_HandleEventProcPtr event;</span></p><p style="margin-top: 0cm; margin-right: 0cm; margin-bottom: 0.0001pt; margin-left: 21pt; line-height: normal; font-size: 10.5pt; font-family: Calibri, sans-serif; text-align: justify;"   ><span lang="EN-US"   style="font-family: 'Courier New';"   >NPP_URLNotifyProcPtr urlnotify;</span></p><p style="margin-top: 0cm; margin-right: 0cm; margin-bottom: 0.0001pt; margin-left: 21pt; line-height: normal; font-size: 10.5pt; font-family: Calibri, sans-serif; text-align: justify;"   ><span lang="EN-US"   style="font-family: 'Courier New';"   >JRIGlobalRef javaClass;</span></p><p style="margin-top: 0cm; margin-right: 0cm; margin-bottom: 0.0001pt; margin-left: 21pt; line-height: normal; font-size: 10.5pt; font-family: Calibri, sans-serif; text-align: justify;"   ><span lang="EN-US"   style="font-family: 'Courier New';"   >NPP_GetValueProcPtr getvalue;</span></p><p style="margin-top: 0cm; margin-right: 0cm; margin-bottom: 0.0001pt; margin-left: 21pt; line-height: normal; font-size: 10.5pt; font-family: Calibri, sans-serif; text-align: justify;"   ><span lang="EN-US"   style="font-family: 'Courier New';"   >NPP_SetValueProcPtr setvalue;</span></p><p style="margin-top: 0cm; margin-right: 0cm; margin-bottom: 0.0001pt; margin-left: 0cm; line-height: normal; font-size: 10.5pt; font-family: Calibri, sans-serif; text-align: justify;"   ><span lang="EN-US"   style="font-family: 'Courier New';"   >}&nbsp;&nbsp; NPPluginFuncs;</span></p><p style="margin-top: 0cm; margin-right: 0cm; margin-bottom: 0.0001pt; margin-left: 0cm; line-height: normal; font-size: 10.5pt; font-family: Calibri, sans-serif; text-align: justify;"   ><span lang="EN-US"   style="font-family: 'Courier New';"   >&nbsp;</span></p><p style="margin-top: 0cm; margin-right: 0cm; margin-bottom: 0.0001pt; margin-left: 0cm; line-height: normal; font-size: 10.5pt; font-family: Calibri, sans-serif; text-align: justify;"   ><b><span lang="EN-US"   style="font-size: 14pt;"   >Plugin Instance Construction and Destruction</span></b></p><p style="margin-top: 0cm; margin-right: 0cm; margin-bottom: 0.0001pt; margin-left: 0cm; line-height: normal; font-size: 10.5pt; font-family: Calibri, sans-serif; text-align: justify;"   ><span style="font-family: 宋体;"   >当</span><span lang="EN-US"   >&nbsp;Browser&nbsp;</span><span style="font-family: 宋体;"   >在</span><span lang="EN-US"   >&nbsp;HTML&nbsp;</span><span style="font-family: 宋体;"   >中发现</span><span lang="EN-US"   >&nbsp;Plugin&nbsp;</span><span style="font-family: 宋体;"   >所对应的</span><span lang="EN-US"   >&nbsp;Mime Type&nbsp;</span><span style="font-family: 宋体;"   >时，会调用</span><span lang="EN-US"   >&nbsp;NPP_New()&nbsp;</span><span style="font-family: 宋体;"   >来向</span><span lang="EN-US"   >&nbsp;Plugin&nbsp;</span><span style="font-family: 宋体;"   >要求一个</span><span lang="EN-US"   >&nbsp;Plugin Instace&nbsp;</span><span style="font-family: 宋体;"   >服务。</span></p><p style="margin-top: 0cm; margin-right: 0cm; margin-bottom: 0.0001pt; margin-left: 0cm; line-height: normal; font-size: 10.5pt; font-family: Calibri, sans-serif; text-align: justify;"   ><span lang="EN-US"   >NPP_New()&nbsp;</span><span style="font-family: 宋体;"   >定义如下：</span></p><p align="left"   style="margin-top: 0cm; margin-right: 0cm; margin-bottom: 0.0001pt; margin-left: 0cm; line-height: 13.2pt; font-size: 10.5pt; font-family: Calibri, sans-serif; text-align: left; background-image: initial; background-attachment: initial; background-origin: initial; background-clip: initial; background-color: white; vertical-align: baseline;"   ><span lang="EN-US"   style="font-size: 10pt; font-family: Consolas; color: rgb(78, 78, 78);"   >&nbsp;</span></p><p style="margin-top: 0cm; margin-right: 0cm; margin-bottom: 0.0001pt; margin-left: 0cm; line-height: normal; font-size: 10.5pt; font-family: Calibri, sans-serif; text-align: justify;"   ><span lang="EN-US"   style="font-family: 'Courier New';"   >#include &lt;npapi.h&gt;</span></p><p style="margin-top: 0cm; margin-right: 0cm; margin-bottom: 0.0001pt; margin-left: 0cm; line-height: normal; font-size: 10.5pt; font-family: Calibri, sans-serif; text-align: justify;"   ><span lang="EN-US"   style="font-family: 'Courier New';"   >&nbsp;</span></p><p style="margin-top: 0cm; margin-right: 0cm; margin-bottom: 0.0001pt; margin-left: 0cm; line-height: normal; font-size: 10.5pt; font-family: Calibri, sans-serif; text-align: justify;"   ><span lang="EN-US"   style="font-family: 'Courier New';"   >NPError NPP_New(NPMIMEType pluginType,</span></p><p style="margin-top: 0cm; margin-right: 0cm; margin-bottom: 0.0001pt; margin-left: 0cm; line-height: normal; font-size: 10.5pt; font-family: Calibri, sans-serif; text-align: justify;"   ><span lang="EN-US"   style="font-family: 'Courier New';"   >NPP instance,</span></p><p style="margin-top: 0cm; margin-right: 0cm; margin-bottom: 0.0001pt; margin-left: 0cm; line-height: normal; font-size: 10.5pt; font-family: Calibri, sans-serif; text-align: justify;"   ><span lang="EN-US"   style="font-family: 'Courier New';"   >uint16 mode,</span></p><p style="margin-top: 0cm; margin-right: 0cm; margin-bottom: 0.0001pt; margin-left: 0cm; line-height: normal; font-size: 10.5pt; font-family: Calibri, sans-serif; text-align: justify;"   ><span lang="EN-US"   style="font-family: 'Courier New';"   >int16 argc,</span></p><p style="margin-top: 0cm; margin-right: 0cm; margin-bottom: 0.0001pt; margin-left: 0cm; line-height: normal; font-size: 10.5pt; font-family: Calibri, sans-serif; text-align: justify;"   ><span lang="EN-US"   style="font-family: 'Courier New';"   >char* argn[],</span></p><p style="margin-top: 0cm; margin-right: 0cm; margin-bottom: 0.0001pt; margin-left: 0cm; line-height: normal; font-size: 10.5pt; font-family: Calibri, sans-serif; text-align: justify;"   ><span lang="EN-US"   style="font-family: 'Courier New';"   >char* argv[],</span></p><p style="margin-top: 0cm; margin-right: 0cm; margin-bottom: 0.0001pt; margin-left: 0cm; line-height: normal; font-size: 10.5pt; font-family: Calibri, sans-serif; text-align: justify;"   ><span lang="EN-US"   style="font-family: 'Courier New';"   >NPSavedData* saved);</span></p><p style="margin-top: 0cm; margin-right: 0cm; margin-bottom: 0.0001pt; margin-left: 0cm; line-height: normal; font-size: 10.5pt; font-family: Calibri, sans-serif; text-align: justify;"   ><span lang="EN-US"   style="font-family: 'Courier New';"   >&nbsp;</span></p><p style="margin-top: 0cm; margin-right: 0cm; margin-bottom: 0.0001pt; margin-left: 0cm; line-height: normal; font-size: 10.5pt; font-family: Calibri, sans-serif; text-align: justify;"   ><span lang="EN-US"   style="font-family: 'Courier New';"   >NPError NPP_Destroy(NPP instance,</span></p><p style="margin-top: 0cm; margin-right: 0cm; margin-bottom: 0.0001pt; margin-left: 0cm; line-height: normal; font-size: 10.5pt; font-family: Calibri, sans-serif; text-align: justify;"   ><span lang="EN-US"   style="font-family: 'Courier New';"   >NPSavedData **save);</span></p><p style="margin-top: 0cm; margin-right: 0cm; margin-bottom: 0.0001pt; margin-left: 0cm; line-height: normal; font-size: 10.5pt; font-family: Calibri, sans-serif; text-align: justify;"   ><span lang="EN-US"   style="font-family: 'Courier New';"   >&nbsp;</span></p><p style="margin-top: 0cm; margin-right: 0cm; margin-bottom: 0.0001pt; margin-left: 0cm; line-height: normal; font-size: 10.5pt; font-family: Calibri, sans-serif; text-align: justify;"   ><span lang="EN-US"   >NPP&nbsp;</span><span style="font-family: 宋体;"   >即为</span><span lang="EN-US"   >&nbsp;Plugin Instance&nbsp;</span><span style="font-family: 宋体;"   >资料结构，由</span><span lang="EN-US"   >&nbsp;Browser&nbsp;</span><span style="font-family: 宋体;"   >所建立，通过</span><span lang="EN-US"   >&nbsp;NPP_New()&nbsp;</span><span style="font-family: 宋体;"   >传送给</span><span lang="EN-US"   >&nbsp;Plugin</span><span style="font-family: 宋体;"   >。</span></p><p style="margin-top: 0cm; margin-right: 0cm; margin-bottom: 7.8pt; margin-left: 0cm; line-height: normal; font-size: 10.5pt; font-family: Calibri, sans-serif; text-align: justify;"   ><span lang="EN-US"   >NPP&nbsp;</span><span style="font-family: 宋体;"   >的结构很简单，仅包含两个</span><span lang="EN-US"   >&nbsp;void pointer</span><span style="font-family: 宋体;"   >：</span></p><p style="margin-top: 0cm; margin-right: 0cm; margin-bottom: 0.0001pt; margin-left: 21pt; line-height: normal; font-size: 10.5pt; font-family: Calibri, sans-serif; text-align: justify; text-indent: -21pt;"   ><span lang="EN-US"   >1.<span style="font: normal normal normal 7pt/normal 'Times New Roman';"   >&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></span><span lang="EN-US"   >void *pdata : Plugin Private Data</span></p><p style="margin-top: 0cm; margin-right: 0cm; margin-bottom: 0.0001pt; margin-left: 21pt; line-height: normal; font-size: 10.5pt; font-family: Calibri, sans-serif; text-align: justify; text-indent: -21pt;"   ><span lang="EN-US"   >2.<span style="font: normal normal normal 7pt/normal 'Times New Roman';"   >&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></span><span lang="EN-US"   >void *ndata : Browser Private Data</span></p><p align="left"   style="margin-top: 0cm; margin-right: 0cm; margin-bottom: 0.0001pt; margin-left: 0cm; line-height: 13.2pt; font-size: 10.5pt; font-family: Calibri, sans-serif; text-align: left; background-image: initial; background-attachment: initial; background-origin: initial; background-clip: initial; background-color: white; vertical-align: baseline;"   ><span lang="EN-US"   style="font-size: 10pt; font-family: Consolas; color: rgb(78, 78, 78);"   >&nbsp;</span></p><p style="margin-top: 0cm; margin-right: 0cm; margin-bottom: 0.0001pt; margin-left: 0cm; line-height: normal; font-size: 10.5pt; font-family: Calibri, sans-serif; text-align: justify;"   ><span lang="EN-US"   style="font-family: 'Courier New';"   >/*</span></p><p style="margin-top: 0cm; margin-right: 0cm; margin-bottom: 0.0001pt; margin-left: 0cm; line-height: normal; font-size: 10.5pt; font-family: Calibri, sans-serif; text-align: justify;"   ><span lang="EN-US"   style="font-family: 'Courier New';"   >* NPP is a plug-in's opaque instance handle</span></p><p style="margin-top: 0cm; margin-right: 0cm; margin-bottom: 0.0001pt; margin-left: 0cm; line-height: normal; font-size: 10.5pt; font-family: Calibri, sans-serif; text-align: justify;"   ><span lang="EN-US"   style="font-family: 'Courier New';"   >*/</span></p><p style="margin-top: 0cm; margin-right: 0cm; margin-bottom: 0.0001pt; margin-left: 0cm; line-height: normal; font-size: 10.5pt; font-family: Calibri, sans-serif; text-align: justify;"   ><span lang="EN-US"   style="font-family: 'Courier New';"   >typedef</span><span lang="EN-US"   style="font-size: 10pt; font-family: 'Courier New';"   >&nbsp;</span><span lang="EN-US"   style="font-family: 'Courier New';"   >struct</span><span lang="EN-US"   style="font-size: 10pt; font-family: 'Courier New';"   >&nbsp;</span><span lang="EN-US"   style="font-family: 'Courier New';"   >_NPP</span></p><p style="margin-top: 0cm; margin-right: 0cm; margin-bottom: 0.0001pt; margin-left: 0cm; line-height: normal; font-size: 10.5pt; font-family: Calibri, sans-serif; text-align: justify;"   ><span lang="EN-US"   style="font-family: 'Courier New';"   >{</span></p><p style="margin-top: 0cm; margin-right: 0cm; margin-bottom: 0.0001pt; margin-left: 21pt; line-height: normal; font-size: 10.5pt; font-family: Calibri, sans-serif; text-align: justify;"   ><span lang="EN-US"   style="font-family: 'Courier New';"   >void* pdata; /* plug-in private data */</span></p><p style="margin-top: 0cm; margin-right: 0cm; margin-bottom: 0.0001pt; margin-left: 21pt; line-height: normal; font-size: 10.5pt; font-family: Calibri, sans-serif; text-align: justify;"   ><span lang="EN-US"   style="font-family: 'Courier New';"   >void* ndata; /* netscape private data */</span></p><p style="margin-top: 0cm; margin-right: 0cm; margin-bottom: 0.0001pt; margin-left: 0cm; line-height: normal; font-size: 10.5pt; font-family: Calibri, sans-serif; text-align: justify;"   ><span lang="EN-US"   style="font-family: 'Courier New';"   >} NPP_t;</span></p><p style="margin-top: 0cm; margin-right: 0cm; margin-bottom: 0.0001pt; margin-left: 0cm; line-height: normal; font-size: 10.5pt; font-family: Calibri, sans-serif; text-align: justify;"   ><span lang="EN-US"   style="font-family: 'Courier New';"   >typedef</span><span lang="EN-US"   style="font-size: 10pt; font-family: 'Courier New';"   >&nbsp;</span><span lang="EN-US"   style="font-family: 'Courier New';"   >NPP_t* NPP;</span></p><p style="margin-top: 0cm; margin-right: 0cm; margin-bottom: 0.0001pt; margin-left: 0cm; line-height: normal; font-size: 10.5pt; font-family: Calibri, sans-serif; text-align: justify;"   ><span lang="EN-US"   style="font-size: 10pt; font-family: 'Courier New';"   >&nbsp;</span></p><p style="margin-top: 0cm; margin-right: 0cm; margin-bottom: 0.0001pt; margin-left: 0cm; line-height: normal; font-size: 10.5pt; font-family: Calibri, sans-serif; text-align: justify;"   ><span style="font-family: 宋体;"   >而</span><span lang="EN-US"   >&nbsp;Browser&nbsp;</span><span style="font-family: 宋体;"   >在某个</span><span lang="EN-US"   >&nbsp;Page&nbsp;</span><span style="font-family: 宋体;"   >被</span><span lang="EN-US"   >&nbsp;Unload&nbsp;</span><span style="font-family: 宋体;"   >之前，则会调用</span><span lang="EN-US"   >&nbsp;NPP_Destroy()&nbsp;</span><span style="font-family: 宋体;"   >来通知</span><span lang="EN-US"   >&nbsp;Plugin&nbsp;</span><span style="font-family: 宋体;"   >结束所对应的</span><span lang="EN-US"   >&nbsp;Plugin Instance</span><span style="font-family: 宋体;"   >。</span></p><p style="margin-top: 0cm; margin-right: 0cm; margin-bottom: 0.0001pt; margin-left: 0cm; line-height: normal; font-size: 10.5pt; font-family: Calibri, sans-serif; text-align: justify;"   ><span lang="EN-US"   >&nbsp;</span></p><p style="margin-top: 0cm; margin-right: 0cm; margin-bottom: 0.0001pt; margin-left: 0cm; line-height: normal; font-size: 10.5pt; font-family: Calibri, sans-serif; text-align: justify;"   ><b><span lang="EN-US"   style="font-size: 14pt;"   >Scriptability</span></b></p><p style="margin-top: 0cm; margin-right: 0cm; margin-bottom: 0.0001pt; margin-left: 0cm; line-height: normal; font-size: 10.5pt; font-family: Calibri, sans-serif; text-align: justify;"   ><span lang="EN-US"   >Scriptability&nbsp;</span><span style="font-family: 宋体;"   >就是让</span><span lang="EN-US"   >&nbsp;JavaScript&nbsp;</span><span style="font-family: 宋体;"   >可以将</span><span lang="EN-US"   >&nbsp;Plugin&nbsp;</span><span style="font-family: 宋体;"   >当作</span><span lang="EN-US"   >&nbsp;JavaScript Object&nbsp;</span><span style="font-family: 宋体;"   >来使用，而</span><span lang="EN-US"   >&nbsp;NPRuntime&nbsp;</span><span style="font-family: 宋体;"   >定义了</span><span lang="EN-US"   >&nbsp;NPObject&nbsp;</span><span style="font-family: 宋体;"   >与</span><span lang="EN-US"   >&nbsp;NPClass&nbsp;</span><span style="font-family: 宋体;"   >两个结构来建立</span><span lang="EN-US"   >&nbsp;Browser&nbsp;</span><span style="font-family: 宋体;"   >能够了解的</span><span lang="EN-US"   >&nbsp;Scriptable Object&nbsp;</span><span style="font-family: 宋体;"   >。</span></p><p style="margin-top: 0cm; margin-right: 0cm; margin-bottom: 0.0001pt; margin-left: 0cm; line-height: normal; font-size: 10.5pt; font-family: Calibri, sans-serif; text-align: justify;"   ><span lang="EN-US"   >&nbsp;</span></p><p style="margin-top: 0cm; margin-right: 0cm; margin-bottom: 0.0001pt; margin-left: 0cm; line-height: normal; font-size: 10.5pt; font-family: Calibri, sans-serif; text-align: justify;"   ><b><span lang="EN-US"   style="font-size: 14pt;"   >Multiple NPObject Instances</span></b></p><p style="margin-top: 0cm; margin-right: 0cm; margin-bottom: 0.0001pt; margin-left: 0cm; line-height: normal; font-size: 10.5pt; font-family: Calibri, sans-serif; text-align: justify;"   ><span style="font-family: 宋体;"   >该注意的一点是，</span><span lang="EN-US"   >NPObject&nbsp;</span><span style="font-family: 宋体;"   >本身也是需要支援</span><span lang="EN-US"   >&nbsp;Multiple Instance</span><span style="font-family: 宋体;"   >，原因很简单，因为</span><span lang="EN-US"   >&nbsp;Plugin Instance&nbsp;</span><span style="font-family: 宋体;"   >都应该拥有自己的</span><span lang="EN-US"   >&nbsp;NPObject</span><span style="font-family: 宋体;"   >，若是</span><span lang="EN-US"   >&nbsp;NPObject&nbsp;</span><span style="font-family: 宋体;"   >不设计成</span><span lang="EN-US"   >&nbsp;Multiple Instance</span><span style="font-family: 宋体;"   >，就得所有</span><span lang="EN-US"   >&nbsp;Plugin Instance “</span><span style="font-family: 宋体;"   >共用</span><span lang="EN-US"   >”</span><span style="font-family: 宋体;"   >一组</span><span lang="EN-US"   >&nbsp;NPObject</span><span style="font-family: 宋体;"   >，将会带来很多扩充性上的困难。</span></p><p style="margin-top: 0cm; margin-right: 0cm; margin-bottom: 0.0001pt; margin-left: 0cm; line-height: normal; font-size: 10.5pt; font-family: Calibri, sans-serif; text-align: justify;"   ><span lang="EN-US"   >&nbsp;</span></p><p style="margin-top: 0cm; margin-right: 0cm; margin-bottom: 0.0001pt; margin-left: 0cm; line-height: normal; font-size: 10.5pt; font-family: Calibri, sans-serif; text-align: justify;"   ><b><span lang="EN-US"   style="font-size: 14pt;"   >Scriptable Object Model (NPObject &amp; NPClass design with UML)</span></b></p><p style="margin-top: 0cm; margin-right: 0cm; margin-bottom: 0.0001pt; margin-left: 0cm; line-height: normal; font-size: 10.5pt; font-family: Calibri, sans-serif; text-align: justify;"   ><span style="font-family: 宋体;"   >以下是个人从</span><span lang="EN-US"   >&nbsp;NPRuntime&nbsp;</span><span style="font-family: 宋体;"   >设计中理解出的</span><span lang="EN-US"   >&nbsp;Scriptable Object Model (</span><span style="font-family: 宋体;"   >名字取的不好，多见谅。</span><span lang="EN-US"   >)</span></p><p align="left"   style="margin-top: 7.2pt; margin-right: 0cm; margin-bottom: 3.6pt; margin-left: 0cm; text-align: left;"   ><font face="宋体"   size="2"   ><span style="line-height: 20px;"   ></span></font></p><div><font face="宋体"   size="2"   ><img title="2011年02月12日 - Dsliu - Dspace"   alt="2011年02月12日 - Dsliu - Dspace"   style="margin:0 10px 0 0;"   src="pic/img.ph.126.net_Yb0ytxuCJnT8YjWltHWYMg==_3729261966440037049.png"   ></font></div><font face="宋体"   size="2"   >&nbsp;</font><p></p><p style="margin-top: 0cm; margin-right: 0cm; margin-bottom: 0.0001pt; margin-left: 0cm; line-height: normal; font-size: 10.5pt; font-family: Calibri, sans-serif; text-align: justify;"   ><b><span lang="EN-US"   style="font-size: 14pt;"   >What is NPClass?</span></b></p><p style="margin-top: 0cm; margin-right: 0cm; margin-bottom: 7.8pt; margin-left: 0cm; line-height: normal; font-size: 10.5pt; font-family: Calibri, sans-serif; text-align: justify;"   ><span lang="EN-US"   >NPClass&nbsp;</span><span style="font-family: 宋体;"   >是一组</span><span lang="EN-US"   >&nbsp;Interface (function pointer table)</span><span style="font-family: 宋体;"   >，代表某个</span><span lang="EN-US"   >&nbsp;NPObject&nbsp;</span><span style="font-family: 宋体;"   >在建立</span><span lang="EN-US"   >&nbsp;Instance&nbsp;</span><span style="font-family: 宋体;"   >时所需要的动作</span><span lang="EN-US"   >(ex: Constructor/Desctructor)</span><span style="font-family: 宋体;"   >，也就是说</span><span lang="EN-US"   >&nbsp;Browser&nbsp;</span><span style="font-family: 宋体;"   >只透过</span><span lang="EN-US"   >&nbsp;NPClass</span><span style="font-family: 宋体;"   >所指定的</span><span lang="EN-US"   >&nbsp;Methods&nbsp;</span><span style="font-family: 宋体;"   >来建立新的</span><span lang="EN-US"   >&nbsp;NPObject Instance</span><span style="font-family: 宋体;"   >。举例来说，当</span><span lang="EN-US"   >&nbsp;Browser&nbsp;</span><span style="font-family: 宋体;"   >透过</span><span lang="EN-US"   >&nbsp;NPP_GetValue()&nbsp;</span><span style="font-family: 宋体;"   >来向</span><span lang="EN-US"   >&nbsp;Plugin&nbsp;</span><span style="font-family: 宋体;"   >要一个</span><span lang="EN-US"   >&nbsp;Property&nbsp;</span><span style="font-family: 宋体;"   >时，</span><span lang="EN-US"   >Plugin&nbsp;</span><span style="font-family: 宋体;"   >可以传回一个</span><span lang="EN-US"   >&nbsp;NPObject&nbsp;</span><span style="font-family: 宋体;"   >给</span><span lang="EN-US"   >Browser&nbsp;</span><span style="font-family: 宋体;"   >，让</span><span lang="EN-US"   >&nbsp;Browser&nbsp;</span><span style="font-family: 宋体;"   >知道其实这个</span><span lang="EN-US"   >&nbsp;Plugin Property&nbsp;</span><span style="font-family: 宋体;"   >其实是一个</span><span lang="EN-US"   >&nbsp;Scriptable Object</span><span style="font-family: 宋体;"   >。</span></p><p style="margin-top: 0cm; margin-right: 0cm; margin-bottom: 7.8pt; margin-left: 0cm; line-height: normal; font-size: 10.5pt; font-family: Calibri, sans-serif; text-align: justify;"   ><i><span lang="EN-US"   style="color: rgb(71, 71, 71);"   >NPClass&nbsp;</span></i><i><span style="font-family: 宋体; color: rgb(71, 71, 71);"   >其实就是所谓的</span><span style="color: rgb(71, 71, 71);"   >&nbsp;<span lang="EN-US"   ><a title="http://en.wikipedia.org/wiki/Marshalling_(computer_science)" style="color: rgb(0, 113, 187); text-decoration: underline;" rel="nofollow" href="http://en.wikipedia.org/wiki/Marshalling_(computer_science)"   >Marshaling Functions</a></span></span></i><i><span style="font-family: 宋体; color: rgb(71, 71, 71);"   >，这个原本由</span><span style="color: rgb(71, 71, 71);"   >&nbsp;<span lang="EN-US"   >RPC&nbsp;</span></span></i><i><span style="font-family: 宋体; color: rgb(71, 71, 71);"   >发展出来的方法已经在很多地方都可以看到，几乎只要是</span><span lang="EN-US"   style="color: rgb(71, 71, 71);"   >&nbsp;Virtual Machine&nbsp;</span></i><i><span style="font-family: 宋体; color: rgb(71, 71, 71);"   >相关的系统都会用这个方式来达到模拟</span><span lang="EN-US"   style="color: rgb(71, 71, 71);"   >&nbsp;Calling Convention&nbsp;</span></i><i><span style="font-family: 宋体; color: rgb(71, 71, 71);"   >的目的。</span><span lang="EN-US"   style="color: rgb(71, 71, 71);"   ><br></span></i><i><span style="font-family: 宋体; color: rgb(71, 71, 71);"   >不过也有例外的，像是</span><span lang="EN-US"   style="color: rgb(71, 71, 71);"   >&nbsp;Mozilla XPCOM&nbsp;</span></i><i><span style="font-family: 宋体; color: rgb(71, 71, 71);"   >的</span><span style="color: rgb(71, 71, 71);"   >&nbsp;<span lang="EN-US"   ><a style="color: rgb(0, 113, 187); text-decoration: underline;" target="_blank" rel="nofollow" href="https://developer.mozilla.org/en/xptcall_FAQ"   >xptcall&nbsp;</a></span></span></i><i><span style="font-family: 宋体; color: rgb(71, 71, 71);"   >就是直接从</span><span lang="EN-US"   style="color: rgb(71, 71, 71);"   >&nbsp;register/stack&nbsp;</span></i><i><span style="font-family: 宋体; color: rgb(71, 71, 71);"   >来做</span><span lang="EN-US"   style="color: rgb(71, 71, 71);"   >&nbsp;Marshaling&nbsp;</span></i><i><span style="font-family: 宋体; color: rgb(71, 71, 71);"   >的动作。</span></i></p><p style="margin-top: 0cm; margin-right: 0cm; margin-bottom: 7.8pt; margin-left: 0cm; line-height: normal; font-size: 10.5pt; font-family: Calibri, sans-serif; text-align: justify;"   ><span lang="EN-US"   >PluginObject&nbsp;</span><span style="font-family: 宋体;"   >是我们实际上想建立的</span><span lang="EN-US"   >&nbsp;Object</span><span style="font-family: 宋体;"   >，它应该具有我们想要的</span><span lang="EN-US"   >&nbsp;Custome Properties&nbsp;</span><span style="font-family: 宋体;"   >与</span><span lang="EN-US"   >&nbsp;Methods</span><span style="font-family: 宋体;"   >，而</span><span lang="EN-US"   >&nbsp;PluginObject&nbsp;</span><span style="font-family: 宋体;"   >所拥有的</span><span lang="EN-US"   >&nbsp;NPClass&nbsp;</span><span style="font-family: 宋体;"   >其实就是</span><span lang="EN-US"   >&nbsp;PluginClass&nbsp;</span><span style="font-family: 宋体;"   >，也是由我们设计的，因为只有设计者才知道</span><span lang="EN-US"   >&nbsp;Plugin Object&nbsp;</span><span style="font-family: 宋体;"   >应该如何</span><span lang="EN-US"   >&nbsp;construct/destruct/etc…)</span><span style="font-family: 宋体;"   >。</span></p><p style="margin-top: 0cm; margin-right: 0cm; margin-bottom: 7.8pt; margin-left: 0cm; line-height: normal; font-size: 10.5pt; font-family: Calibri, sans-serif; text-align: justify;"   ><span style="font-family: 宋体;"   >当</span><span lang="EN-US"   >&nbsp;Browser&nbsp;</span><span style="font-family: 宋体;"   >需要建立</span><span lang="EN-US"   >&nbsp;NPObject Instance&nbsp;</span><span style="font-family: 宋体;"   >时，会呼叫</span><span lang="EN-US"   >&nbsp;NPObject→NPClass→allocate()</span><span style="font-family: 宋体;"   >，也就会呼叫到</span>&nbsp;<span lang="EN-US"   >PluginClass→pluginAllocate()</span><span style="font-family: 宋体;"   >，我们就可以</span><span lang="EN-US"   >&nbsp;new PluginObject()&nbsp;</span><span style="font-family: 宋体;"   >传回给</span><span lang="EN-US"   >&nbsp;Browser&nbsp;</span><span style="font-family: 宋体;"   >了。简单的说，</span><span lang="EN-US"   >Browser&nbsp;</span><span style="font-family: 宋体;"   >想要建立或是存取任何</span><span lang="EN-US"   >&nbsp;PluginObject</span><span style="font-family: 宋体;"   >，都得透过</span><span lang="EN-US"   >&nbsp;PluginClass&nbsp;</span><span style="font-family: 宋体;"   >中的</span><span lang="EN-US"   >&nbsp;API</span><span style="font-family: 宋体;"   >，</span><span lang="EN-US"   >Browser&nbsp;</span><span style="font-family: 宋体;"   >是无法直接存取</span><span lang="EN-US"   >&nbsp;PluginObject&nbsp;</span><span style="font-family: 宋体;"   >的</span><span lang="EN-US"   >&nbsp;Custom Property/Methods&nbsp;</span><span style="font-family: 宋体;"   >。</span></p><p style="margin-top: 0cm; margin-right: 0cm; margin-bottom: 7.8pt; margin-left: 0cm; line-height: normal; font-size: 10.5pt; font-family: Calibri, sans-serif; text-align: justify;"   ><span style="font-family: 宋体;"   >虽然</span><span lang="EN-US"   >&nbsp;NPRuntime&nbsp;</span><span style="font-family: 宋体;"   >的呼叫都是</span><span lang="EN-US"   >&nbsp;C API</span><span style="font-family: 宋体;"   >，但是实际上这组</span>&nbsp;<span lang="EN-US"   >API&nbsp;</span><span style="font-family: 宋体;"   >想完成的事就是上面的</span><span lang="EN-US"   >&nbsp;Scriptable Object Model</span><span style="font-family: 宋体;"   >。若只是了解</span><span lang="EN-US"   >&nbsp;Call Flow&nbsp;</span><span style="font-family: 宋体;"   >是不够的，要能</span><span lang="EN-US"   >“</span><span style="font-family: 宋体;"   >读出</span><span lang="EN-US"   >”</span><span style="font-family: 宋体;"   >原来设计这组</span><span lang="EN-US"   >API&nbsp;</span><span style="font-family: 宋体;"   >的人在</span><span lang="EN-US"   >“</span><span style="font-family: 宋体;"   >想</span><span lang="EN-US"   >”</span><span style="font-family: 宋体;"   >的是什么。</span></p><p style="margin-top: 0cm; margin-right: 0cm; margin-bottom: 7.8pt; margin-left: 0cm; line-height: normal; font-size: 10.5pt; font-family: Calibri, sans-serif; text-align: justify;"   ><span lang="EN-US"   >NPClass&nbsp;</span><span style="font-family: 宋体;"   >与</span><span lang="EN-US"   >&nbsp;NPObject&nbsp;</span><span style="font-family: 宋体;"   >的</span><span lang="EN-US"   >&nbsp;C&nbsp;</span><span style="font-family: 宋体;"   >宣告如下</span><span lang="EN-US"   >:</span></p><p style="margin-top: 0cm; margin-right: 0cm; margin-bottom: 0.0001pt; margin-left: 0cm; line-height: normal; font-size: 10.5pt; font-family: Calibri, sans-serif; text-align: justify;"   ><span lang="EN-US"   style="font-family: 'Courier New';"   >struct</span><span lang="EN-US"   style="font-size: 10pt; font-family: 'Courier New';"   >&nbsp;</span><span lang="EN-US"   style="font-family: 'Courier New';"   >NPClass</span></p><p style="margin-top: 0cm; margin-right: 0cm; margin-bottom: 0.0001pt; margin-left: 0cm; line-height: normal; font-size: 10.5pt; font-family: Calibri, sans-serif; text-align: justify;"   ><span lang="EN-US"   style="font-family: 'Courier New';"   >{</span></p><p style="margin-top: 0cm; margin-right: 0cm; margin-bottom: 0.0001pt; margin-left: 21pt; line-height: normal; font-size: 10.5pt; font-family: Calibri, sans-serif; text-align: justify;"   ><span lang="EN-US"   style="font-family: 'Courier New';"   >uint32_t structVersion;</span></p><p style="margin-top: 0cm; margin-right: 0cm; margin-bottom: 0.0001pt; margin-left: 21pt; line-height: normal; font-size: 10.5pt; font-family: Calibri, sans-serif; text-align: justify;"   ><span lang="EN-US"   style="font-family: 'Courier New';"   >NPAllocateFunctionPtr allocate;</span></p><p style="margin-top: 0cm; margin-right: 0cm; margin-bottom: 0.0001pt; margin-left: 21pt; line-height: normal; font-size: 10.5pt; font-family: Calibri, sans-serif; text-align: justify;"   ><span lang="EN-US"   style="font-family: 'Courier New';"   >NPDeallocateFunctionPtr deallocate;</span></p><p style="margin-top: 0cm; margin-right: 0cm; margin-bottom: 0.0001pt; margin-left: 21pt; line-height: normal; font-size: 10.5pt; font-family: Calibri, sans-serif; text-align: justify;"   ><span lang="EN-US"   style="font-family: 'Courier New';"   >NPInvalidateFunctionPtr invalidate;</span></p><p style="margin-top: 0cm; margin-right: 0cm; margin-bottom: 0.0001pt; margin-left: 21pt; line-height: normal; font-size: 10.5pt; font-family: Calibri, sans-serif; text-align: justify;"   ><span lang="EN-US"   style="font-family: 'Courier New';"   >NPHasMethodFunctionPtr hasMethod;</span></p><p style="margin-top: 0cm; margin-right: 0cm; margin-bottom: 0.0001pt; margin-left: 21pt; line-height: normal; font-size: 10.5pt; font-family: Calibri, sans-serif; text-align: justify;"   ><span lang="EN-US"   style="font-family: 'Courier New';"   >NPInvokeFunctionPtr invoke;</span></p><p style="margin-top: 0cm; margin-right: 0cm; margin-bottom: 0.0001pt; margin-left: 21pt; line-height: normal; font-size: 10.5pt; font-family: Calibri, sans-serif; text-align: justify;"   ><span lang="EN-US"   style="font-family: 'Courier New';"   >NPInvokeDefaultFunctionPtr invokeDefault;</span></p><p style="margin-top: 0cm; margin-right: 0cm; margin-bottom: 0.0001pt; margin-left: 21pt; line-height: normal; font-size: 10.5pt; font-family: Calibri, sans-serif; text-align: justify;"   ><span lang="EN-US"   style="font-family: 'Courier New';"   >NPHasPropertyFunctionPtr hasProperty;</span></p><p style="margin-top: 0cm; margin-right: 0cm; margin-bottom: 0.0001pt; margin-left: 21pt; line-height: normal; font-size: 10.5pt; font-family: Calibri, sans-serif; text-align: justify;"   ><span lang="EN-US"   style="font-family: 'Courier New';"   >NPGetPropertyFunctionPtr getProperty;</span></p><p style="margin-top: 0cm; margin-right: 0cm; margin-bottom: 0.0001pt; margin-left: 21pt; line-height: normal; font-size: 10.5pt; font-family: Calibri, sans-serif; text-align: justify;"   ><span lang="EN-US"   style="font-family: 'Courier New';"   >NPSetPropertyFunctionPtr setProperty;</span></p><p style="margin-top: 0cm; margin-right: 0cm; margin-bottom: 0.0001pt; margin-left: 21pt; line-height: normal; font-size: 10.5pt; font-family: Calibri, sans-serif; text-align: justify;"   ><span lang="EN-US"   style="font-family: 'Courier New';"   >NPRemovePropertyFunctionPtr removeProperty;</span></p><p style="margin-top: 0cm; margin-right: 0cm; margin-bottom: 0.0001pt; margin-left: 21pt; line-height: normal; font-size: 10.5pt; font-family: Calibri, sans-serif; text-align: justify;"   ><span lang="EN-US"   style="font-family: 'Courier New';"   >NPEnumerationFunctionPtr enumerate;</span></p><p style="margin-top: 0cm; margin-right: 0cm; margin-bottom: 0.0001pt; margin-left: 0cm; line-height: normal; font-size: 10.5pt; font-family: Calibri, sans-serif; text-align: justify;"   ><span lang="EN-US"   style="font-family: 'Courier New';"   >};</span></p><p style="margin-top: 0cm; margin-right: 0cm; margin-bottom: 0.0001pt; margin-left: 0cm; line-height: normal; font-size: 10.5pt; font-family: Calibri, sans-serif; text-align: justify;"   ><span lang="EN-US"   style="font-size: 10pt; font-family: 'Courier New';"   >&nbsp;</span></p><p style="margin-top: 0cm; margin-right: 0cm; margin-bottom: 0.0001pt; margin-left: 0cm; line-height: normal; font-size: 10.5pt; font-family: Calibri, sans-serif; text-align: justify;"   ><span lang="EN-US"   style="font-family: 'Courier New';"   >struct</span><span lang="EN-US"   style="font-size: 10pt; font-family: 'Courier New';"   >&nbsp;</span><span lang="EN-US"   style="font-family: 'Courier New';"   >NPObject {</span></p><p style="margin-top: 0cm; margin-right: 0cm; margin-bottom: 0.0001pt; margin-left: 21pt; line-height: normal; font-size: 10.5pt; font-family: Calibri, sans-serif; text-align: justify;"   ><span lang="EN-US"   style="font-family: 'Courier New';"   >NPClass *_class;</span></p><p style="margin-top: 0cm; margin-right: 0cm; margin-bottom: 0.0001pt; margin-left: 21pt; line-height: normal; font-size: 10.5pt; font-family: Calibri, sans-serif; text-align: justify;"   ><span lang="EN-US"   style="font-family: 'Courier New';"   >uint32_t referenceCount;</span></p><p style="margin-top: 0cm; margin-right: 0cm; margin-bottom: 0.0001pt; margin-left: 21pt; line-height: normal; font-size: 10.5pt; font-family: Calibri, sans-serif; text-align: justify;"   ><span lang="EN-US"   style="font-family: 'Courier New';"   >// Additional space may be allocated here by types of NPObjects</span></p><p style="margin-top: 0cm; margin-right: 0cm; margin-bottom: 0.0001pt; margin-left: 0cm; line-height: normal; font-size: 10.5pt; font-family: Calibri, sans-serif; text-align: justify;"   ><span lang="EN-US"   style="font-family: 'Courier New';"   >}</span></p><p style="margin-top: 0cm; margin-right: 0cm; margin-bottom: 0.0001pt; margin-left: 0cm; line-height: normal; font-size: 10.5pt; font-family: Calibri, sans-serif; text-align: justify;"   ><b><span lang="EN-US"   style="font-size: 14pt;"   >When should NPObject be created?</span></b></p><p style="margin-top: 0cm; margin-right: 0cm; margin-bottom: 0.0001pt; margin-left: 0cm; line-height: normal; font-size: 10.5pt; font-family: Calibri, sans-serif; text-align: justify;"   ><span style="font-family: 宋体;"   >当</span><span lang="EN-US"   >&nbsp;NPP_New()&nbsp;</span><span style="font-family: 宋体;"   >要求建立</span><span lang="EN-US"   >&nbsp;Plugin Instance&nbsp;</span><span style="font-family: 宋体;"   >，就需要建立我们的</span><span lang="EN-US"   >&nbsp;PluginObject(which is a NPObject) Instance</span><span style="font-family: 宋体;"   >，在此同时，应该直接以</span><span lang="EN-US"   >&nbsp;NPN_CreateObject()&nbsp;</span><span style="font-family: 宋体;"   >来建立相对应的</span><span lang="EN-US"   >NPObject</span><span style="font-family: 宋体;"   >，因为</span><span lang="EN-US"   >&nbsp;NPObject&nbsp;</span><span style="font-family: 宋体;"   >是由</span><span lang="EN-US"   >&nbsp;Browser&nbsp;</span><span style="font-family: 宋体;"   >来主动</span><span lang="EN-US"   >&nbsp;Allocate/Free Memory</span><span style="font-family: 宋体;"   >，所以</span><span lang="EN-US"   >&nbsp;reference count&nbsp;</span><span style="font-family: 宋体;"   >也会纪录在</span><span lang="EN-US"   >&nbsp;NPObject&nbsp;</span><span style="font-family: 宋体;"   >中。</span></p><p style="margin-top: 0cm; margin-right: 0cm; margin-bottom: 0.0001pt; margin-left: 0cm; line-height: normal; font-size: 10.5pt; font-family: Calibri, sans-serif; text-align: justify;"   ><span lang="EN-US"   >&nbsp;</span></p><p style="margin-top: 0cm; margin-right: 0cm; margin-bottom: 0.0001pt; margin-left: 0cm; line-height: normal; font-size: 10.5pt; font-family: Calibri, sans-serif; text-align: justify;"   ><span style="font-family: 宋体;"   >以下为使用</span><span lang="EN-US"   >&nbsp;NPN_CreateObject()&nbsp;</span><span style="font-family: 宋体;"   >来建立</span><span lang="EN-US"   >&nbsp;NPObject&nbsp;</span><span style="font-family: 宋体;"   >的示例</span><span lang="EN-US"   >:</span></p><p style="margin-top: 0cm; margin-right: 0cm; margin-bottom: 0.0001pt; margin-left: 0cm; line-height: normal; font-size: 10.5pt; font-family: Calibri, sans-serif; text-align: justify;"   ><span lang="EN-US"   style="font-family: 'Courier New';"   >#include &lt;npruntime.h&gt;</span></p><p style="margin-top: 0cm; margin-right: 0cm; margin-bottom: 0.0001pt; margin-left: 0cm; line-height: normal; font-size: 10.5pt; font-family: Calibri, sans-serif; text-align: justify;"   ><span lang="EN-US"   style="font-size: 10pt; font-family: 'Courier New';"   >&nbsp;</span></p><p style="margin-top: 0cm; margin-right: 0cm; margin-bottom: 0.0001pt; margin-left: 0cm; line-height: normal; font-size: 10.5pt; font-family: Calibri, sans-serif; text-align: justify;"   ><span lang="EN-US"   style="font-family: 'Courier New';"   >NPObject *NPN_CreateObject(NPP npp, NPClass *aClass);</span></p><p style="margin-top: 0cm; margin-right: 0cm; margin-bottom: 0.0001pt; margin-left: 0cm; line-height: normal; font-size: 10.5pt; font-family: Calibri, sans-serif; text-align: justify;"   ><span lang="EN-US"   style="font-family: 'Courier New';"   >NPError NPP_New(NPMIMEType pluginType,</span></p><p style="margin-top: 0cm; margin-right: 0cm; margin-bottom: 0.0001pt; margin-left: 0cm; line-height: normal; font-size: 10.5pt; font-family: Calibri, sans-serif; text-align: justify;"   ><span lang="EN-US"   style="font-family: 'Courier New';"   >NPP instance,</span></p><p style="margin-top: 0cm; margin-right: 0cm; margin-bottom: 0.0001pt; margin-left: 0cm; line-height: normal; font-size: 10.5pt; font-family: Calibri, sans-serif; text-align: justify;"   ><span lang="EN-US"   style="font-family: 'Courier New';"   >uint16 mode,</span></p><p style="margin-top: 0cm; margin-right: 0cm; margin-bottom: 0.0001pt; margin-left: 0cm; line-height: normal; font-size: 10.5pt; font-family: Calibri, sans-serif; text-align: justify;"   ><span lang="EN-US"   style="font-family: 'Courier New';"   >int16 argc,</span></p><p style="margin-top: 0cm; margin-right: 0cm; margin-bottom: 0.0001pt; margin-left: 0cm; line-height: normal; font-size: 10.5pt; font-family: Calibri, sans-serif; text-align: justify;"   ><span lang="EN-US"   style="font-family: 'Courier New';"   >char* argn[],</span></p><p style="margin-top: 0cm; margin-right: 0cm; margin-bottom: 0.0001pt; margin-left: 0cm; line-height: normal; font-size: 10.5pt; font-family: Calibri, sans-serif; text-align: justify;"   ><span lang="EN-US"   style="font-family: 'Courier New';"   >char* argv[],</span></p><p style="margin-top: 0cm; margin-right: 0cm; margin-bottom: 0.0001pt; margin-left: 0cm; line-height: normal; font-size: 10.5pt; font-family: Calibri, sans-serif; text-align: justify;"   ><span lang="EN-US"   style="font-family: 'Courier New';"   >NPSavedData* saved)</span></p><p style="margin-top: 0cm; margin-right: 0cm; margin-bottom: 0.0001pt; margin-left: 0cm; line-height: normal; font-size: 10.5pt; font-family: Calibri, sans-serif; text-align: justify;"   ><span lang="EN-US"   style="font-family: 'Courier New';"   >{</span></p><p style="margin-top: 0cm; margin-right: 0cm; margin-bottom: 0.0001pt; margin-left: 21pt; line-height: normal; font-size: 10.5pt; font-family: Calibri, sans-serif; text-align: justify;"   ><span lang="EN-US"   style="font-family: 'Courier New';"   >// Scripting functions appeared in NPAPI version 14</span></p><p style="margin-top: 0cm; margin-right: 0cm; margin-bottom: 0.0001pt; margin-left: 21pt; line-height: normal; font-size: 10.5pt; font-family: Calibri, sans-serif; text-align: justify;"   ><span lang="EN-US"   style="font-family: 'Courier New';"   >if</span><span lang="EN-US"   style="font-size: 10pt; font-family: 'Courier New';"   >&nbsp;</span><span lang="EN-US"   style="font-family: 'Courier New';"   >(browser-&gt;version &gt;= 14)</span></p><p style="margin-top: 0cm; margin-right: 0cm; margin-bottom: 0.0001pt; margin-left: 21pt; line-height: normal; font-size: 10.5pt; font-family: Calibri, sans-serif; text-align: justify;"   ><span lang="EN-US"   style="font-family: 'Courier New';"   >instance-&gt;pdata = NPN_CreateObject ((NPP) instance,</span></p><p style="margin-top: 0cm; margin-right: 0cm; margin-bottom: 0.0001pt; margin-left: 21pt; line-height: normal; font-size: 10.5pt; font-family: Calibri, sans-serif; text-align: justify;"   ><span lang="EN-US"   style="font-family: 'Courier New';"   >(NP_Class *) PluginClass);</span></p><p style="margin-top: 0cm; margin-right: 0cm; margin-bottom: 0.0001pt; margin-left: 0cm; line-height: normal; font-size: 10.5pt; font-family: Calibri, sans-serif; text-align: justify;"   ><span lang="EN-US"   style="font-family: 'Courier New';"   >}</span></p><p style="margin-top: 0cm; margin-right: 0cm; margin-bottom: 7.8pt; margin-left: 0cm; line-height: normal; font-size: 10.5pt; font-family: Calibri, sans-serif; text-align: justify;"   ><span lang="EN-US"   >NPN_CreateObject()&nbsp;</span><span style="font-family: 宋体;"   >是由</span><span lang="EN-US"   >&nbsp;Plugin&nbsp;</span><span style="font-family: 宋体;"   >向</span><span lang="EN-US"   >&nbsp;Browser&nbsp;</span><span style="font-family: 宋体;"   >要求建立一个</span><span lang="EN-US"   >&nbsp;NPObject</span><span style="font-family: 宋体;"   >，此</span><span lang="EN-US"   >&nbsp;NPObject&nbsp;</span><span style="font-family: 宋体;"   >的</span><span lang="EN-US"   >&nbsp;NPClass&nbsp;</span><span style="font-family: 宋体;"   >就是我们所指定的</span><span lang="EN-US"   >&nbsp;PluginClass</span><span style="font-family: 宋体;"   >。</span></p><p style="margin-top: 0cm; margin-right: 0cm; margin-bottom: 7.8pt; margin-left: 0cm; line-height: normal; font-size: 10.5pt; font-family: Calibri, sans-serif; text-align: justify;"   ><span style="font-family: 宋体;"   >若是</span><span lang="EN-US"   >&nbsp;PluginClass&nbsp;</span><span style="font-family: 宋体;"   >中有指定</span><span lang="EN-US"   >&nbsp;allocate()</span><span style="font-family: 宋体;"   >，则</span><span lang="EN-US"   >&nbsp;Browser&nbsp;</span><span style="font-family: 宋体;"   >会使用</span><span lang="EN-US"   >&nbsp;PluginClass -&gt; allocate()&nbsp;</span><span style="font-family: 宋体;"   >来做来替</span><span lang="EN-US"   >&nbsp;NPObject allocate Memory&nbsp;</span><span style="font-family: 宋体;"   >，否则</span><span lang="EN-US"   >&nbsp;Browser&nbsp;</span><span style="font-family: 宋体;"   >会以</span><span lang="EN-US"   >&nbsp;malloc()&nbsp;</span><span style="font-family: 宋体;"   >来</span><span lang="EN-US"   >&nbsp;Allocate NPObject</span><span style="font-family: 宋体;"   >。传回的</span><span lang="EN-US"   >&nbsp;NPObject&nbsp;</span><span style="font-family: 宋体;"   >的</span><span lang="EN-US"   >&nbsp;reference count&nbsp;</span><span style="font-family: 宋体;"   >会变成</span><span lang="EN-US"   >&nbsp;1</span><span style="font-family: 宋体;"   >。</span></p><p style="margin-top: 0cm; margin-right: 0cm; margin-bottom: 7.8pt; margin-left: 0cm; line-height: normal; font-size: 10.5pt; font-family: Calibri, sans-serif; text-align: justify;"   ><span style="font-family: 宋体;"   >这里有一件很重要的技巧，</span><span lang="EN-US"   >PluginClass&nbsp;</span><span style="font-family: 宋体;"   >中的</span><span lang="EN-US"   >&nbsp;pluginAllocate()&nbsp;</span><span style="font-family: 宋体;"   >应该要</span><span lang="EN-US"   >&nbsp;new PluginObject&nbsp;</span><span style="font-family: 宋体;"   >传回给</span><span lang="EN-US"   >&nbsp;Browser</span><span style="font-family: 宋体;"   >，因为</span><span lang="EN-US"   >&nbsp;PluginObject “</span><span style="font-family: 宋体;"   >继承自</span><span lang="EN-US"   >” NPObject</span><span style="font-family: 宋体;"   >，</span>&nbsp;<span style="font-family: 宋体;"   >从</span><span lang="EN-US"   >&nbsp;Browser&nbsp;</span><span style="font-family: 宋体;"   >的角度来看，</span><span lang="EN-US"   >PluginObject&nbsp;</span><span style="font-family: 宋体;"   >就只是个</span><span lang="EN-US"   >&nbsp;NPObject</span><span style="font-family: 宋体;"   >；但是对于</span><span lang="EN-US"   >&nbsp;Plugin&nbsp;</span><span style="font-family: 宋体;"   >来说，</span><span lang="EN-US"   >instance→pdata&nbsp;</span><span style="font-family: 宋体;"   >所存放的其实是</span><span lang="EN-US"   >&nbsp;PluginObject</span><span style="font-family: 宋体;"   >；之后</span><span lang="EN-US"   >&nbsp;Browser&nbsp;</span><span style="font-family: 宋体;"   >呼叫</span><span lang="EN-US"   >&nbsp;PluginClass&nbsp;</span><span style="font-family: 宋体;"   >中的</span><span lang="EN-US"   >&nbsp;Methods&nbsp;</span><span style="font-family: 宋体;"   >时，我们只需要取得</span><span lang="EN-US"   >&nbsp;instance→pdata&nbsp;</span><span style="font-family: 宋体;"   >就可以当做是</span><span lang="EN-US"   >&nbsp;PluginObject</span><span style="font-family: 宋体;"   >，并直接存由</span><span lang="EN-US"   >&nbsp;Plugin&nbsp;</span><span style="font-family: 宋体;"   >自己定义的</span><span lang="EN-US"   >&nbsp;Custom Properties/Methods&nbsp;</span><span style="font-family: 宋体;"   >了。如此一来，就不用一堆</span><span lang="EN-US"   >&nbsp;Variable&nbsp;</span><span style="font-family: 宋体;"   >指来指去的了，这是简化支援</span><span lang="EN-US"   >&nbsp;Multiple Instance&nbsp;</span><span style="font-family: 宋体;"   >的一个重点。</span></p><p style="margin-top: 0cm; margin-right: 0cm; margin-bottom: 7.8pt; margin-left: 0cm; line-height: normal; font-size: 10.5pt; font-family: Calibri, sans-serif; text-align: justify;"   ><i><span style="font-family: 宋体; color: rgb(71, 71, 71);"   >这样的技巧在</span><span lang="EN-US"   style="color: rgb(71, 71, 71);"   >&nbsp;Apple Objective-C&nbsp;</span></i><i><span style="font-family: 宋体; color: rgb(71, 71, 71);"   >与</span><span lang="EN-US"   style="color: rgb(71, 71, 71);"   >&nbsp;Object-Oriented Language (ex: C++ vtable)&nbsp;</span></i><i><span style="font-family: 宋体; color: rgb(71, 71, 71);"   >里是很常见的，可惜的是我们目前的实作完全没有</span><span lang="EN-US"   style="color: rgb(71, 71, 71);"   >&nbsp;OO&nbsp;</span></i><i><span style="font-family: 宋体; color: rgb(71, 71, 71);"   >的思考。</span><span lang="EN-US"   style="color: rgb(71, 71, 71);"   ><br>instance-&gt;pdata&nbsp;</span></i><i><span style="font-family: 宋体; color: rgb(71, 71, 71);"   >反正是个</span><span style="color: rgb(71, 71, 71);"   >&nbsp;<span lang="EN-US"   >void *</span></span></i><i><span style="font-family: 宋体; color: rgb(71, 71, 71);"   >，可以任意</span><span lang="EN-US"   style="color: rgb(71, 71, 71);"   >&nbsp;casting&nbsp;</span></i><i><span style="font-family: 宋体; color: rgb(71, 71, 71);"   >成任一种</span><span lang="EN-US"   style="color: rgb(71, 71, 71);"   >&nbsp;type</span></i><i><span style="font-family: 宋体; color: rgb(71, 71, 71);"   >，</span><span lang="EN-US"   style="color: rgb(71, 71, 71);"   >Browser&nbsp;</span></i><i><span style="font-family: 宋体; color: rgb(71, 71, 71);"   >与</span><span lang="EN-US"   style="color: rgb(71, 71, 71);"   >&nbsp;Plugin&nbsp;</span></i><i><span style="font-family: 宋体; color: rgb(71, 71, 71);"   >就像一个中国各自表述啦～</span></i></p><p style="margin-top: 0cm; margin-right: 0cm; margin-bottom: 0.0001pt; margin-left: 0cm; line-height: normal; font-size: 10.5pt; font-family: Calibri, sans-serif; text-align: justify;"   ><b><span lang="EN-US"   style="font-size: 14pt;"   >Browser ask for NPObject</span></b></p><p style="margin-top: 0cm; margin-right: 0cm; margin-bottom: 0.0001pt; margin-left: 0cm; line-height: normal; font-size: 10.5pt; font-family: Calibri, sans-serif; text-align: justify;"   ><span lang="EN-US"   >Browser&nbsp;</span><span style="font-family: 宋体;"   >在</span><span lang="EN-US"   >&nbsp;NPP_New()&nbsp;</span><span style="font-family: 宋体;"   >建立</span><span lang="EN-US"   >&nbsp;Plugin Instance&nbsp;</span><span style="font-family: 宋体;"   >之后，还会以</span></p><p style="margin-top: 7.8pt; margin-right: 0cm; margin-bottom: 7.8pt; margin-left: 0cm; line-height: normal; font-size: 10.5pt; font-family: Calibri, sans-serif; text-align: justify;"   ><span lang="EN-US"   style="font-family: 'Courier New';"   >NPP_GetValue(npp, NPPVpluginScriptableNPObject, void* value);</span></p><p style="margin-top: 0cm; margin-right: 0cm; margin-bottom: 0.0001pt; margin-left: 0cm; line-height: normal; font-size: 10.5pt; font-family: Calibri, sans-serif; text-align: justify;"   ><span style="font-family: 宋体;"   >来询问</span><span lang="EN-US"   >&nbsp;Plugin&nbsp;</span><span style="font-family: 宋体;"   >是否支援</span><span lang="EN-US"   >&nbsp;Scriptable</span><span style="font-family: 宋体;"   >，此时再把我们先前建立好的</span><span lang="EN-US"   >&nbsp;PluginObject (stored in instance-&gt;pdata)&nbsp;</span><span style="font-family: 宋体;"   >透过</span><span lang="EN-US"   >&nbsp;value&nbsp;</span><span style="font-family: 宋体;"   >传回给</span><span lang="EN-US"   >&nbsp;Browser&nbsp;</span><span style="font-family: 宋体;"   >即可。</span></p><p style="margin-top: 0cm; margin-right: 0cm; margin-bottom: 0.0001pt; margin-left: 0cm; line-height: normal; font-size: 10.5pt; font-family: Calibri, sans-serif; text-align: justify;"   ><span style="font-family: 宋体;"   >示例如下：</span></p><p style="margin-top: 0cm; margin-right: 0cm; margin-bottom: 0.0001pt; margin-left: 0cm; line-height: normal; font-size: 10.5pt; font-family: Calibri, sans-serif; text-align: justify;"   ><span lang="EN-US"   style="font-family: 'Courier New';"   >NPError NPP_GetValue(NPP instance, NPPVariable variable, void</span><span lang="EN-US"   style="font-family: 'Courier New';"   >&nbsp;</span><span lang="EN-US"   style="font-family: 'Courier New';"   >*value)</span></p><p style="margin-top: 0cm; margin-right: 0cm; margin-bottom: 0.0001pt; margin-left: 0cm; line-height: normal; font-size: 10.5pt; font-family: Calibri, sans-serif; text-align: justify;"   ><span lang="EN-US"   style="font-family: 'Courier New';"   >{</span></p><p style="margin-top: 0cm; margin-right: 0cm; margin-bottom: 0.0001pt; margin-left: 21pt; line-height: normal; font-size: 10.5pt; font-family: Calibri, sans-serif; text-align: justify;"   ><span lang="EN-US"   style="font-family: 'Courier New';"   >if</span><span lang="EN-US"   style="font-family: 'Courier New';"   >&nbsp;</span><span lang="EN-US"   style="font-family: 'Courier New';"   >(variable == NPPVpluginScriptableNPObject) {</span></p><p style="margin-top: 0cm; margin-right: 0cm; margin-bottom: 0.0001pt; margin-left: 42pt; line-height: normal; font-size: 10.5pt; font-family: Calibri, sans-serif; text-align: justify;"   ><span lang="EN-US"   style="font-family: 'Courier New';"   >void</span><span lang="EN-US"   style="font-family: 'Courier New';"   >&nbsp;</span><span lang="EN-US"   style="font-family: 'Courier New';"   >**v = (void</span><span lang="EN-US"   style="font-family: 'Courier New';"   >&nbsp;</span><span lang="EN-US"   style="font-family: 'Courier New';"   >**)value;</span></p><p style="margin-top: 0cm; margin-right: 0cm; margin-bottom: 0.0001pt; margin-left: 42pt; line-height: normal; font-size: 10.5pt; font-family: Calibri, sans-serif; text-align: justify;"   ><span lang="EN-US"   style="font-family: 'Courier New';"   >PluginObject *obj = instance-&gt;pdata;</span></p><p style="margin-top: 0cm; margin-right: 0cm; margin-bottom: 0.0001pt; margin-left: 42pt; line-height: normal; font-size: 10.5pt; font-family: Calibri, sans-serif; text-align: justify;"   ><span lang="EN-US"   style="font-family: 'Courier New';"   >&nbsp;</span></p><p style="margin-top: 0cm; margin-right: 0cm; margin-bottom: 0.0001pt; margin-left: 42pt; line-height: normal; font-size: 10.5pt; font-family: Calibri, sans-serif; text-align: justify;"   ><span lang="EN-US"   style="font-family: 'Courier New';"   >if</span><span lang="EN-US"   style="font-family: 'Courier New';"   >&nbsp;</span><span lang="EN-US"   style="font-family: 'Courier New';"   >(obj)</span></p><p style="margin-top: 0cm; margin-right: 0cm; margin-bottom: 0.0001pt; margin-left: 42pt; line-height: normal; font-size: 10.5pt; font-family: Calibri, sans-serif; text-align: justify;"   ><span lang="EN-US"   style="font-family: 'Courier New';"   >NPN_RetainObject((NPObject*)obj);</span></p><p style="margin-top: 0cm; margin-right: 0cm; margin-bottom: 0.0001pt; margin-left: 42pt; line-height: normal; font-size: 10.5pt; font-family: Calibri, sans-serif; text-align: justify;"   ><span lang="EN-US"   style="font-family: 'Courier New';"   >&nbsp;</span></p><p style="margin-top: 0cm; margin-right: 0cm; margin-bottom: 0.0001pt; margin-left: 42pt; line-height: normal; font-size: 10.5pt; font-family: Calibri, sans-serif; text-align: justify;"   ><span lang="EN-US"   style="font-family: 'Courier New';"   >*v = obj;</span></p><p style="margin-top: 0cm; margin-right: 0cm; margin-bottom: 0.0001pt; margin-left: 42pt; line-height: normal; font-size: 10.5pt; font-family: Calibri, sans-serif; text-align: justify;"   ><span lang="EN-US"   style="font-family: 'Courier New';"   >return</span><span lang="EN-US"   style="font-family: 'Courier New';"   >&nbsp;</span><span lang="EN-US"   style="font-family: 'Courier New';"   >NPERR_NO_ERROR;</span></p><p style="margin-top: 0cm; margin-right: 0cm; margin-bottom: 0.0001pt; margin-left: 21pt; line-height: normal; font-size: 10.5pt; font-family: Calibri, sans-serif; text-align: justify;"   ><span lang="EN-US"   style="font-family: 'Courier New';"   >}</span></p><p style="margin-top: 0cm; margin-right: 0cm; margin-bottom: 0.0001pt; margin-left: 21pt; line-height: normal; font-size: 10.5pt; font-family: Calibri, sans-serif; text-align: justify;"   ><span lang="EN-US"   style="font-family: 'Courier New';"   >return</span><span lang="EN-US"   style="font-family: 'Courier New';"   >&nbsp;</span><span lang="EN-US"   style="font-family: 'Courier New';"   >NPERR_GENERIC_ERROR;</span></p><p style="margin-top: 0cm; margin-right: 0cm; margin-bottom: 0.0001pt; margin-left: 0cm; line-height: normal; font-size: 10.5pt; font-family: Calibri, sans-serif; text-align: justify;"   ><span lang="EN-US"   style="font-family: 'Courier New';"   >}</span></p><p style="margin-top: 0cm; margin-right: 0cm; margin-bottom: 0.0001pt; margin-left: 0cm; line-height: normal; font-size: 10.5pt; font-family: Calibri, sans-serif; text-align: justify;"   ><span lang="EN-US"   >NPRuntime API&nbsp;</span><span style="font-family: 宋体;"   >中规定，在传回</span><span lang="EN-US"   >&nbsp;NPObject&nbsp;</span><span style="font-family: 宋体;"   >之前，应该先以</span><span lang="EN-US"   >&nbsp;NPN_RetainObject()&nbsp;</span><span style="font-family: 宋体;"   >来增加</span><span lang="EN-US"   >&nbsp;NPObject.refCount</span><span style="font-family: 宋体;"   >，这对</span><span lang="EN-US"   >&nbsp;JavaScript Engine&nbsp;</span><span style="font-family: 宋体;"   >的</span><span lang="EN-US"   >&nbsp;Garbage Collection&nbsp;</span><span style="font-family: 宋体;"   >机制很重要，千万别忘了。</span></p><p style="margin-top: 0cm; margin-right: 0cm; margin-bottom: 0.0001pt; margin-left: 0cm; line-height: normal; font-size: 10.5pt; font-family: Calibri, sans-serif; text-align: justify;"   ><span lang="EN-US"   >&nbsp;</span></p><p style="margin-top: 0cm; margin-right: 0cm; margin-bottom: 0.0001pt; margin-left: 0cm; line-height: normal; font-size: 10.5pt; font-family: Calibri, sans-serif; text-align: justify;"   ><b><span lang="EN-US"   style="font-size: 14pt;"   >How NPObject was used by JavaScript?</span></b></p><p style="margin-top: 0cm; margin-right: 0cm; margin-bottom: 0.0001pt; margin-left: 0cm; line-height: normal; font-size: 10.5pt; font-family: Calibri, sans-serif; text-align: justify;"   ><b><span lang="EN-US"   style="font-size: 12pt;"   >Two Types Of Marshaling Functions (Method/Property)</span></b></p><p style="margin-top: 0cm; margin-right: 0cm; margin-bottom: 7.8pt; margin-left: 0cm; line-height: normal; font-size: 10.5pt; font-family: Calibri, sans-serif; text-align: justify;"   ><span style="font-family: 宋体;"   >在上面建立完</span><span lang="EN-US"   >&nbsp;Scriptable NPObject&nbsp;</span><span style="font-family: 宋体;"   >后，等于是建立了一个相对应的</span><span lang="EN-US"   >&nbsp;JavaScript Object&nbsp;</span><span style="font-family: 宋体;"   >。于是</span><span lang="EN-US"   >&nbsp;JavaScript&nbsp;</span><span style="font-family: 宋体;"   >可以对</span><span lang="EN-US"   >&nbsp;JavaScript Object&nbsp;</span><span style="font-family: 宋体;"   >做其它的存取动作，而这些动作则被对应到</span><span lang="EN-US"   >&nbsp;NPObject&nbsp;</span><span style="font-family: 宋体;"   >的两类</span><span lang="EN-US"   >&nbsp;Marshaling Functions</span><span style="font-family: 宋体;"   >：</span></p><p style="margin-top: 0cm; margin-right: 0cm; margin-bottom: 7.8pt; margin-left: 0cm; line-height: normal; font-size: 10.5pt; font-family: Calibri, sans-serif; text-align: justify;"   ><span lang="EN-US"   >(</span><span style="font-family: 宋体;"   >提醒一下：</span><span lang="EN-US"   >NPObject-&gt;_class&nbsp;</span><span style="font-family: 宋体;"   >就是</span><span lang="EN-US"   >&nbsp;NPClass )</span></p><p style="margin-top: 0cm; margin-right: 0cm; margin-bottom: 0.0001pt; margin-left: 21pt; line-height: normal; font-size: 10.5pt; font-family: Calibri, sans-serif; text-align: justify; text-indent: -21pt;"   ><span lang="EN-US"   >1.<span style="font: normal normal normal 7pt/normal 'Times New Roman';"   >&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></span><span lang="EN-US"   >Method&nbsp;</span><span style="font-family: 宋体;"   >呼叫</span></p><p style="margin-top: 0cm; margin-right: 0cm; margin-bottom: 0.0001pt; margin-left: 0cm; line-height: normal; font-size: 10.5pt; font-family: Calibri, sans-serif; text-align: justify;"   ><span lang="EN-US"   style="font-family: 'Courier New';"   >typedef</span><span lang="EN-US"   style="font-size: 10pt; font-family: 'Courier New';"   >&nbsp;</span><span lang="EN-US"   style="font-family: 'Courier New';"   >bool</span><span lang="EN-US"   style="font-size: 10pt; font-family: 'Courier New';"   >&nbsp;</span><span lang="EN-US"   style="font-family: 'Courier New';"   >(*NPHasMethodFunctionPtr)(NPObject *obj, NPIdentifier name);</span></p><p style="margin-top: 0cm; margin-right: 0cm; margin-bottom: 0.0001pt; margin-left: 0cm; line-height: normal; font-size: 10.5pt; font-family: Calibri, sans-serif; text-align: justify;"   ><span lang="EN-US"   style="font-family: 'Courier New';"   >typedef</span><span lang="EN-US"   style="font-size: 10pt; font-family: 'Courier New';"   >&nbsp;</span><span lang="EN-US"   style="font-family: 'Courier New';"   >bool</span><span lang="EN-US"   style="font-size: 10pt; font-family: 'Courier New';"   >&nbsp;</span><span lang="EN-US"   style="font-family: 'Courier New';"   >(*NPInvokeFunctionPtr)(NPObject *obj, NPIdentifier name, const</span><span lang="EN-US"   style="font-size: 10pt; font-family: 'Courier New';"   >&nbsp;</span><span lang="EN-US"   style="font-family: 'Courier New';"   >NPVariant *args, uint32_t argCount, NPVariant *result);</span></p><p style="margin-top: 0cm; margin-right: 0cm; margin-bottom: 0.0001pt; margin-left: 0cm; line-height: normal; font-size: 10.5pt; font-family: Calibri, sans-serif; text-align: justify;"   ></p><p style="margin-top: 0cm; margin-right: 0cm; margin-bottom: 0.0001pt; margin-left: 0cm; line-height: normal; font-size: 10.5pt; font-family: Calibri, sans-serif; text-align: justify;"   ><span lang="EN-US"   style="font-family: 'Courier New';"   >typedef</span><span lang="EN-US"   style="font-size: 10pt; font-family: 'Courier New';"   >&nbsp;</span><span lang="EN-US"   style="font-family: 'Courier New';"   >bool</span><span lang="EN-US"   style="font-size: 10pt; font-family: 'Courier New';"   >&nbsp;</span><span lang="EN-US"   style="font-family: 'Courier New';"   >(*NPInvokeDefaultFunctionPtr)(NPObject *npobj, const</span><span lang="EN-US"   style="font-size: 10pt; font-family: 'Courier New';"   >&nbsp;</span><span lang="EN-US"   style="font-family: 'Courier New';"   >NPVariant *args, uint32_t argCount, NPVariant *result);</span></p><p style="margin-top: 0cm; margin-right: 0cm; margin-bottom: 0.0001pt; margin-left: 0cm; line-height: normal; font-size: 10.5pt; font-family: Calibri, sans-serif; text-align: justify;"   ><span lang="EN-US"   style="font-size: 10pt; font-family: 'Courier New';"   >&nbsp;</span></p><p style="margin-top: 0cm; margin-right: 0cm; margin-bottom: 0.0001pt; margin-left: 0cm; line-height: normal; font-size: 10.5pt; font-family: Calibri, sans-serif; text-align: justify;"   ><span lang="EN-US"   style="font-family: 'Courier New';"   >struct</span><span lang="EN-US"   style="font-size: 10pt; font-family: 'Courier New';"   >&nbsp;</span><span lang="EN-US"   style="font-family: 'Courier New';"   >NPClass</span></p><p style="margin-top: 0cm; margin-right: 0cm; margin-bottom: 0.0001pt; margin-left: 0cm; line-height: normal; font-size: 10.5pt; font-family: Calibri, sans-serif; text-align: justify;"   ><span lang="EN-US"   style="font-family: 'Courier New';"   >{</span></p><p style="margin-top: 0cm; margin-right: 0cm; margin-bottom: 0.0001pt; margin-left: 21pt; line-height: normal; font-size: 10.5pt; font-family: Calibri, sans-serif; text-align: justify;"   ><span lang="EN-US"   style="font-family: 'Courier New';"   >...</span></p><p style="margin-top: 0cm; margin-right: 0cm; margin-bottom: 0.0001pt; margin-left: 21pt; line-height: normal; font-size: 10.5pt; font-family: Calibri, sans-serif; text-align: justify;"   ><span lang="EN-US"   style="font-family: 'Courier New';"   >NPHasMethodFunctionPtr hasMethod;</span></p><p style="margin-top: 0cm; margin-right: 0cm; margin-bottom: 0.0001pt; margin-left: 21pt; line-height: normal; font-size: 10.5pt; font-family: Calibri, sans-serif; text-align: justify;"   ><span lang="EN-US"   style="font-family: 'Courier New';"   >NPInvokeFunctionPtr invoke;</span></p><p style="margin-top: 0cm; margin-right: 0cm; margin-bottom: 0.0001pt; margin-left: 21pt; line-height: normal; font-size: 10.5pt; font-family: Calibri, sans-serif; text-align: justify;"   ><span lang="EN-US"   style="font-family: 'Courier New';"   >NPInvokeDefaultFunctionPtr invokeDefault;</span></p><p style="margin-top: 0cm; margin-right: 0cm; margin-bottom: 0.0001pt; margin-left: 21pt; line-height: normal; font-size: 10.5pt; font-family: Calibri, sans-serif; text-align: justify;"   ><span lang="EN-US"   style="font-family: 'Courier New';"   >...</span></p><p style="margin-top: 0cm; margin-right: 0cm; margin-bottom: 0.0001pt; margin-left: 0cm; line-height: normal; font-size: 10.5pt; font-family: Calibri, sans-serif; text-align: justify;"   ><span lang="EN-US"   style="font-family: 'Courier New';"   >};</span></p><p style="margin-top: 0cm; margin-right: 0cm; margin-bottom: 0.0001pt; margin-left: 0cm; line-height: normal; font-size: 10.5pt; font-family: Calibri, sans-serif; text-align: justify;"   ><span lang="EN-US"   style="font-size: 10pt; font-family: 'Courier New';"   >&nbsp;</span></p><p style="margin-top: 0cm; margin-right: 0cm; margin-bottom: 0.0001pt; margin-left: 21pt; line-height: normal; font-size: 10.5pt; font-family: Calibri, sans-serif; text-align: justify; text-indent: -21pt;"   ><span lang="EN-US"   >2.<span style="font: normal normal normal 7pt/normal 'Times New Roman';"   >&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></span><span lang="EN-US"   >Property&nbsp;</span><span style="font-family: 宋体;"   >存取</span></p><p style="margin-top: 0cm; margin-right: 0cm; margin-bottom: 0.0001pt; margin-left: 0cm; line-height: normal; font-size: 10.5pt; font-family: Calibri, sans-serif; text-align: justify;"   ><span lang="EN-US"   style="font-family: 'Courier New';"   >typedef</span><span lang="EN-US"   style="font-size: 10pt; font-family: 'Courier New';"   >&nbsp;</span><span lang="EN-US"   style="font-family: 'Courier New';"   >bool</span><span lang="EN-US"   style="font-size: 10pt; font-family: 'Courier New';"   >&nbsp;</span><span lang="EN-US"   style="font-family: 'Courier New';"   >(*NPHasPropertyFunctionPtr)(NPObject *obj, NPIdentifier name);</span></p><p style="margin-top: 0cm; margin-right: 0cm; margin-bottom: 0.0001pt; margin-left: 0cm; line-height: normal; font-size: 10.5pt; font-family: Calibri, sans-serif; text-align: justify;"   ><span lang="EN-US"   style="font-family: 'Courier New';"   >typedef</span><span lang="EN-US"   style="font-size: 10pt; font-family: 'Courier New';"   >&nbsp;</span><span lang="EN-US"   style="font-family: 'Courier New';"   >bool</span><span lang="EN-US"   style="font-size: 10pt; font-family: 'Courier New';"   >&nbsp;</span><span lang="EN-US"   style="font-family: 'Courier New';"   >(*NPGetPropertyFunctionPtr)(NPObject *obj, NPIdentifier name, NPVariant *result);</span></p><p style="margin-top: 0cm; margin-right: 0cm; margin-bottom: 0.0001pt; margin-left: 0cm; line-height: normal; font-size: 10.5pt; font-family: Calibri, sans-serif; text-align: justify;"   ></p><p style="margin-top: 0cm; margin-right: 0cm; margin-bottom: 0.0001pt; margin-left: 0cm; line-height: normal; font-size: 10.5pt; font-family: Calibri, sans-serif; text-align: justify;"   ><span lang="EN-US"   style="font-family: 'Courier New';"   >typedef</span><span lang="EN-US"   style="font-size: 10pt; font-family: 'Courier New';"   >&nbsp;</span><span lang="EN-US"   style="font-family: 'Courier New';"   >bool</span><span lang="EN-US"   style="font-size: 10pt; font-family: 'Courier New';"   >&nbsp;</span><span lang="EN-US"   style="font-family: 'Courier New';"   >(*NPSetPropertyFunctionPtr)(NPObject *obj, NPIdentifier name, const</span><span lang="EN-US"   style="font-size: 10pt; font-family: 'Courier New';"   >&nbsp;</span><span lang="EN-US"   style="font-family: 'Courier New';"   >NPVariant *value);</span></p><p style="margin-top: 0cm; margin-right: 0cm; margin-bottom: 0.0001pt; margin-left: 0cm; line-height: normal; font-size: 10.5pt; font-family: Calibri, sans-serif; text-align: justify;"   ><span lang="EN-US"   style="font-family: 'Courier New';"   >typedef</span><span lang="EN-US"   style="font-size: 10pt; font-family: 'Courier New';"   >&nbsp;</span><span lang="EN-US"   style="font-family: 'Courier New';"   >bool</span><span lang="EN-US"   style="font-size: 10pt; font-family: 'Courier New';"   >&nbsp;</span><span lang="EN-US"   style="font-family: 'Courier New';"   >(*NPRemovePropertyFunctionPtr)(NPObject *npobj, NPIdentifier name);</span></p><p style="margin-top: 0cm; margin-right: 0cm; margin-bottom: 0.0001pt; margin-left: 0cm; line-height: normal; font-size: 10.5pt; font-family: Calibri, sans-serif; text-align: justify;"   ><span lang="EN-US"   style="font-size: 10pt; font-family: 'Courier New';"   >&nbsp;</span></p><p style="margin-top: 0cm; margin-right: 0cm; margin-bottom: 0.0001pt; margin-left: 0cm; line-height: normal; font-size: 10.5pt; font-family: Calibri, sans-serif; text-align: justify;"   ><span lang="EN-US"   style="font-family: 'Courier New';"   >struct</span><span lang="EN-US"   style="font-size: 10pt; font-family: 'Courier New';"   >&nbsp;</span><span lang="EN-US"   style="font-family: 'Courier New';"   >NPClass</span></p><p style="margin-top: 0cm; margin-right: 0cm; margin-bottom: 0.0001pt; margin-left: 0cm; line-height: normal; font-size: 10.5pt; font-family: Calibri, sans-serif; text-align: justify;"   ><span lang="EN-US"   style="font-family: 'Courier New';"   >{</span></p><p style="margin-top: 0cm; margin-right: 0cm; margin-bottom: 0.0001pt; margin-left: 21pt; line-height: normal; font-size: 10.5pt; font-family: Calibri, sans-serif; text-align: justify;"   ><span lang="EN-US"   style="font-family: 'Courier New';"   >...</span></p><p style="margin-top: 0cm; margin-right: 0cm; margin-bottom: 0.0001pt; margin-left: 21pt; line-height: normal; font-size: 10.5pt; font-family: Calibri, sans-serif; text-align: justify;"   ><span lang="EN-US"   style="font-family: 'Courier New';"   >NPHasPropertyFunctionPtr hasProperty;</span></p><p style="margin-top: 0cm; margin-right: 0cm; margin-bottom: 0.0001pt; margin-left: 21pt; line-height: normal; font-size: 10.5pt; font-family: Calibri, sans-serif; text-align: justify;"   ><span lang="EN-US"   style="font-family: 'Courier New';"   >NPGetPropertyFunctionPtr getProperty;</span></p><p style="margin-top: 0cm; margin-right: 0cm; margin-bottom: 0.0001pt; margin-left: 21pt; line-height: normal; font-size: 10.5pt; font-family: Calibri, sans-serif; text-align: justify;"   ><span lang="EN-US"   style="font-family: 'Courier New';"   >NPSetPropertyFunctionPtr setProperty;</span></p><p style="margin-top: 0cm; margin-right: 0cm; margin-bottom: 0.0001pt; margin-left: 21pt; line-height: normal; font-size: 10.5pt; font-family: Calibri, sans-serif; text-align: justify;"   ><span lang="EN-US"   style="font-family: 'Courier New';"   >NPRemovePropertyFunctionPtr removeProperty;</span></p><p style="margin-top: 0cm; margin-right: 0cm; margin-bottom: 0.0001pt; margin-left: 21pt; line-height: normal; font-size: 10.5pt; font-family: Calibri, sans-serif; text-align: justify;"   ><span lang="EN-US"   style="font-family: 'Courier New';"   >...</span></p><p style="margin-top: 0cm; margin-right: 0cm; margin-bottom: 0.0001pt; margin-left: 0cm; line-height: normal; font-size: 10.5pt; font-family: Calibri, sans-serif; text-align: justify;"   ><span lang="EN-US"   style="font-family: 'Courier New';"   >};</span></p><p style="margin-top: 0cm; margin-right: 0cm; margin-bottom: 0.0001pt; margin-left: 0cm; line-height: normal; font-size: 10.5pt; font-family: Calibri, sans-serif; text-align: justify;"   ><span style="font-family: 宋体;"   >从以下示例说明会比较清楚：</span></p><p style="margin-top: 0cm; margin-right: 0cm; margin-bottom: 0.0001pt; margin-left: 0cm; line-height: normal; font-size: 10.5pt; font-family: Calibri, sans-serif; text-align: justify;"   ><span lang="EN-US"   style="font-family: 'Courier New';"   >&lt;script&gt;</span></p><p style="margin-top: 0cm; margin-right: 0cm; margin-bottom: 0.0001pt; margin-left: 0cm; line-height: normal; font-size: 10.5pt; font-family: Calibri, sans-serif; text-align: justify;"   ><span lang="EN-US"   style="font-family: 'Courier New';"   >var</span><span lang="EN-US"   style="font-family: 'Courier New';"   >&nbsp;</span><span lang="EN-US"   style="font-family: 'Courier New';"   >myPlugin = document.getElementByID("FooPlugin");</span></p><p style="margin-top: 0cm; margin-right: 0cm; margin-bottom: 0.0001pt; margin-left: 0cm; line-height: normal; font-size: 10.5pt; font-family: Calibri, sans-serif; text-align: justify;"   ><span lang="EN-US"   style="font-family: 'Courier New';"   >myPlugin.fooMethod();</span></p><p style="margin-top: 0cm; margin-right: 0cm; margin-bottom: 0.0001pt; margin-left: 0cm; line-height: normal; font-size: 10.5pt; font-family: Calibri, sans-serif; text-align: justify;"   ><span lang="EN-US"   style="font-family: 'Courier New';"   >myPlugin.fooProperty = "hello world";</span></p><p style="margin-top: 0cm; margin-right: 0cm; margin-bottom: 0.0001pt; margin-left: 0cm; line-height: normal; font-size: 10.5pt; font-family: Calibri, sans-serif; text-align: justify;"   ><span lang="EN-US"   style="font-family: 'Courier New';"   >&lt;/script&gt;</span></p><p style="margin-top: 0cm; margin-right: 0cm; margin-bottom: 0.0001pt; margin-left: 0cm; line-height: normal; font-size: 10.5pt; font-family: Calibri, sans-serif; text-align: justify;"   ><span lang="EN-US"   style="font-family: 'Courier New';"   >&nbsp;</span></p><p style="margin-top: 0cm; margin-right: 0cm; margin-bottom: 0.0001pt; margin-left: 0cm; line-height: normal; font-size: 10.5pt; font-family: Calibri, sans-serif; text-align: justify;"   ><span style="font-family: 宋体;"   >从</span><span lang="EN-US"   >&nbsp;ECMAScript&nbsp;</span><span style="font-family: 宋体;"   >的角度说明如下：</span></p><p style="margin-top: 0cm; margin-right: 0cm; margin-bottom: 7.8pt; margin-left: 21pt; line-height: normal; font-size: 10.5pt; font-family: Calibri, sans-serif; text-align: justify; text-indent: -21pt;"   ><span lang="EN-US"   style="font-family: Wingdings;"   >l<span style="font: normal normal normal 7pt/normal 'Times New Roman';"   >&nbsp;&nbsp;</span></span><span lang="EN-US"   >myPlugin : "myPlugin"&nbsp;</span><span style="font-family: 宋体;"   >是一个</span><span lang="EN-US"   >&nbsp;JavaScript Object&nbsp;</span><span style="font-family: 宋体;"   >的名字</span><span lang="EN-US"   >(Identifier)</span><span style="font-family: 宋体;"   >，之后可以将</span><span lang="EN-US"   >&nbsp;myPlugin&nbsp;</span><span style="font-family: 宋体;"   >想像成</span><span lang="EN-US"   >&nbsp;NPObject</span><span style="font-family: 宋体;"   >。</span><span lang="EN-US"   >(</span><span style="font-family: 宋体;"   >实际上</span><span lang="EN-US"   >&nbsp;JavaScript VM&nbsp;</span><span style="font-family: 宋体;"   >内部的对应要复杂许多</span><span lang="EN-US"   >)</span></p><p style="margin-top: 0cm; margin-right: 0cm; margin-bottom: 7.8pt; margin-left: 21pt; line-height: normal; font-size: 10.5pt; font-family: Calibri, sans-serif; text-align: justify; text-indent: -21pt;"   ><span lang="EN-US"   style="font-family: Wingdings;"   >l<span style="font: normal normal normal 7pt/normal 'Times New Roman';"   >&nbsp;&nbsp;</span></span><span lang="EN-US"   >fooMethod : "fooMethod"&nbsp;</span><span style="font-family: 宋体;"   >是我们</span><span lang="EN-US"   >&nbsp;Plugin&nbsp;</span><span style="font-family: 宋体;"   >所提供的</span><span lang="EN-US"   >&nbsp;Method&nbsp;</span><span style="font-family: 宋体;"   >的名字</span><span lang="EN-US"   >(Identifier)</span><span style="font-family: 宋体;"   >，则</span><span lang="EN-US"   >&nbsp;myPlugin.fooMethod();&nbsp;</span><span style="font-family: 宋体;"   >会转换成对</span><span lang="EN-US"   >&nbsp;NPObject&nbsp;</span><span style="font-family: 宋体;"   >内</span><span lang="EN-US"   >&nbsp;NPClass&nbsp;</span><span style="font-family: 宋体;"   >的</span><span lang="EN-US"   >&nbsp;function call&nbsp;</span><span style="font-family: 宋体;"   >，动作如下：</span><span lang="EN-US"   ><br>1.&nbsp;</span><span style="font-family: 宋体;"   >透过</span><span lang="EN-US"   >&nbsp;hasMethod(NPObject, NPIdentifier of "fooMethod")&nbsp;</span><span style="font-family: 宋体;"   >询问</span><span lang="EN-US"   >&nbsp;Plugin&nbsp;</span><span style="font-family: 宋体;"   >是否提供名称为</span><span lang="EN-US"   >&nbsp;"fooMethod"&nbsp;</span><span style="font-family: 宋体;"   >的</span><span lang="EN-US"   >&nbsp;Method</span><span style="font-family: 宋体;"   >，若有则到</span><span lang="EN-US"   >&nbsp;2.<br>2.&nbsp;</span><span style="font-family: 宋体;"   >透过</span><span lang="EN-US"   >&nbsp;invokeMethod(NPObject, NPIdentifier of "fooMethod", …)&nbsp;</span><span style="font-family: 宋体;"   >来传送参数给</span><span lang="EN-US"   >&nbsp;Plugin</span><span style="font-family: 宋体;"   >，而</span><span lang="EN-US"   >&nbsp;Plugin&nbsp;</span><span style="font-family: 宋体;"   >则可由</span><span lang="EN-US"   >&nbsp;NPIdentifier&nbsp;</span><span style="font-family: 宋体;"   >得知</span><span lang="EN-US"   >&nbsp;Browser&nbsp;</span><span style="font-family: 宋体;"   >希望呼叫的</span><span lang="EN-US"   >&nbsp;method&nbsp;</span><span style="font-family: 宋体;"   >为何，再去执行所对应的功能，最后再传回值</span><span lang="EN-US"   >&nbsp;(result)</span><span style="font-family: 宋体;"   >。</span></p><p style="margin-top: 0cm; margin-right: 0cm; margin-bottom: 7.8pt; margin-left: 21pt; line-height: normal; font-size: 10.5pt; font-family: Calibri, sans-serif; text-align: justify; text-indent: -21pt;"   ><span lang="EN-US"   style="font-family: Wingdings;"   >l<span style="font: normal normal normal 7pt/normal 'Times New Roman';"   >&nbsp;&nbsp;</span></span><span lang="EN-US"   >fooProperty : "fooProperty"&nbsp;</span><span style="font-family: 宋体;"   >是我们</span><span lang="EN-US"   >&nbsp;Plugin&nbsp;</span><span style="font-family: 宋体;"   >所提供的</span><span lang="EN-US"   >&nbsp;Property&nbsp;</span><span style="font-family: 宋体;"   >的名字</span><span lang="EN-US"   >(Identifier)</span><span style="font-family: 宋体;"   >，则</span><span lang="EN-US"   >&nbsp;myPlugin.fooProperty = "hello world";&nbsp;</span><span style="font-family: 宋体;"   >会转换成为以下动作：</span><span lang="EN-US"   ><br>1.&nbsp;</span><span style="font-family: 宋体;"   >透过</span><span lang="EN-US"   >&nbsp;hasProperty(NPObject, NPIdentifier of "fooProperty");&nbsp;</span><span style="font-family: 宋体;"   >询问</span><span lang="EN-US"   >&nbsp;Plugin&nbsp;</span><span style="font-family: 宋体;"   >是否有提供名称为</span><span lang="EN-US"   >&nbsp;"fooProperty"&nbsp;</span><span style="font-family: 宋体;"   >的</span><span lang="EN-US"   >&nbsp;Property</span><span style="font-family: 宋体;"   >，若有则到</span><span lang="EN-US"   >&nbsp;2.<br>2.&nbsp;</span><span style="font-family: 宋体;"   >透过</span><span lang="EN-US"   >&nbsp;setProperty(NPObject, NPIdentifier of "fooProperty", "hello world");&nbsp;</span><span style="font-family: 宋体;"   >要求</span><span lang="EN-US"   >&nbsp;Plugin&nbsp;</span><span style="font-family: 宋体;"   >执行将</span><span lang="EN-US"   >&nbsp;fooProperty&nbsp;</span><span style="font-family: 宋体;"   >的值更改为</span><span lang="EN-US"   >&nbsp;"hello world"&nbsp;</span><span style="font-family: 宋体;"   >的动作。</span></p><p style="margin-top: 0cm; margin-right: 0cm; margin-bottom: 0.0001pt; margin-left: 0cm; line-height: normal; font-size: 10.5pt; font-family: Calibri, sans-serif; text-align: justify;"   ><span style="font-family: 宋体;"   >以上说明著动在流程上，细节上并非完全正确，因为</span><span lang="EN-US"   >&nbsp;JavaScript (ECMAScript)&nbsp;</span><span style="font-family: 宋体;"   >内部有许多针对</span><span lang="EN-US"   >&nbsp;Objects, Properties, Attributes&nbsp;</span><span style="font-family: 宋体;"   >等细节，可以说上三天三夜了吧！</span></p><p style="margin-top: 0cm; margin-right: 0cm; margin-bottom: 0.0001pt; margin-left: 0cm; line-height: normal; font-size: 10.5pt; font-family: Calibri, sans-serif; text-align: justify;"   ><span lang="EN-US"   >&nbsp;</span></p><p style="margin-top: 0cm; margin-right: 0cm; margin-bottom: 0.0001pt; margin-left: 0cm; line-height: normal; font-size: 10.5pt; font-family: Calibri, sans-serif; text-align: justify;"   ><b><span lang="EN-US"   style="font-size: 14pt;"   >NPVariant (Parameters Serialization between JavaScript and C)</span></b></p><p style="margin-top: 0cm; margin-right: 0cm; margin-bottom: 0.0001pt; margin-left: 0cm; line-height: normal; font-size: 10.5pt; font-family: Calibri, sans-serif; text-align: justify;"   ><span style="font-family: 宋体;"   >在</span><span lang="EN-US"   >&nbsp;Marshaling Functions&nbsp;</span><span style="font-family: 宋体;"   >中，会以</span><span lang="EN-US"   >&nbsp;NPVariant&nbsp;</span><span style="font-family: 宋体;"   >来传送真正的参数资料。</span></p><p style="margin-top: 0cm; margin-right: 0cm; margin-bottom: 0.0001pt; margin-left: 0cm; line-height: normal; font-size: 10.5pt; font-family: Calibri, sans-serif; text-align: justify;"   ><span lang="EN-US"   >NPVariant&nbsp;</span><span style="font-family: 宋体;"   >就是参数的</span><span lang="EN-US"   >&nbsp;Serialized Data Type&nbsp;</span><span style="font-family: 宋体;"   >。</span></p><p style="margin-top: 0cm; margin-right: 0cm; margin-bottom: 0.0001pt; margin-left: 0cm; line-height: normal; font-size: 10.5pt; font-family: Calibri, sans-serif; text-align: justify;"   ><span lang="EN-US"   style="font-family: 'Courier New';"   >typedef</span><span lang="EN-US"   style="font-size: 10pt; font-family: 'Courier New';"   >&nbsp;</span><span lang="EN-US"   style="font-family: 'Courier New';"   >struct</span><span lang="EN-US"   style="font-size: 10pt; font-family: 'Courier New';"   >&nbsp;</span><span lang="EN-US"   style="font-family: 'Courier New';"   >_NPVariant {</span></p><p style="margin-top: 0cm; margin-right: 0cm; margin-bottom: 0.0001pt; margin-left: 21pt; line-height: normal; font-size: 10.5pt; font-family: Calibri, sans-serif; text-align: justify;"   ><span lang="EN-US"   style="font-family: 'Courier New';"   >NPVariantType type;</span></p><p style="margin-top: 0cm; margin-right: 0cm; margin-bottom: 0.0001pt; margin-left: 21pt; line-height: normal; font-size: 10.5pt; font-family: Calibri, sans-serif; text-align: justify;"   ><span lang="EN-US"   style="font-family: 'Courier New';"   >union</span><span lang="EN-US"   style="font-size: 10pt; font-family: 'Courier New';"   >&nbsp;</span><span lang="EN-US"   style="font-family: 'Courier New';"   >{</span></p><p style="margin-top: 0cm; margin-right: 0cm; margin-bottom: 0.0001pt; margin-left: 42pt; line-height: normal; font-size: 10.5pt; font-family: Calibri, sans-serif; text-align: justify;"   ><span lang="EN-US"   style="font-family: 'Courier New';"   >bool</span><span lang="EN-US"   style="font-size: 10pt; font-family: 'Courier New';"   >&nbsp;</span><span lang="EN-US"   style="font-family: 'Courier New';"   >boolValue;</span></p><p style="margin-top: 0cm; margin-right: 0cm; margin-bottom: 0.0001pt; margin-left: 42pt; line-height: normal; font-size: 10.5pt; font-family: Calibri, sans-serif; text-align: justify;"   ><span lang="EN-US"   style="font-family: 'Courier New';"   >int32_t intValue;</span></p><p style="margin-top: 0cm; margin-right: 0cm; margin-bottom: 0.0001pt; margin-left: 42pt; line-height: normal; font-size: 10.5pt; font-family: Calibri, sans-serif; text-align: justify;"   ><span lang="EN-US"   style="font-family: 'Courier New';"   >double</span><span lang="EN-US"   style="font-size: 10pt; font-family: 'Courier New';"   >&nbsp;</span><span lang="EN-US"   style="font-family: 'Courier New';"   >doubleValue;</span></p><p style="margin-top: 0cm; margin-right: 0cm; margin-bottom: 0.0001pt; margin-left: 42pt; line-height: normal; font-size: 10.5pt; font-family: Calibri, sans-serif; text-align: justify;"   ><span lang="EN-US"   style="font-family: 'Courier New';"   >NPString stringValue;</span></p><p style="margin-top: 0cm; margin-right: 0cm; margin-bottom: 0.0001pt; margin-left: 42pt; line-height: normal; font-size: 10.5pt; font-family: Calibri, sans-serif; text-align: justify;"   ><span lang="EN-US"   style="font-family: 'Courier New';"   >NPObject *objectValue;</span></p><p style="margin-top: 0cm; margin-right: 0cm; margin-bottom: 0.0001pt; margin-left: 21pt; line-height: normal; font-size: 10.5pt; font-family: Calibri, sans-serif; text-align: justify;"   ><span lang="EN-US"   style="font-family: 'Courier New';"   >}&nbsp;&nbsp; value;</span></p><p style="margin-top: 0cm; margin-right: 0cm; margin-bottom: 0.0001pt; margin-left: 0cm; line-height: normal; font-size: 10.5pt; font-family: Calibri, sans-serif; text-align: justify;"   ><span lang="EN-US"   style="font-family: 'Courier New';"   >}&nbsp;&nbsp; NPVariant;</span></p><p style="margin-top: 0cm; margin-right: 0cm; margin-bottom: 0.0001pt; margin-left: 0cm; line-height: normal; font-size: 10.5pt; font-family: Calibri, sans-serif; text-align: justify;"   ><span lang="EN-US"   style="font-size: 10pt; font-family: 'Courier New';"   >&nbsp;</span></p><p style="margin-top: 0cm; margin-right: 0cm; margin-bottom: 0.0001pt; margin-left: 0cm; line-height: normal; font-size: 10.5pt; font-family: Calibri, sans-serif; text-align: justify;"   ><span lang="EN-US"   style="font-family: 'Courier New';"   >typedef</span><span lang="EN-US"   style="font-size: 10pt; font-family: 'Courier New';"   >&nbsp;</span><span lang="EN-US"   style="font-family: 'Courier New';"   >enum</span><span lang="EN-US"   style="font-size: 10pt; font-family: 'Courier New';"   >&nbsp;</span><span lang="EN-US"   style="font-family: 'Courier New';"   >{</span></p><p style="margin-top: 0cm; margin-right: 0cm; margin-bottom: 0.0001pt; margin-left: 21pt; line-height: normal; font-size: 10.5pt; font-family: Calibri, sans-serif; text-align: justify;"   ><span lang="EN-US"   style="font-family: 'Courier New';"   >NPVariantType_Void,</span></p><p style="margin-top: 0cm; margin-right: 0cm; margin-bottom: 0.0001pt; margin-left: 21pt; line-height: normal; font-size: 10.5pt; font-family: Calibri, sans-serif; text-align: justify;"   ><span lang="EN-US"   style="font-family: 'Courier New';"   >NPVariantType_Null,</span></p><p style="margin-top: 0cm; margin-right: 0cm; margin-bottom: 0.0001pt; margin-left: 21pt; line-height: normal; font-size: 10.5pt; font-family: Calibri, sans-serif; text-align: justify;"   ><span lang="EN-US"   style="font-family: 'Courier New';"   >NPVariantType_Bool,</span></p><p style="margin-top: 0cm; margin-right: 0cm; margin-bottom: 0.0001pt; margin-left: 21pt; line-height: normal; font-size: 10.5pt; font-family: Calibri, sans-serif; text-align: justify;"   ><span lang="EN-US"   style="font-family: 'Courier New';"   >NPVariantType_Int32,</span></p><p style="margin-top: 0cm; margin-right: 0cm; margin-bottom: 0.0001pt; margin-left: 21pt; line-height: normal; font-size: 10.5pt; font-family: Calibri, sans-serif; text-align: justify;"   ><span lang="EN-US"   style="font-family: 'Courier New';"   >NPVariantType_Double,</span></p><p style="margin-top: 0cm; margin-right: 0cm; margin-bottom: 0.0001pt; margin-left: 21pt; line-height: normal; font-size: 10.5pt; font-family: Calibri, sans-serif; text-align: justify;"   ><span lang="EN-US"   style="font-family: 'Courier New';"   >NPVariantType_String,</span></p><p style="margin-top: 0cm; margin-right: 0cm; margin-bottom: 0.0001pt; margin-left: 21pt; line-height: normal; font-size: 10.5pt; font-family: Calibri, sans-serif; text-align: justify;"   ><span lang="EN-US"   style="font-family: 'Courier New';"   >NPVariantType_Object</span></p><p style="margin-top: 0cm; margin-right: 0cm; margin-bottom: 0.0001pt; margin-left: 0cm; line-height: normal; font-size: 10.5pt; font-family: Calibri, sans-serif; text-align: justify;"   ><span lang="EN-US"   style="font-family: 'Courier New';"   >}&nbsp;&nbsp; NPVariantType;</span></p><p style="margin-top: 0cm; margin-right: 0cm; margin-bottom: 0.0001pt; margin-left: 0cm; line-height: normal; font-size: 10.5pt; font-family: Calibri, sans-serif; text-align: justify;"   ><span lang="EN-US"   style="font-size: 10pt; font-family: 'Courier New';"   >&nbsp;</span></p><p style="margin-top: 0cm; margin-right: 0cm; margin-bottom: 0.0001pt; margin-left: 0cm; line-height: normal; font-size: 10.5pt; font-family: Calibri, sans-serif; text-align: justify;"   ><b><span lang="EN-US"   style="font-size: 14pt;"   >Data Type Mapping Between JavaScript and NPVariant</span></b></p><p style="margin-top: 0cm; margin-right: 0cm; margin-bottom: 0.0001pt; margin-left: 0cm; line-height: normal; font-size: 10.5pt; font-family: Calibri, sans-serif; text-align: justify;"   ><span lang="EN-US"   >NPVariant&nbsp;</span><span style="font-family: 宋体;"   >所封装的资料型态会对应到</span><span lang="EN-US"   >&nbsp;JavaScript&nbsp;</span><span style="font-family: 宋体;"   >资料型态。</span></p><p style="margin-top: 0cm; margin-right: 0cm; margin-bottom: 0.0001pt; margin-left: 0cm; line-height: normal; font-size: 10.5pt; font-family: Calibri, sans-serif; text-align: justify;"   ><span style="font-family: 宋体;"   >对应如下：</span></p><p style="margin-top: 0cm; margin-right: 0cm; margin-bottom: 0.0001pt; margin-left: 0cm; line-height: normal; font-size: 10.5pt; font-family: Calibri, sans-serif; text-align: justify;"   ><span lang="EN-US"   style="font-family: 'Courier New';"   >undefined&nbsp; NPVariantType_Void</span></p><p style="margin-top: 0cm; margin-right: 0cm; margin-bottom: 0.0001pt; margin-left: 0cm; line-height: normal; font-size: 10.5pt; font-family: Calibri, sans-serif; text-align: justify;"   ><span lang="EN-US"   style="font-family: 'Courier New';"   >null&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; NPVariantType_Null</span></p><p style="margin-top: 0cm; margin-right: 0cm; margin-bottom: 0.0001pt; margin-left: 0cm; line-height: normal; font-size: 10.5pt; font-family: Calibri, sans-serif; text-align: justify;"   ><span lang="EN-US"   style="font-family: 'Courier New';"   >Boolean&nbsp;&nbsp;&nbsp; NPVariantType_Bool</span></p><p style="margin-top: 0cm; margin-right: 0cm; margin-bottom: 0.0001pt; margin-left: 0cm; line-height: normal; font-size: 10.5pt; font-family: Calibri, sans-serif; text-align: justify;"   ><span lang="EN-US"   style="font-family: 'Courier New';"   >Number &nbsp;&nbsp;&nbsp; NPVariantType_Double or NPVariantType_Int32</span></p><p style="margin-top: 0cm; margin-right: 0cm; margin-bottom: 0.0001pt; margin-left: 0cm; line-height: normal; font-size: 10.5pt; font-family: Calibri, sans-serif; text-align: justify;"   ><span lang="EN-US"   style="font-family: 'Courier New';"   >String &nbsp;&nbsp;&nbsp; NPVariantType_String</span></p><p style="margin-top: 0cm; margin-right: 0cm; margin-bottom: 0.0001pt; margin-left: 0cm; line-height: normal; font-size: 10.5pt; font-family: Calibri, sans-serif; text-align: justify;"   ><span lang="EN-US"   style="font-family: 'Courier New';"   >Object &nbsp;&nbsp;&nbsp; NPVariantType_Object</span></p><p align="left"   style="margin-top: 8.4pt; margin-right: 0cm; margin-bottom: 8.4pt; margin-left: 0cm; line-height: 15px; font-size: 10.5pt; font-family: Calibri, sans-serif; text-align: left;"   ><b><span lang="EN-US"   style="font-size: 14pt; line-height: 20px;"   >Marshaling Macro</span></b></p><p style="margin-top: 0cm; margin-right: 0cm; margin-bottom: 0.0001pt; margin-left: 0cm; line-height: normal; font-size: 10.5pt; font-family: Calibri, sans-serif; text-align: justify;"   ><span style="font-family: 宋体;"   >为了方便</span><span lang="EN-US"   >&nbsp;NPVariant&nbsp;</span><span style="font-family: 宋体;"   >与</span><span lang="EN-US"   >&nbsp;JavaScript&nbsp;</span><span style="font-family: 宋体;"   >间的资料转换，</span><span lang="EN-US"   >&nbsp;NPRuntime&nbsp;</span><span style="font-family: 宋体;"   >也定义了一组转换的</span><span lang="EN-US"   >&nbsp;Macro&nbsp;</span><span style="font-family: 宋体;"   >方便程式设计。</span></p><p style="margin-top: 0cm; margin-right: 0cm; margin-bottom: 0.0001pt; margin-left: 0cm; line-height: normal; font-size: 10.5pt; font-family: Calibri, sans-serif; text-align: justify;"   ><span lang="EN-US"   style="font-family: 'Courier New';"   >#define NPVARIANT_IS_VOID(_v) ((_v).type == NPVariantType_Void)</span></p><p style="margin-top: 0cm; margin-right: 0cm; margin-bottom: 0.0001pt; margin-left: 0cm; line-height: normal; font-size: 10.5pt; font-family: Calibri, sans-serif; text-align: justify;"   ><span lang="EN-US"   style="font-family: 'Courier New';"   >#define NPVARIANT_IS_NULL(_v) ((_v).type == NPVariantType_Null)</span></p><p style="margin-top: 0cm; margin-right: 0cm; margin-bottom: 0.0001pt; margin-left: 0cm; line-height: normal; font-size: 10.5pt; font-family: Calibri, sans-serif; text-align: justify;"   ><span lang="EN-US"   style="font-family: 'Courier New';"   >#define NPVARIANT_IS_BOOLEAN(_v) ((_v).type == NPVariantType_Bool)</span></p><p style="margin-top: 0cm; margin-right: 0cm; margin-bottom: 0.0001pt; margin-left: 0cm; line-height: normal; font-size: 10.5pt; font-family: Calibri, sans-serif; text-align: justify;"   ><span lang="EN-US"   style="font-family: 'Courier New';"   >#define NPVARIANT_IS_INT32(_v) ((_v).type == NPVariantType_Int32)</span></p><p style="margin-top: 0cm; margin-right: 0cm; margin-bottom: 0.0001pt; margin-left: 0cm; line-height: normal; font-size: 10.5pt; font-family: Calibri, sans-serif; text-align: justify;"   ><span lang="EN-US"   style="font-family: 'Courier New';"   >#define NPVARIANT_IS_DOUBLE(_v) ((_v).type == NPVariantType_Double)</span></p><p style="margin-top: 0cm; margin-right: 0cm; margin-bottom: 0.0001pt; margin-left: 0cm; line-height: normal; font-size: 10.5pt; font-family: Calibri, sans-serif; text-align: justify;"   ><span lang="EN-US"   style="font-family: 'Courier New';"   >#define NPVARIANT_IS_STRING(_v) ((_v).type == NPVariantType_String)</span></p><p style="margin-top: 0cm; margin-right: 0cm; margin-bottom: 0.0001pt; margin-left: 0cm; line-height: normal; font-size: 10.5pt; font-family: Calibri, sans-serif; text-align: justify;"   ><span lang="EN-US"   style="font-family: 'Courier New';"   >#define NPVARIANT_IS_OBJECT(_v) ((_v).type == NPVariantType_Object)</span></p><p style="margin-top: 0cm; margin-right: 0cm; margin-bottom: 0.0001pt; margin-left: 0cm; line-height: normal; font-size: 10.5pt; font-family: Calibri, sans-serif; text-align: justify;"   ><span lang="EN-US"   style="font-size: 10pt; font-family: 'Courier New';"   >&nbsp;</span></p><p style="margin-top: 0cm; margin-right: 0cm; margin-bottom: 0.0001pt; margin-left: 0cm; line-height: normal; font-size: 10.5pt; font-family: Calibri, sans-serif; text-align: justify;"   ><span lang="EN-US"   style="font-family: 'Courier New';"   >#define NPVARIANT_TO_BOOLEAN(_v) ((_v).value.boolValue)</span></p><p style="margin-top: 0cm; margin-right: 0cm; margin-bottom: 0.0001pt; margin-left: 0cm; line-height: normal; font-size: 10.5pt; font-family: Calibri, sans-serif; text-align: justify;"   ><span lang="EN-US"   style="font-family: 'Courier New';"   >#define NPVARIANT_TO_INT32(_v) ((_v).value.intValue)</span></p><p style="margin-top: 0cm; margin-right: 0cm; margin-bottom: 0.0001pt; margin-left: 0cm; line-height: normal; font-size: 10.5pt; font-family: Calibri, sans-serif; text-align: justify;"   ><span lang="EN-US"   style="font-family: 'Courier New';"   >#define NPVARIANT_TO_DOUBLE(_v) ((_v).value.doubleValue)</span></p><p style="margin-top: 0cm; margin-right: 0cm; margin-bottom: 0.0001pt; margin-left: 0cm; line-height: normal; font-size: 10.5pt; font-family: Calibri, sans-serif; text-align: justify;"   ><span lang="EN-US"   style="font-family: 'Courier New';"   >#define NPVARIANT_TO_STRING(_v) ((_v).value.stringValue)</span></p><p style="margin-top: 0cm; margin-right: 0cm; margin-bottom: 0.0001pt; margin-left: 0cm; line-height: normal; font-size: 10.5pt; font-family: Calibri, sans-serif; text-align: justify;"   ><span lang="EN-US"   style="font-family: 'Courier New';"   >#define NPVARIANT_TO_OBJECT(_v) ((_v).value.objectValue)</span></p><p style="margin-top: 0cm; margin-right: 0cm; margin-bottom: 0.0001pt; margin-left: 0cm; line-height: normal; font-size: 10.5pt; font-family: Calibri, sans-serif; text-align: justify;"   ><span lang="EN-US"   style="font-size: 10pt; font-family: 'Courier New';"   >&nbsp;</span></p><p style="margin-top: 0cm; margin-right: 0cm; margin-bottom: 0.0001pt; margin-left: 0cm; line-height: normal; font-size: 10.5pt; font-family: Calibri, sans-serif; text-align: justify;"   ><span lang="EN-US"   style="font-family: 'Courier New';"   >#define NP_BEGIN_MACRO do {</span></p><p style="margin-top: 0cm; margin-right: 0cm; margin-bottom: 0.0001pt; margin-left: 0cm; line-height: normal; font-size: 10.5pt; font-family: Calibri, sans-serif; text-align: justify;"   ><span lang="EN-US"   style="font-family: 'Courier New';"   >#define NP_END_MACRO } while (0)</span></p><p style="margin-top: 0cm; margin-right: 0cm; margin-bottom: 0.0001pt; margin-left: 0cm; line-height: normal; font-size: 10.5pt; font-family: Calibri, sans-serif; text-align: justify;"   ><span lang="EN-US"   style="font-size: 10pt; font-family: 'Courier New';"   >&nbsp;</span></p><p style="margin-top: 0cm; margin-right: 0cm; margin-bottom: 0.0001pt; margin-left: 0cm; line-height: normal; font-size: 10.5pt; font-family: Calibri, sans-serif; text-align: justify;"   ><span lang="EN-US"   style="font-family: 'Courier New';"   >#define VOID_TO_NPVARIANT(_v) NP_BEGIN_MACRO (_v).type = NPVariantType_Void; (_v).value.objectValue = NULL; NP_END_MACRO</span></p><p style="margin-top: 0cm; margin-right: 0cm; margin-bottom: 0.0001pt; margin-left: 0cm; line-height: normal; font-size: 10.5pt; font-family: Calibri, sans-serif; text-align: justify;"   ><span lang="EN-US"   style="font-family: 'Courier New';"   >&nbsp;</span></p><p style="margin-top: 0cm; margin-right: 0cm; margin-bottom: 0.0001pt; margin-left: 0cm; line-height: normal; font-size: 10.5pt; font-family: Calibri, sans-serif; text-align: justify;"   ><span lang="EN-US"   style="font-family: 'Courier New';"   >#define NULL_TO_NPVARIANT(_v) NP_BEGIN_MACRO (_v).type = NPVariantType_Null; (_v).value.objectValue = NULL; NP_END_MACRO</span></p><p style="margin-top: 0cm; margin-right: 0cm; margin-bottom: 0.0001pt; margin-left: 0cm; line-height: normal; font-size: 10.5pt; font-family: Calibri, sans-serif; text-align: justify;"   ><span lang="EN-US"   style="font-family: 'Courier New';"   >#define BOOLEAN_TO_NPVARIANT(_val, _v) NP_BEGIN_MACRO (_v).type = NPVariantType_Bool; (_v).value.boolValue = !!(_val); NP_END_MACRO</span></p><p style="margin-top: 0cm; margin-right: 0cm; margin-bottom: 0.0001pt; margin-left: 0cm; line-height: normal; font-size: 10.5pt; font-family: Calibri, sans-serif; text-align: justify;"   ><span lang="EN-US"   style="font-family: 'Courier New';"   >&nbsp;</span></p><p style="margin-top: 0cm; margin-right: 0cm; margin-bottom: 0.0001pt; margin-left: 0cm; line-height: normal; font-size: 10.5pt; font-family: Calibri, sans-serif; text-align: justify;"   ><span lang="EN-US"   style="font-family: 'Courier New';"   >#define INT32_TO_NPVARIANT(_val, _v) NP_BEGIN_MACRO (_v).type = NPVariantType_Int32; (_v).value.intValue = _val; NP_END_MACRO</span></p><p style="margin-top: 0cm; margin-right: 0cm; margin-bottom: 0.0001pt; margin-left: 0cm; line-height: normal; font-size: 10.5pt; font-family: Calibri, sans-serif; text-align: justify;"   ><span lang="EN-US"   style="font-family: 'Courier New';"   >#define DOUBLE_TO_NPVARIANT(_val, _v) NP_BEGIN_MACRO (_v).type = NPVariantType_Double; (_v).value.doubleValue = _val; NP_END_MACRO</span></p><p style="margin-top: 0cm; margin-right: 0cm; margin-bottom: 0.0001pt; margin-left: 0cm; line-height: normal; font-size: 10.5pt; font-family: Calibri, sans-serif; text-align: justify;"   ><span lang="EN-US"   style="font-family: 'Courier New';"   >&nbsp;</span></p><p style="margin-top: 0cm; margin-right: 0cm; margin-bottom: 0.0001pt; margin-left: 0cm; line-height: normal; font-size: 10.5pt; font-family: Calibri, sans-serif; text-align: justify;"   ><span lang="EN-US"   style="font-family: 'Courier New';"   >#define STRINGZ_TO_NPVARIANT(_val, _v) NP_BEGIN_MACRO (_v).type = NPVariantType_String; NPString str = { _val, strlen(_val) }; (_v).value.stringValue = str; NP_END_MACRO</span></p><p style="margin-top: 0cm; margin-right: 0cm; margin-bottom: 0.0001pt; margin-left: 0cm; line-height: normal; font-size: 10.5pt; font-family: Calibri, sans-serif; text-align: justify;"   ><span lang="EN-US"   style="font-family: 'Courier New';"   >#define STRINGN_TO_NPVARIANT(_val, _len, _v) NP_BEGIN_MACRO (_v).type = NPVariantType_String; NPString str = { _val, _len }; (_v).value.stringValue = str; NP_END_MACRO</span></p><p style="margin-top: 0cm; margin-right: 0cm; margin-bottom: 0.0001pt; margin-left: 0cm; line-height: normal; font-size: 10.5pt; font-family: Calibri, sans-serif; text-align: justify;"   ><span lang="EN-US"   style="font-family: 'Courier New';"   >&nbsp;</span></p><p style="margin-top: 0cm; margin-right: 0cm; margin-bottom: 0.0001pt; margin-left: 0cm; line-height: normal; font-size: 10.5pt; font-family: Calibri, sans-serif; text-align: justify;"   ><span lang="EN-US"   style="font-family: 'Courier New';"   >#define OBJECT_TO_NPVARIANT(_val, _v) NP_BEGIN_MACRO (_v).type = NPVariantType_Object; (_v).value.objectValue = _val; NP_END_MACRO</span></p><p style="margin-top: 0cm; margin-right: 0cm; margin-bottom: 0.0001pt; margin-left: 0cm; line-height: normal; font-size: 10.5pt; font-family: Calibri, sans-serif; text-align: justify;"   ><span lang="EN-US"   style="font-family: 'Courier New';"   >&nbsp;</span></p><p style="margin-top: 0cm; margin-right: 0cm; margin-bottom: 0.0001pt; margin-left: 0cm; line-height: normal; font-size: 10.5pt; font-family: Calibri, sans-serif; text-align: justify;"   ><b><span lang="EN-US"   style="font-size: 14pt;"   >Why need NPVariant (Serialization) ?</span></b></p><p style="margin-top: 0cm; margin-right: 0cm; margin-bottom: 0.0001pt; margin-left: 0cm; line-height: normal; font-size: 10.5pt; font-family: Calibri, sans-serif; text-align: justify;"   ><span style="font-family: 宋体;"   >在</span><span lang="EN-US"   >&nbsp;JavaScript&nbsp;</span><span style="font-family: 宋体;"   >中，使用者可以任意撰写任何</span><span lang="EN-US"   >&nbsp;function</span><span style="font-family: 宋体;"   >，而这些</span><span lang="EN-US"   >&nbsp;function&nbsp;</span><span style="font-family: 宋体;"   >的参数个数，型态，排列顺序等，都是任意的；我们不可能写出一个</span><span lang="EN-US"   >&nbsp;C function&nbsp;</span><span style="font-family: 宋体;"   >来对应到所有的</span><span lang="EN-US"   >&nbsp;JavaScript function</span><span style="font-family: 宋体;"   >，</span><span lang="EN-US"   >C function&nbsp;</span><span style="font-family: 宋体;"   >是</span><span lang="EN-US"   >&nbsp;compile time&nbsp;</span><span style="font-family: 宋体;"   >时就必须决定参数个数，型态与顺序；因此必须要透过</span><span lang="EN-US"   >&nbsp;Marshaling (Serialization)&nbsp;</span><span style="font-family: 宋体;"   >的方式来取得</span><span lang="EN-US"   >&nbsp;JavaScript&nbsp;</span><span style="font-family: 宋体;"   >的参数后，再转换成</span><span lang="EN-US"   >&nbsp;C&nbsp;</span><span style="font-family: 宋体;"   >语言中相对应的资料型态来处理。</span></p><p style="margin-top: 0cm; margin-right: 0cm; margin-bottom: 0.0001pt; margin-left: 0cm; line-height: normal; font-size: 10.5pt; font-family: Calibri, sans-serif; text-align: justify;"   ><span lang="EN-US"   >&nbsp;</span></p><p style="margin-top: 0cm; margin-right: 0cm; margin-bottom: 0.0001pt; margin-left: 0cm; line-height: normal; font-size: 10.5pt; font-family: Calibri, sans-serif; text-align: justify;"   ><b><span lang="EN-US"   style="font-size: 14pt;"   >NPIdentifier</span></b></p><p style="margin-top: 0cm; margin-right: 0cm; margin-bottom: 0.0001pt; margin-left: 0cm; line-height: normal; font-size: 10.5pt; font-family: Calibri, sans-serif; text-align: justify;"   ><span lang="EN-US"   >NPObject&nbsp;</span><span style="font-family: 宋体;"   >的</span><span lang="EN-US"   >&nbsp;Method&nbsp;</span><span style="font-family: 宋体;"   >与</span><span lang="EN-US"   >&nbsp;Property&nbsp;</span><span style="font-family: 宋体;"   >的皆是由</span><span lang="EN-US"   >&nbsp;NPIdentifier&nbsp;</span><span style="font-family: 宋体;"   >来指定，</span><span lang="EN-US"   >NPIdentifier&nbsp;</span><span style="font-family: 宋体;"   >对于相同名称的</span><span lang="EN-US"   >&nbsp;Method&nbsp;</span><span style="font-family: 宋体;"   >或是</span><span lang="EN-US"   >&nbsp;Property&nbsp;</span><span style="font-family: 宋体;"   >会有一个</span><span lang="EN-US"   >&nbsp;Unique&nbsp;</span><span style="font-family: 宋体;"   >值。而</span><span lang="EN-US"   >&nbsp;NPIdentifier&nbsp;</span><span style="font-family: 宋体;"   >的值是由</span><span lang="EN-US"   >Browser&nbsp;</span><span style="font-family: 宋体;"   >所提供，也就是说</span><span lang="EN-US"   >&nbsp;Browser&nbsp;</span><span style="font-family: 宋体;"   >内部有一个</span><span lang="EN-US"   >&nbsp;(Hash) Table&nbsp;</span><span style="font-family: 宋体;"   >来储存所有的</span><span lang="EN-US"   >&nbsp;NPIdentifier&nbsp;</span><span style="font-family: 宋体;"   >。</span></p><p align="left"   style="margin-top: 0cm; margin-right: 0cm; margin-bottom: 0.0001pt; margin-left: 0cm; line-height: 13.2pt; font-size: 10.5pt; font-family: Calibri, sans-serif; text-align: left; background-image: initial; background-attachment: initial; background-origin: initial; background-clip: initial; background-color: white; vertical-align: baseline;"   ><span lang="EN-US"   style="font-size: 10pt; font-family: Consolas; color: rgb(78, 78, 78);"   >&nbsp;</span></p><p style="margin-top: 0cm; margin-right: 0cm; margin-bottom: 0.0001pt; margin-left: 0cm; line-height: normal; font-size: 10.5pt; font-family: Calibri, sans-serif; text-align: justify;"   ><span lang="EN-US"   style="font-family: 'Courier New';"   >typedef</span><span lang="EN-US"   style="font-size: 10pt; font-family: 'Courier New';"   >&nbsp;</span><span lang="EN-US"   style="font-family: 'Courier New';"   >void</span><span lang="EN-US"   style="font-size: 10pt; font-family: 'Courier New';"   >&nbsp;</span><span lang="EN-US"   style="font-family: 'Courier New';"   >*NPIdentifier;</span></p><p style="margin-top: 0cm; margin-right: 0cm; margin-bottom: 0.0001pt; margin-left: 0cm; line-height: normal; font-size: 10.5pt; font-family: Calibri, sans-serif; text-align: justify;"   ><span lang="EN-US"   style="font-size: 10pt; font-family: 'Courier New';"   >&nbsp;</span></p><p style="margin-top: 0cm; margin-right: 0cm; margin-bottom: 0.0001pt; margin-left: 0cm; line-height: normal; font-size: 10.5pt; font-family: Calibri, sans-serif; text-align: justify;"   ><span lang="EN-US"   style="font-family: 'Courier New';"   >/*</span></p><p style="margin-top: 0cm; margin-right: 0cm; margin-bottom: 0.0001pt; margin-left: 0cm; line-height: normal; font-size: 10.5pt; font-family: Calibri, sans-serif; text-align: justify;"   ><span lang="EN-US"   style="font-family: 'Courier New';"   >NPObjects have methods and properties. Methods and properties are</span></p><p style="margin-top: 0cm; margin-right: 0cm; margin-bottom: 0.0001pt; margin-left: 0cm; line-height: normal; font-size: 10.5pt; font-family: Calibri, sans-serif; text-align: justify;"   ><span lang="EN-US"   style="font-family: 'Courier New';"   >identified with NPIdentifiers. These identifiers may be reflected</span></p><p style="margin-top: 0cm; margin-right: 0cm; margin-bottom: 0.0001pt; margin-left: 0cm; line-height: normal; font-size: 10.5pt; font-family: Calibri, sans-serif; text-align: justify;"   ><span lang="EN-US"   style="font-family: 'Courier New';"   >in script. NPIdentifiers can be either strings or integers, IOW,</span></p><p style="margin-top: 0cm; margin-right: 0cm; margin-bottom: 0.0001pt; margin-left: 0cm; line-height: normal; font-size: 10.5pt; font-family: Calibri, sans-serif; text-align: justify;"   ><span lang="EN-US"   style="font-family: 'Courier New';"   >methods and properties can be identified by either strings or</span></p><p style="margin-top: 0cm; margin-right: 0cm; margin-bottom: 0.0001pt; margin-left: 0cm; line-height: normal; font-size: 10.5pt; font-family: Calibri, sans-serif; text-align: justify;"   ><span lang="EN-US"   style="font-family: 'Courier New';"   >integers (i.e. foo["bar"] vs foo[1]). NPIdentifiers can be</span></p><p style="margin-top: 0cm; margin-right: 0cm; margin-bottom: 0.0001pt; margin-left: 0cm; line-height: normal; font-size: 10.5pt; font-family: Calibri, sans-serif; text-align: justify;"   ><span lang="EN-US"   style="font-family: 'Courier New';"   >compared using ==. In case of any errors, the requested</span></p><p style="margin-top: 0cm; margin-right: 0cm; margin-bottom: 0.0001pt; margin-left: 0cm; line-height: normal; font-size: 10.5pt; font-family: Calibri, sans-serif; text-align: justify;"   ><span lang="EN-US"   style="font-family: 'Courier New';"   >NPIdentifier(s) will be NULL.</span></p><p style="margin-top: 0cm; margin-right: 0cm; margin-bottom: 0.0001pt; margin-left: 0cm; line-height: normal; font-size: 10.5pt; font-family: Calibri, sans-serif; text-align: justify;"   ><span lang="EN-US"   style="font-family: 'Courier New';"   >*/</span></p><p style="margin-top: 0cm; margin-right: 0cm; margin-bottom: 0.0001pt; margin-left: 0cm; line-height: normal; font-size: 10.5pt; font-family: Calibri, sans-serif; text-align: justify;"   ><span lang="EN-US"   style="font-family: 'Courier New';"   >NPIdentifier NPN_GetStringIdentifier(const</span><span lang="EN-US"   style="font-size: 10pt; font-family: 'Courier New';"   >&nbsp;</span><span lang="EN-US"   style="font-family: 'Courier New';"   >NPUTF8 *name);</span></p><p style="margin-top: 0cm; margin-right: 0cm; margin-bottom: 0.0001pt; margin-left: 0cm; line-height: normal; font-size: 10.5pt; font-family: Calibri, sans-serif; text-align: justify;"   ><span lang="EN-US"   style="font-family: 'Courier New';"   >void</span><span lang="EN-US"   style="font-size: 10pt; font-family: 'Courier New';"   >&nbsp;</span><span lang="EN-US"   style="font-family: 'Courier New';"   >NPN_GetStringIdentifiers(const</span><span lang="EN-US"   style="font-size: 10pt; font-family: 'Courier New';"   >&nbsp;</span><span lang="EN-US"   style="font-family: 'Courier New';"   >NPUTF8 **names, int32_t nameCount,</span></p><p style="margin-top: 0cm; margin-right: 0cm; margin-bottom: 0.0001pt; margin-left: 0cm; line-height: normal; font-size: 10.5pt; font-family: Calibri, sans-serif; text-align: justify;"   ><span lang="EN-US"   style="font-family: 'Courier New';"   >NPIdentifier *identifiers);</span></p><p style="margin-top: 0cm; margin-right: 0cm; margin-bottom: 0.0001pt; margin-left: 0cm; line-height: normal; font-size: 10.5pt; font-family: Calibri, sans-serif; text-align: justify;"   ><span lang="EN-US"   style="font-family: 'Courier New';"   >NPIdentifier NPN_GetIntIdentifier(int32_t intid);</span></p><p style="margin-top: 0cm; margin-right: 0cm; margin-bottom: 0.0001pt; margin-left: 0cm; line-height: normal; font-size: 10.5pt; font-family: Calibri, sans-serif; text-align: justify;"   ><span lang="EN-US"   style="font-family: 'Courier New';"   >bool</span><span lang="EN-US"   style="font-size: 10pt; font-family: 'Courier New';"   >&nbsp;</span><span lang="EN-US"   style="font-family: 'Courier New';"   >NPN_IdentifierIsString(NPIdentifier identifier);</span></p><p style="margin-top: 0cm; margin-right: 0cm; margin-bottom: 0.0001pt; margin-left: 0cm; line-height: normal; font-size: 10.5pt; font-family: Calibri, sans-serif; text-align: justify;"   ><span lang="EN-US"   style="font-size: 10pt; font-family: 'Courier New';"   >&nbsp;</span></p><p style="margin-top: 0cm; margin-right: 0cm; margin-bottom: 0.0001pt; margin-left: 0cm; line-height: normal; font-size: 10.5pt; font-family: Calibri, sans-serif; text-align: justify;"   ><span lang="EN-US"   style="font-family: 'Courier New';"   >/*</span></p><p style="margin-top: 0cm; margin-right: 0cm; margin-bottom: 0.0001pt; margin-left: 0cm; line-height: normal; font-size: 10.5pt; font-family: Calibri, sans-serif; text-align: justify;"   ><span lang="EN-US"   style="font-family: 'Courier New';"   >The NPUTF8 returned from NPN_UTF8FromIdentifier SHOULD be freed.</span></p><p style="margin-top: 0cm; margin-right: 0cm; margin-bottom: 0.0001pt; margin-left: 0cm; line-height: normal; font-size: 10.5pt; font-family: Calibri, sans-serif; text-align: justify;"   ><span lang="EN-US"   style="font-family: 'Courier New';"   >*/</span></p><p style="margin-top: 0cm; margin-right: 0cm; margin-bottom: 0.0001pt; margin-left: 0cm; line-height: normal; font-size: 10.5pt; font-family: Calibri, sans-serif; text-align: justify;"   ><span lang="EN-US"   style="font-family: 'Courier New';"   >NPUTF8 *NPN_UTF8FromIdentifier(NPIdentifier identifier);</span></p><p style="margin-top: 0cm; margin-right: 0cm; margin-bottom: 0.0001pt; margin-left: 0cm; line-height: normal; font-size: 10.5pt; font-family: Calibri, sans-serif; text-align: justify;"   ><span lang="EN-US"   style="font-size: 10pt; font-family: 'Courier New';"   >&nbsp;</span></p><p style="margin-top: 0cm; margin-right: 0cm; margin-bottom: 0.0001pt; margin-left: 0cm; line-height: normal; font-size: 10.5pt; font-family: Calibri, sans-serif; text-align: justify;"   ><span lang="EN-US"   style="font-family: 'Courier New';"   >/*</span></p><p style="margin-top: 0cm; margin-right: 0cm; margin-bottom: 0.0001pt; margin-left: 0cm; line-height: normal; font-size: 10.5pt; font-family: Calibri, sans-serif; text-align: justify;"   ><span lang="EN-US"   style="font-family: 'Courier New';"   >Get the integer represented by identifier. If identifier is not an</span></p><p style="margin-top: 0cm; margin-right: 0cm; margin-bottom: 0.0001pt; margin-left: 0cm; line-height: normal; font-size: 10.5pt; font-family: Calibri, sans-serif; text-align: justify;"   ><span lang="EN-US"   style="font-family: 'Courier New';"   >integer identifier, the behaviour is undefined.</span></p><p style="margin-top: 0cm; margin-right: 0cm; margin-bottom: 0.0001pt; margin-left: 0cm; line-height: normal; font-size: 10.5pt; font-family: Calibri, sans-serif; text-align: justify;"   ><span lang="EN-US"   style="font-family: 'Courier New';"   >*/</span></p><p style="margin-top: 0cm; margin-right: 0cm; margin-bottom: 0.0001pt; margin-left: 0cm; line-height: normal; font-size: 10.5pt; font-family: Calibri, sans-serif; text-align: justify;"   ><span lang="EN-US"   style="font-family: 'Courier New';"   >int32_t NPN_IntFromIdentifier(NPIdentifier identifier);</span></p><p style="margin-top: 0cm; margin-right: 0cm; margin-bottom: 0.0001pt; margin-left: 0cm; line-height: normal; font-size: 10.5pt; font-family: Calibri, sans-serif; text-align: justify;"   ><span lang="EN-US"   style="font-size: 10pt; font-family: 'Courier New';"   >&nbsp;</span></p><p style="margin-top: 0cm; margin-right: 0cm; margin-bottom: 0.0001pt; margin-left: 0cm; line-height: normal; font-size: 10.5pt; font-family: Calibri, sans-serif; text-align: justify;"   ><span lang="EN-US"   >Browser&nbsp;</span><span style="font-family: 宋体;"   >另外还提供了</span><span lang="EN-US"   >&nbsp;NPIdentifier&nbsp;</span><span style="font-family: 宋体;"   >的转换函数，供</span><span lang="EN-US"   >&nbsp;Plugin&nbsp;</span><span style="font-family: 宋体;"   >方便使用。</span></p><p style="margin-top: 0cm; margin-right: 0cm; margin-bottom: 0.0001pt; margin-left: 0cm; line-height: normal; font-size: 10.5pt; font-family: Calibri, sans-serif; text-align: justify;"   ><span lang="EN-US"   style="font-size: 10pt; font-family: 'Courier New';"   >&nbsp;</span></p><p style="margin-top: 0cm; margin-right: 0cm; margin-bottom: 0.0001pt; margin-left: 0cm; line-height: normal; font-size: 10.5pt; font-family: Calibri, sans-serif; text-align: justify;"   ><b><span lang="EN-US"   style="font-size: 14pt;"   >Why use NPIdentifier?</span></b></p><p style="margin-top: 0cm; margin-right: 0cm; margin-bottom: 0.0001pt; margin-left: 0cm; line-height: normal; font-size: 10.5pt; font-family: Calibri, sans-serif; text-align: justify;"   ><span style="font-family: 宋体;"   >有</span><span lang="EN-US"   >&nbsp;NPIdentifier&nbsp;</span><span style="font-family: 宋体;"   >这样的设计主要有两个原因：</span></p><p style="margin-top: 0cm; margin-right: 0cm; margin-bottom: 7.8pt; margin-left: 21pt; line-height: normal; font-size: 10.5pt; font-family: Calibri, sans-serif; text-align: justify; text-indent: -21pt;"   ><span lang="EN-US"   >1.<span style="font: normal normal normal 7pt/normal 'Times New Roman';"   >&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></span><span lang="EN-US"   >Less Memory Cost<br></span><span style="font-family: 宋体;"   >对于许多</span><span lang="EN-US"   >&nbsp;Object&nbsp;</span><span style="font-family: 宋体;"   >来说都有相同名称的</span><span lang="EN-US"   >&nbsp;Method&nbsp;</span><span style="font-family: 宋体;"   >或是</span><span lang="EN-US"   >&nbsp;Property</span><span style="font-family: 宋体;"   >，若是将这些</span><span lang="EN-US"   >“</span><span style="font-family: 宋体;"   >名称字串</span><span lang="EN-US"   >”</span><span style="font-family: 宋体;"   >全都储存在</span><span lang="EN-US"   >&nbsp;Object&nbsp;</span><span style="font-family: 宋体;"   >的</span><span lang="EN-US"   >&nbsp;Instance&nbsp;</span><span style="font-family: 宋体;"   >中，对于</span><span lang="EN-US"   >&nbsp;Memory&nbsp;</span><span style="font-family: 宋体;"   >的消耗实在是一种浪费。</span></p><p style="margin-top: 0cm; margin-right: 0cm; margin-bottom: 7.8pt; margin-left: 21pt; line-height: normal; font-size: 10.5pt; font-family: Calibri, sans-serif; text-align: justify; text-indent: -21pt;"   ><span lang="EN-US"   >2.<span style="font: normal normal normal 7pt/normal 'Times New Roman';"   >&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></span><span lang="EN-US"   >Fast Lookup (ECMAScript Identifer Resolution)<br></span><span style="font-family: 宋体;"   >对于</span><span lang="EN-US"   >&nbsp;Browser&nbsp;</span><span style="font-family: 宋体;"   >或是</span><span lang="EN-US"   >&nbsp;Plugin&nbsp;</span><span style="font-family: 宋体;"   >在</span><span lang="EN-US"   >&nbsp;JavaScript&nbsp;</span><span style="font-family: 宋体;"   >执行时在</span><span lang="EN-US"   >&nbsp;Lookup Object&nbsp;</span><span style="font-family: 宋体;"   >的动作时，能够以</span><span lang="EN-US"   >&nbsp;Lookup NPIdentifier&nbsp;</span><span style="font-family: 宋体;"   >来取代</span><span lang="EN-US"   >&nbsp;Name String Compare</span><span style="font-family: 宋体;"   >，可以大大增加</span><span lang="EN-US"   >&nbsp;Lookup&nbsp;</span><span style="font-family: 宋体;"   >的速度。</span></p><p style="margin-top: 0cm; margin-right: 0cm; margin-bottom: 0.0001pt; margin-left: 0cm; line-height: normal; font-size: 10.5pt; font-family: Calibri, sans-serif; text-align: justify;"   ><b><span lang="EN-US"   style="font-size: 14pt;"   >Reference</span></b></p><p style="margin-top: 0cm; margin-right: 0cm; margin-bottom: 0.0001pt; margin-left: 0cm; line-height: normal; font-size: 10.5pt; font-family: Calibri, sans-serif; text-align: justify;"   ><span lang="EN-US"   ><a title="https://developer.mozilla.org/en/Plugins" style="color: rgb(0, 113, 187); text-decoration: underline;" rel="nofollow" href="https://developer.mozilla.org/en/Plugins"   >https://developer.mozilla.org/en/Plugins</a></span></p><p style="margin-top: 0cm; margin-right: 0cm; margin-bottom: 0.0001pt; margin-left: 0cm; line-height: normal; font-size: 10.5pt; font-family: Calibri, sans-serif; text-align: justify;"   ><span lang="EN-US"   ><a title="http://gplflash.sourceforge.net/gplflash2_blog/npapi.html" style="color: rgb(0, 113, 187); text-decoration: underline;" rel="nofollow" href="http://gplflash.sourceforge.net/gplflash2_blog/npapi.html"   >The NPAPI Plugin Guide</a></span></p><p style="margin-top: 0cm; margin-right: 0cm; margin-bottom: 0.0001pt; margin-left: 0cm; line-height: normal; font-size: 10.5pt; font-family: Calibri, sans-serif; text-align: justify;"   ><span lang="EN-US"   >&nbsp;</span></p><wbr>
</body></html>