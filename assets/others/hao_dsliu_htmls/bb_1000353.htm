<html><head><meta http-equiv="Content-Type" content="text/html; charset=utf8"><title>163 blogs的博客：PKCS #11 笔记 - 原理</title>
<style type="text/css">
a{color: #000000;text-decoration : none;font-size: 10pt;}
a:hover {color: red;text-decoration : underline;}
.replyBox{padding:4px;border:1px solid #D8D8D8;}
</style></head><body><h2>PKCS #11 笔记 - 原理</h2>
<p align="right">发布时间：2010-2-11 11:57
<br>分类名称：PKI</p><br>
<p><b style=""   ><span style="font-family: 宋体;"   >定</span></b><span style="font-family: 宋体;"   >义</span></p>  <p><span lang="EN-US"   >PKCS – Public-Key Cryptography Standards(</span><span style="font-family: 宋体;"   >公共密码加密标准</span><span lang="EN-US"   >)</span><span style="font-family: 宋体;"   >。</span></p>  <p><span lang="EN-US"   >PKCS</span><span style="font-family: 宋体;"   >文件和信息可在</span><span lang="EN-US"   ><a rel="nofollow" href="http://www.rsasecurity.com/rsalabs/PKCS"   >http://www.rsasecurity.com/rsalabs/PKCS</a></span><span style="font-family: 宋体;"   >得到</span></p>  <p><span lang="EN-US"   >&nbsp;</span></p>  <p><span lang="EN-US"   >PKCS#11</span><span style="font-family: 宋体;"   >为一些保存加密信息、执行密码函数的设备确定了一种程序设计接口（</span><span lang="EN-US"   >API</span><span style="font-family: 宋体;"   >），称作：</span><span lang="EN-US"   >Cryptoki</span><span style="font-family: 宋体;"   >（</span><span lang="EN-US"   >Cryptographic token interface</span><span style="font-family: 宋体;"   >）</span><span lang="EN-US"   >.</span></p>  <p><span lang="EN-US"   >&nbsp;</span></p>  <p><b style=""   ><span style="font-family: 宋体;"   >目标</span><span lang="EN-US"   ></span></b></p>  <p style="margin-left: 18pt; text-indent: -18pt;"   ><span style=""   lang="EN-US"   ><span style=""   >1.<span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span></span><span style="font-family: 宋体;"   >接口</span><span lang="EN-US"   ><br> Cryptoki </span><span style="font-family: 宋体;"   >作为一个</span><span lang="EN-US"   ><span style=""   >&nbsp; </span></span><span style="font-family: 宋体;"   >应用程序和可移动加密设备（智能卡，</span><span lang="EN-US"   >PCMCIA</span><span style="font-family: 宋体;"   >卡等）之间的接口。</span></p>  <p style="margin-left: 18pt; text-indent: -18pt;"   ><span style=""   lang="EN-US"   ><span style=""   >2.<span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span></span><span style="font-family: 宋体;"   >资源共享</span><span lang="EN-US"   ><br> </span><span style="font-family: 宋体;"   >一个设备应该被多个应用程序同时共享使用。</span></p>  <p><span lang="EN-US"   >&nbsp;</span></p>  <p><b><span style="line-height: 28.18181800842285px; text-indent: -24px; font-size: 16px;"   >Cryptoki</span><span style="line-height: 28.18181800842285px; text-indent: -24px; font-size: 16px;"   >&nbsp;通用</span></b><b style=""   ><span style="font-family: 宋体;"   >模型</span><span lang="EN-US"   ></span></b></p>  <p><a target="_blank" href="pic/img.ph.126.net_fqMwm-fRKiPnx84mKr_aqQ==_3303108851700057168.jpg"   ><img title="PKCS 11 v2.11 Notes - Dsliu - Dspace"   alt="PKCS 11 v2.11 Notes - Dsliu - Dspace"   src="pic/img.ph.126.net_fqMwm-fRKiPnx84mKr_aqQ==_3303108851700057168.jpg"   ></a></p>  <p style="text-align: center;"   align="center"   ><a rel="nofollow"   ><span lang="EN-US"   >Figure </span></a><span style=""   ><span lang="EN-US"   >1</span></span><span style=""   ><span lang="EN-US"   >, General Cryptoki Model</span></span></p>  <span>每个设备对应一个Slot，上层应用无需了解设备的具体细节，只和Cryptoki提供的接口打交道，Cryptoki隐藏了大部分细节。</span><div><span><br style="page-break-before: always;"   clear="all"   > </span>  <p><b style=""   ><span lang="EN-US"   >Token</span></b><b style=""   ><span style="font-family: 宋体;"   >（设备）的逻辑视图</span><span lang="EN-US"   >(logical view)</span></b></p>  <p><a target="_blank" href="pic/img623.ph.126.net_vUD2yUp_UTawuaP4y_OEHA==_1946680938932450208.jpg"   ><img title="PKCS 11 v2.11 Notes - Dsliu - Dspace"   alt="PKCS 11 v2.11 Notes - Dsliu - Dspace"   src="pic/img623.ph.126.net_vUD2yUp_UTawuaP4y_OEHA==_1946680938932450208.jpg"   ></a></p>  <p style="text-align: center;"   align="center"   ><a rel="nofollow"   ><span lang="EN-US"   >Figure </span></a><span style=""   ><span lang="EN-US"   >2</span></span><span style=""   ><span lang="EN-US"   >, Object Hierarchy</span></span><span style="line-height: 28.18181800842285px; font-size: 16px; text-align: left;"   >&nbsp;</span></p>  <p><span lang="EN-US"   >Objects </span><span style="font-family: 宋体;"   >根据生存期和可见性可分为：</span></p>  <p style="margin-left: 18pt; text-indent: -18pt;"   ><span style=""   lang="EN-US"   ><span style=""   >1.<span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span></span><span lang="EN-US"   >Token Object<span style=""   >&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span style="font-family: 宋体;"   >在拥有足够权限的情况下，对所有的程序都可见，一直都保存在设备中</span></p>  <p style="margin-left: 18pt; text-indent: -18pt;"   ><span style=""   lang="EN-US"   ><span style=""   >2.<span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span></span><span lang="EN-US"   >Session Object<span style=""   >&nbsp; </span></span><span style="font-family: 宋体;"   >临时对象，当</span><span lang="EN-US"   >Session</span><span style="font-family: 宋体;"   >（会话）结束，所有的</span><span lang="EN-US"   >Session objects</span><span style="font-family: 宋体;"   >将被销毁。并且只对创建此Session Object的应用程序可见，其余应用程序不可见。注意区分名词：一个名词是Session，指的是会话。一个是Session object，主要指临时的。</span></p>  <p><span lang="EN-US"   >&nbsp;</span></p>  <p><span style="font-family: 宋体;"   >要区分</span><span lang="EN-US"   >Token </span><span style="font-family: 宋体;"   >的逻辑视图和真正的实现，因为不是所有的设备都支持这些对象，</span><span lang="EN-US"   >Cryptoki</span><span style="font-family: 宋体;"   >的功能也就是将</span>设备<span style="font-family: 宋体;"   >内部的不同实现映射成统一的逻辑视图，供应用程序使用统一的接口。</span></p>  <p><span lang="EN-US"   >&nbsp;</span></p>  <p><b style=""   ><span style="font-family: 宋体;"   >用户</span><span lang="EN-US"   ></span></b></p><p><span>Cryptoki支持两种用户：&nbsp;</span></p>  <p style="margin-left: 18pt; text-indent: -18pt;"   ><span style=""   lang="EN-US"   ><span style=""   >1.<span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span></span><span lang="EN-US"   >Security Officer (SO)<span style=""   > </span></span><span style="font-family: 宋体;"   >用来初始化设备、设置用户</span><span lang="EN-US"   >PIN、访问公共数据</span><span style="font-family: 宋体;"   >等操作。</span></p>  <p style="margin-left: 18pt; text-indent: -18pt;"   ><span style=""   lang="EN-US"   ><span style=""   >2.<span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span></span><span lang="EN-US"   >Normal User (User)<span style=""   >&nbsp; </span></span><span style="font-family: 宋体;"   >只有此用户才能访问私有数据，SO不能访问。</span></p>  <p><span lang="EN-US"   >&nbsp;</span></p>  <p><b style=""   ><span style="font-family: 宋体;"   >应用程序</span><span lang="EN-US"   ></span></b></p>  <p><span style="font-family: 宋体;"   >进程中存在很多线程，只要其中某个线程调用</span><span lang="EN-US"   >C_Initialize</span><span style="font-family: 宋体;"   >函数，此进程就成为“</span><span lang="EN-US"   >Cryptoki Application</span><span style="font-family: 宋体;"   >”。当应用程序不需要</span><span lang="EN-US"   >Cryptoki</span><span style="font-family: 宋体;"   >的时候，需要调用</span><span lang="EN-US"   >C_Finalize</span><span style="font-family: 宋体;"   >函数。</span></p>  <p><span lang="EN-US"   >&nbsp;</span></p>  <p style="margin-left: 21pt; text-indent: -21pt;"   ><span style="font-family: Wingdings;"   lang="EN-US"   ><span style=""   >n<span>&nbsp;</span></span></span><span style="font-family: 宋体;"   >进程</span></p>  <p><span style="font-family: 宋体;"   >假设</span><span lang="EN-US"   >Unix</span><span style="font-family: 宋体;"   >中，</span><span lang="EN-US"   >P</span><span style="font-family: 宋体;"   >进程调用了</span><span lang="EN-US"   >C_Initialize</span><span style="font-family: 宋体;"   >函数，然后使用</span><span lang="EN-US"   >fork() </span><span style="font-family: 宋体;"   >创建了进程</span><span lang="EN-US"   >C</span><span style="font-family: 宋体;"   >。由于进程</span><span lang="EN-US"   >P</span><span style="font-family: 宋体;"   >和进程</span><span lang="EN-US"   >C</span><span style="font-family: 宋体;"   >拥有不同的进程空间，他们并不是同一个进程，所以如果进程</span><span lang="EN-US"   >C</span><span style="font-family: 宋体;"   >要使用</span><span lang="EN-US"   >Token</span><span style="font-family: 宋体;"   >，他就要再次调用</span><span lang="EN-US"   >C_Initialize</span><span style="font-family: 宋体;"   >函数</span><span lang="EN-US"   >,</span><span style="font-family: 宋体;"   >而且进程</span><span lang="EN-US"   >C</span><span style="font-family: 宋体;"   >需要登陆</span><span lang="EN-US"   >Token,</span><span style="font-family: 宋体;"   >即便进程</span><span lang="EN-US"   >P</span><span style="font-family: 宋体;"   >已经登录过了</span><span lang="EN-US"   >. </span><span style="font-family: 宋体;"   >如果进程</span><span lang="EN-US"   >C</span><span style="font-family: 宋体;"   >没有调用</span><span lang="EN-US"   >C_Initialize</span><span style="font-family: 宋体;"   >函数</span><span lang="EN-US"   >,</span><span style="font-family: 宋体;"   >访问</span><span lang="EN-US"   >Token</span><span style="font-family: 宋体;"   >将返回</span><span lang="EN-US"   >CKR_CRYPTOKI_NOT_INITIALIZED。此原理同样适用于其他系统平台（如windows，mac等）。</span></p>  <p><span lang="EN-US"   >&nbsp;</span></p>  <p style="margin-left: 21pt; text-indent: -21pt;"   ><span style="font-family: Wingdings;"   lang="EN-US"   ><span style=""   >n<span>&nbsp; </span></span></span><span style="font-family: 宋体;"   >线程</span></p>  <p><span style="font-family: 宋体;"   >当应用程序调用了</span><span lang="EN-US"   >C_Initialize</span><span style="font-family: 宋体;"   >函数</span><span lang="EN-US"   >, </span><span style="font-family: 宋体;"   >它可以明确说明以下</span><span lang="EN-US"   >4</span><span style="font-family: 宋体;"   >种访问Cryptoki的多线程行为</span><span lang="EN-US"   >:</span></p>  <p style="margin-left: 18pt; text-indent: -18pt;"   ><span style=""   lang="EN-US"   ><span style=""   >1.<span>&nbsp; &nbsp;&nbsp;</span></span></span><span style="font-family: 宋体;"   >应用程序明确指出它不需要多线程访问设备</span><span lang="EN-US"   >,</span><span style="font-family: 宋体;"   >此时</span><span lang="EN-US"   >Cryptoki</span><span style="font-family: 宋体;"   >库，并不需要担心线程的安访问问题。</span></p>  <p style="margin-left: 18pt; text-indent: -18pt;"   ><span style=""   lang="EN-US"   ><span style=""   >2.<span>&nbsp;&nbsp;&nbsp;&nbsp;</span></span></span><span style="font-family: 宋体;"   >应用程序明确指出它需要多线程访问设备，此时</span><span lang="EN-US"   >Cryptoki</span><span style="font-family: 宋体;"   >库需要用本地的操作系统提供的同步机制保证线程安全访问。</span></p>  <p style="margin-left: 18pt; text-indent: -18pt;"   ><span style=""   lang="EN-US"   ><span style=""   >3.<span>&nbsp;&nbsp;&nbsp;&nbsp;</span></span></span><span style="font-family: 宋体;"   >应用程序</span><span style="line-height: 28.18181800842285px; font-family: 宋体; font-size: 16px;"   >明确指出</span><span style="line-height: 28.18181800842285px; text-indent: -18pt; font-size: 16px; font-family: 宋体;"   >它需要多线程访问设备，此时</span><span lang="EN-US"   style="line-height: 28.18181800842285px; text-indent: -18pt; font-size: 16px;"   >Cryptoki</span><span style="line-height: 28.18181800842285px; text-indent: -18pt; font-size: 16px; font-family: 宋体;"   >库需要用一组应用程序提供的同步机制</span><span style="line-height: 28.18181800842285px; text-indent: -18pt; font-size: 16px; font-family: 宋体;"   >（例如：纤程)</span><span style="line-height: 28.18181800842285px; text-indent: -18pt; font-size: 16px; font-family: 宋体;"   >保证线程安全访问。</span></p>  <p style="margin-left: 18pt; text-indent: -18pt;"   ><span style=""   lang="EN-US"   ><span style=""   >4.<span>&nbsp;&nbsp;&nbsp;&nbsp;</span></span></span><span style="font-family: 宋体;"   >应用程序</span><span style="font-family: 宋体; line-height: 28.18181800842285px;"   >明确指出</span><span style="font-family: 宋体;"   >它需要多线程访问设备，此时</span><span lang="EN-US"   >Cryptoki</span><span style="font-family: 宋体;"   >库需要用本地的操作系统或一组应用程序提供的同步机制保证线程安全访问。</span></p>  <p><b style=""   ><span lang="EN-US"   >Session</span></b><b style=""   ><span style="font-family: 宋体;"   >（会话）</span><span lang="EN-US"   ></span></b></p>  <p><span lang="EN-US"   >Cryptoki</span><span style="font-family: 宋体;"   >规定应用程序需要打开一个或多个会话来访问</span><span lang="EN-US"   >Token</span><span style="font-family: 宋体;"   >的对象和功能。一个会话(Session)是一个应用程序和</span><span lang="EN-US"   >token设备通讯</span><span style="font-family: 宋体;"   >的逻辑连接。一个会话可以是</span><span lang="EN-US"   >read/write(R/W)</span><span style="font-family: 宋体;"   >会话或</span><span lang="EN-US"   >read-on<wbr>ly(R/O)</span><span style="font-family: 宋体;"   >会话。</span><span lang="EN-US"   >read/write(R/W)</span><span style="font-family: 宋体;"   >和</span><span lang="EN-US"   >read-on<wbr>ly(R/O)</span><span style="font-family: 宋体;"   >只是针对于</span><span lang="EN-US"   >Token objects的访问权限</span><span style="font-family: 宋体;"   >，不针对于</span><span lang="EN-US"   >Session Objects</span><span style="font-family: 宋体;"   >。这俩种会话都可以创建，读取，写入和销毁</span><span lang="EN-US"   >Session Objects(</span><span style="font-family: 宋体;"   >会话对象</span><span lang="EN-US"   >)</span><span style="font-family: 宋体;"   >。只有</span><span lang="EN-US"   >read/write session</span><span style="font-family: 宋体;"   >可以创建创建</span><span lang="EN-US"   >,</span><span style="font-family: 宋体;"   >修改和销毁</span><span lang="EN-US"   >token objects.</span></p>  <p><span style="font-family: 宋体;"   >打开一个会话后</span><span lang="EN-US"   >,</span><span style="font-family: 宋体;"   >应用程序对</span><span lang="EN-US"   >token</span><span style="font-family: 宋体;"   >的公有对象（public object）具有访问权</span><span lang="EN-US"   >. </span><span style="font-family: 宋体;"   >此应用程序的所有线程对此</span><span lang="EN-US"   >session</span><span style="font-family: 宋体;"   >和此</span><span lang="EN-US"   >session</span><span style="font-family: 宋体;"   >创建的</span><span lang="EN-US"   >session objects</span><span style="font-family: 宋体;"   >具有访问权</span><span lang="EN-US"   >, </span><span style="font-family: 宋体;"   >用户必须登录</span><span lang="EN-US"   >token(</span><span style="font-family: 宋体;"   >如验证用户</span><span lang="EN-US"   >PIN)</span><span style="font-family: 宋体;"   >才能访问到私有数据</span><span lang="EN-US"   >.</span></p>  <p><span style="font-family: 宋体;"   >关闭一个</span><span lang="EN-US"   >session, </span><span style="font-family: 宋体;"   >在此会话期间创建的所有</span><span lang="EN-US"   >session objects</span><span style="font-family: 宋体;"   >将被销毁</span><span lang="EN-US"   >.</span><span style="font-family: 宋体;"   >这些</span><span lang="EN-US"   >session objects</span><span style="font-family: 宋体;"   >有可能正在被其它</span><span lang="EN-US"   >session</span><span style="font-family: 宋体;"   >所使用</span><span lang="EN-US"   >. </span><span style="font-family: 宋体;"   >也就是说</span><span lang="EN-US"   >,</span><span style="font-family: 宋体;"   >一个应用程序打开了多个会话</span><span lang="EN-US"   >, </span><span style="font-family: 宋体;"   >它使用其中一个创建了一个</span><span lang="EN-US"   >session object, </span><span style="font-family: 宋体;"   >则其它</span><span lang="EN-US"   >session</span><span style="font-family: 宋体;"   >都可以使用该对象</span><span lang="EN-US"   >.</span><span style="font-family: 宋体;"   >一旦创建</span><span lang="EN-US"   >session object</span><span style="font-family: 宋体;"   >的这个</span><span lang="EN-US"   >session</span><span style="font-family: 宋体;"   >被关闭</span><span lang="EN-US"   >.</span><span style="font-family: 宋体;"   >这个对象就会被销毁</span><span lang="EN-US"   >.</span></p><p>总结一下会话（Session）和临时对象（Session Object）的关系，Session Object在应用程序中的某个Session中建立，此时<span style="line-height: 28.18181800842285px; font-size: 16px;"   >此Session对</span><span style="line-height: 28.18181800842285px; font-size: 16px;"   >Session Object有拥有权，Session Object可以被应用程序的其他Session使用，当拥有Session Object的Session销毁时（调用C_CloseSession)，此Session Object被立即销毁，其它Session则不能继续使用此Session Object。</span></p>  <p><span lang="EN-US"   >&nbsp;</span></p>  <p><b style=""   ><span lang="EN-US"   >Session states(</span></b><b style=""   ><span style="font-family: 宋体;"   >会话状态</span><span lang="EN-US"   >)</span></b></p><p><b>Session 状态决定了是否有权限对Token Object操作或访问一些功能。</b></p>  <p style="margin-left: 21pt; text-indent: -21pt;"   ><span style="font-family: Wingdings;"   lang="EN-US"   ><span style=""   >n<span>&nbsp; </span></span></span><b style=""   ><span lang="EN-US"   >Read-on<wbr>ly session states 只读状态</span></b></p><p style="margin-left: 21pt; text-indent: -21pt;"   ><b>只读Session有两种状态：</b></p>  <p style="page-break-after: avoid;"   ><a target="_blank" href="pic/img.ph.126.net_vZBoaA9UhJZCDkiNg5Mw-A==_3224014383244365258.jpg"   ><img title="PKCS 11 v2.11 Notes - Dsliu - Dspace"   alt="PKCS 11 v2.11 Notes - Dsliu - Dspace"   src="pic/img.ph.126.net_vZBoaA9UhJZCDkiNg5Mw-A==_3224014383244365258.jpg"   ></a></p>  <div style="text-align: left;"   ><ul><li><span style="line-height: 28.18181800842285px; font-size: 16px;"   >当应用程序在打开Session之前，并没有在已经打开的Session中登陆过或者SO登陆过，那么此Session打开后的状态为：</span><span style="line-height: 15.454545021057129px; font-family: Calibri, sans-serif; font-size: 11pt;"   >R/O Public Session。</span></li><li><span style="line-height: 28.18181800842285px; font-size: 16px;"   >当应用程序在打开Session之前，已经在已经打开的Session中登陆过，那么此Session打开后的状态为：</span><span style="line-height: 15.454545021057129px; font-family: Calibri, sans-serif; font-size: 11pt;"   >R/O User Functions。</span></li><li><span style="line-height: 28.18181800842285px; font-size: 16px; font-family: 宋体;"   >注意</span><span lang="EN-US"   style="line-height: 28.18181800842285px; font-size: 16px;"   >:</span><span style="line-height: 28.18181800842285px; font-size: 16px; font-family: 宋体;"   >不存在</span><span lang="EN-US"   style="line-height: 28.18181800842285px; font-size: 16px;"   >read-on<wbr>ly SO sessions。</span></li></ul></div>  <table style="margin-left: 5.4pt; border-collapse: collapse; border: medium none;"   border="1"   cellpadding="0"   cellspacing="0"   >  <thead>   <tr style=""   >    <td style="width: 108pt; border-width: 1.5pt 1pt 1pt 1.5pt; border-color: black; border-style: solid; padding: 0cm 5.4pt;"   valign="top"   width="144"   >    <p style="page-break-after: avoid;"   ><b style=""   ><span lang="EN-US"   >State</span></b></p>    </td>    <td style="width: 329.4pt; border-width: 1.5pt 1.5pt 1pt medium; border-style: solid solid solid none; border-color: black black black -moz-use-text-color; padding: 0cm 5.4pt;"   valign="top"   width="439"   >    <p style="page-break-after: avoid;"   ><b style=""   ><span lang="EN-US"   >Description</span></b></p>    </td>   </tr>  </thead>  <tbody><tr style=""   >   <td style="width: 108pt; border-width: medium 1pt 1pt 1.5pt; border-style: none solid solid; border-color: -moz-use-text-color black black; padding: 0cm 5.4pt;"   valign="top"   width="144"   >   <p style="page-break-after: avoid;"   ><span lang="EN-US"   >R/O Public   Session</span></p>   </td>   <td style="width: 329.4pt; border-width: medium 1.5pt 1pt medium; border-style: none solid solid none; border-color: -moz-use-text-color black black -moz-use-text-color; padding: 0cm 5.4pt;"   valign="top"   width="439"   >   <p style="page-break-after: avoid;"   ><span lang="EN-US"   >The   application has opened a read-on<wbr>ly session.<span style=""   >&nbsp;   </span>The application has read-on<wbr>ly access to public token objects and   read/write access to public session objects.</span></p>   </td>  </tr>  <tr style=""   >   <td style="width: 108pt; border-width: medium 1pt 1.5pt 1.5pt; border-style: none solid solid; border-color: -moz-use-text-color black black; padding: 0cm 5.4pt;"   valign="top"   width="144"   >   <p style="page-break-after: avoid;"   ><span lang="EN-US"   >R/O User   Functions</span></p>   </td>   <td style="width: 329.4pt; border-width: medium 1.5pt 1.5pt medium; border-style: none solid solid none; border-color: -moz-use-text-color black black -moz-use-text-color; padding: 0cm 5.4pt;"   valign="top"   width="439"   >   <p style="page-break-after: avoid;"   ><span lang="EN-US"   >The normal   user has been authenticated to the token. The application has read-on<wbr>ly   access to all token objects (public or private) and read/write access to all   session objects (public or private).</span></p>   </td>  </tr> </table>  <p><span lang="EN-US"   >&nbsp;</span></p>  <p style="margin-left: 21pt; text-indent: -21pt;"   ><span style="font-family: Wingdings;"   lang="EN-US"   ><span style=""   >n<span>&nbsp; </span></span></span><b style=""   ><span lang="EN-US"   >Read/Write session states</span></b></p><p style="margin-left: 21pt; text-indent: -21pt;"   ><b>可读可写Session有3中状态：</b></p>  <p><a target="_blank" href="pic/img.ph.126.net_S5RGpQQhaB1mlc-Nzma_1Q==_3224014383244365262.jpg"   ><img title="PKCS 11 v2.11 Notes - Dsliu - Dspace"   alt="PKCS 11 v2.11 Notes - Dsliu - Dspace"   src="pic/img.ph.126.net_S5RGpQQhaB1mlc-Nzma_1Q==_3224014383244365262.jpg"   ></a></p><ul style="line-height: 28.18181800842285px;"   ><li style="line-height: 28.18181800842285px;"   ><span style="line-height: 28.18181800842285px; font-size: 16px;"   >当应用程序在打开Session之前，并没有在已经打开的Session中登陆过，那么此Session打开后的状态为：</span><span style="line-height: 15.454545021057129px; font-family: Calibri, sans-serif; font-size: 11pt;"   >R/W Public Session。</span></li><li style="line-height: 28.18181800842285px;"   ><span style="line-height: 28.18181800842285px; font-size: 16px;"   >当应用程序在打开Session之前，已经在已经打开的Session中登陆过，那么此Session打开后的状态为：</span><span style="line-height: 15.454545021057129px; font-family: Calibri, sans-serif; font-size: 11pt;"   >R/W User Functions。</span></li><li style="line-height: 28.18181800842285px;"   ><span style="line-height: 28.18181800842285px; font-size: 16px;"   >当应用程序在打开Session之前，已经在已经打开的Session中登陆过SO，那么此Session打开后的状态为：</span><span style="line-height: 15.454545021057129px; font-family: Calibri, sans-serif; font-size: 11pt;"   >R/W SO Functions。</span></li></ul>  <p><span lang="EN-US"   >&nbsp;</span></p>  <table style="margin-left: 5.4pt; border-collapse: collapse; border: medium none;"   border="1"   cellpadding="0"   cellspacing="0"   >  <thead>   <tr style=""   >    <td style="width: 108pt; border-width: 1.5pt 1pt 1pt 1.5pt; border-color: black; border-style: solid; padding: 0cm 5.4pt;"   valign="top"   width="144"   >    <p style="page-break-after: avoid;"   ><b style=""   ><span lang="EN-US"   >State</span></b></p>    </td>    <td style="width: 329.4pt; border-width: 1.5pt 1.5pt 1pt medium; border-style: solid solid solid none; border-color: black black black -moz-use-text-color; padding: 0cm 5.4pt;"   valign="top"   width="439"   >    <p style="page-break-after: avoid;"   ><b style=""   ><span lang="EN-US"   >Description</span></b></p>    </td>   </tr>  </thead>  <tbody><tr style=""   >   <td style="width: 108pt; border-width: medium 1pt 1pt 1.5pt; border-style: none solid solid; border-color: -moz-use-text-color black black; padding: 0cm 5.4pt;"   valign="top"   width="144"   >   <p style="page-break-after: avoid;"   ><span lang="EN-US"   >R/W Public   Session</span></p>   </td>   <td style="width: 329.4pt; border-width: medium 1.5pt 1pt medium; border-style: none solid solid none; border-color: -moz-use-text-color black black -moz-use-text-color; padding: 0cm 5.4pt;"   valign="top"   width="439"   >   <p style="page-break-after: avoid;"   ><span lang="EN-US"   >The   application has opened a read/write session. The application has read/write   access to all public objects.</span></p>   </td>  </tr>  <tr style=""   >   <td style="width: 108pt; border-width: medium 1pt 1pt 1.5pt; border-style: none solid solid; border-color: -moz-use-text-color black black; padding: 0cm 5.4pt;"   valign="top"   width="144"   >   <p style="page-break-after: avoid;"   ><span lang="EN-US"   >R/W SO   Functions</span></p>   </td>   <td style="width: 329.4pt; border-width: medium 1.5pt 1pt medium; border-style: none solid solid none; border-color: -moz-use-text-color black black -moz-use-text-color; padding: 0cm 5.4pt;"   valign="top"   width="439"   >   <p style="page-break-after: avoid;"   ><span lang="EN-US"   >The Security   Officer has been authenticated to the token. The application has read/write   access on<wbr>ly to public objects on the token, not to private objects. The SO   can set the normal user’s PIN.</span></p>   </td>  </tr>  <tr style=""   >   <td style="width: 108pt; border-width: medium 1pt 1.5pt 1.5pt; border-style: none solid solid; border-color: -moz-use-text-color black black; padding: 0cm 5.4pt;"   valign="top"   width="144"   >   <p style="page-break-after: avoid;"   ><span lang="EN-US"   >R/W User   Functions</span></p>   </td>   <td style="width: 329.4pt; border-width: medium 1.5pt 1.5pt medium; border-style: none solid solid none; border-color: -moz-use-text-color black black -moz-use-text-color; padding: 0cm 5.4pt;"   valign="top"   width="439"   >   <p style="page-break-after: avoid;"   ><span lang="EN-US"   >The normal   user has been authenticated to the token. The application has read/write   access to all objects.</span></p>   </td>  </tr> </table>  <p><span lang="EN-US"   >&nbsp;</span></p>  <p><span style=""   lang="EN-US"   >Access to Different Types Objects by Different Types of Sessions</span></p>  <table style="margin-left: 5.4pt; border-collapse: collapse; border: medium none;"   border="1"   cellpadding="0"   cellspacing="0"   >  <thead>   <tr style=""   >    <td style="width: 122.4pt; border-width: 1.5pt 1pt medium 1.5pt; border-style: solid solid none; border-color: black black -moz-use-text-color; padding: 0cm 5.4pt;"   valign="top"   width="163"   >    <p style="text-align: left;"   align="left"   ><span lang="EN-US"   >&nbsp;</span></p>    </td>    <td colspan="5"   style="width: 246.6pt; border-width: 1.5pt 1.5pt 1pt medium; border-style: solid solid solid none; border-color: black black black -moz-use-text-color; padding: 0cm 5.4pt;"   valign="top"   width="329"   >    <p><b style=""   ><span style="font-size: 10pt;"   lang="EN-US"   >Type of session</span></b></p>    </td>   </tr>   <tr style=""   >    <td style="width: 122.4pt; border-width: medium 1pt 1pt 1.5pt; border-style: none solid solid; border-color: -moz-use-text-color black black; padding: 0cm 5.4pt;"   valign="top"   width="163"   >    <p style="text-align: left;"   align="left"   ><b style=""   ><span style="font-size: 10pt;"   lang="EN-US"   >&nbsp;</span></b></p>    <p style="text-align: left;"   align="left"   ><b style=""   ><span style="font-size: 10pt;"   lang="EN-US"   >Type    of object</span></b></p>    </td>    <td style="width: 50.4pt; border-width: medium 1pt 1pt medium; border-style: none solid solid none; border-color: -moz-use-text-color black black -moz-use-text-color; padding: 0cm 5.4pt;"   valign="top"   width="67"   >    <p><b style=""   ><span style="font-size: 10pt;"   lang="EN-US"   >R/O Public</span></b></p>    </td>    <td style="width: 50.4pt; border-width: 1pt 1pt 1pt medium; border-style: solid solid solid none; border-color: black black black -moz-use-text-color; padding: 0cm 5.4pt;"   valign="top"   width="67"   >    <p><b style=""   ><span style="font-size: 10pt;"   lang="EN-US"   >R/W Public</span></b></p>    </td>    <td style="width: 50.4pt; border-width: 1pt 1pt 1pt medium; border-style: solid solid solid none; border-color: black black black -moz-use-text-color; padding: 0cm 5.4pt;"   valign="top"   width="67"   >    <p><b style=""   ><span style="font-size: 10pt;"   lang="EN-US"   >R/O User</span></b></p>    </td>    <td style="width: 50.4pt; border-width: 1pt 1pt 1pt medium; border-style: solid solid solid none; border-color: black black black -moz-use-text-color; padding: 0cm 5.4pt;"   valign="top"   width="67"   >    <p><b style=""   ><span style="font-size: 10pt;"   lang="EN-US"   >R/W User</span></b></p>    </td>    <td style="width: 45pt; border-width: 1pt 1.5pt 1pt medium; border-style: solid solid solid none; border-color: black black black -moz-use-text-color; padding: 0cm 5.4pt;"   valign="top"   width="60"   >    <p><b style=""   ><span style="font-size: 10pt;"   lang="EN-US"   >R/W SO</span></b></p>    </td>   </tr>  </thead>  <tbody><tr style=""   >   <td style="width: 122.4pt; border-width: medium 1pt 1pt 1.5pt; border-style: none solid solid; border-color: -moz-use-text-color black black; padding: 0cm 5.4pt;"   valign="top"   width="163"   >   <p style="text-align: left;"   align="left"   ><span style="font-size: 10pt;"   lang="EN-US"   >Public session object</span></p>   </td>   <td style="width: 50.4pt; border-width: medium 1pt 1pt medium; border-style: none solid solid none; border-color: -moz-use-text-color black black -moz-use-text-color; padding: 0cm 5.4pt;"   valign="top"   width="67"   >   <p><span style="font-size: 10pt;"   lang="EN-US"   >R/W</span></p>   </td>   <td style="width: 50.4pt; border-width: medium 1pt 1pt medium; border-style: none solid solid none; border-color: -moz-use-text-color black black -moz-use-text-color; padding: 0cm 5.4pt;"   valign="top"   width="67"   >   <p><span style="font-size: 10pt;"   lang="EN-US"   >R/W</span></p>   </td>   <td style="width: 50.4pt; border-width: medium 1pt 1pt medium; border-style: none solid solid none; border-color: -moz-use-text-color black black -moz-use-text-color; padding: 0cm 5.4pt;"   valign="top"   width="67"   >   <p><span style="font-size: 10pt;"   lang="EN-US"   >R/W</span></p>   </td>   <td style="width: 50.4pt; border-width: medium 1pt 1pt medium; border-style: none solid solid none; border-color: -moz-use-text-color black black -moz-use-text-color; padding: 0cm 5.4pt;"   valign="top"   width="67"   >   <p><span style="font-size: 10pt;"   lang="EN-US"   >R/W</span></p>   </td>   <td style="width: 45pt; border-width: medium 1.5pt 1pt medium; border-style: none solid solid none; border-color: -moz-use-text-color black black -moz-use-text-color; padding: 0cm 5.4pt;"   valign="top"   width="60"   >   <p><span style="font-size: 10pt;"   lang="EN-US"   >R/W</span></p>   </td>  </tr>  <tr style=""   >   <td style="width: 122.4pt; border-width: medium 1pt 1pt 1.5pt; border-style: none solid solid; border-color: -moz-use-text-color black black; padding: 0cm 5.4pt;"   valign="top"   width="163"   >   <p style="text-align: left;"   align="left"   ><span style="font-size: 10pt;"   lang="EN-US"   >Private session object</span></p>   </td>   <td style="width: 50.4pt; border-width: medium 1pt 1pt medium; border-style: none solid solid none; border-color: -moz-use-text-color black black -moz-use-text-color; padding: 0cm 5.4pt;"   valign="top"   width="67"   >   <p><span style="font-size: 10pt;"   lang="EN-US"   >&nbsp;</span></p>   </td>   <td style="width: 50.4pt; border-width: medium 1pt 1pt medium; border-style: none solid solid none; border-color: -moz-use-text-color black black -moz-use-text-color; padding: 0cm 5.4pt;"   valign="top"   width="67"   >   <p><span style="font-size: 10pt;"   lang="EN-US"   >&nbsp;</span></p>   </td>   <td style="width: 50.4pt; border-width: medium 1pt 1pt medium; border-style: none solid solid none; border-color: -moz-use-text-color black black -moz-use-text-color; padding: 0cm 5.4pt;"   valign="top"   width="67"   >   <p><span style="font-size: 10pt;"   lang="EN-US"   >R/W</span></p>   </td>   <td style="width: 50.4pt; border-width: medium 1pt 1pt medium; border-style: none solid solid none; border-color: -moz-use-text-color black black -moz-use-text-color; padding: 0cm 5.4pt;"   valign="top"   width="67"   >   <p><span style="font-size: 10pt;"   lang="EN-US"   >R/W</span></p>   </td>   <td style="width: 45pt; border-width: medium 1.5pt 1pt medium; border-style: none solid solid none; border-color: -moz-use-text-color black black -moz-use-text-color; padding: 0cm 5.4pt;"   valign="top"   width="60"   >   <p><span style="font-size: 10pt;"   lang="EN-US"   >&nbsp;</span></p>   </td>  </tr>  <tr style=""   >   <td style="width: 122.4pt; border-width: medium 1pt 1pt 1.5pt; border-style: none solid solid; border-color: -moz-use-text-color black black; padding: 0cm 5.4pt;"   valign="top"   width="163"   >   <p style="text-align: left;"   align="left"   ><span style="font-size: 10pt;"   lang="EN-US"   >Public token object</span></p>   </td>   <td style="width: 50.4pt; border-width: medium 1pt 1pt medium; border-style: none solid solid none; border-color: -moz-use-text-color black black -moz-use-text-color; padding: 0cm 5.4pt;"   valign="top"   width="67"   >   <p><span style="font-size: 10pt;"   lang="EN-US"   >R/O</span></p>   </td>   <td style="width: 50.4pt; border-width: medium 1pt 1pt medium; border-style: none solid solid none; border-color: -moz-use-text-color black black -moz-use-text-color; padding: 0cm 5.4pt;"   valign="top"   width="67"   >   <p><span style="font-size: 10pt;"   lang="EN-US"   >R/W</span></p>   </td>   <td style="width: 50.4pt; border-width: medium 1pt 1pt medium; border-style: none solid solid none; border-color: -moz-use-text-color black black -moz-use-text-color; padding: 0cm 5.4pt;"   valign="top"   width="67"   >   <p><span style="font-size: 10pt;"   lang="EN-US"   >R/O</span></p>   </td>   <td style="width: 50.4pt; border-width: medium 1pt 1pt medium; border-style: none solid solid none; border-color: -moz-use-text-color black black -moz-use-text-color; padding: 0cm 5.4pt;"   valign="top"   width="67"   >   <p><span style="font-size: 10pt;"   lang="EN-US"   >R/W</span></p>   </td>   <td style="width: 45pt; border-width: medium 1.5pt 1pt medium; border-style: none solid solid none; border-color: -moz-use-text-color black black -moz-use-text-color; padding: 0cm 5.4pt;"   valign="top"   width="60"   >   <p><span style="font-size: 10pt;"   lang="EN-US"   >R/W</span></p>   </td>  </tr>  <tr style=""   >   <td style="width: 122.4pt; border-width: medium 1pt 1.5pt 1.5pt; border-style: none solid solid; border-color: -moz-use-text-color black black; padding: 0cm 5.4pt;"   valign="top"   width="163"   >   <p style="text-align: left;"   align="left"   ><span style="font-size: 10pt;"   lang="EN-US"   >Private token object</span></p>   </td>   <td style="width: 50.4pt; border-width: medium 1pt 1.5pt medium; border-style: none solid solid none; border-color: -moz-use-text-color black black -moz-use-text-color; padding: 0cm 5.4pt;"   valign="top"   width="67"   >   <p><span style="font-size: 10pt;"   lang="EN-US"   >&nbsp;</span></p>   </td>   <td style="width: 50.4pt; border-width: medium 1pt 1.5pt medium; border-style: none solid solid none; border-color: -moz-use-text-color black black -moz-use-text-color; padding: 0cm 5.4pt;"   valign="top"   width="67"   >   <p><span style="font-size: 10pt;"   lang="EN-US"   >&nbsp;</span></p>   </td>   <td style="width: 50.4pt; border-width: medium 1pt 1.5pt medium; border-style: none solid solid none; border-color: -moz-use-text-color black black -moz-use-text-color; padding: 0cm 5.4pt;"   valign="top"   width="67"   >   <p><span style="font-size: 10pt;"   lang="EN-US"   >R/O</span></p>   </td>   <td style="width: 50.4pt; border-width: medium 1pt 1.5pt medium; border-style: none solid solid none; border-color: -moz-use-text-color black black -moz-use-text-color; padding: 0cm 5.4pt;"   valign="top"   width="67"   >   <p><span style="font-size: 10pt;"   lang="EN-US"   >R/W</span></p>   </td>   <td style="width: 45pt; border-width: medium 1.5pt 1.5pt medium; border-style: none solid solid none; border-color: -moz-use-text-color black black -moz-use-text-color; padding: 0cm 5.4pt;"   valign="top"   width="60"   >   <p><span style="font-size: 10pt;"   lang="EN-US"   >&nbsp;</span></p>   </td>  </tr> </table>  <p><span lang="EN-US"   >&nbsp;</span></p>  <p><span lang="EN-US"   >&nbsp;</span></p>  <p><b style=""   ><span lang="EN-US"   >Session Event(</span></b><b style=""   ><span style="font-family: 宋体;"   >会话事件</span><span lang="EN-US"   >)</span></b></p>  <p><span style="font-family: 宋体;"   >会话事件将会导致会话状态（</span><span lang="EN-US"   >session states</span><span style="font-family: 宋体;"   >）的改变。如下表：</span></p>  <table style="margin-left: 5.4pt; border-collapse: collapse; border: medium none;"   border="1"   cellpadding="0"   cellspacing="0"   >  <thead>   <tr style=""   >    <td style="width: 99pt; border-width: 1.5pt 1pt 1pt 1.5pt; border-color: black; border-style: solid; padding: 0cm 5.4pt;"   valign="top"   width="132"   >    <p style="page-break-after: avoid;"   ><b style=""   ><span lang="EN-US"   >Event</span></b></p>    </td>    <td style="width: 338.4pt; border-width: 1.5pt 1.5pt 1pt medium; border-style: solid solid solid none; border-color: black black black -moz-use-text-color; padding: 0cm 5.4pt;"   valign="top"   width="451"   >    <p style="page-break-after: avoid;"   ><b style=""   ><span lang="EN-US"   >Occurs    when...</span></b></p>    </td>   </tr>  </thead>  <tbody><tr style=""   >   <td style="width: 99pt; border-width: medium 1pt 1pt 1.5pt; border-style: none solid solid; border-color: -moz-use-text-color black black; padding: 0cm 5.4pt;"   valign="top"   width="132"   >   <p style="page-break-after: avoid;"   ><span lang="EN-US"   >Log In SO</span></p>   </td>   <td style="width: 338.4pt; border-width: medium 1.5pt 1pt medium; border-style: none solid solid none; border-color: -moz-use-text-color black black -moz-use-text-color; padding: 0cm 5.4pt;"   valign="top"   width="451"   >   <p style="page-break-after: avoid;"   ><span lang="EN-US"   >the SO is authenticated to the token.</span></p>   </td>  </tr>  <tr style=""   >   <td style="width: 99pt; border-width: medium 1pt 1pt 1.5pt; border-style: none solid solid; border-color: -moz-use-text-color black black; padding: 0cm 5.4pt;"   valign="top"   width="132"   >   <p style="page-break-after: avoid;"   ><span style=""   lang="SV"   >Log In User</span></p>   </td>   <td style="width: 338.4pt; border-width: medium 1.5pt 1pt medium; border-style: none solid solid none; border-color: -moz-use-text-color black black -moz-use-text-color; padding: 0cm 5.4pt;"   valign="top"   width="451"   >   <p style="page-break-after: avoid;"   ><span lang="EN-US"   >the normal user is authenticated to the token.</span></p>   </td>  </tr>  <tr style=""   >   <td style="width: 99pt; border-width: medium 1pt 1pt 1.5pt; border-style: none solid solid; border-color: -moz-use-text-color black black; padding: 0cm 5.4pt;"   valign="top"   width="132"   >   <p style="page-break-after: avoid;"   ><span lang="EN-US"   >Log Out</span></p>   </td>   <td style="width: 338.4pt; border-width: medium 1.5pt 1pt medium; border-style: none solid solid none; border-color: -moz-use-text-color black black -moz-use-text-color; padding: 0cm 5.4pt;"   valign="top"   width="451"   >   <p style="page-break-after: avoid;"   ><span lang="EN-US"   >the application logs out the current user (SO or   normal user).</span></p>   </td>  </tr>  <tr style=""   >   <td style="width: 99pt; border-width: medium 1pt 1pt 1.5pt; border-style: none solid solid; border-color: -moz-use-text-color black black; padding: 0cm 5.4pt;"   valign="top"   width="132"   >   <p style="page-break-after: avoid;"   ><span lang="EN-US"   >Close Session</span></p>   </td>   <td style="width: 338.4pt; border-width: medium 1.5pt 1pt medium; border-style: none solid solid none; border-color: -moz-use-text-color black black -moz-use-text-color; padding: 0cm 5.4pt;"   valign="top"   width="451"   >   <p style="page-break-after: avoid;"   ><span lang="EN-US"   >the application closes the session or closes all   sessions.</span></p>   </td>  </tr>  <tr style=""   >   <td style="width: 99pt; border-width: medium 1pt 1.5pt 1.5pt; border-style: none solid solid; border-color: -moz-use-text-color black black; padding: 0cm 5.4pt;"   valign="top"   width="132"   >   <p style="page-break-after: avoid;"   ><span lang="EN-US"   >Device Removed</span></p>   </td>   <td style="width: 338.4pt; border-width: medium 1.5pt 1.5pt medium; border-style: none solid solid none; border-color: -moz-use-text-color black black -moz-use-text-color; padding: 0cm 5.4pt;"   valign="top"   width="451"   >   <p style="page-break-after: avoid;"   ><span lang="EN-US"   >the device underlying the token has been removed from   its slot.</span></p>   </td>  </tr> </table>  <p><span lang="EN-US"   >&nbsp;当设备移除，应用程序打开的所有Session自动变为log out状态。</span></p>  <p><span style="font-family: 宋体;"   >在</span><span lang="EN-US"   >Cryptoki</span><span style="font-family: 宋体;"   >中，所有的</span><span lang="EN-US"   >Session</span><span style="font-family: 宋体;"   >必须拥有相同的</span><span lang="EN-US"   >Login/Logout </span><span style="font-family: 宋体;"   >状态</span><span lang="EN-US"   >. （</span><span style="line-height: 15.454545021057129px; font-family: Calibri, sans-serif; font-size: 11pt;"   >all sessions are public sessions; all sessions are
SO sessions; or all sessions are user sessions)</span><span lang="EN-US"   style="line-height: 28.18181800842285px; font-size: 16px;"   >）</span><span style="line-height: 28.18181800842285px; font-size: 16px; font-family: 宋体;"   >即如果一个</span><span lang="EN-US"   style="line-height: 28.18181800842285px; font-size: 16px;"   >session</span><span style="line-height: 28.18181800842285px; font-size: 16px; font-family: 宋体;"   >登录到</span><span lang="EN-US"   style="line-height: 28.18181800842285px; font-size: 16px;"   >token</span><span style="line-height: 28.18181800842285px; font-size: 16px; font-family: 宋体;"   >中</span><span lang="EN-US"   style="line-height: 28.18181800842285px; font-size: 16px;"   >,</span><span style="line-height: 28.18181800842285px; font-size: 16px; font-family: 宋体;"   >其余所有的</span><span lang="EN-US"   style="line-height: 28.18181800842285px; font-size: 16px;"   >session</span><span style="line-height: 28.18181800842285px; font-size: 16px; font-family: 宋体;"   >匀变为登录到</span><span lang="EN-US"   style="line-height: 28.18181800842285px; font-size: 16px;"   >token</span><span style="line-height: 28.18181800842285px; font-size: 16px; font-family: 宋体;"   >中的状态</span><span lang="EN-US"   style="line-height: 28.18181800842285px; font-size: 16px;"   >.</span><span style="line-height: 28.18181800842285px; font-size: 16px; font-family: 宋体;"   >当其中一个登出</span><span lang="EN-US"   style="line-height: 28.18181800842285px; font-size: 16px;"   >token,</span><span style="line-height: 28.18181800842285px; font-size: 16px; font-family: 宋体;"   >其余所有的</span><span lang="EN-US"   style="line-height: 28.18181800842285px; font-size: 16px;"   >session</span><span style="line-height: 28.18181800842285px; font-size: 16px; font-family: 宋体;"   >全部转变为登出</span><span lang="EN-US"   style="line-height: 28.18181800842285px; font-size: 16px;"   >token</span><span style="line-height: 28.18181800842285px; font-size: 16px; font-family: 宋体;"   >的状态</span><span lang="EN-US"   style="line-height: 28.18181800842285px; font-size: 16px;"   >.</span><span style="line-height: 28.18181800842285px; font-size: 16px; font-family: 宋体;"   >例如</span><span lang="EN-US"   style="line-height: 28.18181800842285px; font-size: 16px;"   >,</span><span style="line-height: 28.18181800842285px; font-size: 16px; font-family: 宋体;"   >一个程序已经打开了一个</span><span lang="EN-US"   style="line-height: 28.18181800842285px; font-size: 16px;"   >R\O user session, </span><span style="line-height: 28.18181800842285px; font-size: 16px; font-family: 宋体;"   >然后打开一个</span><span lang="EN-US"   style="line-height: 28.18181800842285px; font-size: 16px;"   >R\W session,</span><span style="line-height: 28.18181800842285px; font-size: 16px; font-family: 宋体;"   >这个</span><span lang="EN-US"   style="line-height: 28.18181800842285px; font-size: 16px;"   >session</span><span style="line-height: 28.18181800842285px; font-size: 16px; font-family: 宋体;"   >就会自动变为</span><span lang="EN-US"   style="line-height: 28.18181800842285px; font-size: 16px;"   >login</span><span style="line-height: 28.18181800842285px; font-size: 16px; font-family: 宋体;"   >状态</span><span lang="EN-US"   style="line-height: 28.18181800842285px; font-size: 16px;"   >.</span></p><p>可以理解为Session有横向和纵向两种状态：</p><p></p><ul><li><span style="line-height: 28.18181800842285px; font-size: 16px;"   >横向：SO? User? Public?</span></li><li><span style="line-height: 28.18181800842285px; font-size: 16px;"   >纵向：R/O R/W</span></li><li>当然这种组合不是任意的。如R/O 和 SO是无法组合的。排列组合为6， 减去1，正好是上面五种状态。</li><li>所有的Session只有一种横向状态，纵向状态则可以不同。</li></ul>  <p><br></p>  <p><b style=""   ><span style="font-family: 宋体;"   >会话表示</span><span lang="EN-US"   ></span></b></p>  <p><span style="font-family: 宋体;"   >一个</span><span lang="EN-US"   >Session</span><span style="font-family: 宋体;"   >用一个</span><span lang="EN-US"   >session handle</span><span style="font-family: 宋体;"   >表示</span><span lang="EN-US"   >(</span><span style="font-family: 宋体;"   >其实就是个整数</span><span lang="EN-US"   >). </span><span style="font-family: 宋体;"   >就和文件句柄的功能类似</span><span lang="EN-US"   >. </span></p>  <p><span style="font-family: 宋体;"   >一个无效句柄</span><span lang="EN-US"   >,</span><span style="font-family: 宋体;"   >通常为</span><span lang="EN-US"   >0.</span><span style="font-family: 宋体;"   >表示为</span><span lang="EN-US"   >:</span></p>  <p><span lang="EN-US"   >#define CK_INVALID_HANDLE <span style=""   >&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>0</span></p>  <p><span lang="EN-US"   >&nbsp;</span></p>  <p><b style=""   ><span style="font-family: 宋体;"   >会话能力</span><span lang="EN-US"   ></span></b></p>  <p><span style="font-family: 宋体;"   >大体分</span><span lang="EN-US"   >3</span><span style="font-family: 宋体;"   >个方面：</span></p>  <p style="margin-left: 21pt; text-indent: -21pt;"   ><span style="font-family: Wingdings;"   lang="EN-US"   ><span style=""   >n<span>&nbsp; </span></span></span><span style="font-family: 宋体;"   >管理操作（如登录登出）</span></p>  <p style="margin-left: 21pt; text-indent: -21pt;"   ><span style="font-family: Wingdings;"   lang="EN-US"   ><span style=""   >n<span>&nbsp; </span></span></span><span style="font-family: 宋体;"   >对象管理（诸如创建，更改和销毁对象）</span></p>  <p style="margin-left: 21pt; text-indent: -21pt;"   ><span style="font-family: Wingdings;"   lang="EN-US"   ><span style=""   >n<span>&nbsp; </span></span></span><span style="font-family: 宋体;"   >加密操作（诸如消息摘要，签名，加解密等）</span></p>  <span><br style="page-break-before: always;"   clear="all"   > </span>  <p><b style=""   ><span lang="EN-US"   >Objects</span></b><b style=""   ><span style="font-family: 宋体;"   >（对象）</span><span lang="EN-US"   ></span></b></p>  <p style="text-align: center; page-break-after: avoid;"   align="center"   ><a target="_blank" href="pic/img844.ph.126.net_heFcgqQ_CTJTkb0eoex-xA==_1888415618753451006.jpg"   ><img title="PKCS 11 v2.11 Notes - Dsliu - Dspace"   alt="PKCS 11 v2.11 Notes - Dsliu - Dspace"   src="pic/img844.ph.126.net_heFcgqQ_CTJTkb0eoex-xA==_1888415618753451006.jpg"   ></a></p>  <p style="text-align: center;"   align="center"   ><a rel="nofollow"   ><span lang="EN-US"   >Figure </span></a><span style=""   ><span lang="EN-US"   ><span style=""   >5</span></span></span><span style=""   ><span lang="EN-US"   >, Object Attribute Hierarchy</span></span></p></div>
</body></html>