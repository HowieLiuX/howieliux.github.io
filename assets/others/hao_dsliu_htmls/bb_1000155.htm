<html><head><meta http-equiv="Content-Type" content="text/html; charset=utf8"><title>163 blogs的博客：七.中断和异常</title>
<style type="text/css">
a{color: #000000;text-decoration : none;font-size: 10pt;}
a:hover {color: red;text-decoration : underline;}
.replyBox{padding:4px;border:1px solid #D8D8D8;}
</style></head><body><h2>七.中断和异常</h2>
<p align="right">发布时间：2012-5-20 16:57
<br>分类名称：80x86保护模式</p><br>
<p><span style="color:black; font-size:9pt;"  ><span style="font-family:Times New Roman;"  >80386</span><span style="font-family:宋体;"  >除了保持</span><span style="font-family:Times New Roman;"  >8086/80386</span><span style="font-family:宋体;"  >的相关功能外，还增强了中断处理能力，并引入了</span><span style="font-family:Times New Roman;"  >"</span><span style="font-family:宋体;"  >异常</span><span style="font-family:Times New Roman;"  >"</span><span style="font-family:宋体;"  >的概念。本文</span><span style="font-family:Times New Roman;"  >    </span><span style="font-family:宋体;"  >将介绍</span><span style="font-family:Times New Roman;"  >80386</span><span style="font-family:宋体;"  >中断和异常的机制。<a rel="nofollow" href="file:///E:\Books\Crack\Kindle\80x86&#20445;&#25252;&#27169;&#24335;&#31995;&#21015;&#25945;&#31243;\My%20Webs\DOWNLOAD\asm67.exe"  ><span style="color:blue;"  >这里下载本文所有源代码</span></a>。</span><span style="font-family:Times New Roman;"  >    </span></span></p><p><span style="color:red; font-family:Batang; font-size:18pt;"  ><strong>&lt;一&gt;80386的中断和异常 </strong></span></p><p><span style="color:black; font-size:9pt;"  ><span style="font-family:Times New Roman;"  >8086/8088</span><span style="font-family:宋体;"  >把中断分为内部中断和外部中断两大类。为了支持多任务和虚拟存储器等功能，</span><span style="font-family:Times New Roman;"  >80386</span><span style="font-family:宋体;"  >把</span><span style="font-family:Times New Roman;"  >    </span><span style="font-family:宋体;"  >外部中断称为</span><span style="font-family:Times New Roman;"  >"</span><span style="font-family:宋体;"  >中断</span><span style="font-family:Times New Roman;"  >"</span><span style="font-family:宋体;"  >，把内部中断称为</span><span style="font-family:Times New Roman;"  >"</span><span style="font-family:宋体;"  >异常</span><span style="font-family:Times New Roman;"  >"</span><span style="font-family:宋体;"  >。与</span><span style="font-family:Times New Roman;"  >8086/8088</span><span style="font-family:宋体;"  >一样，</span><span style="font-family:Times New Roman;"  >80386</span><span style="font-family:宋体;"  >通常在两条指令之间</span><span style="font-family:Times New Roman;"  >    </span><span style="font-family:宋体;"  >响应中断或异常。</span><span style="font-family:Times New Roman;"  >80386</span><span style="font-family:宋体;"  >最多处理</span><span style="font-family:Times New Roman;"  >256</span><span style="font-family:宋体;"  >种中断或异常。</span><span style="font-family:Times New Roman;"  >    </span></span></p><p><span style="color:red; font-family:Batang; font-size:13pt;"  ><strong>1.中断 </strong></span></p><p><span style="color:black; font-size:9pt;"  ><span style="font-family:宋体;"  >对</span><span style="font-family:Times New Roman;"  >80386</span><span style="font-family:宋体;"  >而言，中断是由异步的外部事件引起的。外部事件及中断响应与正执行的指令没有关系。</span><span style="font-family:Times New Roman;"  >    </span><span style="font-family:宋体;"  >通常，中断用于指示</span><span style="font-family:Times New Roman;"  >I/O</span><span style="font-family:宋体;"  >设备的一次操作已完成。与</span><span style="font-family:Times New Roman;"  >8086/8088</span><span style="font-family:宋体;"  >一样，</span><span style="font-family:Times New Roman;"  >80386</span><span style="font-family:宋体;"  >有两根引脚</span><span style="font-family:Times New Roman;"  >INTR</span><span style="font-family:宋体;"  >和</span><span style="font-family:Times New Roman;"  >NMI</span><span style="font-family:宋体;"  >接</span><span style="font-family:Times New Roman;"  >    </span><span style="font-family:宋体;"  >受外部中断请求信号。</span><span style="font-family:Times New Roman;"  >INTR</span><span style="font-family:宋体;"  >接受可屏蔽中断请求。</span><span style="font-family:Times New Roman;"  >NMI</span><span style="font-family:宋体;"  >接受不可屏蔽中断请求。在</span><span style="font-family:Times New Roman;"  >80386</span><span style="font-family:宋体;"  >中，标志寄</span><span style="font-family:Times New Roman;"  >    </span><span style="font-family:宋体;"  >存器</span><span style="font-family:Times New Roman;"  >EFLAGS</span><span style="font-family:宋体;"  >中的</span><span style="font-family:Times New Roman;"  >IF</span><span style="font-family:宋体;"  >标志决定是否屏蔽可屏蔽中断请求。</span><span style="font-family:Times New Roman;"  >    </span></span></p><p><span style="color:black; font-size:9pt;"  ><span style="font-family:宋体;"  >外部硬件在通过</span><span style="font-family:Times New Roman;"  >INTR</span><span style="font-family:宋体;"  >发出中断请求信号的同时，还要向处理器给出一个</span><span style="font-family:Times New Roman;"  >8</span><span style="font-family:宋体;"  >位的中断向量。处理器在</span><span style="font-family:Times New Roman;"  >    </span><span style="font-family:宋体;"  >响应可屏蔽中断请求时，读取这个由外部硬件给出的中断向量号。处理器对这个中断向量号并没有</span><span style="font-family:Times New Roman;"  >    </span><span style="font-family:宋体;"  >规定。但在具体的微机系统中，系统必须通过软件和硬件的配合设置，使得给出的这个中断向量号</span><span style="font-family:Times New Roman;"  >    </span><span style="font-family:宋体;"  >不仅与外部中断源对应，而且要避免中断向量号使用冲突情况的出现。可编程中断控制器芯片</span><span style="font-family:Times New Roman;"  >8259A</span><span style="font-family:宋体;"  >可</span><span style="font-family:Times New Roman;"  >    </span><span style="font-family:宋体;"  >配合</span><span style="font-family:Times New Roman;"  >80386</span><span style="font-family:宋体;"  >工作，能够根据设置向处理器提供上述中断向量号，还能处理中断请求的优先级。每</span><span style="font-family:Times New Roman;"  >    </span><span style="font-family:宋体;"  >个</span><span style="font-family:Times New Roman;"  >8259A</span><span style="font-family:宋体;"  >芯片可以支持</span><span style="font-family:Times New Roman;"  >8</span><span style="font-family:宋体;"  >路中断请求信号，如果使用</span><span style="font-family:Times New Roman;"  >9</span><span style="font-family:宋体;"  >个</span><span style="font-family:Times New Roman;"  >8259A</span><span style="font-family:宋体;"  >芯片</span><span style="font-family:Times New Roman;"  >(</span><span style="font-family:宋体;"  >一个主片，</span><span style="font-family:Times New Roman;"  >8</span><span style="font-family:宋体;"  >个从片</span><span style="font-family:Times New Roman;"  >)</span><span style="font-family:宋体;"  >，就可使</span><span style="font-family:Times New Roman;"  >80386</span><span style="font-family:宋体;"  >在</span><span style="font-family:Times New Roman;"  >    </span><span style="font-family:宋体;"  >单个引脚</span><span style="font-family:Times New Roman;"  >INTR</span><span style="font-family:宋体;"  >上接受多达</span><span style="font-family:Times New Roman;"  >64</span><span style="font-family:宋体;"  >个中断源的中断请求信号。</span><span style="font-family:Times New Roman;"  >    </span></span></p><p><span style="color:black; font-size:9pt;"  ><span style="font-family:宋体;"  >处理器不屏蔽来自</span><span style="font-family:Times New Roman;"  >NMI</span><span style="font-family:宋体;"  >的中断请求。处理器在响应</span><span style="font-family:Times New Roman;"  >NMI</span><span style="font-family:宋体;"  >中断时，不从外部硬件接收中断向量号。</span><span style="font-family:Times New Roman;"  >    </span><span style="font-family:宋体;"  >与</span><span style="font-family:Times New Roman;"  >8086/8088</span><span style="font-family:宋体;"  >一样，在</span><span style="font-family:Times New Roman;"  >80386</span><span style="font-family:宋体;"  >中，不可屏蔽中断所对应的中断向量号固定为</span><span style="font-family:Times New Roman;"  >2</span><span style="font-family:宋体;"  >。为了不可屏蔽中断的</span><span style="font-family:Times New Roman;"  >    </span><span style="font-family:宋体;"  >嵌套，每当接受一个</span><span style="font-family:Times New Roman;"  >NMI</span><span style="font-family:宋体;"  >中断，处理器就在内部屏蔽了再次响应</span><span style="font-family:Times New Roman;"  >NMI</span><span style="font-family:宋体;"  >，这一屏蔽过程直到执行中断返回</span><span style="font-family:Times New Roman;"  >    </span><span style="font-family:宋体;"  >指令</span><span style="font-family:Times New Roman;"  >IRET</span><span style="font-family:宋体;"  >后才结束。所以，</span><span style="font-family:Times New Roman;"  >NMI</span><span style="font-family:宋体;"  >处理程序应以</span><span style="font-family:Times New Roman;"  >IRET</span><span style="font-family:宋体;"  >指令结束。</span><span style="font-family:Times New Roman;"  >    </span></span></p><p><span style="color:red; font-family:Batang; font-size:13pt;"  ><strong>2.异常 </strong></span></p><p><span style="color:black; font-size:9pt;"  ><span style="font-family:宋体;"  >异常是</span><span style="font-family:Times New Roman;"  >80386</span><span style="font-family:宋体;"  >在执行指令期间检测到不正常的或非法的条件所引起的。异常与正执行的指令有直接</span><span style="font-family:Times New Roman;"  >    </span><span style="font-family:宋体;"  >的联系。例如，执行除法指令时，除数等于</span><span style="font-family:Times New Roman;"  >0</span><span style="font-family:宋体;"  >。再如，执行指令时发现特权级不正确。当发生这些</span><span style="font-family:Times New Roman;"  >    </span><span style="font-family:宋体;"  >情况时，指令就不能成功完成。软中断指令</span><span style="font-family:Times New Roman;"  >"INT n"</span><span style="font-family:宋体;"  >和</span><span style="font-family:Times New Roman;"  >"INTO"</span><span style="font-family:宋体;"  >也归类于异常而不称为中断，这</span><span style="font-family:Times New Roman;"  >    </span><span style="font-family:宋体;"  >是因为执行这些指令产生异常事件。</span><span style="font-family:Times New Roman;"  >    </span></span></p><p><span style="color:black; font-size:9pt;"  ><span style="font-family:Times New Roman;"  >80386</span><span style="font-family:宋体;"  >识别多种不同类别的异常，并赋予每一种类别以不同的中断向量号。异常发生后，处理器就</span><span style="font-family:Times New Roman;"  >    </span><span style="font-family:宋体;"  >象响应中断那样处理异常。即根据中断向量号，转相应的中断处理程序。把这种中断处理程序称为</span><span style="font-family:Times New Roman;"  >    </span><span style="font-family:宋体;"  >异常处理程序可能更合适。</span><span style="font-family:Times New Roman;"  >    </span></span></p><p><span style="color:black; font-size:9pt;"  ><span style="font-family:宋体;"  >根据引起异常的程序是否可被恢复和恢复点不同，把异常进一步分类为故障</span><span style="font-family:Times New Roman;"  >(Fault)</span><span style="font-family:宋体;"  >、陷阱</span><span style="font-family:Times New Roman;"  >(Trap)</span><span style="font-family:宋体;"  >和</span><span style="font-family:Times New Roman;"  >    </span><span style="font-family:宋体;"  >中止</span><span style="font-family:Times New Roman;"  >(Abort)</span><span style="font-family:宋体;"  >。我们把对应的异常处理程序分别称为故障处理程序、陷阱处理程序和中止处理程序。</span><span style="font-family:Times New Roman;"  >    </span></span></p><p><span style="color:black; font-size:9pt;"  ><span style="font-family:宋体;"  >故障是在引起异常的指令之前，把异常情况通知给系统的一种异常。</span><span style="font-family:Times New Roman;"  >80386</span><span style="font-family:宋体;"  >认为故障是可排除的。当</span><span style="font-family:Times New Roman;"  >    </span><span style="font-family:宋体;"  >控制转移到故障处理程序时，所保存的断点</span><span style="font-family:Times New Roman;"  >CS</span><span style="font-family:宋体;"  >及</span><span style="font-family:Times New Roman;"  >EIP</span><span style="font-family:宋体;"  >的值指向引起故障的指令。这样，在故障处理程</span><span style="font-family:Times New Roman;"  >    </span><span style="font-family:宋体;"  >序把故障排除后，执行</span><span style="font-family:Times New Roman;"  >IRET</span><span style="font-family:宋体;"  >返回到引起故障的程序继续执行时，刚才引起故障的指令可重新得到执</span><span style="font-family:Times New Roman;"  >    </span><span style="font-family:宋体;"  >行。这种重新执行，不需要操作系统软件的额外参与。故障的发现可能在指令开始执行之前，也可</span><span style="font-family:Times New Roman;"  >    </span><span style="font-family:宋体;"  >能在指令执行期间。如果在指令执行期间检测到故障，那么中止故障指令，并把指令的操作数恢复</span><span style="font-family:Times New Roman;"  >    </span><span style="font-family:宋体;"  >为指令开始执行之前的值。这可保证故障指令的重新执行得到正确的结果。例如，在一条指令的执</span><span style="font-family:Times New Roman;"  >    </span><span style="font-family:宋体;"  >行期间，如果发现段不存在，那么停止该指令的执行，并通知系统产生段故障，对应的段故障处理</span><span style="font-family:Times New Roman;"  >    </span><span style="font-family:宋体;"  >程序可通过加载该段的方法来排除故障，之后，原指令就可成功执行，至少不再发生段不存在的故障。</span><span style="font-family:Times New Roman;"  >    </span></span></p><p><span style="color:black; font-size:9pt;"  ><span style="font-family:宋体;"  >陷阱是在引起异常的指令之后，把异常情况通知给系统的一种异常。当控制转移到异常处理程序时，</span><span style="font-family:Times New Roman;"  >    </span><span style="font-family:宋体;"  >所保存的断点</span><span style="font-family:Times New Roman;"  >CS</span><span style="font-family:宋体;"  >及</span><span style="font-family:Times New Roman;"  >EIP</span><span style="font-family:宋体;"  >的值指向引起陷阱的指令的下一条要执行的指令。下一条要执行的指令，不一</span><span style="font-family:Times New Roman;"  >    </span><span style="font-family:宋体;"  >定就是下一条指令。因此，陷阱处理程序并不是总能根据保存的断点，反推确定出产生异常的指令。</span><span style="font-family:Times New Roman;"  >    </span><span style="font-family:宋体;"  >在转入陷阱处理程序时，引起陷阱的指令应正常完成，它有可能改变了寄存器或存储单元。软中断</span><span style="font-family:Times New Roman;"  >    </span><span style="font-family:宋体;"  >指令、单步异常是陷阱的例子。</span><span style="font-family:Times New Roman;"  >    </span></span></p><p><span style="color:black; font-size:9pt;"  ><span style="font-family:宋体;"  >中止是在系统出现严重情况时，通知系统的一种异常。引起中止的指令是无法确定的。产生中止时，</span><span style="font-family:Times New Roman;"  >    </span><span style="font-family:宋体;"  >正执行的程序不能被恢复执行。系统接收中止后，处理程序要重新建立各种系统表格，并可能重新</span><span style="font-family:Times New Roman;"  >    </span><span style="font-family:宋体;"  >启动操作系统。硬件故障和系统表中出现非法值或不一致的值是中止的例子。</span><span style="font-family:Times New Roman;"  >    </span></span></p><p><span style="color:red; font-family:Batang; font-size:13pt;"  ><strong>3.优先级 </strong></span></p><p><span style="color:black; font-size:9pt;"  ><span style="font-family:宋体;"  >在一条指令执行期间，入检测到不只一个中断或异常，那么按下表所列优先级通知系统。把优先级</span><span style="font-family:Times New Roman;"  >    </span><span style="font-family:宋体;"  >最高的中断或异常通知系统，其它优先级较低的异常被废弃，而优先级较高的中断则保持悬挂。</span><span style="font-family:Times New Roman;"  >    </span></span></p><p> &nbsp;</p><div style="text-align: center;"  ><table style="border-collapse:collapse; background: #0099cc;"  border="0"  ><colgroup><col style="width:60px;"  /><col style="width:130px;"  /><col style="width:40px;"  /><tbody valign="top"  ><tr><td rowspan="7"  vAlign="middle"  style="padding-top: 1px; padding-left: 1px; padding-bottom: 1px; padding-right: 1px; border-top:  solid #00ccff 0.75pt; border-left:  solid #00ccff 0.75pt; border-bottom:  solid #006699 0.75pt; border-right:  solid #006699 0.75pt;"  ><p style="text-align: center;"  ><span style="color:white; font-size:9pt;"  ><span style="font-family:Times New Roman;"  >80386</span><span style="font-family:宋体;"  >响应</span><span style="font-family:Times New Roman;"  ><br></span><span style="font-family:宋体;"  >中断</span><span style="font-family:Times New Roman;"  >/</span><span style="font-family:宋体;"  >异常</span><span style="font-family:Times New Roman;"  ><br></span><span style="font-family:宋体;"  >的优先级</span></span></p></td><td vAlign="middle"  style="padding-top: 1px; padding-left: 1px; padding-bottom: 1px; padding-right: 1px; border-top:  solid #00ccff 0.75pt; border-left:  none; border-bottom:  solid #006699 0.75pt; border-right:  solid #006699 0.75pt;"  ><p style="text-align: center;"  ><span style="color:white; font-size:9pt;"  ><span style="font-family:宋体;"  >中断</span><span style="font-family:Times New Roman;"  >/</span><span style="font-family:宋体;"  >异常类型</span></span></p></td><td vAlign="middle"  style="padding-top: 1px; padding-left: 1px; padding-bottom: 1px; padding-right: 1px; border-top:  solid #00ccff 0.75pt; border-left:  none; border-bottom:  solid #006699 0.75pt; border-right:  solid #006699 0.75pt;"  ><p style="text-align: center;"  ><span style="color:white; font-family:宋体; font-size:9pt;"  >优先级</span></p></td></tr><tr><td vAlign="middle"  style="padding-top: 1px; padding-left: 1px; padding-bottom: 1px; padding-right: 1px; border-top:  none; border-left:  solid #00ccff 0.75pt; border-bottom:  solid #006699 0.75pt; border-right:  solid #006699 0.75pt;"  ><p><span style="color:white; font-family:宋体; font-size:9pt;"  >调试故障</span></p></td><td vAlign="middle"  style="padding-top: 1px; padding-left: 1px; padding-bottom: 1px; padding-right: 1px; border-top:  none; border-left:  none; border-bottom:  solid #006699 0.75pt; border-right:  solid #006699 0.75pt;"  ><p style="text-align: center;"  ><span style="color:white; font-family:宋体; font-size:9pt;"  >最高</span></p></td></tr><tr><td vAlign="middle"  style="padding-top: 1px; padding-left: 1px; padding-bottom: 1px; padding-right: 1px; border-top:  none; border-left:  solid #00ccff 0.75pt; border-bottom:  solid #006699 0.75pt; border-right:  solid #006699 0.75pt;"  ><p><span style="color:white; font-family:宋体; font-size:9pt;"  >其它故障</span></p></td><td vAlign="middle"  style="padding-top: 1px; padding-left: 1px; padding-bottom: 1px; padding-right: 1px; border-top:  none; border-left:  none; border-bottom:  solid #006699 0.75pt; border-right:  solid #006699 0.75pt;"  ><p style="text-align: center;"  ><span style="color:white; font-family:Times New Roman; font-size:9pt;"  >↓</span></p></td></tr><tr><td vAlign="middle"  style="padding-top: 1px; padding-left: 1px; padding-bottom: 1px; padding-right: 1px; border-top:  none; border-left:  solid #00ccff 0.75pt; border-bottom:  solid #006699 0.75pt; border-right:  solid #006699 0.75pt;"  ><p><span style="color:white; font-size:9pt;"  ><span style="font-family:宋体;"  >陷阱指令</span><span style="font-family:Times New Roman;"  >INT n</span><span style="font-family:宋体;"  >和</span><span style="font-family:Times New Roman;"  >INTO</span></span></p></td><td vAlign="middle"  style="padding-top: 1px; padding-left: 1px; padding-bottom: 1px; padding-right: 1px; border-top:  none; border-left:  none; border-bottom:  solid #006699 0.75pt; border-right:  solid #006699 0.75pt;"  ><p style="text-align: center;"  ><span style="color:white; font-family:Times New Roman; font-size:9pt;"  >↓</span></p></td></tr><tr><td vAlign="middle"  style="padding-top: 1px; padding-left: 1px; padding-bottom: 1px; padding-right: 1px; border-top:  none; border-left:  solid #00ccff 0.75pt; border-bottom:  solid #006699 0.75pt; border-right:  solid #006699 0.75pt;"  ><p><span style="color:white; font-family:宋体; font-size:9pt;"  >调试陷阱</span></p></td><td vAlign="middle"  style="padding-top: 1px; padding-left: 1px; padding-bottom: 1px; padding-right: 1px; border-top:  none; border-left:  none; border-bottom:  solid #006699 0.75pt; border-right:  solid #006699 0.75pt;"  ><p style="text-align: center;"  ><span style="color:white; font-family:Times New Roman; font-size:9pt;"  >↓</span></p></td></tr><tr><td vAlign="middle"  style="padding-top: 1px; padding-left: 1px; padding-bottom: 1px; padding-right: 1px; border-top:  none; border-left:  solid #00ccff 0.75pt; border-bottom:  solid #006699 0.75pt; border-right:  solid #006699 0.75pt;"  ><p><span style="color:white; font-size:9pt;"  ><span style="font-family:Times New Roman;"  >NMI</span><span style="font-family:宋体;"  >中断</span></span></p></td><td vAlign="middle"  style="padding-top: 1px; padding-left: 1px; padding-bottom: 1px; padding-right: 1px; border-top:  none; border-left:  none; border-bottom:  solid #006699 0.75pt; border-right:  solid #006699 0.75pt;"  ><p style="text-align: center;"  ><span style="color:white; font-family:Times New Roman; font-size:9pt;"  >↓</span></p></td></tr><tr><td vAlign="middle"  style="padding-top: 1px; padding-left: 1px; padding-bottom: 1px; padding-right: 1px; border-top:  none; border-left:  solid #00ccff 0.75pt; border-bottom:  solid #006699 0.75pt; border-right:  solid #006699 0.75pt;"  ><p><span style="color:white; font-size:9pt;"  ><span style="font-family:Times New Roman;"  >INTR</span><span style="font-family:宋体;"  >中断</span></span></p></td><td vAlign="middle"  style="padding-top: 1px; padding-left: 1px; padding-bottom: 1px; padding-right: 1px; border-top:  none; border-left:  none; border-bottom:  solid #006699 0.75pt; border-right:  solid #006699 0.75pt;"  ><p style="text-align: center;"  ><span style="color:white; font-family:宋体; font-size:9pt;"  >最低</span></p></td></tr></table></div><p> &nbsp;</p><p><span style="color:red; font-family:Batang; font-size:18pt;"  ><strong>&lt;二&gt;异常类型 </strong></span></p><p><span style="color:black; font-size:9pt;"  ><span style="font-family:宋体;"  >象中断分为多种类型一样，异常也可分为多种类型。</span><span style="font-family:Times New Roman;"  >    </span></span></p><p><span style="color:red; font-family:Batang; font-size:13pt;"  ><strong>1.80386识别的异常 </strong></span></p><p><span style="color:black; font-size:9pt;"  ><span style="font-family:Times New Roman;"  >80386</span><span style="font-family:宋体;"  >识别的多种不同类别的异常及赋予的对应中断向量号如下表所示。某些异常还以出错码的形式</span><span style="font-family:Times New Roman;"  >    </span><span style="font-family:宋体;"  >提供一些附加信息传递给异常处理程序，出错代码列中的</span><span style="font-family:Times New Roman;"  >"</span><span style="font-family:宋体;"  >无</span><span style="font-family:Times New Roman;"  >"</span><span style="font-family:宋体;"  >表示没有出错代码，</span><span style="font-family:Times New Roman;"  >"</span><span style="font-family:宋体;"  >有</span><span style="font-family:Times New Roman;"  >"</span><span style="font-family:宋体;"  >表示有</span><span style="font-family:Times New Roman;"  >    </span><span style="font-family:宋体;"  >出错代码。</span><span style="font-family:Times New Roman;"  >    </span></span></p><p> &nbsp;</p><div style="text-align: center;"  ><table style="border-collapse:collapse; background: #0099cc;"  border="0"  ><colgroup><col style="width:16px;"  /><col style="width:64px;"  /><col style="width:86px;"  /><col style="width:54px;"  /><col style="width:51px;"  /><col style="width:309px;"  /><tbody valign="top"  ><tr><td rowspan="17"  vAlign="middle"  style="padding-top: 1px; padding-left: 1px; padding-bottom: 1px; padding-right: 1px; border-top:  solid #00ccff 0.75pt; border-left:  solid #00ccff 0.75pt; border-bottom:  solid #006699 0.75pt; border-right:  solid #006699 0.75pt;"  ><p style="text-align: center;"  ><span style="color:white; font-size:9pt;"  ><span style="font-family:宋体;"  >异</span><span style="font-family:Times New Roman;"  ><br><br><br></span><span style="font-family:宋体;"  >常</span><span style="font-family:Times New Roman;"  ><br><br><br></span><span style="font-family:宋体;"  >一</span><span style="font-family:Times New Roman;"  ><br><br><br></span><span style="font-family:宋体;"  >览</span><span style="font-family:Times New Roman;"  ><br><br><br></span><span style="font-family:宋体;"  >表</span></span></p></td><td vAlign="middle"  style="padding-top: 1px; padding-left: 1px; padding-bottom: 1px; padding-right: 1px; border-top:  solid #00ccff 0.75pt; border-left:  none; border-bottom:  solid #006699 0.75pt; border-right:  solid #006699 0.75pt;"  ><p style="text-align: center;"  ><span style="color:white; font-family:宋体; font-size:9pt;"  >向量号</span></p></td><td vAlign="middle"  style="padding-top: 1px; padding-left: 1px; padding-bottom: 1px; padding-right: 1px; border-top:  solid #00ccff 0.75pt; border-left:  none; border-bottom:  solid #006699 0.75pt; border-right:  solid #006699 0.75pt;"  ><p style="text-align: center;"  ><span style="color:white; font-family:宋体; font-size:9pt;"  >异常名称</span></p></td><td vAlign="middle"  style="padding-top: 1px; padding-left: 1px; padding-bottom: 1px; padding-right: 1px; border-top:  solid #00ccff 0.75pt; border-left:  none; border-bottom:  solid #006699 0.75pt; border-right:  solid #006699 0.75pt;"  ><p style="text-align: center;"  ><span style="color:white; font-family:宋体; font-size:9pt;"  >异常类型</span></p></td><td vAlign="middle"  style="padding-top: 1px; padding-left: 1px; padding-bottom: 1px; padding-right: 1px; border-top:  solid #00ccff 0.75pt; border-left:  none; border-bottom:  solid #006699 0.75pt; border-right:  solid #006699 0.75pt;"  ><p style="text-align: center;"  ><span style="color:white; font-family:宋体; font-size:9pt;"  >出错代码</span></p></td><td vAlign="middle"  style="padding-top: 1px; padding-left: 1px; padding-bottom: 1px; padding-right: 1px; border-top:  solid #00ccff 0.75pt; border-left:  none; border-bottom:  solid #006699 0.75pt; border-right:  solid #006699 0.75pt;"  ><p style="text-align: center;"  ><span style="color:white; font-family:宋体; font-size:9pt;"  >相关指令</span></p></td></tr><tr><td vAlign="middle"  style="padding-top: 1px; padding-left: 1px; padding-bottom: 1px; padding-right: 1px; border-top:  none; border-left:  solid #00ccff 0.75pt; border-bottom:  solid #006699 0.75pt; border-right:  solid #006699 0.75pt;"  ><p style="text-align: center;"  ><span style="color:white; font-family:Times New Roman; font-size:9pt;"  >0</span></p></td><td vAlign="middle"  style="padding-top: 1px; padding-left: 1px; padding-bottom: 1px; padding-right: 1px; border-top:  none; border-left:  none; border-bottom:  solid #006699 0.75pt; border-right:  solid #006699 0.75pt;"  ><p><span style="color:white; font-family:宋体; font-size:9pt;"  >除法出错</span></p></td><td vAlign="middle"  style="padding-top: 1px; padding-left: 1px; padding-bottom: 1px; padding-right: 1px; border-top:  none; border-left:  none; border-bottom:  solid #006699 0.75pt; border-right:  solid #006699 0.75pt;"  ><p><span style="color:white; font-family:宋体; font-size:9pt;"  >故障</span></p></td><td vAlign="middle"  style="padding-top: 1px; padding-left: 1px; padding-bottom: 1px; padding-right: 1px; border-top:  none; border-left:  none; border-bottom:  solid #006699 0.75pt; border-right:  solid #006699 0.75pt;"  ><p style="text-align: center;"  ><span style="color:white; font-family:宋体; font-size:9pt;"  >无</span></p></td><td vAlign="middle"  style="padding-top: 1px; padding-left: 1px; padding-bottom: 1px; padding-right: 1px; border-top:  none; border-left:  none; border-bottom:  solid #006699 0.75pt; border-right:  solid #006699 0.75pt;"  ><p><span style="color:white; font-family:Times New Roman; font-size:9pt;"  >DIV,IDIV</span></p></td></tr><tr><td vAlign="middle"  style="padding-top: 1px; padding-left: 1px; padding-bottom: 1px; padding-right: 1px; border-top:  none; border-left:  solid #00ccff 0.75pt; border-bottom:  solid #006699 0.75pt; border-right:  solid #006699 0.75pt;"  ><p style="text-align: center;"  ><span style="color:white; font-family:Times New Roman; font-size:9pt;"  >1</span></p></td><td vAlign="middle"  style="padding-top: 1px; padding-left: 1px; padding-bottom: 1px; padding-right: 1px; border-top:  none; border-left:  none; border-bottom:  solid #006699 0.75pt; border-right:  solid #006699 0.75pt;"  ><p><span style="color:white; font-family:宋体; font-size:9pt;"  >调试异常</span></p></td><td vAlign="middle"  style="padding-top: 1px; padding-left: 1px; padding-bottom: 1px; padding-right: 1px; border-top:  none; border-left:  none; border-bottom:  solid #006699 0.75pt; border-right:  solid #006699 0.75pt;"  ><p><span style="color:white; font-size:9pt;"  ><span style="font-family:宋体;"  >故障</span><span style="font-family:Times New Roman;"  >/</span><span style="font-family:宋体;"  >陷阱</span></span></p></td><td vAlign="middle"  style="padding-top: 1px; padding-left: 1px; padding-bottom: 1px; padding-right: 1px; border-top:  none; border-left:  none; border-bottom:  solid #006699 0.75pt; border-right:  solid #006699 0.75pt;"  ><p style="text-align: center;"  ><span style="color:white; font-family:宋体; font-size:9pt;"  >无</span></p></td><td vAlign="middle"  style="padding-top: 1px; padding-left: 1px; padding-bottom: 1px; padding-right: 1px; border-top:  none; border-left:  none; border-bottom:  solid #006699 0.75pt; border-right:  solid #006699 0.75pt;"  ><p><span style="color:white; font-family:宋体; font-size:9pt;"  >任何指令</span></p></td></tr><tr><td vAlign="middle"  style="padding-top: 1px; padding-left: 1px; padding-bottom: 1px; padding-right: 1px; border-top:  none; border-left:  solid #00ccff 0.75pt; border-bottom:  solid #006699 0.75pt; border-right:  solid #006699 0.75pt;"  ><p style="text-align: center;"  ><span style="color:white; font-family:Times New Roman; font-size:9pt;"  >3</span></p></td><td vAlign="middle"  style="padding-top: 1px; padding-left: 1px; padding-bottom: 1px; padding-right: 1px; border-top:  none; border-left:  none; border-bottom:  solid #006699 0.75pt; border-right:  solid #006699 0.75pt;"  ><p><span style="color:white; font-size:9pt;"  ><span style="font-family:宋体;"  >单字节</span><span style="font-family:Times New Roman;"  >INT3</span></span></p></td><td vAlign="middle"  style="padding-top: 1px; padding-left: 1px; padding-bottom: 1px; padding-right: 1px; border-top:  none; border-left:  none; border-bottom:  solid #006699 0.75pt; border-right:  solid #006699 0.75pt;"  ><p><span style="color:white; font-family:宋体; font-size:9pt;"  >陷阱</span></p></td><td vAlign="middle"  style="padding-top: 1px; padding-left: 1px; padding-bottom: 1px; padding-right: 1px; border-top:  none; border-left:  none; border-bottom:  solid #006699 0.75pt; border-right:  solid #006699 0.75pt;"  ><p style="text-align: center;"  ><span style="color:white; font-family:宋体; font-size:9pt;"  >无</span></p></td><td vAlign="middle"  style="padding-top: 1px; padding-left: 1px; padding-bottom: 1px; padding-right: 1px; border-top:  none; border-left:  none; border-bottom:  solid #006699 0.75pt; border-right:  solid #006699 0.75pt;"  ><p><span style="color:white; font-family:Times New Roman; font-size:9pt;"  >INT 3</span></p></td></tr><tr><td vAlign="middle"  style="padding-top: 1px; padding-left: 1px; padding-bottom: 1px; padding-right: 1px; border-top:  none; border-left:  solid #00ccff 0.75pt; border-bottom:  solid #006699 0.75pt; border-right:  solid #006699 0.75pt;"  ><p style="text-align: center;"  ><span style="color:white; font-family:Times New Roman; font-size:9pt;"  >4</span></p></td><td vAlign="middle"  style="padding-top: 1px; padding-left: 1px; padding-bottom: 1px; padding-right: 1px; border-top:  none; border-left:  none; border-bottom:  solid #006699 0.75pt; border-right:  solid #006699 0.75pt;"  ><p><span style="color:white; font-family:宋体; font-size:9pt;"  >溢出</span></p></td><td vAlign="middle"  style="padding-top: 1px; padding-left: 1px; padding-bottom: 1px; padding-right: 1px; border-top:  none; border-left:  none; border-bottom:  solid #006699 0.75pt; border-right:  solid #006699 0.75pt;"  ><p><span style="color:white; font-family:宋体; font-size:9pt;"  >陷阱</span></p></td><td vAlign="middle"  style="padding-top: 1px; padding-left: 1px; padding-bottom: 1px; padding-right: 1px; border-top:  none; border-left:  none; border-bottom:  solid #006699 0.75pt; border-right:  solid #006699 0.75pt;"  ><p style="text-align: center;"  ><span style="color:white; font-family:宋体; font-size:9pt;"  >无</span></p></td><td vAlign="middle"  style="padding-top: 1px; padding-left: 1px; padding-bottom: 1px; padding-right: 1px; border-top:  none; border-left:  none; border-bottom:  solid #006699 0.75pt; border-right:  solid #006699 0.75pt;"  ><p><span style="color:white; font-family:Times New Roman; font-size:9pt;"  >INTO</span></p></td></tr><tr><td vAlign="middle"  style="padding-top: 1px; padding-left: 1px; padding-bottom: 1px; padding-right: 1px; border-top:  none; border-left:  solid #00ccff 0.75pt; border-bottom:  solid #006699 0.75pt; border-right:  solid #006699 0.75pt;"  ><p style="text-align: center;"  ><span style="color:white; font-family:Times New Roman; font-size:9pt;"  >5</span></p></td><td vAlign="middle"  style="padding-top: 1px; padding-left: 1px; padding-bottom: 1px; padding-right: 1px; border-top:  none; border-left:  none; border-bottom:  solid #006699 0.75pt; border-right:  solid #006699 0.75pt;"  ><p><span style="color:white; font-family:宋体; font-size:9pt;"  >边界检查</span></p></td><td vAlign="middle"  style="padding-top: 1px; padding-left: 1px; padding-bottom: 1px; padding-right: 1px; border-top:  none; border-left:  none; border-bottom:  solid #006699 0.75pt; border-right:  solid #006699 0.75pt;"  ><p><span style="color:white; font-family:宋体; font-size:9pt;"  >故障</span></p></td><td vAlign="middle"  style="padding-top: 1px; padding-left: 1px; padding-bottom: 1px; padding-right: 1px; border-top:  none; border-left:  none; border-bottom:  solid #006699 0.75pt; border-right:  solid #006699 0.75pt;"  ><p style="text-align: center;"  ><span style="color:white; font-family:宋体; font-size:9pt;"  >无</span></p></td><td vAlign="middle"  style="padding-top: 1px; padding-left: 1px; padding-bottom: 1px; padding-right: 1px; border-top:  none; border-left:  none; border-bottom:  solid #006699 0.75pt; border-right:  solid #006699 0.75pt;"  ><p><span style="color:white; font-family:Times New Roman; font-size:9pt;"  >BOUNT</span></p></td></tr><tr><td vAlign="middle"  style="padding-top: 1px; padding-left: 1px; padding-bottom: 1px; padding-right: 1px; border-top:  none; border-left:  solid #00ccff 0.75pt; border-bottom:  solid #006699 0.75pt; border-right:  solid #006699 0.75pt;"  ><p style="text-align: center;"  ><span style="color:white; font-family:Times New Roman; font-size:9pt;"  >6</span></p></td><td vAlign="middle"  style="padding-top: 1px; padding-left: 1px; padding-bottom: 1px; padding-right: 1px; border-top:  none; border-left:  none; border-bottom:  solid #006699 0.75pt; border-right:  solid #006699 0.75pt;"  ><p><span style="color:white; font-family:宋体; font-size:9pt;"  >非法操作码</span></p></td><td vAlign="middle"  style="padding-top: 1px; padding-left: 1px; padding-bottom: 1px; padding-right: 1px; border-top:  none; border-left:  none; border-bottom:  solid #006699 0.75pt; border-right:  solid #006699 0.75pt;"  ><p><span style="color:white; font-family:宋体; font-size:9pt;"  >故障</span></p></td><td vAlign="middle"  style="padding-top: 1px; padding-left: 1px; padding-bottom: 1px; padding-right: 1px; border-top:  none; border-left:  none; border-bottom:  solid #006699 0.75pt; border-right:  solid #006699 0.75pt;"  ><p style="text-align: center;"  ><span style="color:white; font-family:宋体; font-size:9pt;"  >无</span></p></td><td vAlign="middle"  style="padding-top: 1px; padding-left: 1px; padding-bottom: 1px; padding-right: 1px; border-top:  none; border-left:  none; border-bottom:  solid #006699 0.75pt; border-right:  solid #006699 0.75pt;"  ><p><span style="color:white; font-family:宋体; font-size:9pt;"  >非法指令编码或操作数</span></p></td></tr><tr><td vAlign="middle"  style="padding-top: 1px; padding-left: 1px; padding-bottom: 1px; padding-right: 1px; border-top:  none; border-left:  solid #00ccff 0.75pt; border-bottom:  solid #006699 0.75pt; border-right:  solid #006699 0.75pt;"  ><p style="text-align: center;"  ><span style="color:white; font-family:Times New Roman; font-size:9pt;"  >7</span></p></td><td vAlign="middle"  style="padding-top: 1px; padding-left: 1px; padding-bottom: 1px; padding-right: 1px; border-top:  none; border-left:  none; border-bottom:  solid #006699 0.75pt; border-right:  solid #006699 0.75pt;"  ><p><span style="color:white; font-family:宋体; font-size:9pt;"  >设备不可用</span></p></td><td vAlign="middle"  style="padding-top: 1px; padding-left: 1px; padding-bottom: 1px; padding-right: 1px; border-top:  none; border-left:  none; border-bottom:  solid #006699 0.75pt; border-right:  solid #006699 0.75pt;"  ><p><span style="color:white; font-family:宋体; font-size:9pt;"  >故障</span></p></td><td vAlign="middle"  style="padding-top: 1px; padding-left: 1px; padding-bottom: 1px; padding-right: 1px; border-top:  none; border-left:  none; border-bottom:  solid #006699 0.75pt; border-right:  solid #006699 0.75pt;"  ><p style="text-align: center;"  ><span style="color:white; font-family:宋体; font-size:9pt;"  >无</span></p></td><td vAlign="middle"  style="padding-top: 1px; padding-left: 1px; padding-bottom: 1px; padding-right: 1px; border-top:  none; border-left:  none; border-bottom:  solid #006699 0.75pt; border-right:  solid #006699 0.75pt;"  ><p><span style="color:white; font-size:9pt;"  ><span style="font-family:宋体;"  >浮点指令或</span><span style="font-family:Times New Roman;"  >WAIT</span></span></p></td></tr><tr><td vAlign="middle"  style="padding-top: 1px; padding-left: 1px; padding-bottom: 1px; padding-right: 1px; border-top:  none; border-left:  solid #00ccff 0.75pt; border-bottom:  solid #006699 0.75pt; border-right:  solid #006699 0.75pt;"  ><p style="text-align: center;"  ><span style="color:white; font-family:Times New Roman; font-size:9pt;"  >8</span></p></td><td vAlign="middle"  style="padding-top: 1px; padding-left: 1px; padding-bottom: 1px; padding-right: 1px; border-top:  none; border-left:  none; border-bottom:  solid #006699 0.75pt; border-right:  solid #006699 0.75pt;"  ><p><span style="color:white; font-family:宋体; font-size:9pt;"  >双重故障</span></p></td><td vAlign="middle"  style="padding-top: 1px; padding-left: 1px; padding-bottom: 1px; padding-right: 1px; border-top:  none; border-left:  none; border-bottom:  solid #006699 0.75pt; border-right:  solid #006699 0.75pt;"  ><p><span style="color:white; font-family:宋体; font-size:9pt;"  >中止</span></p></td><td vAlign="middle"  style="padding-top: 1px; padding-left: 1px; padding-bottom: 1px; padding-right: 1px; border-top:  none; border-left:  none; border-bottom:  solid #006699 0.75pt; border-right:  solid #006699 0.75pt;"  ><p style="text-align: center;"  ><span style="color:white; font-family:宋体; font-size:9pt;"  >有</span></p></td><td vAlign="middle"  style="padding-top: 1px; padding-left: 1px; padding-bottom: 1px; padding-right: 1px; border-top:  none; border-left:  none; border-bottom:  solid #006699 0.75pt; border-right:  solid #006699 0.75pt;"  ><p><span style="color:white; font-family:宋体; font-size:9pt;"  >任何指令</span></p></td></tr><tr><td vAlign="middle"  style="padding-top: 1px; padding-left: 1px; padding-bottom: 1px; padding-right: 1px; border-top:  none; border-left:  solid #00ccff 0.75pt; border-bottom:  solid #006699 0.75pt; border-right:  solid #006699 0.75pt;"  ><p style="text-align: center;"  ><span style="color:white; font-family:Times New Roman; font-size:9pt;"  >9</span></p></td><td vAlign="middle"  style="padding-top: 1px; padding-left: 1px; padding-bottom: 1px; padding-right: 1px; border-top:  none; border-left:  none; border-bottom:  solid #006699 0.75pt; border-right:  solid #006699 0.75pt;"  ><p><span style="color:white; font-family:宋体; font-size:9pt;"  >协处理器段越界</span></p></td><td vAlign="middle"  style="padding-top: 1px; padding-left: 1px; padding-bottom: 1px; padding-right: 1px; border-top:  none; border-left:  none; border-bottom:  solid #006699 0.75pt; border-right:  solid #006699 0.75pt;"  ><p><span style="color:white; font-family:宋体; font-size:9pt;"  >中止</span></p></td><td vAlign="middle"  style="padding-top: 1px; padding-left: 1px; padding-bottom: 1px; padding-right: 1px; border-top:  none; border-left:  none; border-bottom:  solid #006699 0.75pt; border-right:  solid #006699 0.75pt;"  ><p style="text-align: center;"  ><span style="color:white; font-family:宋体; font-size:9pt;"  >无</span></p></td><td vAlign="middle"  style="padding-top: 1px; padding-left: 1px; padding-bottom: 1px; padding-right: 1px; border-top:  none; border-left:  none; border-bottom:  solid #006699 0.75pt; border-right:  solid #006699 0.75pt;"  ><p><span style="color:white; font-family:宋体; font-size:9pt;"  >访问存储器的浮点指令</span></p></td></tr><tr><td vAlign="middle"  style="padding-top: 1px; padding-left: 1px; padding-bottom: 1px; padding-right: 1px; border-top:  none; border-left:  solid #00ccff 0.75pt; border-bottom:  solid #006699 0.75pt; border-right:  solid #006699 0.75pt;"  ><p style="text-align: center;"  ><span style="color:white; font-family:Times New Roman; font-size:9pt;"  >0AH</span></p></td><td vAlign="middle"  style="padding-top: 1px; padding-left: 1px; padding-bottom: 1px; padding-right: 1px; border-top:  none; border-left:  none; border-bottom:  solid #006699 0.75pt; border-right:  solid #006699 0.75pt;"  ><p><span style="color:white; font-size:9pt;"  ><span style="font-family:宋体;"  >无效</span><span style="font-family:Times New Roman;"  >TSS</span><span style="font-family:宋体;"  >异常</span></span></p></td><td vAlign="middle"  style="padding-top: 1px; padding-left: 1px; padding-bottom: 1px; padding-right: 1px; border-top:  none; border-left:  none; border-bottom:  solid #006699 0.75pt; border-right:  solid #006699 0.75pt;"  ><p><span style="color:white; font-family:宋体; font-size:9pt;"  >故障</span></p></td><td vAlign="middle"  style="padding-top: 1px; padding-left: 1px; padding-bottom: 1px; padding-right: 1px; border-top:  none; border-left:  none; border-bottom:  solid #006699 0.75pt; border-right:  solid #006699 0.75pt;"  ><p style="text-align: center;"  ><span style="color:white; font-family:宋体; font-size:9pt;"  >有</span></p></td><td vAlign="middle"  style="padding-top: 1px; padding-left: 1px; padding-bottom: 1px; padding-right: 1px; border-top:  none; border-left:  none; border-bottom:  solid #006699 0.75pt; border-right:  solid #006699 0.75pt;"  ><p><span style="color:white; font-size:9pt;"  ><span style="font-family:Times New Roman;"  >JMP</span><span style="font-family:宋体;"  >、</span><span style="font-family:Times New Roman;"  >CALL</span><span style="font-family:宋体;"  >、</span><span style="font-family:Times New Roman;"  >IRET</span><span style="font-family:宋体;"  >或中断</span></span></p></td></tr><tr><td vAlign="middle"  style="padding-top: 1px; padding-left: 1px; padding-bottom: 1px; padding-right: 1px; border-top:  none; border-left:  solid #00ccff 0.75pt; border-bottom:  solid #006699 0.75pt; border-right:  solid #006699 0.75pt;"  ><p style="text-align: center;"  ><span style="color:white; font-family:Times New Roman; font-size:9pt;"  >0BH</span></p></td><td vAlign="middle"  style="padding-top: 1px; padding-left: 1px; padding-bottom: 1px; padding-right: 1px; border-top:  none; border-left:  none; border-bottom:  solid #006699 0.75pt; border-right:  solid #006699 0.75pt;"  ><p><span style="color:white; font-family:宋体; font-size:9pt;"  >段不存在</span></p></td><td vAlign="middle"  style="padding-top: 1px; padding-left: 1px; padding-bottom: 1px; padding-right: 1px; border-top:  none; border-left:  none; border-bottom:  solid #006699 0.75pt; border-right:  solid #006699 0.75pt;"  ><p><span style="color:white; font-family:宋体; font-size:9pt;"  >故障</span></p></td><td vAlign="middle"  style="padding-top: 1px; padding-left: 1px; padding-bottom: 1px; padding-right: 1px; border-top:  none; border-left:  none; border-bottom:  solid #006699 0.75pt; border-right:  solid #006699 0.75pt;"  ><p style="text-align: center;"  ><span style="color:white; font-family:宋体; font-size:9pt;"  >有</span></p></td><td vAlign="middle"  style="padding-top: 1px; padding-left: 1px; padding-bottom: 1px; padding-right: 1px; border-top:  none; border-left:  none; border-bottom:  solid #006699 0.75pt; border-right:  solid #006699 0.75pt;"  ><p><span style="color:white; font-family:宋体; font-size:9pt;"  >装载段寄存器的指令</span></p></td></tr><tr><td vAlign="middle"  style="padding-top: 1px; padding-left: 1px; padding-bottom: 1px; padding-right: 1px; border-top:  none; border-left:  solid #00ccff 0.75pt; border-bottom:  solid #006699 0.75pt; border-right:  solid #006699 0.75pt;"  ><p style="text-align: center;"  ><span style="color:white; font-family:Times New Roman; font-size:9pt;"  >0CH</span></p></td><td vAlign="middle"  style="padding-top: 1px; padding-left: 1px; padding-bottom: 1px; padding-right: 1px; border-top:  none; border-left:  none; border-bottom:  solid #006699 0.75pt; border-right:  solid #006699 0.75pt;"  ><p><span style="color:white; font-family:宋体; font-size:9pt;"  >堆栈段异常</span></p></td><td vAlign="middle"  style="padding-top: 1px; padding-left: 1px; padding-bottom: 1px; padding-right: 1px; border-top:  none; border-left:  none; border-bottom:  solid #006699 0.75pt; border-right:  solid #006699 0.75pt;"  ><p><span style="color:white; font-family:宋体; font-size:9pt;"  >故障</span></p></td><td vAlign="middle"  style="padding-top: 1px; padding-left: 1px; padding-bottom: 1px; padding-right: 1px; border-top:  none; border-left:  none; border-bottom:  solid #006699 0.75pt; border-right:  solid #006699 0.75pt;"  ><p style="text-align: center;"  ><span style="color:white; font-family:宋体; font-size:9pt;"  >有</span></p></td><td vAlign="middle"  style="padding-top: 1px; padding-left: 1px; padding-bottom: 1px; padding-right: 1px; border-top:  none; border-left:  none; border-bottom:  solid #006699 0.75pt; border-right:  solid #006699 0.75pt;"  ><p><span style="color:white; font-size:9pt;"  ><span style="font-family:宋体;"  >装载</span><span style="font-family:Times New Roman;"  >SS</span><span style="font-family:宋体;"  >寄存器的任何指令、对</span><span style="font-family:Times New Roman;"  >SS</span><span style="font-family:宋体;"  >寻址的段访问的任何指令</span></span></p></td></tr><tr><td vAlign="middle"  style="padding-top: 1px; padding-left: 1px; padding-bottom: 1px; padding-right: 1px; border-top:  none; border-left:  solid #00ccff 0.75pt; border-bottom:  solid #006699 0.75pt; border-right:  solid #006699 0.75pt;"  ><p style="text-align: center;"  ><span style="color:white; font-family:Times New Roman; font-size:9pt;"  >0DH</span></p></td><td vAlign="middle"  style="padding-top: 1px; padding-left: 1px; padding-bottom: 1px; padding-right: 1px; border-top:  none; border-left:  none; border-bottom:  solid #006699 0.75pt; border-right:  solid #006699 0.75pt;"  ><p><span style="color:white; font-family:宋体; font-size:9pt;"  >通用保护异常</span></p></td><td vAlign="middle"  style="padding-top: 1px; padding-left: 1px; padding-bottom: 1px; padding-right: 1px; border-top:  none; border-left:  none; border-bottom:  solid #006699 0.75pt; border-right:  solid #006699 0.75pt;"  ><p><span style="color:white; font-family:宋体; font-size:9pt;"  >故障</span></p></td><td vAlign="middle"  style="padding-top: 1px; padding-left: 1px; padding-bottom: 1px; padding-right: 1px; border-top:  none; border-left:  none; border-bottom:  solid #006699 0.75pt; border-right:  solid #006699 0.75pt;"  ><p style="text-align: center;"  ><span style="color:white; font-family:宋体; font-size:9pt;"  >有</span></p></td><td vAlign="middle"  style="padding-top: 1px; padding-left: 1px; padding-bottom: 1px; padding-right: 1px; border-top:  none; border-left:  none; border-bottom:  solid #006699 0.75pt; border-right:  solid #006699 0.75pt;"  ><p><span style="color:white; font-family:宋体; font-size:9pt;"  >任何特权指令、任何访问存储器的指令</span></p></td></tr><tr><td vAlign="middle"  style="padding-top: 1px; padding-left: 1px; padding-bottom: 1px; padding-right: 1px; border-top:  none; border-left:  solid #00ccff 0.75pt; border-bottom:  solid #006699 0.75pt; border-right:  solid #006699 0.75pt;"  ><p style="text-align: center;"  ><span style="color:white; font-family:Times New Roman; font-size:9pt;"  >0EH</span></p></td><td vAlign="middle"  style="padding-top: 1px; padding-left: 1px; padding-bottom: 1px; padding-right: 1px; border-top:  none; border-left:  none; border-bottom:  solid #006699 0.75pt; border-right:  solid #006699 0.75pt;"  ><p><span style="color:white; font-family:宋体; font-size:9pt;"  >页异常</span></p></td><td vAlign="middle"  style="padding-top: 1px; padding-left: 1px; padding-bottom: 1px; padding-right: 1px; border-top:  none; border-left:  none; border-bottom:  solid #006699 0.75pt; border-right:  solid #006699 0.75pt;"  ><p><span style="color:white; font-family:宋体; font-size:9pt;"  >故障</span></p></td><td vAlign="middle"  style="padding-top: 1px; padding-left: 1px; padding-bottom: 1px; padding-right: 1px; border-top:  none; border-left:  none; border-bottom:  solid #006699 0.75pt; border-right:  solid #006699 0.75pt;"  ><p style="text-align: center;"  ><span style="color:white; font-family:宋体; font-size:9pt;"  >有</span></p></td><td vAlign="middle"  style="padding-top: 1px; padding-left: 1px; padding-bottom: 1px; padding-right: 1px; border-top:  none; border-left:  none; border-bottom:  solid #006699 0.75pt; border-right:  solid #006699 0.75pt;"  ><p><span style="color:white; font-family:宋体; font-size:9pt;"  >任何访问存储器的指令</span></p></td></tr><tr><td vAlign="middle"  style="padding-top: 1px; padding-left: 1px; padding-bottom: 1px; padding-right: 1px; border-top:  none; border-left:  solid #00ccff 0.75pt; border-bottom:  solid #006699 0.75pt; border-right:  solid #006699 0.75pt;"  ><p style="text-align: center;"  ><span style="color:white; font-family:Times New Roman; font-size:9pt;"  >10H</span></p></td><td vAlign="middle"  style="padding-top: 1px; padding-left: 1px; padding-bottom: 1px; padding-right: 1px; border-top:  none; border-left:  none; border-bottom:  solid #006699 0.75pt; border-right:  solid #006699 0.75pt;"  ><p><span style="color:white; font-family:宋体; font-size:9pt;"  >协处理器出错</span></p></td><td vAlign="middle"  style="padding-top: 1px; padding-left: 1px; padding-bottom: 1px; padding-right: 1px; border-top:  none; border-left:  none; border-bottom:  solid #006699 0.75pt; border-right:  solid #006699 0.75pt;"  ><p><span style="color:white; font-family:宋体; font-size:9pt;"  >故障</span></p></td><td vAlign="middle"  style="padding-top: 1px; padding-left: 1px; padding-bottom: 1px; padding-right: 1px; border-top:  none; border-left:  none; border-bottom:  solid #006699 0.75pt; border-right:  solid #006699 0.75pt;"  ><p style="text-align: center;"  ><span style="color:white; font-family:宋体; font-size:9pt;"  >无</span></p></td><td vAlign="middle"  style="padding-top: 1px; padding-left: 1px; padding-bottom: 1px; padding-right: 1px; border-top:  none; border-left:  none; border-bottom:  solid #006699 0.75pt; border-right:  solid #006699 0.75pt;"  ><p><span style="color:white; font-size:9pt;"  ><span style="font-family:宋体;"  >浮点指令或</span><span style="font-family:Times New Roman;"  >WAIT</span></span></p></td></tr><tr><td vAlign="middle"  style="padding-top: 1px; padding-left: 1px; padding-bottom: 1px; padding-right: 1px; border-top:  none; border-left:  solid #00ccff 0.75pt; border-bottom:  solid #006699 0.75pt; border-right:  solid #006699 0.75pt;"  ><p style="text-align: center;"  ><span style="color:white; font-family:Times New Roman; font-size:9pt;"  >11H—0FFH</span></p></td><td vAlign="middle"  style="padding-top: 1px; padding-left: 1px; padding-bottom: 1px; padding-right: 1px; border-top:  none; border-left:  none; border-bottom:  solid #006699 0.75pt; border-right:  solid #006699 0.75pt;"  ><p><span style="color:white; font-family:宋体; font-size:9pt;"  >软中断</span></p></td><td vAlign="middle"  style="padding-top: 1px; padding-left: 1px; padding-bottom: 1px; padding-right: 1px; border-top:  none; border-left:  none; border-bottom:  solid #006699 0.75pt; border-right:  solid #006699 0.75pt;"  ><p><span style="color:white; font-family:宋体; font-size:9pt;"  >陷阱</span></p></td><td vAlign="middle"  style="padding-top: 1px; padding-left: 1px; padding-bottom: 1px; padding-right: 1px; border-top:  none; border-left:  none; border-bottom:  solid #006699 0.75pt; border-right:  solid #006699 0.75pt;"  ><p style="text-align: center;"  ><span style="color:white; font-family:宋体; font-size:9pt;"  >无</span></p></td><td vAlign="middle"  style="padding-top: 1px; padding-left: 1px; padding-bottom: 1px; padding-right: 1px; border-top:  none; border-left:  none; border-bottom:  solid #006699 0.75pt; border-right:  solid #006699 0.75pt;"  ><p><span style="color:white; font-family:Times New Roman; font-size:9pt;"  >INT n</span></p></td></tr></table></div><p> &nbsp;</p><p><span style="color:black; font-size:9pt;"  ><span style="font-family:宋体;"  >由上表可见，保护模式下的某些中断向量号的分配与实模式的中断向量号发生了冲突。实</span><span style="font-family:Times New Roman;"  >    </span><span style="font-family:宋体;"  >模式下的中断向量号的分配基于</span><span style="font-family:Times New Roman;"  >PC</span><span style="font-family:宋体;"  >微机系统的</span><span style="font-family:Times New Roman;"  >8086/8088 CPU</span><span style="font-family:宋体;"  >，上表中的中断向量号的分配</span><span style="font-family:Times New Roman;"  >    </span><span style="font-family:宋体;"  >是</span><span style="font-family:Times New Roman;"  >80386</span><span style="font-family:宋体;"  >所规定的。实际上，</span><span style="font-family:Times New Roman;"  >Intel</span><span style="font-family:宋体;"  >在宣布</span><span style="font-family:Times New Roman;"  >8086/8088</span><span style="font-family:宋体;"  >时，保留了这些发生冲突的中断向量号。</span><span style="font-family:Times New Roman;"  >    </span><span style="font-family:宋体;"  >尽管发生这样的冲突，但以</span><span style="font-family:Times New Roman;"  >80386</span><span style="font-family:宋体;"  >为</span><span style="font-family:Times New Roman;"  >CPU</span><span style="font-family:宋体;"  >的微机系统仍可保持与以</span><span style="font-family:Times New Roman;"  >8086/8088</span><span style="font-family:宋体;"  >为</span><span style="font-family:Times New Roman;"  >CPU</span><span style="font-family:宋体;"  >的微机系统</span><span style="font-family:Times New Roman;"  >    </span><span style="font-family:宋体;"  >的兼容，原因是在</span><span style="font-family:Times New Roman;"  >80386</span><span style="font-family:宋体;"  >的实模式下，几乎不发生那些中断向量号与外部硬件中断请求时所</span><span style="font-family:Times New Roman;"  >    </span><span style="font-family:宋体;"  >提供的中断向量号存在冲突的异常。需要注意的是，在保</span><span style="font-family:Times New Roman;"  >    </span><span style="font-family:宋体;"  >护模式下必须重新设置</span><span style="font-family:Times New Roman;"  >8259A</span><span style="font-family:宋体;"  >中断控制器，以产生不与异常相冲突的硬件中断向量。</span><span style="font-family:Times New Roman;"  >    </span></span></p><p><span style="color:red; font-family:Batang; font-size:13pt;"  ><strong>2.故障类异常 </strong></span></p><p><span style="color:black; font-size:9pt;"  ><span style="font-family:宋体;"  >当发生故障，控制转移到故障处理程序时，所保存的断点</span><span style="font-family:Times New Roman;"  >CS</span><span style="font-family:宋体;"  >及</span><span style="font-family:Times New Roman;"  >EIP</span><span style="font-family:宋体;"  >的值指向引起故障的指令，</span><span style="font-family:Times New Roman;"  >    </span><span style="font-family:宋体;"  >以便在排除故障后恢复执行。</span><span style="font-family:Times New Roman;"  >    </span></span></p><p><span style="color:fuchsia; font-family:Batang; font-size:12pt;"  ><strong>(1)除法出错故障(异常0) </strong></span></p><p><span style="color:black; font-size:9pt;"  ><span style="font-family:宋体;"  >除法出错是一种故障。当执行</span><span style="font-family:Times New Roman;"  >DIV</span><span style="font-family:宋体;"  >指令或</span><span style="font-family:Times New Roman;"  >IDIV</span><span style="font-family:宋体;"  >指令时，如果除数等于</span><span style="font-family:Times New Roman;"  >0</span><span style="font-family:宋体;"  >或者商太大，以至于存</span><span style="font-family:Times New Roman;"  >    </span><span style="font-family:宋体;"  >放商的操作数容纳不下，那么就产生这一故障。除法出错故障不提供出错码。</span><span style="font-family:Times New Roman;"  >    </span></span></p><p><span style="color:fuchsia; font-family:Batang; font-size:12pt;"  ><strong>(2)边界检查故障(异常5) </strong></span></p><p><span style="color:black; font-size:9pt;"  ><span style="font-family:宋体;"  >如果</span><span style="font-family:Times New Roman;"  >BOUND</span><span style="font-family:宋体;"  >指令发现被测试的值超过了指令中给定的范围，那么就发生边界检查故障。边界</span><span style="font-family:Times New Roman;"  >    </span><span style="font-family:宋体;"  >检查故障不提供出错码。</span><span style="font-family:Times New Roman;"  >    </span></span></p><p><span style="color:fuchsia; font-family:Batang; font-size:12pt;"  ><strong>(3)非法操作码故障(异常6) </strong></span></p><p><span style="color:black; font-size:9pt;"  ><span style="font-family:宋体;"  >如果</span><span style="font-family:Times New Roman;"  >80386</span><span style="font-family:宋体;"  >不能把</span><span style="font-family:Times New Roman;"  >CS</span><span style="font-family:宋体;"  >和</span><span style="font-family:Times New Roman;"  >EIP</span><span style="font-family:宋体;"  >所指向存储单元的位模式识别为某条指令的部分，那么就发生非</span><span style="font-family:Times New Roman;"  >    </span><span style="font-family:宋体;"  >法操作码故障。当出现如下情况时，发生这样的故障：</span><span style="font-family:Times New Roman;"  >(1)</span><span style="font-family:宋体;"  >操作码字段的内容不是一个合法</span><span style="font-family:Times New Roman;"  >    </span><span style="font-family:宋体;"  >的</span><span style="font-family:Times New Roman;"  >80386</span><span style="font-family:宋体;"  >指令代码；</span><span style="font-family:Times New Roman;"  >(2)</span><span style="font-family:宋体;"  >要求使用存储器操作数的场合，使用了寄存器操作数；</span><span style="font-family:Times New Roman;"  >(3)</span><span style="font-family:宋体;"  >不能被加</span><span style="font-family:Times New Roman;"  >    </span><span style="font-family:宋体;"  >锁的指令前使用了</span><span style="font-family:Times New Roman;"  >LOCK</span><span style="font-family:宋体;"  >前缀。非法操作码故障不提供操作码。</span><span style="font-family:Times New Roman;"  >    </span></span></p><p><span style="color:fuchsia; font-family:Batang; font-size:12pt;"  ><strong>(4)设备不可用故障(异常7) </strong></span></p><p><span style="color:black; font-size:9pt;"  ><span style="font-family:宋体;"  >设备不可用故障支持</span><span style="font-family:Times New Roman;"  >80387</span><span style="font-family:宋体;"  >数字协处理器。在没有</span><span style="font-family:Times New Roman;"  >80387</span><span style="font-family:宋体;"  >协处理器硬件的系统中，可用该异</span><span style="font-family:Times New Roman;"  >    </span><span style="font-family:宋体;"  >常的处理程序代替协处理器的软件模拟器。在发生任务切换时，使得只有在新任务使用浮</span><span style="font-family:Times New Roman;"  >    </span><span style="font-family:宋体;"  >点指令时，才进行</span><span style="font-family:Times New Roman;"  >80387</span><span style="font-family:宋体;"  >寄存器状态的切换。设备不可用故障不提供出错码。该故障在下列</span><span style="font-family:Times New Roman;"  >    </span><span style="font-family:宋体;"  >情况下产生：</span><span style="font-family:Times New Roman;"  >(1)</span><span style="font-family:宋体;"  >在执行浮点指令时，控制寄存器</span><span style="font-family:Times New Roman;"  >CR0</span><span style="font-family:宋体;"  >中的</span><span style="font-family:Times New Roman;"  >EM</span><span style="font-family:宋体;"  >位或</span><span style="font-family:Times New Roman;"  >TS</span><span style="font-family:宋体;"  >位为</span><span style="font-family:Times New Roman;"  >1</span><span style="font-family:宋体;"  >；</span><span style="font-family:Times New Roman;"  >(2)</span><span style="font-family:宋体;"  >在执行</span><span style="font-family:Times New Roman;"  >WAIT</span><span style="font-family:宋体;"  >指</span><span style="font-family:Times New Roman;"  >    </span><span style="font-family:宋体;"  >令时，控制寄存器</span><span style="font-family:Times New Roman;"  >CR0</span><span style="font-family:宋体;"  >中</span><span style="font-family:Times New Roman;"  >TS</span><span style="font-family:宋体;"  >位及</span><span style="font-family:Times New Roman;"  >EM</span><span style="font-family:宋体;"  >位都为</span><span style="font-family:Times New Roman;"  >1</span><span style="font-family:宋体;"  >。需要注意的</span><span style="font-family:Times New Roman;"  >    </span><span style="font-family:宋体;"  >是，本异常的处理程序必须是一个过程而不能是任务，否则当处理程序发布一条</span><span style="font-family:Times New Roman;"  >IRET</span><span style="font-family:宋体;"  >指令</span><span style="font-family:Times New Roman;"  >    </span><span style="font-family:宋体;"  >时，</span><span style="font-family:Times New Roman;"  >80386</span><span style="font-family:宋体;"  >就设置</span><span style="font-family:Times New Roman;"  >TS</span><span style="font-family:宋体;"  >位。然后协处理器再次执行这个发生故障的指令，发现</span><span style="font-family:Times New Roman;"  >TS</span><span style="font-family:宋体;"  >是置位的，因</span><span style="font-family:Times New Roman;"  >    </span><span style="font-family:宋体;"  >此就再次发生异常</span><span style="font-family:Times New Roman;"  >7</span><span style="font-family:宋体;"  >，结果是无休止的循环。处理程序能通过陷阱门被调用，因为执行期间</span><span style="font-family:Times New Roman;"  >    </span><span style="font-family:宋体;"  >可以允许中断。</span><span style="font-family:Times New Roman;"  >    </span></span></p><p><span style="color:fuchsia; font-family:Batang; font-size:12pt;"  ><strong>(5)无效TSS故障(异常0AH) </strong></span></p><p><span style="color:black; font-size:9pt;"  ><span style="font-family:宋体;"  >当正从任务状态段</span><span style="font-family:Times New Roman;"  >TSS</span><span style="font-family:宋体;"  >装入选择子时，如果发生了除了段不存在故障以外的段异常时，就发</span><span style="font-family:Times New Roman;"  >    </span><span style="font-family:宋体;"  >生无效</span><span style="font-family:Times New Roman;"  >TSS</span><span style="font-family:宋体;"  >故障。在进入故障处理程序时，保存的</span><span style="font-family:Times New Roman;"  >CS</span><span style="font-family:宋体;"  >及</span><span style="font-family:Times New Roman;"  >EIP</span><span style="font-family:宋体;"  >指向发生故障的指令；或者该故障</span><span style="font-family:Times New Roman;"  >    </span><span style="font-family:宋体;"  >作为任务切换的一部分发生时，指向任务的第一条指令。</span><span style="font-family:Times New Roman;"  >    </span></span></p><p><span style="color:black; font-size:9pt;"  ><span style="font-family:宋体;"  >无效</span><span style="font-family:Times New Roman;"  >TSS</span><span style="font-family:宋体;"  >故障提供了一个出错码，出错码的格式如下图所示。其中选择子部分是指向引起故</span><span style="font-family:Times New Roman;"  >    </span><span style="font-family:宋体;"  >障的</span><span style="font-family:Times New Roman;"  >TSS</span><span style="font-family:宋体;"  >的选择子。</span><span style="font-family:Times New Roman;"  >16</span><span style="font-family:宋体;"  >位的出错代码的主要成分是选择子，指向引起故障的</span><span style="font-family:Times New Roman;"  >TSS</span><span style="font-family:宋体;"  >的选择子。</span><span style="font-family:Times New Roman;"  >    </span><span style="font-family:宋体;"  >高</span><span style="font-family:Times New Roman;"  >13</span><span style="font-family:宋体;"  >位是选择子的索引部分，</span><span style="font-family:Times New Roman;"  >TI</span><span style="font-family:宋体;"  >位是描述符表指示位。</span><span style="font-family:Times New Roman;"  >    </span></span></p><p> &nbsp;</p><div style="text-align: center;"  ><table style="border-collapse:collapse; background: #0099cc;"  border="0"  ><colgroup><col style="width:100px;"  /><col style="width:29px;"  /><col style="width:29px;"  /><col style="width:29px;"  /><tbody valign="top"  ><tr><td colspan="4"  vAlign="middle"  style="padding-top: 1px; padding-left: 1px; padding-bottom: 1px; padding-right: 1px; border-top:  solid #00ccff 0.75pt; border-left:  solid #00ccff 0.75pt; border-bottom:  solid #006699 0.75pt; border-right:  solid #006699 0.75pt;"  ><p style="text-align: center;"  ><span style="color:white; font-family:宋体; font-size:9pt;"  >出错代码的格式</span></p></td></tr><tr><td vAlign="middle"  style="padding-top: 1px; padding-left: 1px; padding-bottom: 1px; padding-right: 1px; border-top:  none; border-left:  solid #00ccff 0.75pt; border-bottom:  solid #006699 0.75pt; border-right:  solid #006699 0.75pt;"  ><p style="text-align: center;"  ><span style="color:white; font-family:Times New Roman; font-size:9pt;"  >BIT15—BIT3</span></p></td><td vAlign="middle"  style="padding-top: 1px; padding-left: 1px; padding-bottom: 1px; padding-right: 1px; border-top:  none; border-left:  none; border-bottom:  solid #006699 0.75pt; border-right:  solid #006699 0.75pt;"  ><p style="text-align: center;"  ><span style="color:white; font-family:Times New Roman; font-size:9pt;"  >BIT2</span></p></td><td vAlign="middle"  style="padding-top: 1px; padding-left: 1px; padding-bottom: 1px; padding-right: 1px; border-top:  none; border-left:  none; border-bottom:  solid #006699 0.75pt; border-right:  solid #006699 0.75pt;"  ><p style="text-align: center;"  ><span style="color:white; font-family:Times New Roman; font-size:9pt;"  >BIT1</span></p></td><td vAlign="middle"  style="padding-top: 1px; padding-left: 1px; padding-bottom: 1px; padding-right: 1px; border-top:  none; border-left:  none; border-bottom:  solid #006699 0.75pt; border-right:  solid #006699 0.75pt;"  ><p style="text-align: center;"  ><span style="color:white; font-family:Times New Roman; font-size:9pt;"  >BIT0</span></p></td></tr><tr><td vAlign="middle"  style="padding-top: 1px; padding-left: 1px; padding-bottom: 1px; padding-right: 1px; border-top:  none; border-left:  solid #00ccff 0.75pt; border-bottom:  solid #006699 0.75pt; border-right:  solid #006699 0.75pt;"  ><p style="text-align: center;"  ><span style="color:white; font-family:宋体; font-size:9pt;"  >选择子的索引部分</span></p></td><td vAlign="middle"  style="padding-top: 1px; padding-left: 1px; padding-bottom: 1px; padding-right: 1px; border-top:  none; border-left:  none; border-bottom:  solid #006699 0.75pt; border-right:  solid #006699 0.75pt;"  ><p style="text-align: center;"  ><span style="color:white; font-family:Times New Roman; font-size:9pt;"  >TI</span></p></td><td vAlign="middle"  style="padding-top: 1px; padding-left: 1px; padding-bottom: 1px; padding-right: 1px; border-top:  none; border-left:  none; border-bottom:  solid #006699 0.75pt; border-right:  solid #006699 0.75pt;"  ><p style="text-align: center;"  ><span style="color:white; font-family:Times New Roman; font-size:9pt;"  >IDT</span></p></td><td vAlign="middle"  style="padding-top: 1px; padding-left: 1px; padding-bottom: 1px; padding-right: 1px; border-top:  none; border-left:  none; border-bottom:  solid #006699 0.75pt; border-right:  solid #006699 0.75pt;"  ><p style="text-align: center;"  ><span style="color:white; font-family:Times New Roman; font-size:9pt;"  >EXT</span></p></td></tr></table></div><p> &nbsp;</p><p><span style="color:black; font-size:9pt;"  ><span style="font-family:宋体;"  >上图所示出错码格式是异常时出错码的一般格式。从图中可见出错码中不含选择子的</span><span style="font-family:Times New Roman;"  >RPL</span><span style="font-family:宋体;"  >，</span><span style="font-family:Times New Roman;"  >    </span><span style="font-family:宋体;"  >而由</span><span style="font-family:Times New Roman;"  >IDT</span><span style="font-family:宋体;"  >位和</span><span style="font-family:Times New Roman;"  >EXT</span><span style="font-family:宋体;"  >位代替。当处理某一异常或外部中断时，又发生了某种异常，那么</span><span style="font-family:Times New Roman;"  >EXT</span><span style="font-family:宋体;"  >位</span><span style="font-family:Times New Roman;"  >    </span><span style="font-family:宋体;"  >置</span><span style="font-family:Times New Roman;"  >1</span><span style="font-family:宋体;"  >。当从中断描述符表</span><span style="font-family:Times New Roman;"  >IDT</span><span style="font-family:宋体;"  >中读出表项并产生异常时，</span><span style="font-family:Times New Roman;"  >IDT</span><span style="font-family:宋体;"  >位置</span><span style="font-family:Times New Roman;"  >1</span><span style="font-family:宋体;"  >，这只在中断或异常的处</span><span style="font-family:Times New Roman;"  >    </span><span style="font-family:宋体;"  >理期间才会发生。当没有选择子时，构成出错码选择子部分的值为</span><span style="font-family:Times New Roman;"  >0</span><span style="font-family:宋体;"  >。</span><span style="font-family:Times New Roman;"  >    </span></span></p><p><span style="color:black; font-size:9pt;"  ><span style="font-family:宋体;"  >一些引起无效</span><span style="font-family:Times New Roman;"  >TSS</span><span style="font-family:宋体;"  >故障的原因如下：</span><span style="font-family:Times New Roman;"  >    </span></span></p><p><span style="color:black; font-size:9pt;"  ><span style="font-family:Times New Roman;"  >TSS</span><span style="font-family:宋体;"  >描述符中的段限长小于</span><span style="font-family:Times New Roman;"  >103</span><span style="font-family:宋体;"  >；</span><span style="font-family:Times New Roman;"  >    </span></span></p><p><span style="color:black; font-size:9pt;"  ><span style="font-family:宋体;"  >无效的</span><span style="font-family:Times New Roman;"  >LDT</span><span style="font-family:宋体;"  >描述符，或者</span><span style="font-family:Times New Roman;"  >LDT</span><span style="font-family:宋体;"  >未出现；</span><span style="font-family:Times New Roman;"  >    </span></span></p><p><span style="color:black; font-size:9pt;"  ><span style="font-family:宋体;"  >堆栈段不是一个可写段；</span><span style="font-family:Times New Roman;"  >    </span></span></p><p><span style="color:black; font-size:9pt;"  ><span style="font-family:宋体;"  >堆栈段选择子索引的描述符超出描述符表界限；</span><span style="font-family:Times New Roman;"  >    </span></span></p><p><span style="color:black; font-size:9pt;"  ><span style="font-family:宋体;"  >堆栈段</span><span style="font-family:Times New Roman;"  >DPL</span><span style="font-family:宋体;"  >与新的</span><span style="font-family:Times New Roman;"  >CPL</span><span style="font-family:宋体;"  >不匹配；</span><span style="font-family:Times New Roman;"  >    </span></span></p><p><span style="color:black; font-size:9pt;"  ><span style="font-family:宋体;"  >堆栈段选择子的</span><span style="font-family:Times New Roman;"  >RPL</span><span style="font-family:宋体;"  >不等于</span><span style="font-family:Times New Roman;"  >CPL</span><span style="font-family:宋体;"  >；</span><span style="font-family:Times New Roman;"  >    </span></span></p><p><span style="color:black; font-size:9pt;"  ><span style="font-family:宋体;"  >代码段选择子索引的描述符超出描述符表界限；</span><span style="font-family:Times New Roman;"  >    </span></span></p><p><span style="color:black; font-size:9pt;"  ><span style="font-family:宋体;"  >代码段选择子不指向代码段；</span><span style="font-family:Times New Roman;"  >    </span></span></p><p><span style="color:black; font-size:9pt;"  ><span style="font-family:宋体;"  >非一致代码段的</span><span style="font-family:Times New Roman;"  >DPL</span><span style="font-family:宋体;"  >不等于新的</span><span style="font-family:Times New Roman;"  >CPL</span><span style="font-family:宋体;"  >；</span><span style="font-family:Times New Roman;"  >    </span></span></p><p><span style="color:black; font-size:9pt;"  ><span style="font-family:宋体;"  >一致代码段的</span><span style="font-family:Times New Roman;"  >DPL</span><span style="font-family:宋体;"  >大于新的</span><span style="font-family:Times New Roman;"  >CPL</span><span style="font-family:宋体;"  >；</span><span style="font-family:Times New Roman;"  >    </span></span></p><p><span style="color:black; font-size:9pt;"  ><span style="font-family:宋体;"  >对应</span><span style="font-family:Times New Roman;"  >DS</span><span style="font-family:宋体;"  >、</span><span style="font-family:Times New Roman;"  >ES</span><span style="font-family:宋体;"  >、</span><span style="font-family:Times New Roman;"  >FS</span><span style="font-family:宋体;"  >或</span><span style="font-family:Times New Roman;"  >GS</span><span style="font-family:宋体;"  >的选择子指向一个不可读段</span><span style="font-family:Times New Roman;"  >(</span><span style="font-family:宋体;"  >如系统段</span><span style="font-family:Times New Roman;"  >)</span><span style="font-family:宋体;"  >；</span><span style="font-family:Times New Roman;"  >    </span></span></p><p><span style="color:black; font-size:9pt;"  ><span style="font-family:宋体;"  >对应</span><span style="font-family:Times New Roman;"  >DS</span><span style="font-family:宋体;"  >、</span><span style="font-family:Times New Roman;"  >ES</span><span style="font-family:宋体;"  >、</span><span style="font-family:Times New Roman;"  >FS</span><span style="font-family:宋体;"  >或</span><span style="font-family:Times New Roman;"  >GS</span><span style="font-family:宋体;"  >的选择子索引的描述符超出描述符表的界限。</span><span style="font-family:Times New Roman;"  >    </span></span></p><p><span style="color:fuchsia; font-family:Batang; font-size:12pt;"  ><strong>(6)段不存在故障(异常0BH) </strong></span></p><p><span style="color:black; font-size:9pt;"  ><span style="font-family:宋体;"  >处理器在把描述符装入非</span><span style="font-family:Times New Roman;"  >SS</span><span style="font-family:宋体;"  >段寄存器的高速缓冲时，如果发现描述符其它方面有效，而</span><span style="font-family:Times New Roman;"  >P</span><span style="font-family:宋体;"  >位</span><span style="font-family:Times New Roman;"  >    </span><span style="font-family:宋体;"  >为</span><span style="font-family:Times New Roman;"  >0(</span><span style="font-family:宋体;"  >表示对应段不存在</span><span style="font-family:Times New Roman;"  >)</span><span style="font-family:宋体;"  >，那么在引用此描述符时就发生段不存在故障。有关</span><span style="font-family:Times New Roman;"  >SS</span><span style="font-family:宋体;"  >段的情形纳</span><span style="font-family:Times New Roman;"  >    </span><span style="font-family:宋体;"  >入堆栈段故障。在进入故障处理程序时，保存的</span><span style="font-family:Times New Roman;"  >CS</span><span style="font-family:宋体;"  >及</span><span style="font-family:Times New Roman;"  >EIP</span><span style="font-family:宋体;"  >执行发生故障的指令；或者该故障</span><span style="font-family:Times New Roman;"  >    </span><span style="font-family:宋体;"  >作为任务切换的一部分发生时，指向任务的第一条指令。</span><span style="font-family:Times New Roman;"  >    </span></span></p><p><span style="color:black; font-size:9pt;"  ><span style="font-family:宋体;"  >段不存在故障提供了一个包含引起该故障的段选择子的出错代码。出错码的格式如上图所</span><span style="font-family:Times New Roman;"  >    </span><span style="font-family:宋体;"  >示。选择子索引部分为引起段不存在故障的段描述符选择子的索引。</span><span style="font-family:Times New Roman;"  >    </span></span></p><p><span style="color:fuchsia; font-family:Batang; font-size:12pt;"  ><strong>(7)堆栈段故障(异常0CH) </strong></span></p><p><span style="color:black; font-size:9pt;"  ><span style="font-family:宋体;"  >当处理器检测到用</span><span style="font-family:Times New Roman;"  >SS</span><span style="font-family:宋体;"  >寄存器进行寻址的段有关的某种问题时，就发生堆栈段故障。在进入</span><span style="font-family:Times New Roman;"  >    </span><span style="font-family:宋体;"  >故障处理程序时，保存的</span><span style="font-family:Times New Roman;"  >CS</span><span style="font-family:宋体;"  >及</span><span style="font-family:Times New Roman;"  >EIP</span><span style="font-family:宋体;"  >指向发生故障的指令；或者该故障作为任务切换的一部分</span><span style="font-family:Times New Roman;"  >    </span><span style="font-family:宋体;"  >发生时，指向任务的第一条指令。堆栈段故障提供一个出错码，出错码的格式也如上图。</span><span style="font-family:Times New Roman;"  >    </span></span></p><p><span style="color:black; font-size:9pt;"  ><span style="font-family:宋体;"  >具体地说，当出现下列三种情况时，将引起堆栈段故障：</span><span style="font-family:Times New Roman;"  >    </span></span></p><p><span style="color:black; font-size:9pt;"  ><span style="font-family:Times New Roman;"  >(1)</span><span style="font-family:宋体;"  >在堆栈操作时，偏移超出段界限所规定的范围。这种情况下的出错码是</span><span style="font-family:Times New Roman;"  >0</span><span style="font-family:宋体;"  >。例如</span><span style="font-family:Times New Roman;"  >PUSH</span><span style="font-family:宋体;"  >操</span><span style="font-family:Times New Roman;"  >    </span><span style="font-family:宋体;"  >作时，堆栈溢出。</span><span style="font-family:Times New Roman;"  >    </span></span></p><p><span style="color:black; font-size:9pt;"  ><span style="font-family:Times New Roman;"  >(2)</span><span style="font-family:宋体;"  >在由特权级变换所引起的对内层堆栈的操作时，偏移超出段界限所规定的范围。这种情</span><span style="font-family:Times New Roman;"  >    </span><span style="font-family:宋体;"  >况下的出错码包含有内层堆栈的选择子。</span><span style="font-family:Times New Roman;"  >    </span></span></p><p><span style="color:black; font-size:9pt;"  ><span style="font-family:Times New Roman;"  >(3)</span><span style="font-family:宋体;"  >装入到</span><span style="font-family:Times New Roman;"  >SS</span><span style="font-family:宋体;"  >寄存器</span><span style="font-family:Times New Roman;"  >(</span><span style="font-family:宋体;"  >高速缓冲寄存器</span><span style="font-family:Times New Roman;"  >)</span><span style="font-family:宋体;"  >的描述符中的存在位为</span><span style="font-family:Times New Roman;"  >0</span><span style="font-family:宋体;"  >。这种情况下的出错码包含</span><span style="font-family:Times New Roman;"  >    </span><span style="font-family:宋体;"  >有对应的选择子。</span><span style="font-family:Times New Roman;"  >    </span></span></p><p><span style="color:black; font-size:9pt;"  ><span style="font-family:宋体;"  >上述第一种情况是容易辨别的。第二和第三种情况的辨别要通过判断出错代码所含选择子</span><span style="font-family:Times New Roman;"  >    </span><span style="font-family:宋体;"  >所指示的描述符中的存在位进行。如果存在位为</span><span style="font-family:Times New Roman;"  >1</span><span style="font-family:宋体;"  >，那么是第二种情况；否则是第三种情况。</span><span style="font-family:Times New Roman;"  >    </span></span></p><p><span style="color:fuchsia; font-family:Batang; font-size:12pt;"  ><strong>(8)通用保护故障(异常0DH) </strong></span></p><p><span style="color:black; font-size:9pt;"  ><span style="font-family:宋体;"  >除了明确列出的段异常外，其它的段异常都被视为通用保护故障。在进入故障处理程序时，</span><span style="font-family:Times New Roman;"  >    </span><span style="font-family:宋体;"  >保存的</span><span style="font-family:Times New Roman;"  >CS</span><span style="font-family:宋体;"  >及</span><span style="font-family:Times New Roman;"  >EIP</span><span style="font-family:宋体;"  >指向发生故障的指令；或者该故障作为任务切换的一部分发生时，指向任务</span><span style="font-family:Times New Roman;"  >    </span><span style="font-family:宋体;"  >的第一条指令。通用保护故障提供一个出错码，出错码的格式也如上图所示。</span><span style="font-family:Times New Roman;"  >    </span></span></p><p><span style="color:black; font-size:9pt;"  ><span style="font-family:宋体;"  >根据处理程序可能作出的响应，通用保护故障可分为如下两类：</span><span style="font-family:Times New Roman;"  >    </span></span></p><p><span style="color:black; font-size:9pt;"  ><span style="font-family:Times New Roman;"  >(1)</span><span style="font-family:宋体;"  >违反保护方式，但程序无须中止的异常。这类故障提供的出错码为</span><span style="font-family:Times New Roman;"  >0</span><span style="font-family:宋体;"  >。这种异常在应用</span><span style="font-family:Times New Roman;"  >    </span><span style="font-family:宋体;"  >程序执行特权指令或</span><span style="font-family:Times New Roman;"  >I/O</span><span style="font-family:宋体;"  >访问时发生，支持虚拟</span><span style="font-family:Times New Roman;"  >8086</span><span style="font-family:宋体;"  >程序的系统或支持虚拟</span><span style="font-family:Times New Roman;"  >I/O</span><span style="font-family:宋体;"  >访问的系统</span><span style="font-family:Times New Roman;"  >    </span><span style="font-family:宋体;"  >需要模拟这些指令，并在模拟完成产生故障的指令后，重新执行被中断的程序。</span><span style="font-family:Times New Roman;"  >    </span></span></p><p><span style="color:black; font-size:9pt;"  ><span style="font-family:Times New Roman;"  >(2)</span><span style="font-family:宋体;"  >违反保护方式，并导致程序终止的异常。这类故障提供的出错码可能为</span><span style="font-family:Times New Roman;"  >0</span><span style="font-family:宋体;"  >，也可能不</span><span style="font-family:Times New Roman;"  >    </span><span style="font-family:宋体;"  >为</span><span style="font-family:Times New Roman;"  >0(</span><span style="font-family:宋体;"  >能确定选择子时</span><span style="font-family:Times New Roman;"  >)</span><span style="font-family:宋体;"  >。引起这类故障的一些原因如下：</span><span style="font-family:Times New Roman;"  >    </span></span></p><p><span style="color:black; font-size:9pt;"  ><span style="font-family:宋体;"  >向某个只读数据段或代码段写；</span><span style="font-family:Times New Roman;"  >    </span></span></p><p><span style="color:black; font-size:9pt;"  ><span style="font-family:宋体;"  >从某个只能执行的代码段读出；</span><span style="font-family:Times New Roman;"  >    </span></span></p><p><span style="color:black; font-size:9pt;"  ><span style="font-family:宋体;"  >将某个系统段描述符装入到数据段寄存器</span><span style="font-family:Times New Roman;"  >DS</span><span style="font-family:宋体;"  >、</span><span style="font-family:Times New Roman;"  >ES</span><span style="font-family:宋体;"  >、</span><span style="font-family:Times New Roman;"  >FS</span><span style="font-family:宋体;"  >、</span><span style="font-family:Times New Roman;"  >GS</span><span style="font-family:宋体;"  >或</span><span style="font-family:Times New Roman;"  >SS</span><span style="font-family:宋体;"  >；</span><span style="font-family:Times New Roman;"  >    </span></span></p><p><span style="color:black; font-size:9pt;"  ><span style="font-family:宋体;"  >将控制转移到一个不可执行的段；</span><span style="font-family:Times New Roman;"  >    </span></span></p><p><span style="color:black; font-size:9pt;"  ><span style="font-family:宋体;"  >在通过段寄存器</span><span style="font-family:Times New Roman;"  >CS</span><span style="font-family:宋体;"  >、</span><span style="font-family:Times New Roman;"  >DS</span><span style="font-family:宋体;"  >、</span><span style="font-family:Times New Roman;"  >ES</span><span style="font-family:宋体;"  >、</span><span style="font-family:Times New Roman;"  >FS</span><span style="font-family:宋体;"  >或</span><span style="font-family:Times New Roman;"  >GS</span><span style="font-family:宋体;"  >访问内存时，偏移超出段界限；</span><span style="font-family:Times New Roman;"  >    </span></span></p><p><span style="color:black; font-size:9pt;"  ><span style="font-family:宋体;"  >当访问某个描述符表时，超过描述符表段界限；</span><span style="font-family:Times New Roman;"  >    </span></span></p><p><span style="color:black; font-size:9pt;"  ><span style="font-family:宋体;"  >把</span><span style="font-family:Times New Roman;"  >PG</span><span style="font-family:宋体;"  >位为</span><span style="font-family:Times New Roman;"  >1</span><span style="font-family:宋体;"  >但</span><span style="font-family:Times New Roman;"  >PE</span><span style="font-family:宋体;"  >位为</span><span style="font-family:Times New Roman;"  >0</span><span style="font-family:宋体;"  >的控制信息装入到</span><span style="font-family:Times New Roman;"  >CR0</span><span style="font-family:宋体;"  >寄存器；</span><span style="font-family:Times New Roman;"  >    </span></span></p><p><span style="color:black; font-size:9pt;"  ><span style="font-family:宋体;"  >切换到一个正忙的任务。</span><span style="font-family:Times New Roman;"  >    </span></span></p><p><span style="color:black; font-size:9pt;"  ><span style="font-family:宋体;"  >对上述两类通用保护故障的辨别，可通过检查引起故障的指令和出错码进行。如果出错码</span><span style="font-family:Times New Roman;"  >    </span><span style="font-family:宋体;"  >非</span><span style="font-family:Times New Roman;"  >0</span><span style="font-family:宋体;"  >，那么肯定是第二类通用保护故障。如果出错码是</span><span style="font-family:Times New Roman;"  >0</span><span style="font-family:宋体;"  >，那么需要进一步检查引起故障的</span><span style="font-family:Times New Roman;"  >    </span><span style="font-family:宋体;"  >指令，以确定它是否是系统支持的可以模拟的指令。</span><span style="font-family:Times New Roman;"  >    </span></span></p><p><span style="color:fuchsia; font-family:Batang; font-size:12pt;"  ><strong>(9)页故障(异常0EH) </strong></span></p><p><span style="color:black; font-size:9pt;"  ><span style="font-family:宋体;"  >关于页故障的详细说明请见后面的文章。</span><span style="font-family:Times New Roman;"  >    </span></span></p><p><span style="color:fuchsia; font-family:Batang; font-size:12pt;"  ><strong>(10)协处理器出错(异常10H) </strong></span></p><p><span style="color:black; font-size:9pt;"  ><span style="font-family:宋体;"  >协处理器出错故障指示协处理器发生了未被屏蔽的数字错误，如上溢或下溢。在引起故障</span><span style="font-family:Times New Roman;"  >    </span><span style="font-family:宋体;"  >的浮点指令之后的下一条浮点指令或</span><span style="font-family:Times New Roman;"  >WAIT</span><span style="font-family:宋体;"  >指令，把协处理器出错作为一个故障通知给系统。</span><span style="font-family:Times New Roman;"  >    </span><span style="font-family:宋体;"  >协处理器出错故障不提供出错码。</span><span style="font-family:Times New Roman;"  >    </span></span></p><p><span style="color:red; font-family:Batang; font-size:13pt;"  ><strong>3.陷阱类异常 </strong></span></p><p><span style="color:fuchsia; font-family:Batang; font-size:12pt;"  ><strong>(1)调试陷阱(异常1) </strong></span></p><p><span style="color:black; font-size:9pt;"  ><span style="font-family:宋体;"  >调试异常有故障类型，也有陷阱类型。调试程序可以访问调试寄存器</span><span style="font-family:Times New Roman;"  >DR6</span><span style="font-family:宋体;"  >，以确定调试异常</span><span style="font-family:Times New Roman;"  >    </span><span style="font-family:宋体;"  >的原因和类型。调试异常不提供出错码。</span><span style="font-family:Times New Roman;"  >    </span></span></p><p><span style="color:fuchsia; font-family:Batang; font-size:12pt;"  ><strong>(2)单字节INT3(异常3) </strong></span></p><p><span style="color:black; font-size:9pt;"  ><span style="font-family:Times New Roman;"  >INT3</span><span style="font-family:宋体;"  >是一条特别的单字节</span><span style="font-family:Times New Roman;"  >"INT n"</span><span style="font-family:宋体;"  >指令。调试程序可利用该指令支持程序断点。</span><span style="font-family:Times New Roman;"  >INT3</span><span style="font-family:宋体;"  >指令</span><span style="font-family:Times New Roman;"  >    </span><span style="font-family:宋体;"  >被看成是一种陷阱，而不是一个中断。当由于执行</span><span style="font-family:Times New Roman;"  >INT3</span><span style="font-family:宋体;"  >指令进入异常</span><span style="font-family:Times New Roman;"  >3</span><span style="font-family:宋体;"  >处理程序时，被保存</span><span style="font-family:Times New Roman;"  >    </span><span style="font-family:宋体;"  >的</span><span style="font-family:Times New Roman;"  >CS</span><span style="font-family:宋体;"  >和</span><span style="font-family:Times New Roman;"  >EIP</span><span style="font-family:宋体;"  >指向紧跟</span><span style="font-family:Times New Roman;"  >INT3</span><span style="font-family:宋体;"  >的指令，即</span><span style="font-family:Times New Roman;"  >INT3</span><span style="font-family:宋体;"  >后面的字节。</span><span style="font-family:Times New Roman;"  >INT3</span><span style="font-family:宋体;"  >陷阱不提供出错码。</span><span style="font-family:Times New Roman;"  >    </span></span></p><p><span style="color:fuchsia; font-family:Batang; font-size:12pt;"  ><strong>(3)溢出(异常4) </strong></span></p><p><span style="color:black; font-size:9pt;"  ><span style="font-family:Times New Roman;"  >INTO</span><span style="font-family:宋体;"  >指令提供条件陷阱。如果</span><span style="font-family:Times New Roman;"  >OF</span><span style="font-family:宋体;"  >标志为</span><span style="font-family:Times New Roman;"  >1</span><span style="font-family:宋体;"  >，那么</span><span style="font-family:Times New Roman;"  >INTO</span><span style="font-family:宋体;"  >指令产生陷阱；否则不产生陷阱，继续</span><span style="font-family:Times New Roman;"  >    </span><span style="font-family:宋体;"  >执行</span><span style="font-family:Times New Roman;"  >INTO</span><span style="font-family:宋体;"  >后面的指令。在进入溢出处理程序时，被保存的</span><span style="font-family:Times New Roman;"  >CS</span><span style="font-family:宋体;"  >和</span><span style="font-family:Times New Roman;"  >EIP</span><span style="font-family:宋体;"  >指向</span><span style="font-family:Times New Roman;"  >INTO</span><span style="font-family:宋体;"  >指令的下一条指</span><span style="font-family:Times New Roman;"  >    </span><span style="font-family:宋体;"  >令。溢出陷阱不提供出错码。</span><span style="font-family:Times New Roman;"  >    </span></span></p><p><span style="color:red; font-family:Batang; font-size:13pt;"  ><strong>4.中止类异常 </strong></span></p><p><span style="color:fuchsia; font-family:Batang; font-size:12pt;"  ><strong>(1)双重故障异常(异常8) </strong></span></p><p><span style="color:black; font-size:9pt;"  ><span style="font-family:宋体;"  >当系统正在处理一个异常时，如果又检测到一个异常，处理器试图向系统通知一个双重故障，</span><span style="font-family:Times New Roman;"  >    </span><span style="font-family:宋体;"  >而不是通知第二个异常。双重故障属于中止类异常，所以在转入双重故障处理程序时，被保</span><span style="font-family:Times New Roman;"  >    </span><span style="font-family:宋体;"  >存的</span><span style="font-family:Times New Roman;"  >CS</span><span style="font-family:宋体;"  >和</span><span style="font-family:Times New Roman;"  >EIP</span><span style="font-family:宋体;"  >可能不指向引起双重故障的指令，而且指令的重新启动不支持双重故障。双重故</span><span style="font-family:Times New Roman;"  >    </span><span style="font-family:宋体;"  >障提供的出错码为</span><span style="font-family:Times New Roman;"  >0</span><span style="font-family:宋体;"  >。</span><span style="font-family:Times New Roman;"  >    </span></span></p><p><span style="color:black; font-size:9pt;"  ><span style="font-family:宋体;"  >当正处理一个段故障异常时，有可能又产生一个页故障。在这种情况下，通知给系统的是一</span><span style="font-family:Times New Roman;"  >    </span><span style="font-family:宋体;"  >个页故障异常而不是双重故障异常。但是，如果正处理一个段故障或页故障时，又一个段故</span><span style="font-family:Times New Roman;"  >    </span><span style="font-family:宋体;"  >障被检测到；或者如果正处理一个页故障时，又一个页故障被检测到，那么就引起双重故障。</span><span style="font-family:Times New Roman;"  >    </span></span></p><p><span style="color:black; font-size:9pt;"  ><span style="font-family:宋体;"  >当正处理一个双重故障时，又一个段或页故障被检测到，那么处理器暂停执行指令，并进入</span><span style="font-family:Times New Roman;"  >    </span><span style="font-family:宋体;"  >关机方式。关机方式类似于处理器指令一条</span><span style="font-family:Times New Roman;"  >HLT</span><span style="font-family:宋体;"  >指令后的状态：处理器空转，并维持到处理器</span><span style="font-family:Times New Roman;"  >    </span><span style="font-family:宋体;"  >接收到一个</span><span style="font-family:Times New Roman;"  >NMI</span><span style="font-family:宋体;"  >中断请求或者被重新启动为止。在关机方式下，处理器不响应</span><span style="font-family:Times New Roman;"  >INTR</span><span style="font-family:宋体;"  >中断请求。</span><span style="font-family:Times New Roman;"  >    </span></span></p><p><span style="color:black; font-size:9pt;"  ><span style="font-family:宋体;"  >双重故障通常指示系统表出现严重的问题，例如段描述符表、页表或中断描述符表出现问题。</span><span style="font-family:Times New Roman;"  >    </span><span style="font-family:宋体;"  >双重故障处理程序在重建系统表后，可能不得不重新启动操作系统。</span><span style="font-family:Times New Roman;"  >    </span></span></p><p><span style="color:fuchsia; font-family:Batang; font-size:12pt;"  ><strong>(2)协处理器段越界(异常9) </strong></span></p><p><span style="color:black; font-size:9pt;"  ><span style="font-family:宋体;"  >协处理器段越界异常属于中止类异常，这是因为引起该异常的指令不能被重新启动。当浮点</span><span style="font-family:Times New Roman;"  >    </span><span style="font-family:宋体;"  >指令操作数超出段界限时，产生该中止异常。协处理器段越界异常不提供出错码。在异常处</span><span style="font-family:Times New Roman;"  >    </span><span style="font-family:宋体;"  >理程序入口保存的</span><span style="font-family:Times New Roman;"  >CS</span><span style="font-family:宋体;"  >及</span><span style="font-family:Times New Roman;"  >EIP</span><span style="font-family:宋体;"  >指向被中止的指令。这种中止不是系统的中止，而是只影响检测到</span><span style="font-family:Times New Roman;"  >    </span><span style="font-family:宋体;"  >这种异常时正执行的指令所在的程序。</span><span style="font-family:Times New Roman;"  >    </span></span></p><p><span style="color:red; font-family:Batang; font-size:18pt;"  ><strong>&lt;三&gt;中断和异常的转移方法 </strong></span></p><p><span style="color:black; font-size:9pt;"  ><span style="font-family:Times New Roman;"  >80386</span><span style="font-family:宋体;"  >实模式下的中断和异常的转移方法与</span><span style="font-family:Times New Roman;"  >8086</span><span style="font-family:宋体;"  >相同。这里介绍的中断和异常的转移方法是指</span><span style="font-family:Times New Roman;"  >80386</span><span style="font-family:宋体;"  >在保护模式下响应中断和处理异常时所采用的转移方法。</span><span style="font-family:Times New Roman;"  >    </span></span></p><p><span style="color:red; font-family:Batang; font-size:13pt;"  ><strong>1.中断描述符表IDT </strong></span></p><p><span style="color:black; font-size:9pt;"  ><span style="font-family:宋体;"  >与</span><span style="font-family:Times New Roman;"  >8086/8088</span><span style="font-family:宋体;"  >一样，在响应中断或者处理异常时，</span><span style="font-family:Times New Roman;"  >80386</span><span style="font-family:宋体;"  >根据中断向量号转对应的处理程序。但</span><span style="font-family:Times New Roman;"  >    </span><span style="font-family:宋体;"  >是，在保护模式下，</span><span style="font-family:Times New Roman;"  >80386</span><span style="font-family:宋体;"  >不使用实模式下的中断向量表，而是使用中断描述符表</span><span style="font-family:Times New Roman;"  >IDT</span><span style="font-family:宋体;"  >。在保护</span><span style="font-family:Times New Roman;"  >    </span><span style="font-family:宋体;"  >模式下，</span><span style="font-family:Times New Roman;"  >80386</span><span style="font-family:宋体;"  >把中断向量号作为中断描述符表</span><span style="font-family:Times New Roman;"  >IDT</span><span style="font-family:宋体;"  >中描述符的索引，而不再是中断向量表中的</span><span style="font-family:Times New Roman;"  >    </span><span style="font-family:宋体;"  >中断向量的索引。</span><span style="font-family:Times New Roman;"  >    </span></span></p><p><span style="color:black; font-size:9pt;"  ><span style="font-family:宋体;"  >象全局描述符表</span><span style="font-family:Times New Roman;"  >GDT</span><span style="font-family:宋体;"  >一样，在整个系统中，中断描述符表</span><span style="font-family:Times New Roman;"  >IDT</span><span style="font-family:宋体;"  >只有一个。中断描述符表寄存</span><span style="font-family:Times New Roman;"  >    </span><span style="font-family:宋体;"  >器</span><span style="font-family:Times New Roman;"  >IDTR</span><span style="font-family:宋体;"  >指示</span><span style="font-family:Times New Roman;"  >IDT</span><span style="font-family:宋体;"  >在内存中的位置。由于</span><span style="font-family:Times New Roman;"  >80386</span><span style="font-family:宋体;"  >只识别</span><span style="font-family:Times New Roman;"  >256</span><span style="font-family:宋体;"  >个中断向量号，所以</span><span style="font-family:Times New Roman;"  >IDT</span><span style="font-family:宋体;"  >最大长度是</span><span style="font-family:Times New Roman;"  >2K</span><span style="font-family:宋体;"  >。</span><span style="font-family:Times New Roman;"  >    </span></span></p><p><span style="color:black; font-size:9pt;"  ><span style="font-family:宋体;"  >中断描述符表</span><span style="font-family:Times New Roman;"  >IDT</span><span style="font-family:宋体;"  >所含的描述符只能是中断门、陷阱门和任务门。也就是说，在保护模式</span><span style="font-family:Times New Roman;"  >    </span><span style="font-family:宋体;"  >下，</span><span style="font-family:Times New Roman;"  >80386</span><span style="font-family:宋体;"  >只有通过中断门、陷阱门或任务门才能转移到对应的中断或异常处理程序。</span><span style="font-family:Times New Roman;"  >    </span></span></p><p><span style="color:black; font-size:9pt;"  ><span style="font-family:宋体;"  >从前文中给出的门描述符的格式可见，门描述符包含由选择子和偏移构成的</span><span style="font-family:Times New Roman;"  >48</span><span style="font-family:宋体;"  >位全指针。另</span><span style="font-family:Times New Roman;"  >    </span><span style="font-family:宋体;"  >外，双字计数字段对中断门、陷阱门和任务门而言无意义。</span><span style="font-family:Times New Roman;"  >    </span></span></p><p><span style="color:red; font-family:Batang; font-size:13pt;"  ><strong>2.中断响应和异常处理的步骤 </strong></span></p><p><span style="color:black; font-size:9pt;"  ><span style="font-family:宋体;"  >由硬件自动实现的中断响应和异常处理的步骤如下：</span><span style="font-family:Times New Roman;"  >    </span></span></p><p><span style="color:black; font-size:9pt;"  ><span style="font-family:宋体;"  >首先，判断中断向量号要索引的门描述符是否超出</span><span style="font-family:Times New Roman;"  >IDT</span><span style="font-family:宋体;"  >的界限。若超出界限，就引起通用保护</span><span style="font-family:Times New Roman;"  >    </span><span style="font-family:宋体;"  >故障，出错码为中断向量号乘</span><span style="font-family:Times New Roman;"  >8</span><span style="font-family:宋体;"  >再加</span><span style="font-family:Times New Roman;"  >2</span><span style="font-family:宋体;"  >。</span><span style="font-family:Times New Roman;"  >    </span></span></p><p><span style="color:black; font-size:9pt;"  ><span style="font-family:宋体;"  >其次，从</span><span style="font-family:Times New Roman;"  >IDT</span><span style="font-family:宋体;"  >中取得对应的门描述符，分解出选择子、偏移量和描述符属性类型，并进行有关</span><span style="font-family:Times New Roman;"  >    </span><span style="font-family:宋体;"  >检查。描述符只能是任务门、</span><span style="font-family:Times New Roman;"  >286</span><span style="font-family:宋体;"  >中断门、</span><span style="font-family:Times New Roman;"  >286</span><span style="font-family:宋体;"  >陷阱门、</span><span style="font-family:Times New Roman;"  >386</span><span style="font-family:宋体;"  >中断门或</span><span style="font-family:Times New Roman;"  >386</span><span style="font-family:宋体;"  >陷阱门，否则就引起</span><span style="font-family:Times New Roman;"  >    </span><span style="font-family:宋体;"  >通用保护故障，出错码是中断向量号乘</span><span style="font-family:Times New Roman;"  >8</span><span style="font-family:宋体;"  >再加</span><span style="font-family:Times New Roman;"  >2</span><span style="font-family:宋体;"  >。如果是由</span><span style="font-family:Times New Roman;"  >INT n</span><span style="font-family:宋体;"  >指令或</span><span style="font-family:Times New Roman;"  >INTO</span><span style="font-family:宋体;"  >指令引起转移，还</span><span style="font-family:Times New Roman;"  >    </span><span style="font-family:宋体;"  >要检查中断门、陷阱门或任务门描述符中的</span><span style="font-family:Times New Roman;"  >DPL</span><span style="font-family:宋体;"  >是否满足</span><span style="font-family:Times New Roman;"  >CPL&lt;=DPL(</span><span style="font-family:宋体;"  >对于其它的异常或中断，</span><span style="font-family:Times New Roman;"  >    </span><span style="font-family:宋体;"  >门中的</span><span style="font-family:Times New Roman;"  >DPL</span><span style="font-family:宋体;"  >被忽略</span><span style="font-family:Times New Roman;"  >)</span><span style="font-family:宋体;"  >。这种检查可以避免应用程序执行</span><span style="font-family:Times New Roman;"  >INT n</span><span style="font-family:宋体;"  >指令时，使用分配给各种设备用的</span><span style="font-family:Times New Roman;"  >    </span><span style="font-family:宋体;"  >中断向量号。如果检查不通过，就引起通用保护故障，出错码是中断向量号乘</span><span style="font-family:Times New Roman;"  >8</span><span style="font-family:宋体;"  >再加</span><span style="font-family:Times New Roman;"  >2</span><span style="font-family:宋体;"  >。门描</span><span style="font-family:Times New Roman;"  >    </span><span style="font-family:宋体;"  >述符中的</span><span style="font-family:Times New Roman;"  >P</span><span style="font-family:宋体;"  >位必须是</span><span style="font-family:Times New Roman;"  >1</span><span style="font-family:宋体;"  >，表示门描述符是一个有效项，否则就引起段不存在故障，出错码是中</span><span style="font-family:Times New Roman;"  >    </span><span style="font-family:宋体;"  >断向量号乘</span><span style="font-family:Times New Roman;"  >8</span><span style="font-family:宋体;"  >再加</span><span style="font-family:Times New Roman;"  >2</span><span style="font-family:宋体;"  >。</span><span style="font-family:Times New Roman;"  >    </span></span></p><p><span style="color:black; font-size:9pt;"  ><span style="font-family:宋体;"  >最后，根据门描述符类型，分情况转入中断或异常处理程序。</span><span style="font-family:Times New Roman;"  >    </span></span></p><p><span style="color:black; font-size:9pt;"  ><span style="font-family:宋体;"  >对于异常处理，在开始上述步骤之前，还要根据异常类型确定返回点；如果有出错代码，则形</span><span style="font-family:Times New Roman;"  >    </span><span style="font-family:宋体;"  >成符合出错码格式的出错码，并在实际执行异常处理程序之前把出错码压入堆栈。为了保证栈</span><span style="font-family:Times New Roman;"  >    </span><span style="font-family:宋体;"  >的双字边界对齐，</span><span style="font-family:Times New Roman;"  >16</span><span style="font-family:宋体;"  >位的出错码以</span><span style="font-family:Times New Roman;"  >32</span><span style="font-family:宋体;"  >位的值压入，其中高</span><span style="font-family:Times New Roman;"  >16</span><span style="font-family:宋体;"  >位的值未作定义，对于</span><span style="font-family:Times New Roman;"  >16</span><span style="font-family:宋体;"  >位段也是</span><span style="font-family:Times New Roman;"  >    </span><span style="font-family:宋体;"  >如此。</span><span style="font-family:Times New Roman;"  >    </span></span></p><p><span style="color:red; font-family:Batang; font-size:13pt;"  ><strong>3.通过中断门或陷阱门的转移 </strong></span></p><p><span style="color:black; font-size:9pt;"  ><span style="font-family:宋体;"  >如果中断向量号所指示的门描述符是</span><span style="font-family:Times New Roman;"  >386</span><span style="font-family:宋体;"  >中断门或</span><span style="font-family:Times New Roman;"  >386</span><span style="font-family:宋体;"  >陷阱门，那么控制转移到当前任务的一个</span><span style="font-family:Times New Roman;"  >    </span><span style="font-family:宋体;"  >处理程序过程，并且可以变换特权级。与其它调用门的</span><span style="font-family:Times New Roman;"  >CALL</span><span style="font-family:宋体;"  >指令一样，从中断门和陷阱门中获</span><span style="font-family:Times New Roman;"  >    </span><span style="font-family:宋体;"  >取指向处理程序的</span><span style="font-family:Times New Roman;"  >48</span><span style="font-family:宋体;"  >位全指针。其中</span><span style="font-family:Times New Roman;"  >16</span><span style="font-family:宋体;"  >位选择子是对应处理程序或代码段的选择子，它指示全</span><span style="font-family:Times New Roman;"  >    </span><span style="font-family:宋体;"  >局描述符表</span><span style="font-family:Times New Roman;"  >GDT</span><span style="font-family:宋体;"  >或局部描述符表</span><span style="font-family:Times New Roman;"  >LDT</span><span style="font-family:宋体;"  >中的代码段描述符；</span><span style="font-family:Times New Roman;"  >32</span><span style="font-family:宋体;"  >位偏移指示处理程序入口点在代码段</span><span style="font-family:Times New Roman;"  >    </span><span style="font-family:宋体;"  >内的偏移量。</span><span style="font-family:Times New Roman;"  >    </span></span></p><p><span style="color:black; font-size:9pt;"  ><span style="font-family:宋体;"  >通过中断门或陷阱门的转移过程如下所示，该过程由</span><span style="font-family:Times New Roman;"  >    </span><span style="font-family:宋体;"  >硬件自动进行。</span><span style="font-family:Times New Roman;"  >    </span></span></p><p><span style="color:black; font-size:9pt;"  ><span style="font-family:Times New Roman;"  >(1)</span><span style="font-family:宋体;"  >若选择子为空，则产生通用保护故障；</span><span style="font-family:Times New Roman;"  >    </span></span></p><p><span style="color:black; font-size:9pt;"  ><span style="font-family:Times New Roman;"  >(2)</span><span style="font-family:宋体;"  >取对应的描述符；</span><span style="font-family:Times New Roman;"  >    </span></span></p><p><span style="color:black; font-size:9pt;"  ><span style="font-family:Times New Roman;"  >(3)</span><span style="font-family:宋体;"  >若非存储段描述符，则产生通用保护故障；</span><span style="font-family:Times New Roman;"  >    </span></span></p><p><span style="color:black; font-size:9pt;"  ><span style="font-family:Times New Roman;"  >(4)</span><span style="font-family:宋体;"  >若非一致代码段且</span><span style="font-family:Times New Roman;"  >DPL&lt;CPL</span><span style="font-family:宋体;"  >且段存在，则切换到内层堆栈；</span><span style="font-family:Times New Roman;"  >&lt; DIV=""&gt; </span></span></p><p><span style="color:black; font-size:9pt;"  ><span style="font-family:Times New Roman;"  >(5)</span><span style="font-family:宋体;"  >调整</span><span style="font-family:Times New Roman;"  >RPL=0</span><span style="font-family:宋体;"  >；</span><span style="font-family:Times New Roman;"  >    </span></span></p><p><span style="color:black; font-size:9pt;"  ><span style="font-family:Times New Roman;"  >(6)</span><span style="font-family:宋体;"  >把描述符装入</span><span style="font-family:Times New Roman;"  >CS</span><span style="font-family:宋体;"  >；</span><span style="font-family:Times New Roman;"  >    </span></span></p><p><span style="color:black; font-size:9pt;"  ><span style="font-family:Times New Roman;"  >(7)</span><span style="font-family:宋体;"  >若入口偏移越界，则产生通用保护故障；</span><span style="font-family:Times New Roman;"  >    </span></span></p><p><span style="color:black; font-size:9pt;"  ><span style="font-family:Times New Roman;"  >(8)EFLAGS</span><span style="font-family:宋体;"  >压入堆栈；</span><span style="font-family:Times New Roman;"  >    </span></span></p><p><span style="color:black; font-size:9pt;"  ><span style="font-family:Times New Roman;"  >(9)CS</span><span style="font-family:宋体;"  >压入堆栈；</span><span style="font-family:Times New Roman;"  >    </span></span></p><p><span style="color:black; font-size:9pt;"  ><span style="font-family:Times New Roman;"  >(10)EIP</span><span style="font-family:宋体;"  >压入堆栈；</span><span style="font-family:Times New Roman;"  >    </span></span></p><p><span style="color:black; font-size:9pt;"  ><span style="font-family:Times New Roman;"  >(11)</span><span style="font-family:宋体;"  >使</span><span style="font-family:Times New Roman;"  >TF=0</span><span style="font-family:宋体;"  >，</span><span style="font-family:Times New Roman;"  >NT=0</span><span style="font-family:宋体;"  >；</span><span style="font-family:Times New Roman;"  >    </span></span></p><p><span style="color:black; font-size:9pt;"  ><span style="font-family:Times New Roman;"  >(12)</span><span style="font-family:宋体;"  >若为中断门，则使</span><span style="font-family:Times New Roman;"  >IF=0</span><span style="font-family:宋体;"  >；</span><span style="font-family:Times New Roman;"  >    </span></span></p><p><span style="color:black; font-size:9pt;"  ><span style="font-family:Times New Roman;"  >(13)</span><span style="font-family:宋体;"  >若有出错码，则把出错码压入堆栈；</span><span style="font-family:Times New Roman;"  >    </span></span></p><p><span style="color:black; font-size:9pt;"  ><span style="font-family:Times New Roman;"  >(14)</span><span style="font-family:宋体;"  >转入处理程序。</span><span style="font-family:Times New Roman;"  >    </span></span></p><p><span style="color:black; font-size:9pt;"  ><span style="font-family:Times New Roman;"  >&lt;/CPL</span><span style="font-family:宋体;"  >且段存在，则切换到内层堆栈；</span><span style="font-family:Times New Roman;"  >&lt;&gt; </span></span></p><p><span style="color:black; font-size:9pt;"  ><span style="font-family:宋体;"  >由上述转移过程可见，中断门或陷阱门中指示处理程序的选择子必须指向描述一个可执行的</span><span style="font-family:Times New Roman;"  >    </span><span style="font-family:宋体;"  >代码段的描述符。如果选择子为空，就引起通用保护故障，出错码是</span><span style="font-family:Times New Roman;"  >0</span><span style="font-family:宋体;"  >。如果描述符不是代码</span><span style="font-family:Times New Roman;"  >    </span><span style="font-family:宋体;"  >段描述符，就引起通用保护故障，出错码含选择子。</span><span style="font-family:Times New Roman;"  >    </span></span></p><p><span style="color:black; font-size:9pt;"  ><span style="font-family:宋体;"  >中断或异常可以转移到同一特权级或内层特权级。上述指定处理程序代码段的描述符中的类</span><span style="font-family:Times New Roman;"  >    </span><span style="font-family:宋体;"  >型及</span><span style="font-family:Times New Roman;"  >DPL</span><span style="font-family:宋体;"  >字段，决定了这种同一任务内的转移是否要发生特权级变换。如果是一个非一致代码</span><span style="font-family:Times New Roman;"  >    </span><span style="font-family:宋体;"  >段，并且</span><span style="font-family:Times New Roman;"  >DPLCPL</span><span style="font-family:宋体;"  >则产生通用保护异常。</span><span style="font-family:Times New Roman;"  >    </span></span></p><p><span style="color:black; font-size:9pt;"  ><span style="font-family:宋体;"  >上述转移过程中的第六步，也就是</span><span style="font-family:Times New Roman;"  >"</span><span style="font-family:宋体;"  >把描述符装入</span><span style="font-family:Times New Roman;"  >CS"</span><span style="font-family:宋体;"  >，是指把上述指定处理程序段的描述符</span><span style="font-family:Times New Roman;"  >    </span><span style="font-family:宋体;"  >装入</span><span style="font-family:Times New Roman;"  >CS</span><span style="font-family:宋体;"  >的高速缓冲寄存器中，在这一步骤中要对描述符进行类似通过调用门进行转移的其它检</span><span style="font-family:Times New Roman;"  >    </span><span style="font-family:宋体;"  >查，包括是否代码段描述符和代码段描述符是否存在等，因此可能再发生异常。在对该描述符</span><span style="font-family:Times New Roman;"  >    </span><span style="font-family:宋体;"  >进行检查时，通过调整门中选择子的</span><span style="font-family:Times New Roman;"  >RPL=0(</span><span style="font-family:宋体;"  >在处理器内部调整，而不影响存储器中的选择子</span><span style="font-family:Times New Roman;"  >    </span><span style="font-family:宋体;"  >的</span><span style="font-family:Times New Roman;"  >RPL</span><span style="font-family:宋体;"  >字段</span><span style="font-family:Times New Roman;"  >)</span><span style="font-family:宋体;"  >的方法，实现只考虑代码段的</span><span style="font-family:Times New Roman;"  >DPL</span><span style="font-family:宋体;"  >，而不考虑门中选择子的</span><span style="font-family:Times New Roman;"  >RPL</span><span style="font-family:宋体;"  >。把描述符装入</span><span style="font-family:Times New Roman;"  >CS</span><span style="font-family:宋体;"  >之</span><span style="font-family:Times New Roman;"  >    </span><span style="font-family:宋体;"  >后，还要检查门描述符中给出的表示处理程序代码段入口的偏移是否越界，即是否超出段界限。</span><span style="font-family:Times New Roman;"  >    </span><span style="font-family:宋体;"  >如果越界，就引起出错码为</span><span style="font-family:Times New Roman;"  >0</span><span style="font-family:宋体;"  >的通用保护故障。</span><span style="font-family:Times New Roman;"  >    </span></span></p><p><span style="color:black; font-size:9pt;"  ><span style="font-family:宋体;"  >从转移过程还可以看出，把标志寄存器和断点压入堆栈的做法和顺序与实模式是相同的，但这</span><span style="font-family:Times New Roman;"  >    </span><span style="font-family:宋体;"  >里每一次堆栈操作是一个双字，</span><span style="font-family:Times New Roman;"  >CS</span><span style="font-family:宋体;"  >被扩展成</span><span style="font-family:Times New Roman;"  >32</span><span style="font-family:宋体;"  >位。在</span><span style="font-family:Times New Roman;"  >16</span><span style="font-family:宋体;"  >位段中亦是如此。</span><span style="font-family:Times New Roman;"  >    </span></span></p><p><span style="color:black; font-size:9pt;"  ><span style="font-family:宋体;"  >把</span><span style="font-family:Times New Roman;"  >TF</span><span style="font-family:宋体;"  >置成</span><span style="font-family:Times New Roman;"  >0</span><span style="font-family:宋体;"  >，表示不允许处理程序单步执行。把</span><span style="font-family:Times New Roman;"  >NT</span><span style="font-family:宋体;"  >置成</span><span style="font-family:Times New Roman;"  >0</span><span style="font-family:宋体;"  >，表示处理程序在利用中断返回指</span><span style="font-family:Times New Roman;"  >    </span><span style="font-family:宋体;"  >令</span><span style="font-family:Times New Roman;"  >IRET</span><span style="font-family:宋体;"  >返回时，返回到同一任务而不是一个嵌套任务。需要注意的是，任何特权级的程序都可</span><span style="font-family:Times New Roman;"  >    </span><span style="font-family:宋体;"  >改变</span><span style="font-family:Times New Roman;"  >NT</span><span style="font-family:宋体;"  >位，这样可以利用中断或陷阱处理程序完成任务切换。</span><span style="font-family:Times New Roman;"  >    </span></span></p><p><span style="color:black; font-size:9pt;"  ><span style="font-family:宋体;"  >通过中断门的转移和通过陷阱门的转移之间的差别只是对</span><span style="font-family:Times New Roman;"  >IF</span><span style="font-family:宋体;"  >标志的处理。对于中断门，在转移</span><span style="font-family:Times New Roman;"  >    </span><span style="font-family:宋体;"  >过程中把</span><span style="font-family:Times New Roman;"  >IF</span><span style="font-family:宋体;"  >置为</span><span style="font-family:Times New Roman;"  >0</span><span style="font-family:宋体;"  >，使得在处理程序执行期间屏蔽掉</span><span style="font-family:Times New Roman;"  >INTR</span><span style="font-family:宋体;"  >中断</span><span style="font-family:Times New Roman;"  >(</span><span style="font-family:宋体;"  >当然，在中断处理程序中可以人</span><span style="font-family:Times New Roman;"  >    </span><span style="font-family:宋体;"  >为设置</span><span style="font-family:Times New Roman;"  >IF</span><span style="font-family:宋体;"  >标志打开中断，以使得在处理程序执行期间允许响应可屏蔽中断</span><span style="font-family:Times New Roman;"  >)</span><span style="font-family:宋体;"  >；对于陷阱门，在</span><span style="font-family:Times New Roman;"  >    </span><span style="font-family:宋体;"  >转移过程中保持</span><span style="font-family:Times New Roman;"  >IF</span><span style="font-family:宋体;"  >位不变，即如果</span><span style="font-family:Times New Roman;"  >IF</span><span style="font-family:宋体;"  >位原来是</span><span style="font-family:Times New Roman;"  >1</span><span style="font-family:宋体;"  >，那么通过陷阱门转移到处理程序之后仍允</span><span style="font-family:Times New Roman;"  >    </span><span style="font-family:宋体;"  >许</span><span style="font-family:Times New Roman;"  >INTR</span><span style="font-family:宋体;"  >中断。因此，中断门最适宜于处理中断，而陷阱门适宜于处理异常。</span><span style="font-family:Times New Roman;"  >    </span></span></p><p><span style="color:black; font-size:9pt;"  ><span style="font-family:宋体;"  >在有出错码的情况下，转入处理程序之前还要把出错码压入堆栈。只有异常处理才可能有出错</span><span style="font-family:Times New Roman;"  >    </span><span style="font-family:宋体;"  >码。下图给出了通过中断门或陷阱门转移时的堆栈情况。</span><span style="font-family:Times New Roman;"  >(a)</span><span style="font-family:宋体;"  >是没有变换特权级和没有出错码</span><span style="font-family:Times New Roman;"  >    </span><span style="font-family:宋体;"  >的情形；</span><span style="font-family:Times New Roman;"  >(b)</span><span style="font-family:宋体;"  >是没有变换特权级有出错码的情形；</span><span style="font-family:Times New Roman;"  >(c)</span><span style="font-family:宋体;"  >是变换特权级和没有出错码的内层堆栈的</span><span style="font-family:Times New Roman;"  >    </span><span style="font-family:宋体;"  >情形。</span><span style="font-family:Times New Roman;"  >(d)</span><span style="font-family:宋体;"  >是变换特权级和有出错码的内层堆栈情形。注意图中每一项为双字。</span><span style="font-family:Times New Roman;"  >    </span></span></p><p style="text-align: center;"  ><img title="七.中断和异常 - Howie - Dspace"  src="pic/img2.ph.126.net_7bfDmrkAY9SZq4vbS-cNFA==_6597144533446725172.jpg"  alt=""  /><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >   </span></p><p><span style="color:red; font-family:Batang; font-size:13pt;"  ><strong>4.通过任务门的转移 </strong></span></p><p><span style="color:black; font-size:9pt;"  ><span style="font-family:宋体;"  >如果中断向量号所只是的门描述符是任务门描述符，那么控制转移到一个作为独立的任务方式</span><span style="font-family:Times New Roman;"  >    </span><span style="font-family:宋体;"  >出现的处理程序。任务门中的选择子是指向描述对应处理程序任务的</span><span style="font-family:Times New Roman;"  >TSS</span><span style="font-family:宋体;"  >段的选择子，即该选择</span><span style="font-family:Times New Roman;"  >    </span><span style="font-family:宋体;"  >子指示一个可用的</span><span style="font-family:Times New Roman;"  >286TSS</span><span style="font-family:宋体;"  >或</span><span style="font-family:Times New Roman;"  >386TSS</span><span style="font-family:宋体;"  >。通过任务门的转移与通过任务门到一个可用的</span><span style="font-family:Times New Roman;"  >386TSS</span><span style="font-family:宋体;"  >的段</span><span style="font-family:Times New Roman;"  >    </span><span style="font-family:宋体;"  >间调用指令</span><span style="font-family:Times New Roman;"  >CALL</span><span style="font-family:宋体;"  >的转移很相似，主要的区别是，对于提供出错码的异常处理，在完成任务切换</span><span style="font-family:Times New Roman;"  >    </span><span style="font-family:宋体;"  >之后，把出错码压入新任务的堆栈中</span><span style="font-family:Times New Roman;"  >(</span><span style="font-family:宋体;"  >通过任务门进行转移时，返回地址和外层栈指针不压入新</span><span style="font-family:Times New Roman;"  >    </span><span style="font-family:宋体;"  >任务的堆栈</span><span style="font-family:Times New Roman;"  >)</span><span style="font-family:宋体;"  >。</span><span style="font-family:Times New Roman;"  >    </span></span></p><p><span style="color:black; font-size:9pt;"  ><span style="font-family:宋体;"  >通过任务门的转移，在进入中断或异常处理程序时，标志寄存器</span><span style="font-family:Times New Roman;"  >EFLAGS</span><span style="font-family:宋体;"  >中的</span><span style="font-family:Times New Roman;"  >NT</span><span style="font-family:宋体;"  >位被置为</span><span style="font-family:Times New Roman;"  >1</span><span style="font-family:宋体;"  >，表示</span><span style="font-family:Times New Roman;"  >    </span><span style="font-family:宋体;"  >是嵌套任务，则</span><span style="font-family:Times New Roman;"  >IRET</span><span style="font-family:宋体;"  >指令返回时，沿</span><span style="font-family:Times New Roman;"  >TSS</span><span style="font-family:宋体;"  >中的链接字段返回到最后一个被挂起的任务。</span><span style="font-family:Times New Roman;"  >    </span></span></p><p><span style="color:black; font-size:9pt;"  ><span style="font-family:宋体;"  >在响应中断或处理异常时，使用任务门可提供一个处理程序任务的自动调度。这种任务调度由</span><span style="font-family:Times New Roman;"  >    </span><span style="font-family:宋体;"  >硬件直接执行，并且越过包含在操作系统中的软件任务切换，这就为处理程序提供了一个快速</span><span style="font-family:Times New Roman;"  >    </span><span style="font-family:宋体;"  >的任务切换。</span><span style="font-family:Times New Roman;"  >    </span></span></p><p><span style="color:red; font-family:Batang; font-size:13pt;"  ><strong>5.转移方法的比较 </strong></span></p><p><span style="color:black; font-size:9pt;"  ><span style="font-family:宋体;"  >对中断的响应和异常的处理，</span><span style="font-family:Times New Roman;"  >80386</span><span style="font-family:宋体;"  >允许通过使用中断门或陷阱门实现由当前任务之内的一个过</span><span style="font-family:Times New Roman;"  >    </span><span style="font-family:宋体;"  >程进行处理；也允许通过使用任务门实现由另一个任务进行处理。在当前任务之内的处理程序</span><span style="font-family:Times New Roman;"  >    </span><span style="font-family:宋体;"  >较为简单，并可以很快地转移到处理程序，但处理程序要负责保存及恢复处理器的寄存器等内</span><span style="font-family:Times New Roman;"  >    </span><span style="font-family:宋体;"  >容。转到不同任务的处理程序要花费较长时间，保存及恢复处理器寄存器内容的开销作为任务</span><span style="font-family:Times New Roman;"  >    </span><span style="font-family:宋体;"  >切换的一部分。使用当前任务内的处理程序的方法，在响应中断或处理异常时，对正执行任务</span><span style="font-family:Times New Roman;"  >    </span><span style="font-family:宋体;"  >的状态可直接进行访问，但是这就要求每一个任务之内都包含一个处理程序。使用独立任务的</span><span style="font-family:Times New Roman;"  >    </span><span style="font-family:宋体;"  >处理方法，使处理程序得到较好的隔离，但在响应中断或处理异常时，对原任务状态的访问变</span><span style="font-family:Times New Roman;"  >    </span><span style="font-family:宋体;"  >得较为复杂。需要注意得是，有些异常必须由中断门或陷阱门进行处理，如上面提到得异常</span><span style="font-family:Times New Roman;"  >7</span><span style="font-family:宋体;"  >。</span><span style="font-family:Times New Roman;"  >    </span></span></p><p><span style="color:black; font-size:9pt;"  ><span style="font-family:宋体;"  >无效</span><span style="font-family:Times New Roman;"  >TSS</span><span style="font-family:宋体;"  >异常必须使用任务门进行处理，以保证处理程序有一个有效得任务环境。其它得异常通</span><span style="font-family:Times New Roman;"  >    </span><span style="font-family:宋体;"  >常在任务环境之内进行处理。在任务内，异常被检测并且不必屏蔽中断，所以，所以使用陷阱</span><span style="font-family:Times New Roman;"  >    </span><span style="font-family:宋体;"  >门。由陷阱门指示的异常处理程序是一个由所有任务共享的过程，所以该处理程序最好置于全</span><span style="font-family:Times New Roman;"  >    </span><span style="font-family:宋体;"  >局地址空间之内。如果各个任务要求有不同的处理程序，那么全局异常处理程序可保存一个各</span><span style="font-family:Times New Roman;"  >    </span><span style="font-family:宋体;"  >处理程序的入口表，并为引起异常的任务调用相应的处理程序。</span><span style="font-family:Times New Roman;"  >    </span></span></p><p><span style="color:black; font-size:9pt;"  ><span style="font-family:宋体;"  >中断通常与正执行的任务没有关系，并可能从使用任务门提供的隔离中获得好处。要求较快响</span><span style="font-family:Times New Roman;"  >    </span><span style="font-family:宋体;"  >应的中断，通过中断门可以得到较好的处理。因为中断随时都可能发生，所以，通过中断门访</span><span style="font-family:Times New Roman;"  >    </span><span style="font-family:宋体;"  >问的中断处理程序，必须置于全局地址空间中，以便对所有的任务都有效。还需强调的</span><span style="font-family:Times New Roman;"  >    </span><span style="font-family:宋体;"  >是，</span><span style="font-family:Times New Roman;"  >80386</span><span style="font-family:宋体;"  >程序绝不能调用一个低特权级的过程，当处理器调用一个中断或异常处理程序时，它</span><span style="font-family:Times New Roman;"  >    </span><span style="font-family:宋体;"  >实施相同的规则，所以，这样一个过程必须至少具有与在其任务上下文中被调用的、由任务所</span><span style="font-family:Times New Roman;"  >    </span><span style="font-family:宋体;"  >执行的最高特权级的过程相同的特权级。因此，在使用中断门时，中断处理程序通常必须被安</span><span style="font-family:Times New Roman;"  >    </span><span style="font-family:宋体;"  >排在特权级</span><span style="font-family:Times New Roman;"  >0</span><span style="font-family:宋体;"  >，否则若正在特权级</span><span style="font-family:Times New Roman;"  >0</span><span style="font-family:宋体;"  >执行时发生中断，则不能进入中断处理程序，而会引起通用</span><span style="font-family:Times New Roman;"  >    </span><span style="font-family:宋体;"  >保护故障</span><span style="font-family:Times New Roman;"  >(</span><span style="font-family:宋体;"  >中断处理程序使用任务门时除外，因为任务切换可以从任何特权级切换到目标任务的</span><span style="font-family:Times New Roman;"  >    </span><span style="font-family:宋体;"  >任何特权级</span><span style="font-family:Times New Roman;"  >)</span><span style="font-family:宋体;"  >。</span><span style="font-family:Times New Roman;"  >    </span></span></p><p><span style="color:red; font-family:Batang; font-size:13pt;"  ><strong>6.中断或异常处理后的返回 </strong></span></p><p><span style="color:black; font-size:9pt;"  ><span style="font-family:宋体;"  >中断返回指令</span><span style="font-family:Times New Roman;"  >IRET</span><span style="font-family:宋体;"  >用于从中断或异常处理程序的返回。该指令的执行根据任务嵌套标志</span><span style="font-family:Times New Roman;"  >NT</span><span style="font-family:宋体;"  >位是</span><span style="font-family:Times New Roman;"  >    </span><span style="font-family:宋体;"  >否为</span><span style="font-family:Times New Roman;"  >1</span><span style="font-family:宋体;"  >分为两种情形。</span><span style="font-family:Times New Roman;"  >    </span></span></p><p><span style="color:black; font-size:9pt;"  ><span style="font-family:Times New Roman;"  >NT</span><span style="font-family:宋体;"  >位为</span><span style="font-family:Times New Roman;"  >1</span><span style="font-family:宋体;"  >，表示是嵌套任务的返回。当前</span><span style="font-family:Times New Roman;"  >TSS</span><span style="font-family:宋体;"  >中的链接字段保存有前一任务的</span><span style="font-family:Times New Roman;"  >TSS</span><span style="font-family:宋体;"  >的选择子，取出</span><span style="font-family:Times New Roman;"  >    </span><span style="font-family:宋体;"  >该选择子进行任务切换就完成了返回。这种情形在由通过任务门转入的中断或异常处理程序返</span><span style="font-family:Times New Roman;"  >    </span><span style="font-family:宋体;"  >回时出现，因为在由中断门或陷阱门转入处理程序时，</span><span style="font-family:Times New Roman;"  >NT</span><span style="font-family:宋体;"  >位已被清</span><span style="font-family:Times New Roman;"  >0</span><span style="font-family:宋体;"  >。</span><span style="font-family:Times New Roman;"  >    </span></span></p><p><span style="color:black; font-size:9pt;"  ><span style="font-family:Times New Roman;"  >NT</span><span style="font-family:宋体;"  >位为</span><span style="font-family:Times New Roman;"  >0</span><span style="font-family:宋体;"  >，表示当前任务内的返回。这种情形在由通过中断门或陷阱门转入的中断或异常处理程</span><span style="font-family:Times New Roman;"  >    </span><span style="font-family:宋体;"  >序返回时出现。具体进行的操作包括：从堆栈顶弹出返回指针</span><span style="font-family:Times New Roman;"  >EIP</span><span style="font-family:宋体;"  >及</span><span style="font-family:Times New Roman;"  >CS</span><span style="font-family:宋体;"  >，然后弹出</span><span style="font-family:Times New Roman;"  >EFLAGS</span><span style="font-family:宋体;"  >值。弹</span><span style="font-family:Times New Roman;"  >    </span><span style="font-family:宋体;"  >出的</span><span style="font-family:Times New Roman;"  >CS</span><span style="font-family:宋体;"  >选择子的</span><span style="font-family:Times New Roman;"  >RPL</span><span style="font-family:宋体;"  >字段，确定返回后的特权级。如果返回选择子的</span><span style="font-family:Times New Roman;"  >RPL</span><span style="font-family:宋体;"  >与</span><span style="font-family:Times New Roman;"  >CPL</span><span style="font-family:宋体;"  >相同，则不进行特</span><span style="font-family:Times New Roman;"  >    </span><span style="font-family:宋体;"  >权级改变。若</span><span style="font-family:Times New Roman;"  >RPL</span><span style="font-family:宋体;"  >规定了一个外层特权级，则需要特权级改变，从内层堆栈中弹出外层堆栈的指</span><span style="font-family:Times New Roman;"  >    </span><span style="font-family:宋体;"  >针</span><span style="font-family:Times New Roman;"  >ESP</span><span style="font-family:宋体;"  >及</span><span style="font-family:Times New Roman;"  >SS</span><span style="font-family:宋体;"  >的值。这些做法与</span><span style="font-family:Times New Roman;"  >RET</span><span style="font-family:宋体;"  >指令相似。例如，使用</span><span style="font-family:Times New Roman;"  >CS</span><span style="font-family:宋体;"  >选择子的</span><span style="font-family:Times New Roman;"  >RPL</span><span style="font-family:宋体;"  >，而不是由选择子标识的</span><span style="font-family:Times New Roman;"  >    </span><span style="font-family:宋体;"  >段的</span><span style="font-family:Times New Roman;"  >DPL</span><span style="font-family:宋体;"  >，是为了返回到不在</span><span style="font-family:Times New Roman;"  >DPL</span><span style="font-family:宋体;"  >给定特权级的一致代码段。若弹出的</span><span style="font-family:Times New Roman;"  >CS</span><span style="font-family:宋体;"  >的选择子的</span><span style="font-family:Times New Roman;"  >RPL</span><span style="font-family:宋体;"  >规定了一</span><span style="font-family:Times New Roman;"  >    </span><span style="font-family:宋体;"  >个内层特权级，则产生通用保护故障。需要注意的是，对于</span><span style="font-family:Times New Roman;"  >IRET</span><span style="font-family:宋体;"  >指令，保存在当前堆栈中的返回</span><span style="font-family:Times New Roman;"  >    </span><span style="font-family:宋体;"  >地址中的选择子字段必须指向代码段描述符。而不能是系统段或门描述符。否则将引起通用保护</span><span style="font-family:Times New Roman;"  >    </span><span style="font-family:宋体;"  >故障。</span><span style="font-family:Times New Roman;"  >    </span></span></p><p><span style="color:black; font-size:9pt;"  ><span style="font-family:宋体;"  >对于提供出错代码的异常处理程序，必须先人为地从堆栈中弹出出错代码，然后再执行</span><span style="font-family:Times New Roman;"  >IRET</span><span style="font-family:宋体;"  >指令，</span><span style="font-family:Times New Roman;"  >    </span><span style="font-family:宋体;"  >及出错代码不会自动被处理器弹出或取消。</span><span style="font-family:Times New Roman;"  >    </span></span></p><p><span style="color:black; font-size:9pt;"  ><span style="font-family:宋体;"  >中断返回指令</span><span style="font-family:Times New Roman;"  >IRET</span><span style="font-family:宋体;"  >不仅能够用于由中断</span><span style="font-family:Times New Roman;"  >/</span><span style="font-family:宋体;"  >异常引起的嵌套任务的返回，而且也适用于由段间调用</span><span style="font-family:Times New Roman;"  >    </span><span style="font-family:宋体;"  >指令</span><span style="font-family:Times New Roman;"  >CALL</span><span style="font-family:宋体;"  >通过任务门引起的嵌套任务的返回，如前文所述，在执行通过任务门进行任务切换的段</span><span style="font-family:Times New Roman;"  >    </span><span style="font-family:宋体;"  >间调用指令</span><span style="font-family:Times New Roman;"  >CALL</span><span style="font-family:宋体;"  >时，标志寄存器中的</span><span style="font-family:Times New Roman;"  >NT</span><span style="font-family:宋体;"  >位被置为</span><span style="font-family:Times New Roman;"  >1</span><span style="font-family:宋体;"  >，表示任务嵌套。而</span><span style="font-family:Times New Roman;"  >RET</span><span style="font-family:宋体;"  >指令不能实现此功能。</span><span style="font-family:Times New Roman;"  >    </span></span></p><p><span style="color:red; font-family:Batang; font-size:18pt;"  ><strong>&lt;四&gt;演示中断处理的实例(实例六) </strong></span></p><p><span style="color:black; font-size:9pt;"  ><span style="font-family:宋体;"  >下面给出一个用于演示中断处理的实例。该实例的逻辑功能是，在屏幕的左上角以倒计时方式显</span><span style="font-family:Times New Roman;"  >    </span><span style="font-family:宋体;"  >示秒为单位的时间，在时间用完后结束。该实例演示内容包括：外部中断处理程序和陷阱处理程序。</span><span style="font-family:Times New Roman;"  >    </span></span></p><p><span style="color:red; font-family:Batang; font-size:13pt;"  ><strong>1.源程序组织和清单 </strong></span></p><p><span style="color:black; font-size:9pt;"  ><span style="font-family:宋体;"  >本实例由如下几部分组成：</span><span style="font-family:Times New Roman;"  >    </span></span></p><p><span style="color:black; font-size:9pt;"  ><span style="font-family:Times New Roman;"  >(1)</span><span style="font-family:宋体;"  >全局描述符表</span><span style="font-family:Times New Roman;"  >GDT</span><span style="font-family:宋体;"  >。</span><span style="font-family:Times New Roman;"  >GDT</span><span style="font-family:宋体;"  >中除了含有常见的几个描述符外，还含有描述时钟中断处理程序所使用</span><span style="font-family:Times New Roman;"  >    </span><span style="font-family:宋体;"  >的代码段和数据段描述符，以及描述显示程序所使用的代码段和数据段描述符。</span><span style="font-family:Times New Roman;"  >    </span></span></p><p><span style="color:black; font-size:9pt;"  ><span style="font-family:Times New Roman;"  >(2)</span><span style="font-family:宋体;"  >中断描述符表</span><span style="font-family:Times New Roman;"  >IDT</span><span style="font-family:宋体;"  >。为了在保护模式下响应中断和处理异常，必须有</span><span style="font-family:Times New Roman;"  >IDT</span><span style="font-family:宋体;"  >。</span><span style="font-family:Times New Roman;"  >IDT</span><span style="font-family:宋体;"  >含有</span><span style="font-family:Times New Roman;"  >256</span><span style="font-family:宋体;"  >个门描述</span><span style="font-family:Times New Roman;"  >    </span><span style="font-family:宋体;"  >符。</span><span style="font-family:Times New Roman;"  >8</span><span style="font-family:宋体;"  >号安排的是一个通向时钟中断处理程序的中断门，</span><span style="font-family:Times New Roman;"  >0FEH</span><span style="font-family:宋体;"  >号安排的是通向显示处理程序的陷阱</span><span style="font-family:Times New Roman;"  >    </span><span style="font-family:宋体;"  >门，其它均安排成通向其它中断或异常处理程序的陷阱门。</span><span style="font-family:Times New Roman;"  >    </span></span></p><p><span style="color:black; font-size:9pt;"  ><span style="font-family:Times New Roman;"  >(3)</span><span style="font-family:宋体;"  >时钟中断处理程序的代码段和数据段。</span><span style="font-family:Times New Roman;"  >    </span></span></p><p><span style="color:black; font-size:9pt;"  ><span style="font-family:Times New Roman;"  >(4)</span><span style="font-family:宋体;"  >实现直接写显示缓冲区进行显示的程序代码段和数据段。</span><span style="font-family:Times New Roman;"  >    </span></span></p><p><span style="color:black; font-size:9pt;"  ><span style="font-family:Times New Roman;"  >(5)</span><span style="font-family:宋体;"  >处理其它中断或异常的处理程序的代码段。</span><span style="font-family:Times New Roman;"  >    </span></span></p><p><span style="color:black; font-size:9pt;"  ><span style="font-family:Times New Roman;"  >(6)</span><span style="font-family:宋体;"  >演示程序的代码段、数据段和堆栈段。</span><span style="font-family:Times New Roman;"  >    </span></span></p><p><span style="color:black; font-size:9pt;"  ><span style="font-family:Times New Roman;"  >(7)</span><span style="font-family:宋体;"  >实模式下执行的启动和结束程序代码段和数据段。</span><span style="font-family:Times New Roman;"  >    </span></span></p><p><span style="color:black; font-size:9pt;"  ><span style="font-family:宋体;"  >源程序清单如下：</span><span style="font-family:Times New Roman;"  >    </span></span></p><p><span style="color:#999999; font-size:9pt;"  ><em><span style="font-family:Times New Roman;"  >;</span><span style="font-family:宋体;"  >名称</span></em><span style="font-family:Times New Roman;"  ><em>:ASM6.ASM</em><span style="color:black;"  >     </span></span></span></p><p><span style="color:#999999; font-size:9pt;"  ><em><span style="font-family:Times New Roman;"  >;</span><span style="font-family:宋体;"  >功能</span><span style="font-family:Times New Roman;"  >:</span><span style="font-family:宋体;"  >演示中断处理的实现</span></em><span style="color:black; font-family:Times New Roman;"  >    </span></span></p><p><span style="color:#999999; font-size:9pt;"  ><em><span style="font-family:Times New Roman;"  >;</span><span style="font-family:宋体;"  >编译</span></em><span style="font-family:Times New Roman;"  ><em>:TASM ASM6.ASM</em><span style="color:black;"  >     </span></span></span></p><p><span style="color:#999999; font-size:9pt;"  ><em><span style="font-family:Times New Roman;"  >;</span><span style="font-family:宋体;"  >连接</span></em><span style="font-family:Times New Roman;"  ><em>:TLINK ASM6.OBJ</em><span style="color:black;"  >     </span></span></span></p><p><span style="color:#999999; font-family:Times New Roman; font-size:9pt;"  ><em>;----------------------------------------------------------------------------</em><span style="color:black;"  >    </span></span></p><p><span style="color:#009999; font-family:Times New Roman; font-size:9pt;"  >INCLUDE<span style="color:black;"  >         386SCD.INC </span></span></p><p><span style="color:#999999; font-family:Times New Roman; font-size:9pt;"  ><em>;----------------------------------------------------------------------------</em><span style="color:black;"  >    </span></span></p><p><span style="color:#999999; font-size:9pt;"  ><em><span style="font-family:Times New Roman;"  >;</span><span style="font-family:宋体;"  >部分常量定义</span></em><span style="color:black; font-family:Times New Roman;"  >    </span></span></p><p><span style="color:#999999; font-family:Times New Roman; font-size:9pt;"  ><em>;----------------------------------------------------------------------------</em><span style="color:black;"  >    </span></span></p><p><span style="color:black; font-size:9pt;"  ><span style="font-family:Times New Roman;"  >EOICOM          <span style="color:red;"  >=<span style="color:black;"  >       <span style="color:#000099;"  >20h<span style="color:black;"  >         <span style="color:#999999;"  ><em>;</em></span></span></span></span></span></span><span style="font-family:宋体;"  ><em>外部中断处理结束命令</em></span><span style="font-family:Times New Roman;"  >    </span></span></p><p><span style="color:black; font-size:9pt;"  ><span style="font-family:Times New Roman;"  >ICREGP          <span style="color:red;"  >=<span style="color:black;"  >       <span style="color:#000099;"  >20h<span style="color:black;"  >         <span style="color:#999999;"  ><em>;</em></span></span></span></span></span></span><span style="font-family:宋体;"  ><em>中断控制寄存器端口地址</em></span><span style="font-family:Times New Roman;"  >    </span></span></p><p><span style="color:black; font-size:9pt;"  ><span style="font-family:Times New Roman;"  >IMREGP          <span style="color:red;"  >=<span style="color:black;"  >       <span style="color:#000099;"  >21h<span style="color:black;"  >         <span style="color:#999999;"  ><em>;</em></span></span></span></span></span></span><span style="font-family:宋体;"  ><em>中断屏蔽寄存器端口地址</em></span><span style="font-family:Times New Roman;"  >    </span></span></p><p><span style="color:#999999; font-family:Times New Roman; font-size:9pt;"  ><em>;----------------------------------------------------------------------------</em><span style="color:black;"  >    </span></span></p><p><span style="color:black; font-size:9pt;"  ><span style="font-family:Times New Roman;"  >GDTSeg          <span style="color:#009999;"  >SEGMENT<span style="color:black;"  >       <span style="color:#009999;"  >PARA<span style="color:black;"  >         <span style="color:#009999;"  >USE16<span style="color:black;"  >           <span style="color:#999999;"  ><em>;</em></span></span></span></span></span></span></span></span><span style="font-family:宋体;"  ><em>全局描述符表数据段</em></span><span style="color:#999999;"  ><em><span style="font-family:Times New Roman;"  >(16</span><span style="font-family:宋体;"  >位</span></em><span style="font-family:Times New Roman;"  ><em>)</em><span style="color:black;"  >      </span></span></span></span></p><p><span style="color:#999999; font-family:Times New Roman; font-size:9pt;"  ><em>;----------------------------------------------------------------------------</em><span style="color:black;"  >    </span></span></p><p><span style="color:black; font-size:9pt;"  ><span style="font-family:Times New Roman;"  >     <span style="color:#999999;"  ><em>;</em></span></span><span style="font-family:宋体;"  ><em>全局描述符表</em></span><span style="color:#999999; font-family:Times New Roman;"  ><em>GDT</em><span style="color:black;"  >     </span></span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >GDT             <span style="color:#009999;"  >LABEL<span style="color:black;"  >      <span style="color:#009999;"  >BYTE<span style="color:black;"  >       </span></span></span></span></span></p><p><span style="color:black; font-size:9pt;"  ><span style="font-family:Times New Roman;"  >     <span style="color:#999999;"  ><em>;</em></span></span><span style="font-family:宋体;"  ><em>空描述符</em></span><span style="font-family:Times New Roman;"  >    </span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >DUMMY           Desc    <span style="color:red;"  >&lt;&gt;<span style="color:black;"  >     </span></span></span></p><p><span style="color:black; font-size:9pt;"  ><span style="font-family:Times New Roman;"  >     <span style="color:#999999;"  ><em>;</em></span></span><span style="font-family:宋体;"  ><em>规范段描述符</em></span><span style="font-family:Times New Roman;"  >    </span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >Normal          Desc    <span style="color:red;"  >&lt;<span style="color:#000099;"  >0ffffh<span style="color:red;"  >,,,<span style="color:black;"  >ATDW<span style="color:red;"  >,,&gt;<span style="color:black;"  >         </span></span></span></span></span></span></span></p><p><span style="color:black; font-size:9pt;"  ><span style="font-family:Times New Roman;"  >     <span style="color:#999999;"  ><em>;</em></span></span><span style="font-family:宋体;"  ><em>视频缓冲区段描述符</em></span><span style="color:#999999; font-family:Times New Roman;"  ><em>(DPL=3)</em><span style="color:black;"  >     </span></span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >VideoBuf        Desc    <span style="color:red;"  >&lt;<span style="color:#000099;"  >0ffffh<span style="color:red;"  >,<span style="color:#000099;"  >8000h<span style="color:red;"  >,<span style="color:#000099;"  >0bh<span style="color:red;"  >,<span style="color:black;"  >ATDW<span style="color:red;"  >,,&gt;<span style="color:black;"  >             </span></span></span></span></span></span></span></span></span></span></span></p><p><span style="color:#999999; font-family:Times New Roman; font-size:9pt;"  ><em>;----------------------------------------------------------------------------</em><span style="color:black;"  >    </span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >EFFGDT          <span style="color:#009999;"  >LABEL<span style="color:black;"  >      <span style="color:#009999;"  >BYTE<span style="color:black;"  >       </span></span></span></span></span></p><p><span style="color:black; font-size:9pt;"  ><span style="font-family:Times New Roman;"  >     <span style="color:#999999;"  ><em>;</em></span></span><span style="font-family:宋体;"  ><em>临时代码段描述符</em></span><span style="font-family:Times New Roman;"  >    </span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >TempCode        Desc    <span style="color:red;"  >&lt;<span style="color:#000099;"  >0ffffh<span style="color:red;"  >,<span style="color:black;"  >TempCodeSeg<span style="color:red;"  >,,<span style="color:black;"  >ATCE<span style="color:red;"  >,,&gt;<span style="color:black;"  >           </span></span></span></span></span></span></span></span></span></p><p><span style="color:black; font-size:9pt;"  ><span style="font-family:Times New Roman;"  >     <span style="color:#999999;"  ><em>;</em></span></span><span style="font-family:宋体;"  ><em>演示代码段描述符</em></span><span style="font-family:Times New Roman;"  >    </span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >DemoCode        Desc    <span style="color:red;"  >&lt;<span style="color:black;"  >DemoCodeLen<span style="color:red;"  >-<span style="color:#000099;"  >1<span style="color:red;"  >,<span style="color:black;"  >DemoCodeSeg<span style="color:red;"  >,,<span style="color:black;"  >ATCE<span style="color:red;"  >,,&gt;<span style="color:black;"  >             </span></span></span></span></span></span></span></span></span></span></span></p><p><span style="color:black; font-size:9pt;"  ><span style="font-family:Times New Roman;"  >     <span style="color:#999999;"  ><em>;</em></span></span><span style="font-family:宋体;"  ><em>演示数据段描述符</em></span><span style="font-family:Times New Roman;"  >    </span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >DemoData        Desc    <span style="color:red;"  >&lt;<span style="color:black;"  >DemoDataLen<span style="color:red;"  >-<span style="color:#000099;"  >1<span style="color:red;"  >,<span style="color:black;"  >DemoDataSeg<span style="color:red;"  >,,<span style="color:black;"  >ATDW<span style="color:red;"  >,,&gt;<span style="color:black;"  >             </span></span></span></span></span></span></span></span></span></span></span></p><p><span style="color:black; font-size:9pt;"  ><span style="font-family:Times New Roman;"  >     <span style="color:#999999;"  ><em>;</em></span></span><span style="font-family:宋体;"  ><em>演示堆栈段描述符</em></span><span style="font-family:Times New Roman;"  >    </span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >DemoStack       Desc    <span style="color:red;"  >&lt;<span style="color:black;"  >DemoStackLen<span style="color:red;"  >-<span style="color:#000099;"  >1<span style="color:red;"  >,<span style="color:black;"  >DemoStackSeg<span style="color:red;"  >,,<span style="color:black;"  >ATDWA<span style="color:red;"  >,,&gt;<span style="color:black;"  >             </span></span></span></span></span></span></span></span></span></span></span></p><p><span style="color:black; font-size:9pt;"  ><span style="font-family:Times New Roman;"  >     <span style="color:#999999;"  ><em>;0feh</em></span></span><span style="font-family:宋体;"  ><em>号中断处理程序</em></span><span style="color:#999999;"  ><em><span style="font-family:Times New Roman;"  >(</span><span style="font-family:宋体;"  >显示程序</span><span style="font-family:Times New Roman;"  >)</span><span style="font-family:宋体;"  >代码段描述符</span></em><span style="color:black; font-family:Times New Roman;"  >     </span></span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >EchoCode        Desc    <span style="color:red;"  >&lt;<span style="color:black;"  >EchoCodeLen<span style="color:red;"  >-<span style="color:#000099;"  >1<span style="color:red;"  >,<span style="color:black;"  >EchoCodeSeg<span style="color:red;"  >,,<span style="color:black;"  >ATCE<span style="color:red;"  >,,&gt;<span style="color:black;"  >             </span></span></span></span></span></span></span></span></span></span></span></p><p><span style="color:black; font-size:9pt;"  ><span style="font-family:Times New Roman;"  >     <span style="color:#999999;"  ><em>;0feh</em></span></span><span style="font-family:宋体;"  ><em>号中断处理程序</em></span><span style="color:#999999;"  ><em><span style="font-family:Times New Roman;"  >(</span><span style="font-family:宋体;"  >显示程序</span><span style="font-family:Times New Roman;"  >)</span><span style="font-family:宋体;"  >数据段描述符</span></em><span style="color:black; font-family:Times New Roman;"  >     </span></span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >EchoData        Desc    <span style="color:red;"  >&lt;<span style="color:black;"  >EchoDataLen<span style="color:red;"  >-<span style="color:#000099;"  >1<span style="color:red;"  >,<span style="color:black;"  >EchoDataSeg<span style="color:red;"  >,,<span style="color:black;"  >ATDW<span style="color:red;"  >,,&gt;<span style="color:black;"  >             </span></span></span></span></span></span></span></span></span></span></span></p><p><span style="color:black; font-size:9pt;"  ><span style="font-family:Times New Roman;"  >     <span style="color:#999999;"  ><em>;8</em></span></span><span style="font-family:宋体;"  ><em>号中断处理程序代码段描述符</em></span><span style="font-family:Times New Roman;"  >    </span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >TICode          Desc    <span style="color:red;"  >&lt;<span style="color:black;"  >TICodeLen<span style="color:red;"  >-<span style="color:#000099;"  >1<span style="color:red;"  >,<span style="color:black;"  >TICodeSeg<span style="color:red;"  >,,<span style="color:black;"  >ATCE<span style="color:red;"  >,,&gt;<span style="color:black;"  >             </span></span></span></span></span></span></span></span></span></span></span></p><p><span style="color:black; font-size:9pt;"  ><span style="font-family:Times New Roman;"  >     <span style="color:#999999;"  ><em>;8</em></span></span><span style="font-family:宋体;"  ><em>号中断处理程序数据段描述符</em></span><span style="font-family:Times New Roman;"  >    </span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >TIData          Desc    <span style="color:red;"  >&lt;<span style="color:black;"  >TIDataLen<span style="color:red;"  >-<span style="color:#000099;"  >1<span style="color:red;"  >,<span style="color:black;"  >TIDataSeg<span style="color:red;"  >,,<span style="color:black;"  >ATDW<span style="color:red;"  >,,&gt;<span style="color:black;"  >             </span></span></span></span></span></span></span></span></span></span></span></p><p><span style="color:black; font-size:9pt;"  ><span style="font-family:Times New Roman;"  >     <span style="color:#999999;"  ><em>;</em></span></span><span style="font-family:宋体;"  ><em>其它中断或异常处理程序代码段描述符</em></span><span style="font-family:Times New Roman;"  >    </span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >Other           Desc    <span style="color:red;"  >&lt;<span style="color:black;"  >OtherCodeLen<span style="color:red;"  >-<span style="color:#000099;"  >1<span style="color:red;"  >,<span style="color:black;"  >OtherCodeSeg<span style="color:red;"  >,,<span style="color:black;"  >ATCE<span style="color:red;"  >,,&gt;<span style="color:black;"  >             </span></span></span></span></span></span></span></span></span></span></span></p><p><span style="color:#999999; font-family:Times New Roman; font-size:9pt;"  ><em>;----------------------------------------------------------------------------</em><span style="color:black;"  >    </span></span></p><p><span style="color:black; font-size:9pt;"  ><span style="font-family:Times New Roman;"  >GDTLen          <span style="color:red;"  >=<span style="color:black;"  >       <span style="color:red;"  >$-<span style="color:black;"  >GDT                     <span style="color:#999999;"  ><em>;</em></span></span></span></span></span></span><span style="font-family:宋体;"  ><em>全局描述符表长度</em></span><span style="font-family:Times New Roman;"  >    </span></span></p><p><span style="color:black; font-size:9pt;"  ><span style="font-family:Times New Roman;"  >GDNum           <span style="color:red;"  >=<span style="color:black;"  >       <span style="color:red;"  >($-<span style="color:black;"  >EFFGDT<span style="color:red;"  >)/(<span style="color:#009999;"  >SIZE<span style="color:black;"  > Desc<span style="color:red;"  >)<span style="color:black;"  >              <span style="color:#999999;"  ><em>;</em></span></span></span></span></span></span></span></span></span></span></span><span style="font-family:宋体;"  ><em>需特殊处理的描述符数</em></span><span style="font-family:Times New Roman;"  >    </span></span></p><p><span style="color:#999999; font-family:Times New Roman; font-size:9pt;"  ><em>;----------------------------------------------------------------------------</em><span style="color:black;"  >    </span></span></p><p><span style="color:black; font-size:9pt;"  ><span style="font-family:Times New Roman;"  >Normal_Sel      <span style="color:red;"  >=<span style="color:black;"  >       Normal<span style="color:red;"  >-<span style="color:black;"  >GDT                <span style="color:#999999;"  ><em>;</em></span></span></span></span></span></span><span style="font-family:宋体;"  ><em>规范段描述符选择子</em></span><span style="font-family:Times New Roman;"  >    </span></span></p><p><span style="color:black; font-size:9pt;"  ><span style="font-family:Times New Roman;"  >Video_Sel       <span style="color:red;"  >=<span style="color:black;"  >       VideoBuf<span style="color:red;"  >-<span style="color:black;"  >GDT              <span style="color:#999999;"  ><em>;</em></span></span></span></span></span></span><span style="font-family:宋体;"  ><em>视频缓冲区段描述符选择子</em></span><span style="font-family:Times New Roman;"  >    </span></span></p><p><span style="color:#999999; font-family:Times New Roman; font-size:9pt;"  ><em>;----------------------------------------------------------------------------</em><span style="color:black;"  >    </span></span></p><p><span style="color:black; font-size:9pt;"  ><span style="font-family:Times New Roman;"  >TempCode_Sel    <span style="color:red;"  >=<span style="color:black;"  >       TempCode<span style="color:red;"  >-<span style="color:black;"  >GDT              <span style="color:#999999;"  ><em>;</em></span></span></span></span></span></span><span style="font-family:宋体;"  ><em>临时代码段的选择子</em></span><span style="font-family:Times New Roman;"  >    </span></span></p><p><span style="color:black; font-size:9pt;"  ><span style="font-family:Times New Roman;"  >DemoCode_Sel    <span style="color:red;"  >=<span style="color:black;"  >       DemoCode<span style="color:red;"  >-<span style="color:black;"  >GDT              <span style="color:#999999;"  ><em>;</em></span></span></span></span></span></span><span style="font-family:宋体;"  ><em>演示代码段的<span style="color:#999999;"  >选择子</span></em></span><span style="color:black; font-family:Times New Roman;"  >    </span></span></p><p><span style="color:black; font-size:9pt;"  ><span style="font-family:Times New Roman;"  >DemoData_Sel    <span style="color:red;"  >=<span style="color:black;"  >       DemoData<span style="color:red;"  >-<span style="color:black;"  >GDT              <span style="color:#999999;"  ><em>;</em></span></span></span></span></span></span><span style="font-family:宋体;"  ><em>演示数据段的选择子</em></span><span style="font-family:Times New Roman;"  >    </span></span></p><p><span style="color:black; font-size:9pt;"  ><span style="font-family:Times New Roman;"  >DemoStack_Sel   <span style="color:red;"  >=<span style="color:black;"  >       DemoStack<span style="color:red;"  >-<span style="color:black;"  >GDT             <span style="color:#999999;"  ><em>;</em></span></span></span></span></span></span><span style="font-family:宋体;"  ><em>演示堆栈段的选择子</em></span><span style="font-family:Times New Roman;"  >    </span></span></p><p><span style="color:black; font-size:9pt;"  ><span style="font-family:Times New Roman;"  >EchoCode_Sel    <span style="color:red;"  >=<span style="color:black;"  >       EchoCode<span style="color:red;"  >-<span style="color:black;"  >GDT              <span style="color:#999999;"  ><em>;0feh</em></span></span></span></span></span></span><span style="font-family:宋体;"  ><em>号中断程序代码段选择子</em></span><span style="font-family:Times New Roman;"  >    </span></span></p><p><span style="color:black; font-size:9pt;"  ><span style="font-family:Times New Roman;"  >EchoData_Sel    <span style="color:red;"  >=<span style="color:black;"  >       EchoData<span style="color:red;"  >-<span style="color:black;"  >GDT              <span style="color:#999999;"  ><em>;0feh</em></span></span></span></span></span></span><span style="font-family:宋体;"  ><em>号中断程序数据段选择子</em></span><span style="font-family:Times New Roman;"  >    </span></span></p><p><span style="color:black; font-size:9pt;"  ><span style="font-family:Times New Roman;"  >TICode_Sel      <span style="color:red;"  >=<span style="color:black;"  >       TICode<span style="color:red;"  >-<span style="color:black;"  >GDT                <span style="color:#999999;"  ><em>;8</em></span></span></span></span></span></span><span style="font-family:宋体;"  ><em>号中断程序代码段选择子</em></span><span style="font-family:Times New Roman;"  >    </span></span></p><p><span style="color:black; font-size:9pt;"  ><span style="font-family:Times New Roman;"  >TIData_Sel      <span style="color:red;"  >=<span style="color:black;"  >       TIData<span style="color:red;"  >-<span style="color:black;"  >GDT                <span style="color:#999999;"  ><em>;8</em></span></span></span></span></span></span><span style="font-family:宋体;"  ><em>号中断程序数据段选择子</em></span><span style="font-family:Times New Roman;"  >    </span></span></p><p><span style="color:black; font-size:9pt;"  ><span style="font-family:Times New Roman;"  >Other_Sel       <span style="color:red;"  >=<span style="color:black;"  >       Other<span style="color:red;"  >-<span style="color:black;"  >GDT                 <span style="color:#999999;"  ><em>;</em></span></span></span></span></span></span><span style="font-family:宋体;"  ><em>其它中断或异常代码段选择子</em></span><span style="font-family:Times New Roman;"  >    </span></span></p><p><span style="color:#999999; font-family:Times New Roman; font-size:9pt;"  ><em>;----------------------------------------------------------------------------</em><span style="color:black;"  >    </span></span></p><p><span style="color:black; font-size:9pt;"  ><span style="font-family:Times New Roman;"  >GDTSeg          <span style="color:#009999;"  >ENDS<span style="color:black;"  >       <span style="color:#999999;"  ><em>;</em></span></span></span></span><span style="font-family:宋体;"  ><em>全局描述符表段定义结束</em></span><span style="font-family:Times New Roman;"  >    </span></span></p><p><span style="color:#999999; font-family:Times New Roman; font-size:9pt;"  ><em>;----------------------------------------------------------------------------</em><span style="color:black;"  >    </span></span></p><p><span style="color:black; font-size:9pt;"  ><span style="font-family:Times New Roman;"  >IDTSeg          <span style="color:#009999;"  >SEGMENT<span style="color:black;"  >       <span style="color:#009999;"  >PARA<span style="color:black;"  >         <span style="color:#009999;"  >USE16<span style="color:black;"  >           <span style="color:#999999;"  ><em>;</em></span></span></span></span></span></span></span></span><span style="font-family:宋体;"  ><em>中断描述符表数据段</em></span><span style="color:#999999;"  ><em><span style="font-family:Times New Roman;"  >(16</span><span style="font-family:宋体;"  >位</span></em><span style="font-family:Times New Roman;"  ><em>)</em><span style="color:black;"  >      </span></span></span></span></p><p><span style="color:#999999; font-family:Times New Roman; font-size:9pt;"  ><em>;----------------------------------------------------------------------------</em><span style="color:black;"  >    </span></span></p><p><span style="color:black; font-size:9pt;"  ><span style="font-family:Times New Roman;"  >IDT             <span style="color:#009999;"  >LABEL<span style="color:black;"  >       <span style="color:#009999;"  >BYTE<span style="color:black;"  >         <span style="color:#999999;"  ><em>;</em></span></span></span></span></span></span><span style="font-family:宋体;"  ><em>中断描述符表</em></span><span style="font-family:Times New Roman;"  >    </span></span></p><p><span style="color:black; font-size:9pt;"  ><span style="font-family:Times New Roman;"  >     <span style="color:#999999;"  ><em>;0--7</em></span></span><span style="font-family:宋体;"  ><em>的</em></span><span style="color:#999999;"  ><em><span style="font-family:Times New Roman;"  >8</span><span style="font-family:宋体;"  >个陷阱门描述符</span></em><span style="color:black; font-family:Times New Roman;"  >     </span></span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >    <span style="color:#009999;"  >REPT<span style="color:black;"  >      <span style="color:#000099;"  >8<span style="color:black;"  >       </span></span></span></span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >                Gate    <span style="color:red;"  >&lt;<span style="color:black;"  >OtherBegin<span style="color:red;"  >,<span style="color:black;"  >Other_Sel<span style="color:red;"  >,,<span style="color:black;"  >AT386TGate<span style="color:red;"  >,&gt;<span style="color:black;"  >           </span></span></span></span></span></span></span></span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >    <span style="color:#009999;"  >ENDM<span style="color:black;"  >     </span></span></span></p><p><span style="color:black; font-size:9pt;"  ><span style="font-family:Times New Roman;"  >     <span style="color:#999999;"  ><em>;</em></span></span><span style="font-family:宋体;"  ><em>对应</em></span><span style="color:#999999;"  ><em><span style="font-family:Times New Roman;"  >8</span><span style="font-family:宋体;"  >号</span><span style="font-family:Times New Roman;"  >(</span><span style="font-family:宋体;"  >时钟</span><span style="font-family:Times New Roman;"  >)</span><span style="font-family:宋体;"  >中断处理程序的门描述符</span></em><span style="color:black; font-family:Times New Roman;"  >     </span></span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >                Gate    <span style="color:red;"  >&lt;<span style="color:black;"  >TIBegin<span style="color:red;"  >,<span style="color:black;"  >TICode_Sel<span style="color:red;"  >,,<span style="color:black;"  >AT386IGate<span style="color:red;"  >,&gt;<span style="color:black;"  >           </span></span></span></span></span></span></span></span></span></p><p><span style="color:black; font-size:9pt;"  ><span style="font-family:Times New Roman;"  >     <span style="color:#999999;"  ><em>;</em></span></span><span style="font-family:宋体;"  ><em>从</em></span><span style="color:#999999;"  ><em><span style="font-family:Times New Roman;"  >9--0fdh</span><span style="font-family:宋体;"  >的</span><span style="font-family:Times New Roman;"  >245</span><span style="font-family:宋体;"  >个陷阱门描述符</span></em><span style="color:black; font-family:Times New Roman;"  >     </span></span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >    <span style="color:#009999;"  >REPT<span style="color:black;"  >      <span style="color:#000099;"  >245<span style="color:black;"  >       </span></span></span></span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >                Gate    <span style="color:red;"  >&lt;<span style="color:black;"  >OtherBegin<span style="color:red;"  >,<span style="color:black;"  >Other_Sel<span style="color:red;"  >,,<span style="color:black;"  >AT386TGate<span style="color:red;"  >,&gt;<span style="color:black;"  >           </span></span></span></span></span></span></span></span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >    <span style="color:#009999;"  >ENDM<span style="color:black;"  >     </span></span></span></p><p><span style="color:black; font-size:9pt;"  ><span style="font-family:Times New Roman;"  >     <span style="color:#999999;"  ><em>;</em></span></span><span style="font-family:宋体;"  ><em>对应</em></span><span style="color:#999999;"  ><em><span style="font-family:Times New Roman;"  >0feh</span><span style="font-family:宋体;"  >号中断处理程序的陷阱门描述符</span></em><span style="color:black; font-family:Times New Roman;"  >     </span></span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >                Gate    <span style="color:red;"  >&lt;<span style="color:black;"  >EchoBegin<span style="color:red;"  >,<span style="color:black;"  >EchoCode_Sel<span style="color:red;"  >,,<span style="color:black;"  >AT386TGate<span style="color:red;"  >,&gt;<span style="color:black;"  >           </span></span></span></span></span></span></span></span></span></p><p><span style="color:black; font-size:9pt;"  ><span style="font-family:Times New Roman;"  >     <span style="color:#999999;"  ><em>;</em></span></span><span style="font-family:宋体;"  ><em>对应</em></span><span style="color:#999999;"  ><em><span style="font-family:Times New Roman;"  >0ffh</span><span style="font-family:宋体;"  >号中断处理程序的陷阱门描述符</span></em><span style="color:black; font-family:Times New Roman;"  >     </span></span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >                Gate    <span style="color:red;"  >&lt;<span style="color:black;"  >OtherBegin<span style="color:red;"  >,<span style="color:black;"  >Other_Sel<span style="color:red;"  >,,<span style="color:black;"  >AT386TGate<span style="color:red;"  >,&gt;<span style="color:black;"  >           </span></span></span></span></span></span></span></span></span></p><p><span style="color:#999999; font-family:Times New Roman; font-size:9pt;"  ><em>;----------------------------------------------------------------------------</em><span style="color:black;"  >    </span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >IDTLen          <span style="color:red;"  >=<span style="color:black;"  >      <span style="color:red;"  >$-<span style="color:black;"  >IDT </span></span></span></span></span></p><p><span style="color:#999999; font-family:Times New Roman; font-size:9pt;"  ><em>;----------------------------------------------------------------------------</em><span style="color:black;"  >    </span></span></p><p><span style="color:black; font-size:9pt;"  ><span style="font-family:Times New Roman;"  >IDTSeg          <span style="color:#009999;"  >ENDS<span style="color:black;"  >       <span style="color:#999999;"  ><em>;</em></span></span></span></span><span style="font-family:宋体;"  ><em>中断描述符表段定义结束</em></span><span style="font-family:Times New Roman;"  >    </span></span></p><p><span style="color:#999999; font-family:Times New Roman; font-size:9pt;"  ><em>;----------------------------------------------------------------------------</em><span style="color:black;"  >    </span></span></p><p><span style="color:#999999; font-size:9pt;"  ><em><span style="font-family:Times New Roman;"  >;</span><span style="font-family:宋体;"  >其它中断或异常处理程序的代码段</span></em><span style="color:black; font-family:Times New Roman;"  >    </span></span></p><p><span style="color:#999999; font-family:Times New Roman; font-size:9pt;"  ><em>;----------------------------------------------------------------------------</em><span style="color:black;"  >    </span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >OtherCodeSeg    <span style="color:#009999;"  >SEGMENT<span style="color:black;"  >      <span style="color:#009999;"  >PARA<span style="color:black;"  >        <span style="color:#009999;"  >USE16<span style="color:black;"  >         </span></span></span></span></span></span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >    <span style="color:#009999;"  >ASSUME<span style="color:black;"  >      <span style="color:fuchsia;"  >CS<span style="color:black;"  >:OtherCodeSeg </span></span></span></span></span></p><p><span style="color:#999999; font-family:Times New Roman; font-size:9pt;"  ><em>;----------------------------------------------------------------------------</em><span style="color:black;"  >    </span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >OtherBegin      <span style="color:#009999;"  >PROC<span style="color:black;"  >      <span style="color:#009999;"  >FAR<span style="color:black;"  >       </span></span></span></span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >    <span style="color:blue;"  >mov<span style="color:black;"  >      <span style="color:fuchsia;"  >ax<span style="color:red;"  >,<span style="color:black;"  >Video_Sel </span></span></span></span></span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >    <span style="color:blue;"  >mov<span style="color:black;"  >      <span style="color:fuchsia;"  >es<span style="color:red;"  >,<span style="color:fuchsia;"  >ax<span style="color:black;"  >         </span></span></span></span></span></span></span></p><p><span style="color:black; font-size:9pt;"  ><span style="font-family:Times New Roman;"  >     <span style="color:blue;"  >mov<span style="color:black;"  >       <span style="color:fuchsia;"  >ah<span style="color:red;"  >,<span style="color:#000099;"  >17h<span style="color:black;"  >           <span style="color:#999999;"  ><em>;</em></span></span></span></span></span></span></span></span><span style="font-family:宋体;"  ><em>在屏幕左上角显示兰底白字</em></span><span style="font-family:Times New Roman;"  >    </span></span></p><p><span style="color:black; font-size:9pt;"  ><span style="font-family:Times New Roman;"  >     <span style="color:blue;"  >mov<span style="color:black;"  >       <span style="color:fuchsia;"  >al<span style="color:red;"  >,<span style="color:#999900;"  >'!'<span style="color:black;"  >           <span style="color:#999999;"  ><em>;</em></span></span></span></span></span></span></span></span><span style="font-family:宋体;"  ><em>符号</em></span><span style="color:#999999; font-family:Times New Roman;"  ><em>"!"</em><span style="color:black;"  >     </span></span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >    <span style="color:blue;"  >mov<span style="color:black;"  >      <span style="color:#009999;"  >WORD<span style="color:black;"  >        <span style="color:#009999;"  >PTR<span style="color:black;"  >          <span style="color:fuchsia;"  >es<span style="color:black;"  >:<span style="color:red;"  >[<span style="color:#000099;"  >0<span style="color:red;"  >],<span style="color:fuchsia;"  >ax<span style="color:black;"  >                </span></span></span></span></span></span></span></span></span></span></span></span></span></span></p><p><span style="color:black; font-size:9pt;"  ><span style="font-family:Times New Roman;"  >     <span style="color:blue;"  >jmp<span style="color:black;"  >       <span style="color:red;"  >$<span style="color:black;"  >         <span style="color:#999999;"  ><em>;</em></span></span></span></span></span></span><span style="font-family:宋体;"  ><em>无限循环</em></span><span style="font-family:Times New Roman;"  >    </span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >OtherBegin      <span style="color:#009999;"  >ENDP<span style="color:black;"  >     </span></span></span></p><p><span style="color:#999999; font-family:Times New Roman; font-size:9pt;"  ><em>;----------------------------------------------------------------------------</em><span style="color:black;"  >    </span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >OtherCodeLen    <span style="color:red;"  >=<span style="color:black;"  >      <span style="color:red;"  >$<span style="color:black;"  >       </span></span></span></span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >OtherCodeSeg    <span style="color:#009999;"  >ENDS<span style="color:black;"  >     </span></span></span></p><p><span style="color:#999999; font-family:Times New Roman; font-size:9pt;"  ><em>;----------------------------------------------------------------------------</em><span style="color:black;"  >    </span></span></p><p><span style="color:#999999; font-size:9pt;"  ><em><span style="font-family:Times New Roman;"  >;8</span><span style="font-family:宋体;"  >号中断处理程序的数据段</span></em><span style="color:black; font-family:Times New Roman;"  >    </span></span></p><p><span style="color:#999999; font-family:Times New Roman; font-size:9pt;"  ><em>;----------------------------------------------------------------------------</em><span style="color:black;"  >    </span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >TIDataSeg       <span style="color:#009999;"  >SEGMENT<span style="color:black;"  >      <span style="color:#009999;"  >PARA<span style="color:black;"  >        <span style="color:#009999;"  >USE16<span style="color:black;"  >         </span></span></span></span></span></span></span></p><p><span style="color:black; font-size:9pt;"  ><span style="font-family:Times New Roman;"  >Count           <span style="color:#009999;"  >DB<span style="color:black;"  >       <span style="color:#000099;"  >0<span style="color:black;"  >         <span style="color:#999999;"  ><em>;</em></span></span></span></span></span></span><span style="font-family:宋体;"  ><em>中断发生的计数器</em></span><span style="font-family:Times New Roman;"  >    </span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >TIDataLen       <span style="color:red;"  >=<span style="color:black;"  >      <span style="color:red;"  >$<span style="color:black;"  >       </span></span></span></span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >TIDataSeg       <span style="color:#009999;"  >ENDS<span style="color:black;"  >     </span></span></span></p><p><span style="color:#999999; font-family:Times New Roman; font-size:9pt;"  ><em>;----------------------------------------------------------------------------</em><span style="color:black;"  >    </span></span></p><p><span style="color:#999999; font-size:9pt;"  ><em><span style="font-family:Times New Roman;"  >;8</span><span style="font-family:宋体;"  >号中断处理程序的代码段</span></em><span style="color:black; font-family:Times New Roman;"  >    </span></span></p><p><span style="color:#999999; font-family:Times New Roman; font-size:9pt;"  ><em>;----------------------------------------------------------------------------</em><span style="color:black;"  >    </span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >TICodeSeg       <span style="color:#009999;"  >SEGMENT<span style="color:black;"  >      <span style="color:#009999;"  >PARA<span style="color:black;"  >        <span style="color:#009999;"  >USE16<span style="color:black;"  >         </span></span></span></span></span></span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >    <span style="color:#009999;"  >ASSUME<span style="color:black;"  >      <span style="color:fuchsia;"  >CS<span style="color:black;"  >:TICodeSeg<span style="color:red;"  >,<span style="color:fuchsia;"  >DS<span style="color:black;"  >:TIDataSeg </span></span></span></span></span></span></span></span></p><p><span style="color:#999999; font-family:Times New Roman; font-size:9pt;"  ><em>;----------------------------------------------------------------------------</em><span style="color:black;"  >    </span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >TIBegin         <span style="color:#009999;"  >PROC<span style="color:black;"  >      <span style="color:#009999;"  >FAR<span style="color:black;"  >       </span></span></span></span></span></p><p><span style="color:black; font-size:9pt;"  ><span style="font-family:Times New Roman;"  >     <span style="color:blue;"  >push<span style="color:black;"  >       <span style="color:fuchsia;"  >eax<span style="color:black;"  >         <span style="color:#999999;"  ><em>;</em></span></span></span></span></span></span><span style="font-family:宋体;"  ><em>保护现场</em></span><span style="font-family:Times New Roman;"  >    </span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >    <span style="color:blue;"  >push<span style="color:black;"  >      <span style="color:fuchsia;"  >ds<span style="color:black;"  >       </span></span></span></span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >    <span style="color:blue;"  >push<span style="color:black;"  >      <span style="color:fuchsia;"  >fs<span style="color:black;"  >       </span></span></span></span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >    <span style="color:blue;"  >push<span style="color:black;"  >      <span style="color:fuchsia;"  >gs<span style="color:black;"  >       </span></span></span></span></span></p><p><span style="color:black; font-size:9pt;"  ><span style="font-family:Times New Roman;"  >     <span style="color:blue;"  >mov<span style="color:black;"  >       <span style="color:fuchsia;"  >ax<span style="color:red;"  >,<span style="color:black;"  >TIData_Sel             <span style="color:#999999;"  ><em>;</em></span></span></span></span></span></span></span><span style="font-family:宋体;"  ><em>置中断处理程序数据段</em></span><span style="font-family:Times New Roman;"  >    </span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >    <span style="color:blue;"  >mov<span style="color:black;"  >      <span style="color:fuchsia;"  >ds<span style="color:red;"  >,<span style="color:fuchsia;"  >ax<span style="color:black;"  >         </span></span></span></span></span></span></span></p><p><span style="color:black; font-size:9pt;"  ><span style="font-family:Times New Roman;"  >     <span style="color:blue;"  >mov<span style="color:black;"  >       <span style="color:fuchsia;"  >ax<span style="color:red;"  >,<span style="color:black;"  >EchoData_Sel           <span style="color:#999999;"  ><em>;</em></span></span></span></span></span></span></span><span style="font-family:宋体;"  ><em>置显示过程数据段</em></span><span style="font-family:Times New Roman;"  >    </span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >    <span style="color:blue;"  >mov<span style="color:black;"  >      <span style="color:fuchsia;"  >fs<span style="color:red;"  >,<span style="color:fuchsia;"  >ax<span style="color:black;"  >         </span></span></span></span></span></span></span></p><p><span style="color:black; font-size:9pt;"  ><span style="font-family:Times New Roman;"  >     <span style="color:blue;"  >mov<span style="color:black;"  >       <span style="color:fuchsia;"  >ax<span style="color:red;"  >,<span style="color:black;"  >DemoData_Sel           <span style="color:#999999;"  ><em>;</em></span></span></span></span></span></span></span><span style="font-family:宋体;"  ><em>置演示程序数据段</em></span><span style="font-family:Times New Roman;"  >    </span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >    <span style="color:blue;"  >mov<span style="color:black;"  >      <span style="color:fuchsia;"  >gs<span style="color:red;"  >,<span style="color:fuchsia;"  >ax<span style="color:black;"  >         </span></span></span></span></span></span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >    <span style="color:blue;"  >cmp<span style="color:black;"  >     Count<span style="color:red;"  >,<span style="color:#000099;"  >0<span style="color:black;"  >        </span></span></span></span></span></span></p><p><span style="color:black; font-size:9pt;"  ><span style="font-family:Times New Roman;"  >     <span style="color:blue;"  >jnz<span style="color:black;"  >     TI2                       <span style="color:#999999;"  ><em>;</em></span></span></span></span><span style="font-family:宋体;"  ><em>计数非</em></span><span style="color:#999999;"  ><em><span style="font-family:Times New Roman;"  >0</span><span style="font-family:宋体;"  >表示未到</span><span style="font-family:Times New Roman;"  >1</span><span style="font-family:宋体;"  >秒</span></em><span style="color:black; font-family:Times New Roman;"  >     </span></span></span></p><p><span style="color:black; font-size:9pt;"  ><span style="font-family:Times New Roman;"  >     <span style="color:blue;"  >mov<span style="color:black;"  >     Count<span style="color:red;"  >,<span style="color:#000099;"  >18<span style="color:black;"  >          <span style="color:#999999;"  ><em>;</em></span></span></span></span></span></span></span><span style="font-family:宋体;"  ><em>每秒约</em></span><span style="color:#999999;"  ><em><span style="font-family:Times New Roman;"  >18</span><span style="font-family:宋体;"  >次</span></em><span style="color:black; font-family:Times New Roman;"  >     </span></span></span></p><p><span style="color:black; font-size:9pt;"  ><span style="font-family:Times New Roman;"  >     <span style="color:blue;"  >int<span style="color:black;"  >       <span style="color:#000099;"  >0feh<span style="color:black;"  >         <span style="color:#999999;"  ><em>;</em></span></span></span></span></span></span><span style="font-family:宋体;"  ><em>调用</em></span><span style="color:#999999;"  ><em><span style="font-family:Times New Roman;"  >0FEH</span><span style="font-family:宋体;"  >号中断处理程序显示</span></em><span style="color:black; font-family:Times New Roman;"  >     </span></span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >    <span style="color:blue;"  >cmp<span style="color:black;"  >      <span style="color:#009999;"  >BYTE<span style="color:black;"  >        <span style="color:#009999;"  >PTR<span style="color:black;"  >          <span style="color:fuchsia;"  >fs<span style="color:black;"  >:Mess<span style="color:red;"  >,<span style="color:#999900;"  >'0'<span style="color:black;"  >              </span></span></span></span></span></span></span></span></span></span></span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >    <span style="color:blue;"  >jnz<span style="color:black;"  >     TI1 </span></span></span></p><p><span style="color:black; font-size:9pt;"  ><span style="font-family:Times New Roman;"  >     <span style="color:blue;"  >mov<span style="color:black;"  >       <span style="color:#009999;"  >BYTE<span style="color:black;"  >         <span style="color:#009999;"  >PTR<span style="color:black;"  >           <span style="color:fuchsia;"  >gs<span style="color:black;"  >:Flag<span style="color:red;"  >,<span style="color:#000099;"  >1<span style="color:black;"  >                <span style="color:#999999;"  ><em>;</em></span></span></span></span></span></span></span></span></span></span></span></span></span><span style="font-family:宋体;"  ><em>显示符号</em></span><span style="color:#999999;"  ><em><span style="font-family:Times New Roman;"  >'0'</span><span style="font-family:宋体;"  >时置标记</span></em><span style="color:black; font-family:Times New Roman;"  >     </span></span></span></p><p><span style="color:#990000; font-size:9pt;"  ><span style="font-family:Times New Roman;"  >TI1:<span style="color:black;"  >      <span style="color:blue;"  >dec<span style="color:black;"  >        <span style="color:#009999;"  >BYTE<span style="color:black;"  >          <span style="color:#009999;"  >PTR<span style="color:black;"  >            <span style="color:fuchsia;"  >fs<span style="color:black;"  >:Mess          <span style="color:#999999;"  ><em>;</em></span></span></span></span></span></span></span></span></span></span></span><span style="font-family:宋体;"  ><em>调整显示符号</em></span><span style="color:black; font-family:Times New Roman;"  >    </span></span></p><p><span style="color:#990000; font-size:9pt;"  ><span style="font-family:Times New Roman;"  >TI2:<span style="color:black;"  >      <span style="color:blue;"  >dec<span style="color:black;"  >     Count                     <span style="color:#999999;"  ><em>;</em></span></span></span></span></span><span style="font-family:宋体;"  ><em>调整计数</em></span><span style="color:black; font-family:Times New Roman;"  >    </span></span></p><p><span style="color:black; font-size:9pt;"  ><span style="font-family:Times New Roman;"  >     <span style="color:blue;"  >pop<span style="color:black;"  >       <span style="color:fuchsia;"  >gs<span style="color:black;"  >         <span style="color:#999999;"  ><em>;</em></span></span></span></span></span></span><span style="font-family:宋体;"  ><em>恢复现场</em></span><span style="font-family:Times New Roman;"  >    </span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >    <span style="color:blue;"  >pop<span style="color:black;"  >      <span style="color:fuchsia;"  >fs<span style="color:black;"  >       </span></span></span></span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >    <span style="color:blue;"  >pop<span style="color:black;"  >      <span style="color:fuchsia;"  >ds<span style="color:black;"  >       </span></span></span></span></span></p><p><span style="color:black; font-size:9pt;"  ><span style="font-family:Times New Roman;"  >     <span style="color:blue;"  >mov<span style="color:black;"  >       <span style="color:fuchsia;"  >al<span style="color:red;"  >,<span style="color:black;"  >EOICOM                 <span style="color:#999999;"  ><em>;</em></span></span></span></span></span></span></span><span style="font-family:宋体;"  ><em>通知中断控制器中断处理结束</em></span><span style="font-family:Times New Roman;"  >    </span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >    <span style="color:blue;"  >out<span style="color:black;"  >     ICREGP<span style="color:red;"  >,<span style="color:fuchsia;"  >al<span style="color:black;"  >        </span></span></span></span></span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >    <span style="color:blue;"  >pop<span style="color:black;"  >      <span style="color:fuchsia;"  >eax<span style="color:black;"  >       </span></span></span></span></span></p><p><span style="color:black; font-size:9pt;"  ><span style="font-family:Times New Roman;"  >     <span style="color:blue;"  >iretd<span style="color:black;"  >       <span style="color:#999999;"  ><em>;</em></span></span></span></span><span style="font-family:宋体;"  ><em>中断返回</em></span><span style="font-family:Times New Roman;"  >    </span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >TIBegin         <span style="color:#009999;"  >ENDP<span style="color:black;"  >     </span></span></span></p><p><span style="color:#999999; font-family:Times New Roman; font-size:9pt;"  ><em>;----------------------------------------------------------------------------</em><span style="color:black;"  >    </span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >TICodeLen       <span style="color:red;"  >=<span style="color:black;"  >      <span style="color:red;"  >$<span style="color:black;"  >       </span></span></span></span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >TICodeSeg       <span style="color:#009999;"  >ENDS<span style="color:black;"  >     </span></span></span></p><p><span style="color:#999999; font-family:Times New Roman; font-size:9pt;"  ><em>;----------------------------------------------------------------------------</em><span style="color:black;"  >    </span></span></p><p><span style="color:#999999; font-size:9pt;"  ><em><span style="font-family:Times New Roman;"  >;0FEH</span><span style="font-family:宋体;"  >号中断处理程序数据段</span></em><span style="color:black; font-family:Times New Roman;"  >    </span></span></p><p><span style="color:#999999; font-family:Times New Roman; font-size:9pt;"  ><em>;----------------------------------------------------------------------------</em><span style="color:black;"  >    </span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >EchoDataSeg     <span style="color:#009999;"  >SEGMENT<span style="color:black;"  >      <span style="color:#009999;"  >PARA<span style="color:black;"  >        <span style="color:#009999;"  >USE16<span style="color:black;"  >         </span></span></span></span></span></span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >Mess            <span style="color:#009999;"  >DB<span style="color:black;"  >      <span style="color:#999900;"  >'8'<span style="color:red;"  >,<span style="color:#000099;"  >4eh<span style="color:black;"  >         </span></span></span></span></span></span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >EchoDataLen     <span style="color:red;"  >=<span style="color:black;"  >      <span style="color:red;"  >$<span style="color:black;"  >       </span></span></span></span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >EchoDataSeg     <span style="color:#009999;"  >ENDS<span style="color:black;"  >     </span></span></span></p><p><span style="color:#999999; font-family:Times New Roman; font-size:9pt;"  ><em>;----------------------------------------------------------------------------</em><span style="color:black;"  >    </span></span></p><p><span style="color:#999999; font-size:9pt;"  ><em><span style="font-family:Times New Roman;"  >;0FEH</span><span style="font-family:宋体;"  >号中断处理程序</span><span style="font-family:Times New Roman;"  >(</span><span style="font-family:宋体;"  >显示程序</span><span style="font-family:Times New Roman;"  >)</span><span style="font-family:宋体;"  >的代码段</span></em><span style="color:black; font-family:Times New Roman;"  >    </span></span></p><p><span style="color:#999999; font-family:Times New Roman; font-size:9pt;"  ><em>;----------------------------------------------------------------------------</em><span style="color:black;"  >    </span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >EchoCodeSeg     <span style="color:#009999;"  >SEGMENT<span style="color:black;"  >      <span style="color:#009999;"  >PARA<span style="color:black;"  >        <span style="color:#009999;"  >USE16<span style="color:black;"  >         </span></span></span></span></span></span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >    <span style="color:#009999;"  >ASSUME<span style="color:black;"  >      <span style="color:fuchsia;"  >CS<span style="color:black;"  >:EchoCodeSeg<span style="color:red;"  >,<span style="color:fuchsia;"  >DS<span style="color:black;"  >:EchoDataSeg </span></span></span></span></span></span></span></span></p><p><span style="color:#999999; font-family:Times New Roman; font-size:9pt;"  ><em>;----------------------------------------------------------------------------</em><span style="color:black;"  >    </span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >EchoBegin       <span style="color:#009999;"  >PROC<span style="color:black;"  >      <span style="color:#009999;"  >FAR<span style="color:black;"  >       </span></span></span></span></span></p><p><span style="color:black; font-size:9pt;"  ><span style="font-family:Times New Roman;"  >     <span style="color:blue;"  >push<span style="color:black;"  >       <span style="color:fuchsia;"  >ax<span style="color:black;"  >         <span style="color:#999999;"  ><em>;</em></span></span></span></span></span></span><span style="font-family:宋体;"  ><em>保护现场</em></span><span style="font-family:Times New Roman;"  >    </span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >    <span style="color:blue;"  >push<span style="color:black;"  >      <span style="color:fuchsia;"  >ds<span style="color:black;"  >       </span></span></span></span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >    <span style="color:blue;"  >push<span style="color:black;"  >      <span style="color:fuchsia;"  >es<span style="color:black;"  >       </span></span></span></span></span></p><p><span style="color:black; font-size:9pt;"  ><span style="font-family:Times New Roman;"  >     <span style="color:blue;"  >mov<span style="color:black;"  >       <span style="color:fuchsia;"  >ax<span style="color:red;"  >,<span style="color:black;"  >EchoData_Sel           <span style="color:#999999;"  ><em>;</em></span></span></span></span></span></span></span><span style="font-family:宋体;"  ><em>置显示过程数据段</em></span><span style="font-family:Times New Roman;"  >    </span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >    <span style="color:blue;"  >mov<span style="color:black;"  >      <span style="color:fuchsia;"  >ds<span style="color:red;"  >,<span style="color:fuchsia;"  >ax<span style="color:black;"  >         </span></span></span></span></span></span></span></p><p><span style="color:black; font-size:9pt;"  ><span style="font-family:Times New Roman;"  >     <span style="color:blue;"  >mov<span style="color:black;"  >       <span style="color:fuchsia;"  >ax<span style="color:red;"  >,<span style="color:black;"  >Video_Sel              <span style="color:#999999;"  ><em>;</em></span></span></span></span></span></span></span><span style="font-family:宋体;"  ><em>置视频缓冲区数据段</em></span><span style="font-family:Times New Roman;"  >    </span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >    <span style="color:blue;"  >mov<span style="color:black;"  >      <span style="color:fuchsia;"  >es<span style="color:red;"  >,<span style="color:fuchsia;"  >ax<span style="color:black;"  >         </span></span></span></span></span></span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >    <span style="color:blue;"  >mov<span style="color:black;"  >      <span style="color:fuchsia;"  >ax<span style="color:red;"  >,<span style="color:#009999;"  >WORD<span style="color:black;"  >          <span style="color:#009999;"  >PTR<span style="color:black;"  > Mess </span></span></span></span></span></span></span></span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >    <span style="color:blue;"  >mov<span style="color:black;"  >      <span style="color:#009999;"  >WORD<span style="color:black;"  >        <span style="color:#009999;"  >PTR<span style="color:black;"  >          <span style="color:fuchsia;"  >es<span style="color:black;"  >:<span style="color:red;"  >[<span style="color:#000099;"  >0<span style="color:red;"  >],<span style="color:fuchsia;"  >ax<span style="color:black;"  >                </span></span></span></span></span></span></span></span></span></span></span></span></span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >    <span style="color:blue;"  >pop<span style="color:black;"  >      <span style="color:fuchsia;"  >es<span style="color:black;"  >       </span></span></span></span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >    <span style="color:blue;"  >pop<span style="color:black;"  >      <span style="color:fuchsia;"  >ds<span style="color:black;"  >       </span></span></span></span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >    <span style="color:blue;"  >pop<span style="color:black;"  >      <span style="color:fuchsia;"  >ax<span style="color:black;"  >       </span></span></span></span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >    <span style="color:blue;"  >iretd<span style="color:black;"  >     </span></span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >EchoBegin       <span style="color:#009999;"  >ENDP<span style="color:black;"  >     </span></span></span></p><p><span style="color:#999999; font-family:Times New Roman; font-size:9pt;"  ><em>;----------------------------------------------------------------------------</em><span style="color:black;"  >    </span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >EchoCodeLen     <span style="color:red;"  >=<span style="color:black;"  >      <span style="color:red;"  >$<span style="color:black;"  >       </span></span></span></span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >EchoCodeSeg     <span style="color:#009999;"  >ENDS<span style="color:black;"  >     </span></span></span></p><p><span style="color:#999999; font-family:Times New Roman; font-size:9pt;"  ><em>;----------------------------------------------------------------------------</em><span style="color:black;"  >    </span></span></p><p><span style="color:#999999; font-size:9pt;"  ><em><span style="font-family:Times New Roman;"  >;</span><span style="font-family:宋体;"  >演示任务的堆栈段</span></em><span style="color:black; font-family:Times New Roman;"  >    </span></span></p><p><span style="color:#999999; font-family:Times New Roman; font-size:9pt;"  ><em>;----------------------------------------------------------------------------</em><span style="color:black;"  >    </span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >DemoStackSeg    <span style="color:#009999;"  >SEGMENT<span style="color:black;"  >      <span style="color:#009999;"  >PARA<span style="color:black;"  >        <span style="color:#009999;"  >USE16<span style="color:black;"  >         </span></span></span></span></span></span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >DemoStackLen    <span style="color:red;"  >=<span style="color:black;"  >      <span style="color:#000099;"  >1024<span style="color:black;"  >       </span></span></span></span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >    <span style="color:#009999;"  >DB<span style="color:black;"  >      DemoStackLen <span style="color:#009999;"  >DUP<span style="color:red;"  >(<span style="color:#000099;"  >0<span style="color:red;"  >)<span style="color:black;"  >          </span></span></span></span></span></span></span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >DemoStackSeg    <span style="color:#009999;"  >ENDS<span style="color:black;"  >     </span></span></span></p><p><span style="color:#999999; font-family:Times New Roman; font-size:9pt;"  ><em>;----------------------------------------------------------------------------</em><span style="color:black;"  >    </span></span></p><p><span style="color:#999999; font-size:9pt;"  ><em><span style="font-family:Times New Roman;"  >;</span><span style="font-family:宋体;"  >演示任务的数据段</span></em><span style="color:black; font-family:Times New Roman;"  >    </span></span></p><p><span style="color:#999999; font-family:Times New Roman; font-size:9pt;"  ><em>;----------------------------------------------------------------------------</em><span style="color:black;"  >    </span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >DemoDataSeg     <span style="color:#009999;"  >SEGMENT<span style="color:black;"  >      <span style="color:#009999;"  >PARA<span style="color:black;"  >        <span style="color:#009999;"  >USE16<span style="color:black;"  >         </span></span></span></span></span></span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >Flag            <span style="color:#009999;"  >DB<span style="color:black;"  >      <span style="color:#000099;"  >0<span style="color:black;"  >       </span></span></span></span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >DemoDataLen     <span style="color:red;"  >=<span style="color:black;"  >      <span style="color:red;"  >$<span style="color:black;"  >       </span></span></span></span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >DemoDataSeg     <span style="color:#009999;"  >ENDS<span style="color:black;"  >     </span></span></span></p><p><span style="color:#999999; font-family:Times New Roman; font-size:9pt;"  ><em>;----------------------------------------------------------------------------</em><span style="color:black;"  >    </span></span></p><p><span style="color:#999999; font-size:9pt;"  ><em><span style="font-family:Times New Roman;"  >;</span><span style="font-family:宋体;"  >演示任务的代码段</span></em><span style="color:black; font-family:Times New Roman;"  >    </span></span></p><p><span style="color:#999999; font-family:Times New Roman; font-size:9pt;"  ><em>;----------------------------------------------------------------------------</em><span style="color:black;"  >    </span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >DemoCodeSeg     <span style="color:#009999;"  >SEGMENT<span style="color:black;"  >      <span style="color:#009999;"  >PARA<span style="color:black;"  >        <span style="color:#009999;"  >USE16<span style="color:black;"  >         </span></span></span></span></span></span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >    <span style="color:#009999;"  >ASSUME<span style="color:black;"  >      <span style="color:fuchsia;"  >CS<span style="color:black;"  >:DemoCodeSeg<span style="color:red;"  >,<span style="color:fuchsia;"  >DS<span style="color:black;"  >:DemoDataSeg </span></span></span></span></span></span></span></span></p><p><span style="color:#999999; font-family:Times New Roman; font-size:9pt;"  ><em>;----------------------------------------------------------------------------</em><span style="color:black;"  >    </span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >DemoBegin       <span style="color:#009999;"  >PROC<span style="color:black;"  >      <span style="color:#009999;"  >FAR<span style="color:black;"  >       </span></span></span></span></span></p><p><span style="color:black; font-size:9pt;"  ><span style="font-family:Times New Roman;"  >     <span style="color:blue;"  >mov<span style="color:black;"  >       <span style="color:fuchsia;"  >ax<span style="color:red;"  >,<span style="color:black;"  >DemoStack_Sel          <span style="color:#999999;"  ><em>;</em></span></span></span></span></span></span></span><span style="font-family:宋体;"  ><em>置堆栈</em></span><span style="font-family:Times New Roman;"  >    </span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >    <span style="color:blue;"  >mov<span style="color:black;"  >      <span style="color:fuchsia;"  >ss<span style="color:red;"  >,<span style="color:fuchsia;"  >ax<span style="color:black;"  >         </span></span></span></span></span></span></span></p><p><span style="color:black; font-size:9pt;"  ><span style="font-family:Times New Roman;"  >     <span style="color:blue;"  >mov<span style="color:black;"  >       <span style="color:fuchsia;"  >sp<span style="color:red;"  >,<span style="color:black;"  >DemoStackLen           <span style="color:#999999;"  ><em>;</em></span></span></span></span></span></span></span><span style="font-family:宋体;"  ><em>置数据段</em></span><span style="font-family:Times New Roman;"  >    </span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >    <span style="color:blue;"  >mov<span style="color:black;"  >      <span style="color:fuchsia;"  >ax<span style="color:red;"  >,<span style="color:black;"  >DemoData_Sel </span></span></span></span></span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >    <span style="color:blue;"  >mov<span style="color:black;"  >      <span style="color:fuchsia;"  >ds<span style="color:red;"  >,<span style="color:fuchsia;"  >ax<span style="color:black;"  >         </span></span></span></span></span></span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >    <span style="color:blue;"  >mov<span style="color:black;"  >      <span style="color:fuchsia;"  >es<span style="color:red;"  >,<span style="color:fuchsia;"  >ax<span style="color:black;"  >         </span></span></span></span></span></span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >    <span style="color:blue;"  >mov<span style="color:black;"  >      <span style="color:fuchsia;"  >fs<span style="color:red;"  >,<span style="color:fuchsia;"  >ax<span style="color:black;"  >         </span></span></span></span></span></span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >    <span style="color:blue;"  >mov<span style="color:black;"  >      <span style="color:fuchsia;"  >gs<span style="color:red;"  >,<span style="color:fuchsia;"  >ax<span style="color:black;"  >         </span></span></span></span></span></span></span></p><p><span style="color:black; font-size:9pt;"  ><span style="font-family:Times New Roman;"  >     <span style="color:blue;"  >mov<span style="color:black;"  >       <span style="color:fuchsia;"  >al<span style="color:red;"  >,<span style="color:#000099;"  >11111110b<span style="color:black;"  >           <span style="color:#999999;"  ><em>;</em></span></span></span></span></span></span></span></span><span style="font-family:宋体;"  ><em>置中断屏蔽字</em></span><span style="font-family:Times New Roman;"  >    </span></span></p><p><span style="color:black; font-size:9pt;"  ><span style="font-family:Times New Roman;"  >     <span style="color:blue;"  >out<span style="color:black;"  >     IMREGP<span style="color:red;"  >,<span style="color:fuchsia;"  >al<span style="color:black;"  >          <span style="color:#999999;"  ><em>;</em></span></span></span></span></span></span></span><span style="font-family:宋体;"  ><em>只开发时钟中断</em></span><span style="font-family:Times New Roman;"  >    </span></span></p><p><span style="color:black; font-size:9pt;"  ><span style="font-family:Times New Roman;"  >     <span style="color:blue;"  >sti<span style="color:black;"  >       <span style="color:#999999;"  ><em>;</em></span></span></span></span><span style="font-family:宋体;"  ><em>开中断</em></span><span style="font-family:Times New Roman;"  >    </span></span></p><p><span style="color:#990000; font-size:9pt;"  ><span style="font-family:Times New Roman;"  >DemoConti:<span style="color:black;"  >      <span style="color:blue;"  >cmp<span style="color:black;"  >        <span style="color:#009999;"  >BYTE<span style="color:black;"  >          <span style="color:#009999;"  >PTR<span style="color:black;"  > Flag<span style="color:red;"  >,<span style="color:#000099;"  >0<span style="color:black;"  >               <span style="color:#999999;"  ><em>;</em></span></span></span></span></span></span></span></span></span></span></span></span><span style="font-family:宋体;"  ><em>判标志</em></span><span style="color:black; font-family:Times New Roman;"  >    </span></span></p><p><span style="color:black; font-size:9pt;"  ><span style="font-family:Times New Roman;"  >     <span style="color:blue;"  >jz<span style="color:black;"  >      DemoConti                 <span style="color:#999999;"  ><em>;</em></span></span></span></span><span style="font-family:宋体;"  ><em>直到不为</em></span><span style="color:#999999; font-family:Times New Roman;"  ><em>0</em><span style="color:black;"  >     </span></span></span></p><p><span style="color:black; font-size:9pt;"  ><span style="font-family:Times New Roman;"  >     <span style="color:blue;"  >cli<span style="color:black;"  >       <span style="color:#999999;"  ><em>;</em></span></span></span></span><span style="font-family:宋体;"  ><em>关中断</em></span><span style="font-family:Times New Roman;"  >    </span></span></p><p><span style="color:black; font-size:9pt;"  ><span style="font-family:Times New Roman;"  >     <span style="color:#999999;"  ><em>;</em></span></span><span style="font-family:宋体;"  ><em>转回临时代码段</em></span><span style="color:#999999;"  ><em><span style="font-family:Times New Roman;"  >,</span><span style="font-family:宋体;"  >准备回实方式</span></em><span style="color:black; font-family:Times New Roman;"  >     </span></span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >    <span style="color:#009900;"  >JUMP16<span style="color:black;"  >  TempCode_Sel<span style="color:red;"  >,&lt;<span style="color:#009999;"  >OFFSET<span style="color:black;"  > ToDos<span style="color:red;"  >&gt;<span style="color:black;"  >          </span></span></span></span></span></span></span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >DemoBegin       <span style="color:#009999;"  >ENDP<span style="color:black;"  >     </span></span></span></p><p><span style="color:#999999; font-family:Times New Roman; font-size:9pt;"  ><em>;----------------------------------------------------------------------------</em><span style="color:black;"  >    </span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >DemoCodeLen     <span style="color:red;"  >=<span style="color:black;"  >      <span style="color:red;"  >$<span style="color:black;"  >       </span></span></span></span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >DemoCodeSeg     <span style="color:#009999;"  >ENDS<span style="color:black;"  >     </span></span></span></p><p><span style="color:#999999; font-family:Times New Roman; font-size:9pt;"  ><em>;----------------------------------------------------------------------------</em><span style="color:black;"  >    </span></span></p><p><span style="color:black; font-size:9pt;"  ><span style="font-family:Times New Roman;"  >TempCodeSeg     <span style="color:#009999;"  >SEGMENT<span style="color:black;"  >       <span style="color:#009999;"  >PARA<span style="color:black;"  >         <span style="color:#009999;"  >USE16<span style="color:black;"  >           <span style="color:#999999;"  ><em>;</em></span></span></span></span></span></span></span></span><span style="font-family:宋体;"  ><em>临时任务的代码段</em></span><span style="font-family:Times New Roman;"  >    </span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >    <span style="color:#009999;"  >ASSUME<span style="color:black;"  >      <span style="color:fuchsia;"  >CS<span style="color:black;"  >:TempCodeSeg </span></span></span></span></span></p><p><span style="color:#999999; font-family:Times New Roman; font-size:9pt;"  ><em>;----------------------------------------------------------------------------</em><span style="color:black;"  >    </span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >Virtual         <span style="color:#009999;"  >PROC<span style="color:black;"  >      <span style="color:#009999;"  >FAR<span style="color:black;"  >       </span></span></span></span></span></p><p><span style="color:black; font-size:9pt;"  ><span style="font-family:Times New Roman;"  >     <span style="color:#009900;"  >JUMP16<span style="color:black;"  >  DemoCode_Sel<span style="color:red;"  >,<span style="color:black;"  >DemoBegin    <span style="color:#999999;"  ><em>;</em></span></span></span></span></span></span><span style="font-family:宋体;"  ><em>转演示任务</em></span><span style="font-family:Times New Roman;"  >    </span></span></p><p><span style="color:#990000; font-size:9pt;"  ><span style="font-family:Times New Roman;"  >ToDos:<span style="color:black;"  >      <span style="color:blue;"  >mov<span style="color:black;"  >        <span style="color:fuchsia;"  >ax<span style="color:red;"  >,<span style="color:black;"  >Normal_Sel             <span style="color:#999999;"  ><em>;</em></span></span></span></span></span></span></span></span><span style="font-family:宋体;"  ><em>恢复实方式段描述符高速缓存</em></span><span style="color:black; font-family:Times New Roman;"  >    </span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >    <span style="color:blue;"  >mov<span style="color:black;"  >      <span style="color:fuchsia;"  >ds<span style="color:red;"  >,<span style="color:fuchsia;"  >ax<span style="color:black;"  >         </span></span></span></span></span></span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >    <span style="color:blue;"  >mov<span style="color:black;"  >      <span style="color:fuchsia;"  >es<span style="color:red;"  >,<span style="color:fuchsia;"  >ax<span style="color:black;"  >         </span></span></span></span></span></span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >    <span style="color:blue;"  >mov<span style="color:black;"  >      <span style="color:fuchsia;"  >fs<span style="color:red;"  >,<span style="color:fuchsia;"  >ax<span style="color:black;"  >         </span></span></span></span></span></span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >    <span style="color:blue;"  >mov<span style="color:black;"  >      <span style="color:fuchsia;"  >gs<span style="color:red;"  >,<span style="color:fuchsia;"  >ax<span style="color:black;"  >         </span></span></span></span></span></span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >    <span style="color:blue;"  >mov<span style="color:black;"  >      <span style="color:fuchsia;"  >ss<span style="color:red;"  >,<span style="color:fuchsia;"  >ax<span style="color:black;"  >         </span></span></span></span></span></span></span></p><p><span style="color:black; font-size:9pt;"  ><span style="font-family:Times New Roman;"  >     <span style="color:blue;"  >mov<span style="color:black;"  >       <span style="color:fuchsia;"  >eax<span style="color:red;"  >,<span style="color:fuchsia;"  >cr0<span style="color:black;"  >           <span style="color:#999999;"  ><em>;</em></span></span></span></span></span></span></span></span><span style="font-family:宋体;"  ><em>准备返回实模式</em></span><span style="font-family:Times New Roman;"  >    </span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >    <span style="color:blue;"  >and<span style="color:black;"  >      <span style="color:fuchsia;"  >al<span style="color:red;"  >,<span style="color:#000099;"  >11111110b<span style="color:black;"  >         </span></span></span></span></span></span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >    <span style="color:blue;"  >mov<span style="color:black;"  >      <span style="color:fuchsia;"  >cr0<span style="color:red;"  >,<span style="color:fuchsia;"  >eax<span style="color:black;"  >         </span></span></span></span></span></span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >    <span style="color:#009900;"  >JUMP16<span style="color:black;"  >      <span style="color:red;"  >&lt;<span style="color:#009999;"  >SEG<span style="color:black;"  > Real<span style="color:red;"  >&gt;,&lt;<span style="color:#009999;"  >OFFSET<span style="color:black;"  > Real<span style="color:red;"  >&gt;<span style="color:black;"  >             </span></span></span></span></span></span></span></span></span></span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >Virtual         <span style="color:#009999;"  >ENDP<span style="color:black;"  >     </span></span></span></p><p><span style="color:#999999; font-family:Times New Roman; font-size:9pt;"  ><em>;----------------------------------------------------------------------------</em><span style="color:black;"  >    </span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >TempCodeSeg     <span style="color:#009999;"  >ENDS<span style="color:black;"  >     </span></span></span></p><p><span style="color:#999999; font-family:Times New Roman; font-size:9pt;"  ><em>;============================================================================</em><span style="color:black;"  >    </span></span></p><p><span style="color:black; font-size:9pt;"  ><span style="font-family:Times New Roman;"  >RDataSeg        <span style="color:#009999;"  >SEGMENT<span style="color:black;"  >       <span style="color:#009999;"  >PARA<span style="color:black;"  >         <span style="color:#009999;"  >USE16<span style="color:black;"  >           <span style="color:#999999;"  ><em>;</em></span></span></span></span></span></span></span></span><span style="font-family:宋体;"  ><em>实方式数据段</em></span><span style="font-family:Times New Roman;"  >    </span></span></p><p><span style="color:black; font-size:9pt;"  ><span style="font-family:Times New Roman;"  >VGDTR           PDesc   <span style="color:red;"  >&lt;<span style="color:black;"  >GDTLen<span style="color:red;"  >-<span style="color:#000099;"  >1<span style="color:red;"  >,&gt;<span style="color:black;"  >           <span style="color:#999999;"  ><em>;GDT</em></span></span></span></span></span></span></span></span><span style="font-family:宋体;"  ><em>伪描述符</em></span><span style="font-family:Times New Roman;"  >    </span></span></p><p><span style="color:black; font-size:9pt;"  ><span style="font-family:Times New Roman;"  >VIDTR           PDesc   <span style="color:red;"  >&lt;<span style="color:black;"  >IDTLen<span style="color:red;"  >-<span style="color:#000099;"  >1<span style="color:red;"  >,&gt;<span style="color:black;"  >           <span style="color:#999999;"  ><em>;IDT</em></span></span></span></span></span></span></span></span><span style="font-family:宋体;"  ><em>伪描述符</em></span><span style="font-family:Times New Roman;"  >    </span></span></p><p><span style="color:black; font-size:9pt;"  ><span style="font-family:Times New Roman;"  >NORVIDTR        PDesc   <span style="color:red;"  >&lt;<span style="color:#000099;"  >3ffh<span style="color:red;"  >,&gt;<span style="color:black;"  >         <span style="color:#999999;"  ><em>;</em></span></span></span></span></span></span><span style="font-family:宋体;"  ><em>用于保存原</em></span><span style="color:#999999;"  ><em><span style="font-family:Times New Roman;"  >IDTR</span><span style="font-family:宋体;"  >值</span></em><span style="color:black; font-family:Times New Roman;"  >     </span></span></span></p><p><span style="color:black; font-size:9pt;"  ><span style="font-family:Times New Roman;"  >SPVar           <span style="color:#009999;"  >DW<span style="color:black;"  >       <span style="color:red;"  >?<span style="color:black;"  >         <span style="color:#999999;"  ><em>;</em></span></span></span></span></span></span><span style="font-family:宋体;"  ><em>用于保存实方式下的</em></span><span style="color:#999999; font-family:Times New Roman;"  ><em>SP</em><span style="color:black;"  >     </span></span></span></p><p><span style="color:black; font-size:9pt;"  ><span style="font-family:Times New Roman;"  >SSVar           <span style="color:#009999;"  >DW<span style="color:black;"  >       <span style="color:red;"  >?<span style="color:black;"  >         <span style="color:#999999;"  ><em>;</em></span></span></span></span></span></span><span style="font-family:宋体;"  ><em>用于保存实方式下的</em></span><span style="color:#999999; font-family:Times New Roman;"  ><em>SS</em><span style="color:black;"  >     </span></span></span></p><p><span style="color:black; font-size:9pt;"  ><span style="font-family:Times New Roman;"  >IMaskRegV       <span style="color:#009999;"  >DB<span style="color:black;"  >       <span style="color:red;"  >?<span style="color:black;"  >         <span style="color:#999999;"  ><em>;</em></span></span></span></span></span></span><span style="font-family:宋体;"  ><em>用于保存原中断屏蔽寄存器值</em></span><span style="font-family:Times New Roman;"  >    </span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >RDataSeg        <span style="color:#009999;"  >ENDS<span style="color:black;"  >     </span></span></span></p><p><span style="color:#999999; font-family:Times New Roman; font-size:9pt;"  ><em>;----------------------------------------------------------------------------</em><span style="color:black;"  >    </span></span></p><p><span style="color:black; font-size:9pt;"  ><span style="font-family:Times New Roman;"  >RCodeSeg        <span style="color:#009999;"  >SEGMENT<span style="color:black;"  >       <span style="color:#009999;"  >PARA<span style="color:black;"  >         <span style="color:#009999;"  >USE16<span style="color:black;"  >           <span style="color:#999999;"  ><em>;</em></span></span></span></span></span></span></span></span><span style="font-family:宋体;"  ><em>实方式代码段</em></span><span style="font-family:Times New Roman;"  >    </span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >    <span style="color:#009999;"  >ASSUME<span style="color:black;"  >      <span style="color:fuchsia;"  >CS<span style="color:black;"  >:RCodeSeg<span style="color:red;"  >,<span style="color:fuchsia;"  >DS<span style="color:black;"  >:RDataSeg </span></span></span></span></span></span></span></span></p><p><span style="color:#999999; font-family:Times New Roman; font-size:9pt;"  ><em>;----------------------------------------------------------------------------</em><span style="color:black;"  >    </span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >Start           <span style="color:#009999;"  >PROC<span style="color:black;"  >     </span></span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >    <span style="color:blue;"  >mov<span style="color:black;"  >      <span style="color:fuchsia;"  >ax<span style="color:red;"  >,<span style="color:black;"  >RDataSeg </span></span></span></span></span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >    <span style="color:blue;"  >mov<span style="color:black;"  >      <span style="color:fuchsia;"  >ds<span style="color:red;"  >,<span style="color:fuchsia;"  >ax<span style="color:black;"  >         </span></span></span></span></span></span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >    <span style="color:blue;"  >cld<span style="color:black;"  >     </span></span></span></p><p><span style="color:black; font-size:9pt;"  ><span style="font-family:Times New Roman;"  >     <span style="color:blue;"  >call<span style="color:black;"  >    InitGDT                   <span style="color:#999999;"  ><em>;</em></span></span></span></span><span style="font-family:宋体;"  ><em>初始化全局描述符表</em></span><span style="color:#999999; font-family:Times New Roman;"  ><em>GDT</em><span style="color:black;"  >     </span></span></span></p><p><span style="color:black; font-size:9pt;"  ><span style="font-family:Times New Roman;"  >     <span style="color:blue;"  >call<span style="color:black;"  >    InitIDT                   <span style="color:#999999;"  ><em>;</em></span></span></span></span><span style="font-family:宋体;"  ><em>初始化中断描述符表</em></span><span style="color:#999999; font-family:Times New Roman;"  ><em>IDT</em><span style="color:black;"  >     </span></span></span></p><p><span style="color:black; font-size:9pt;"  ><span style="font-family:Times New Roman;"  >     <span style="color:blue;"  >mov<span style="color:black;"  >     SSVar<span style="color:red;"  >,<span style="color:fuchsia;"  >ss<span style="color:black;"  >          <span style="color:#999999;"  ><em>;</em></span></span></span></span></span></span></span><span style="font-family:宋体;"  ><em>保存堆栈指针</em></span><span style="font-family:Times New Roman;"  >    </span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >    <span style="color:blue;"  >mov<span style="color:black;"  >     SPVar<span style="color:red;"  >,<span style="color:fuchsia;"  >sp<span style="color:black;"  >        </span></span></span></span></span></span></p><p><span style="color:black; font-size:9pt;"  ><span style="font-family:Times New Roman;"  >     <span style="color:blue;"  >sidt<span style="color:black;"  >       <span style="color:#009999;"  >QWORD<span style="color:black;"  >         <span style="color:#009999;"  >PTR<span style="color:black;"  > NORVIDTR        <span style="color:#999999;"  ><em>;</em></span></span></span></span></span></span></span></span><span style="font-family:宋体;"  ><em>保存</em></span><span style="color:#999999; font-family:Times New Roman;"  ><em>IDTR</em><span style="color:black;"  >     </span></span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >    <span style="color:blue;"  >in<span style="color:black;"  >      <span style="color:fuchsia;"  >al<span style="color:red;"  >,<span style="color:black;"  >IMREGP </span></span></span></span></span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >    <span style="color:blue;"  >mov<span style="color:black;"  >      <span style="color:#009999;"  >BYTE<span style="color:black;"  >        <span style="color:#009999;"  >PTR<span style="color:black;"  > IMaskRegV<span style="color:red;"  >,<span style="color:fuchsia;"  >al<span style="color:black;"  >            </span></span></span></span></span></span></span></span></span></span></p><p><span style="color:black; font-size:9pt;"  ><span style="font-family:Times New Roman;"  >     <span style="color:blue;"  >lgdt<span style="color:black;"  >       <span style="color:#009999;"  >QWORD<span style="color:black;"  >         <span style="color:#009999;"  >PTR<span style="color:black;"  > VGDTR           <span style="color:#999999;"  ><em>;</em></span></span></span></span></span></span></span></span><span style="font-family:宋体;"  ><em>装载</em></span><span style="color:#999999; font-family:Times New Roman;"  ><em>GDTR</em><span style="color:black;"  >     </span></span></span></p><p><span style="color:black; font-size:9pt;"  ><span style="font-family:Times New Roman;"  >     <span style="color:blue;"  >cli<span style="color:black;"  >       <span style="color:#999999;"  ><em>;</em></span></span></span></span><span style="font-family:宋体;"  ><em>关中断</em></span><span style="font-family:Times New Roman;"  >    </span></span></p><p><span style="color:black; font-size:9pt;"  ><span style="font-family:Times New Roman;"  >     <span style="color:blue;"  >lidt<span style="color:black;"  >       <span style="color:#009999;"  >QWORD<span style="color:black;"  >         <span style="color:#009999;"  >PTR<span style="color:black;"  > VIDTR           <span style="color:#999999;"  ><em>;</em></span></span></span></span></span></span></span></span><span style="font-family:宋体;"  ><em>装载</em></span><span style="color:#999999; font-family:Times New Roman;"  ><em>IDTR</em><span style="color:black;"  >     </span></span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >    <span style="color:blue;"  >mov<span style="color:black;"  >      <span style="color:fuchsia;"  >eax<span style="color:red;"  >,<span style="color:fuchsia;"  >cr0<span style="color:black;"  >         </span></span></span></span></span></span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >    <span style="color:blue;"  >or<span style="color:black;"  >      <span style="color:fuchsia;"  >al<span style="color:red;"  >,<span style="color:#000099;"  >1<span style="color:black;"  >         </span></span></span></span></span></span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >    <span style="color:blue;"  >mov<span style="color:black;"  >      <span style="color:fuchsia;"  >cr0<span style="color:red;"  >,<span style="color:fuchsia;"  >eax<span style="color:black;"  >         </span></span></span></span></span></span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >    <span style="color:#009900;"  >JUMP16<span style="color:black;"  >      <span style="color:red;"  >&lt;<span style="color:black;"  >TempCode_Sel<span style="color:red;"  >&gt;,&lt;<span style="color:#009999;"  >OFFSET<span style="color:black;"  > Virtual<span style="color:red;"  >&gt;<span style="color:black;"  >            </span></span></span></span></span></span></span></span></span></span></p><p><span style="color:#990000; font-family:Times New Roman; font-size:9pt;"  >Real:<span style="color:black;"  >     <span style="color:blue;"  >mov<span style="color:black;"  >       <span style="color:fuchsia;"  >ax<span style="color:red;"  >,<span style="color:black;"  >RDataSeg </span></span></span></span></span></span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >    <span style="color:blue;"  >mov<span style="color:black;"  >      <span style="color:fuchsia;"  >ds<span style="color:red;"  >,<span style="color:fuchsia;"  >ax<span style="color:black;"  >         </span></span></span></span></span></span></span></p><p><span style="color:black; font-size:9pt;"  ><span style="font-family:Times New Roman;"  >     <span style="color:blue;"  >lss<span style="color:black;"  >       <span style="color:fuchsia;"  >sp<span style="color:red;"  >,<span style="color:#009999;"  >DWORD<span style="color:black;"  >           <span style="color:#009999;"  >PTR<span style="color:black;"  > SPVar        <span style="color:#999999;"  ><em>;</em></span></span></span></span></span></span></span></span></span></span><span style="font-family:宋体;"  ><em>又回<span style="color:#999999;"  >到实方式</span></em></span><span style="color:black; font-family:Times New Roman;"  >    </span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >    <span style="color:blue;"  >lidt<span style="color:black;"  >      <span style="color:#009999;"  >QWORD<span style="color:black;"  >        <span style="color:#009999;"  >PTR<span style="color:black;"  > NORVIDTR </span></span></span></span></span></span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >    <span style="color:blue;"  >mov<span style="color:black;"  >      <span style="color:fuchsia;"  >al<span style="color:red;"  >,<span style="color:black;"  >IMaskRegV </span></span></span></span></span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >    <span style="color:blue;"  >out<span style="color:black;"  >     IMREGP<span style="color:red;"  >,<span style="color:fuchsia;"  >al<span style="color:black;"  >        </span></span></span></span></span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >    <span style="color:blue;"  >sti<span style="color:black;"  >     </span></span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >    <span style="color:blue;"  >mov<span style="color:black;"  >      <span style="color:fuchsia;"  >ax<span style="color:red;"  >,<span style="color:#000099;"  >4c00h<span style="color:black;"  >         </span></span></span></span></span></span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >    <span style="color:blue;"  >int<span style="color:black;"  >      <span style="color:#000099;"  >21h<span style="color:black;"  >       </span></span></span></span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >Start           <span style="color:#009999;"  >ENDP<span style="color:black;"  >     </span></span></span></p><p><span style="color:#999999; font-family:Times New Roman; font-size:9pt;"  ><em>;----------------------------------------------------------------------------</em><span style="color:black;"  >    </span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >InitGDT         <span style="color:#009999;"  >PROC<span style="color:black;"  >     </span></span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >    <span style="color:blue;"  >push<span style="color:black;"  >      <span style="color:fuchsia;"  >ds<span style="color:black;"  >       </span></span></span></span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >    <span style="color:blue;"  >mov<span style="color:black;"  >      <span style="color:fuchsia;"  >ax<span style="color:red;"  >,<span style="color:black;"  >GDTSeg </span></span></span></span></span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >    <span style="color:blue;"  >mov<span style="color:black;"  >      <span style="color:fuchsia;"  >ds<span style="color:red;"  >,<span style="color:fuchsia;"  >ax<span style="color:black;"  >         </span></span></span></span></span></span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >    <span style="color:blue;"  >mov<span style="color:black;"  >      <span style="color:fuchsia;"  >cx<span style="color:red;"  >,<span style="color:black;"  >GDNum </span></span></span></span></span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >    <span style="color:blue;"  >mov<span style="color:black;"  >      <span style="color:fuchsia;"  >si<span style="color:red;"  >,<span style="color:#009999;"  >OFFSET<span style="color:black;"  > EFFGDT </span></span></span></span></span></span></span></p><p><span style="color:#990000; font-family:Times New Roman; font-size:9pt;"  >InitG:<span style="color:black;"  >     <span style="color:blue;"  >mov<span style="color:black;"  >       <span style="color:fuchsia;"  >ax<span style="color:red;"  >,[<span style="color:fuchsia;"  >si<span style="color:red;"  >].<span style="color:black;"  >BaseL </span></span></span></span></span></span></span></span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >    <span style="color:blue;"  >movzx<span style="color:black;"  >      <span style="color:fuchsia;"  >eax<span style="color:red;"  >,<span style="color:fuchsia;"  >ax<span style="color:black;"  >         </span></span></span></span></span></span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >    <span style="color:blue;"  >shl<span style="color:black;"  >      <span style="color:fuchsia;"  >eax<span style="color:red;"  >,<span style="color:#000099;"  >4<span style="color:black;"  >         </span></span></span></span></span></span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >    <span style="color:blue;"  >shld<span style="color:black;"  >      <span style="color:fuchsia;"  >edx<span style="color:red;"  >,<span style="color:fuchsia;"  >eax<span style="color:red;"  >,<span style="color:#000099;"  >16<span style="color:black;"  >           </span></span></span></span></span></span></span></span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >    <span style="color:blue;"  >mov<span style="color:black;"  >      <span style="color:#009999;"  >WORD<span style="color:black;"  >        <span style="color:#009999;"  >PTR<span style="color:black;"  >          <span style="color:red;"  >[<span style="color:fuchsia;"  >si<span style="color:red;"  >].<span style="color:black;"  >BaseL<span style="color:red;"  >,<span style="color:fuchsia;"  >ax<span style="color:black;"  >                </span></span></span></span></span></span></span></span></span></span></span></span></span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >    <span style="color:blue;"  >mov<span style="color:black;"  >      <span style="color:#009999;"  >BYTE<span style="color:black;"  >        <span style="color:#009999;"  >PTR<span style="color:black;"  >          <span style="color:red;"  >[<span style="color:fuchsia;"  >si<span style="color:red;"  >].<span style="color:black;"  >BaseM<span style="color:red;"  >,<span style="color:fuchsia;"  >dl<span style="color:black;"  >                </span></span></span></span></span></span></span></span></span></span></span></span></span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >    <span style="color:blue;"  >mov<span style="color:black;"  >      <span style="color:#009999;"  >BYTE<span style="color:black;"  >        <span style="color:#009999;"  >PTR<span style="color:black;"  >          <span style="color:red;"  >[<span style="color:fuchsia;"  >si<span style="color:red;"  >].<span style="color:black;"  >BaseH<span style="color:red;"  >,<span style="color:fuchsia;"  >dh<span style="color:black;"  >                </span></span></span></span></span></span></span></span></span></span></span></span></span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >    <span style="color:blue;"  >add<span style="color:black;"  >      <span style="color:fuchsia;"  >si<span style="color:red;"  >,<span style="color:#009999;"  >SIZE<span style="color:black;"  > Desc </span></span></span></span></span></span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >    <span style="color:blue;"  >loop<span style="color:black;"  >    InitG </span></span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >    <span style="color:blue;"  >pop<span style="color:black;"  >      <span style="color:fuchsia;"  >ds<span style="color:black;"  >       </span></span></span></span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >    <span style="color:blue;"  >mov<span style="color:black;"  >      <span style="color:fuchsia;"  >bx<span style="color:red;"  >,<span style="color:#000099;"  >16<span style="color:black;"  >         </span></span></span></span></span></span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >    <span style="color:blue;"  >mov<span style="color:black;"  >      <span style="color:fuchsia;"  >ax<span style="color:red;"  >,<span style="color:black;"  >GDTSeg </span></span></span></span></span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >    <span style="color:blue;"  >mul<span style="color:black;"  >      <span style="color:fuchsia;"  >bx<span style="color:black;"  >       </span></span></span></span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >    <span style="color:blue;"  >mov<span style="color:black;"  >      <span style="color:#009999;"  >WORD<span style="color:black;"  >        <span style="color:#009999;"  >PTR<span style="color:black;"  > VGDTR<span style="color:red;"  >.<span style="color:black;"  >Base<span style="color:red;"  >,<span style="color:fuchsia;"  >ax<span style="color:black;"  >              </span></span></span></span></span></span></span></span></span></span></span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >    <span style="color:blue;"  >mov<span style="color:black;"  >      <span style="color:#009999;"  >WORD<span style="color:black;"  >        <span style="color:#009999;"  >PTR<span style="color:black;"  > VGDTR<span style="color:red;"  >.<span style="color:black;"  >Base<span style="color:red;"  >+<span style="color:#000099;"  >2<span style="color:red;"  >,<span style="color:fuchsia;"  >dx<span style="color:black;"  >                </span></span></span></span></span></span></span></span></span></span></span></span></span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >    <span style="color:blue;"  >ret<span style="color:black;"  >     </span></span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >InitGDT         <span style="color:#009999;"  >ENDP<span style="color:black;"  >     </span></span></span></p><p><span style="color:#999999; font-family:Times New Roman; font-size:9pt;"  ><em>;----------------------------------------------------------------------------</em><span style="color:black;"  >    </span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >InitIDT         <span style="color:#009999;"  >PROC<span style="color:black;"  >     </span></span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >    <span style="color:blue;"  >mov<span style="color:black;"  >      <span style="color:fuchsia;"  >bx<span style="color:red;"  >,<span style="color:#000099;"  >16<span style="color:black;"  >         </span></span></span></span></span></span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >    <span style="color:blue;"  >mov<span style="color:black;"  >      <span style="color:fuchsia;"  >ax<span style="color:red;"  >,<span style="color:black;"  >IDTSeg </span></span></span></span></span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >    <span style="color:blue;"  >mul<span style="color:black;"  >      <span style="color:fuchsia;"  >bx<span style="color:black;"  >       </span></span></span></span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >    <span style="color:blue;"  >mov<span style="color:black;"  >      <span style="color:#009999;"  >WORD<span style="color:black;"  >        <span style="color:#009999;"  >PTR<span style="color:black;"  > VIDTR<span style="color:red;"  >.<span style="color:black;"  >Base<span style="color:red;"  >,<span style="color:fuchsia;"  >ax<span style="color:black;"  >              </span></span></span></span></span></span></span></span></span></span></span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >    <span style="color:blue;"  >mov<span style="color:black;"  >      <span style="color:#009999;"  >WORD<span style="color:black;"  >        <span style="color:#009999;"  >PTR<span style="color:black;"  > VIDTR<span style="color:red;"  >.<span style="color:black;"  >Base<span style="color:red;"  >+<span style="color:#000099;"  >2<span style="color:red;"  >,<span style="color:fuchsia;"  >dx<span style="color:black;"  >                </span></span></span></span></span></span></span></span></span></span></span></span></span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >    <span style="color:blue;"  >ret<span style="color:black;"  >     </span></span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >InitIDT         <span style="color:#009999;"  >ENDP<span style="color:black;"  >     </span></span></span></p><p><span style="color:#999999; font-family:Times New Roman; font-size:9pt;"  ><em>;----------------------------------------------------------------------------</em><span style="color:black;"  >    </span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >RCodeSeg        <span style="color:#009999;"  >ENDS<span style="color:black;"  >     </span></span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >    <span style="color:#009999;"  >END<span style="color:black;"  >     Start </span></span></span></p><p><span style="color:red; font-family:Batang; font-size:13pt;"  ><strong>2.关于实例六的说明 </strong></span></p><p><span style="color:fuchsia; font-family:Batang; font-size:12pt;"  ><strong>(1)时钟中断仍使用8H号中断向量 </strong></span></p><p><span style="color:black; font-size:9pt;"  ><span style="font-family:宋体;"  >为了即简单又清楚地演示在保护模式下响应外部中断并进行处理，实例使用了时钟中断源，</span><span style="font-family:Times New Roman;"  >    </span><span style="font-family:宋体;"  >但没有通过重新设置中断控制器的方法改变对应的中断向量。所以，时钟中断使用的</span><span style="font-family:Times New Roman;"  >8H</span><span style="font-family:宋体;"  >号中</span><span style="font-family:Times New Roman;"  >    </span><span style="font-family:宋体;"  >断向量号就与双重故障异常使用的中断向量号发生冲突。但实例仅是演示程序，所以只要保</span><span style="font-family:Times New Roman;"  >    </span><span style="font-family:宋体;"  >证不发生双重故障异常，就可避免冲突，从而不会影响演示。</span><span style="font-family:Times New Roman;"  >    </span></span></p><p><span style="color:black; font-size:9pt;"  ><span style="font-family:宋体;"  >设置中断屏蔽寄存器，仅开放时钟中断。所以，在开中断状态下，也只可能发生时钟中断，</span><span style="font-family:Times New Roman;"  >    </span><span style="font-family:宋体;"  >而不会发生其它外部中断。</span><span style="font-family:Times New Roman;"  >    </span></span></p><p><span style="color:fuchsia; font-family:Batang; font-size:12pt;"  ><strong>(2)时钟中断处理程序的设计 </strong></span></p><p><span style="color:black; font-size:9pt;"  ><span style="font-family:宋体;"  >由于通过中断门转时钟中断处理程序，所以在控制转移时不发生任务切换。但外部中断随时</span><span style="font-family:Times New Roman;"  >    </span><span style="font-family:宋体;"  >可能发生，因此中断处理程序必须采取保护现场等措施。作为演示程序，该中断处理程序检</span><span style="font-family:Times New Roman;"  >    </span><span style="font-family:宋体;"  >查和调整在其数据段中的计数器，满</span><span style="font-family:Times New Roman;"  >18</span><span style="font-family:宋体;"  >次后，就认为已满一秒，再调整用于显示的倒计数信</span><span style="font-family:Times New Roman;"  >    </span><span style="font-family:宋体;"  >息。如果倒计数信息为</span><span style="font-family:Times New Roman;"  >0</span><span style="font-family:宋体;"  >，那么就设置演示程序数据段中的时间为</span><span style="font-family:Times New Roman;"  >0</span><span style="font-family:宋体;"  >标志。该中断处理程序通</span><span style="font-family:Times New Roman;"  >    </span><span style="font-family:宋体;"  >过约定的数据区与显示程序及演示程序交换信息。</span><span style="font-family:Times New Roman;"  >    </span></span></p><p><span style="color:fuchsia; font-family:Batang; font-size:12pt;"  ><strong>(3)利用一个软中断(陷阱处理)程序实现显示 </strong></span></p><p><span style="color:black; font-size:9pt;"  ><span style="font-family:宋体;"  >为了演示陷阱及其处理，把显示过程安排成陷阱处理程序。上述时钟中断处理程序通过软中</span><span style="font-family:Times New Roman;"  >    </span><span style="font-family:宋体;"  >断调用指令</span><span style="font-family:Times New Roman;"  >INT</span><span style="font-family:宋体;"  >调用该显示程序，以显示倒计数。在控制转移时，也没有任务切换。该陷阱</span><span style="font-family:Times New Roman;"  >    </span><span style="font-family:宋体;"  >处理程序相当于一个</span><span style="font-family:Times New Roman;"  >"</span><span style="font-family:宋体;"  >软中断</span><span style="font-family:Times New Roman;"  >"</span><span style="font-family:宋体;"  >处理程序，类似实模式下的</span><span style="font-family:Times New Roman;"  >BIOS</span><span style="font-family:宋体;"  >中断</span><span style="font-family:Times New Roman;"  >INT 10H</span><span style="font-family:宋体;"  >。</span><span style="font-family:Times New Roman;"  >    </span></span></p><p><span style="color:fuchsia; font-family:Batang; font-size:12pt;"  ><strong>(4)对其它中断或异常的响应 </strong></span></p><p><span style="color:black; font-size:9pt;"  ><span style="font-family:宋体;"  >为了简单，除了</span><span style="font-family:Times New Roman;"  >8H</span><span style="font-family:宋体;"  >号和</span><span style="font-family:Times New Roman;"  >0FEH</span><span style="font-family:宋体;"  >号外，</span><span style="font-family:Times New Roman;"  >IDT</span><span style="font-family:宋体;"  >中其它的门均通向一个处理程序。该处理程序用于处</span><span style="font-family:Times New Roman;"  >    </span><span style="font-family:宋体;"  >理其它中断或异常。处理过程也极其简单，在屏幕左上角显示蓝底白字的符号</span><span style="font-family:Times New Roman;"  >"!"</span><span style="font-family:宋体;"  >，然后</span><span style="font-family:Times New Roman;"  >    </span><span style="font-family:宋体;"  >进入无限循环。实际上，按演示程序现在的安排，不可能发生这种情况。</span><span style="font-family:Times New Roman;"  >    </span></span></p><p><span style="color:fuchsia; font-family:Batang; font-size:12pt;"  ><strong>(5)没有特权级变换 </strong></span></p><p><span style="color:black; font-size:9pt;"  ><span style="font-family:宋体;"  >为了简单，实例涉及的中断处理程序和异常处理程序都保持特权级</span><span style="font-family:Times New Roman;"  >0</span><span style="font-family:宋体;"  >。所以，控制转移时不</span><span style="font-family:Times New Roman;"  >    </span><span style="font-family:宋体;"  >发生特权级变换。因此，没有使用其它堆栈。</span><span style="font-family:Times New Roman;"  >    </span></span></p><p><span style="color:fuchsia; font-family:Batang; font-size:12pt;"  ><strong>(6)对IDT的初始化 </strong></span></p><p><span style="color:black; font-size:9pt;"  ><span style="font-family:宋体;"  >由于</span><span style="font-family:Times New Roman;"  >IDT</span><span style="font-family:宋体;"  >中门描述符没有</span><span style="font-family:Times New Roman;"  >32</span><span style="font-family:宋体;"  >位段基地址，并且入口点偏移较小，所以就直接填写门描述符结</span><span style="font-family:Times New Roman;"  >    </span><span style="font-family:宋体;"  >构变量，没有额外再初始化。过程</span><span style="font-family:Times New Roman;"  >InitIDT</span><span style="font-family:宋体;"  >只是设置</span><span style="font-family:Times New Roman;"  >IDT</span><span style="font-family:宋体;"  >伪描述符。</span><span style="font-family:Times New Roman;"  >    </span></span></p><p><span style="color:fuchsia; font-family:Batang; font-size:12pt;"  ><strong>(7)装载和保存IDTR寄存器 </strong></span></p><p><span style="color:black; font-size:9pt;"  ><span style="font-family:宋体;"  >再使</span><span style="font-family:Times New Roman;"  >IDT</span><span style="font-family:宋体;"  >发挥作用之前，还要装载中断描述符表寄存器</span><span style="font-family:Times New Roman;"  >IDTR</span><span style="font-family:宋体;"  >；但为了回到实模式后，恢复原</span><span style="font-family:Times New Roman;"  >    </span><span style="font-family:宋体;"  >来的</span><span style="font-family:Times New Roman;"  >IDTR</span><span style="font-family:宋体;"  >之内容，所以先保存</span><span style="font-family:Times New Roman;"  >IDTR</span><span style="font-family:宋体;"  >的内容。实例使用如下指令保存</span><span style="font-family:Times New Roman;"  >IDTR</span><span style="font-family:宋体;"  >：</span><span style="font-family:Times New Roman;"  >    </span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >    <span style="color:blue;"  >sidt<span style="color:black;"  >      <span style="color:#009999;"  >QWORD<span style="color:black;"  >        <span style="color:#009999;"  >PTR<span style="color:black;"  > NORVIDTR </span></span></span></span></span></span></span></p><p><span style="color:black; font-size:9pt;"  ><span style="font-family:宋体;"  >该指令的功能是把</span><span style="font-family:Times New Roman;"  >IDTR</span><span style="font-family:宋体;"  >的内容保存到存储器中的伪描述符</span><span style="font-family:Times New Roman;"  >NORVIDTR</span><span style="font-family:宋体;"  >中。该伪描述符的结构如</span><span style="font-family:Times New Roman;"  >    </span><span style="font-family:宋体;"  >前文所述的结构类型</span><span style="font-family:Times New Roman;"  >PDESC</span><span style="font-family:宋体;"  >所示，低字是以字节为单位的界限，高双字是基地址。在后面的文</span><span style="font-family:Times New Roman;"  >    </span><span style="font-family:宋体;"  >章中将对</span><span style="font-family:Times New Roman;"  >SIDT</span><span style="font-family:宋体;"  >指令作详细说明。</span><span style="font-family:Times New Roman;"  >    </span></span></p><p><span style="color:black; font-size:9pt;"  ><span style="font-family:宋体;"  >本实例使用如下指令装载</span><span style="font-family:Times New Roman;"  >IDTR</span><span style="font-family:宋体;"  >寄存器：</span><span style="font-family:Times New Roman;"  >    </span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >    <span style="color:blue;"  >lidt<span style="color:black;"  >      <span style="color:#009999;"  >QWORD<span style="color:black;"  >        <span style="color:#009999;"  >PTR<span style="color:black;"  > VIDTR </span></span></span></span></span></span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >    <span style="color:blue;"  >lidt<span style="color:black;"  >      <span style="color:#009999;"  >QWORD<span style="color:black;"  >        <span style="color:#009999;"  >PTR<span style="color:black;"  > NORVIDTR </span></span></span></span></span></span></span></p><p><span style="color:black; font-size:9pt;"  ><span style="font-family:Times New Roman;"  >LIDT</span><span style="font-family:宋体;"  >指令类似于</span><span style="font-family:Times New Roman;"  >LGDT</span><span style="font-family:宋体;"  >指令，在后面的文章中将对</span><span style="font-family:Times New Roman;"  >LIDT</span><span style="font-family:宋体;"  >指令作详细说明。</span><span style="font-family:Times New Roman;"  >    </span></span></p><p><span style="color:red; font-family:Batang; font-size:18pt;"  ><strong>&lt;五&gt;演示异常处理的实例(实例七) </strong></span></p><p><span style="color:black; font-size:9pt;"  ><span style="font-family:宋体;"  >下面给出一个用于模拟异常和演示异常处理的实例。该实例的逻辑功能是，在屏幕上显示一条</span><span style="font-family:Times New Roman;"  >    </span><span style="font-family:宋体;"  >提示用户以按键方式选择异常类型的字符，然后模拟指定的异常。该实例演示内容包括：除法</span><span style="font-family:Times New Roman;"  >    </span><span style="font-family:宋体;"  >出错故障处理、溢出陷阱处理、段不存在故障处理、堆栈段出错处理和通用保护故障处理；还</span><span style="font-family:Times New Roman;"  >    </span><span style="font-family:宋体;"  >有作为一个独立任务方式出现的陷阱处理程序。</span><span style="font-family:Times New Roman;"  >    </span></span></p><p><span style="color:red; font-family:Batang; font-size:13pt;"  ><strong>1.源程序组织和清单 </strong></span></p><p><span style="color:black; font-size:9pt;"  ><span style="font-family:宋体;"  >为了演示以独立任务方式出现的陷阱处理程序，实例含有两个任务：演示任务和读键盘任务。</span><span style="font-family:Times New Roman;"  >    </span><span style="font-family:宋体;"  >实例由如下几部分组成：</span><span style="font-family:Times New Roman;"  >    </span></span></p><p><span style="color:black; font-size:9pt;"  ><span style="font-family:Times New Roman;"  >(1)</span><span style="font-family:宋体;"  >全局描述符表</span><span style="font-family:Times New Roman;"  >GDT</span><span style="font-family:宋体;"  >和中断描述符表</span><span style="font-family:Times New Roman;"  >IDT</span><span style="font-family:宋体;"  >；</span><span style="font-family:Times New Roman;"  >    </span></span></p><p><span style="color:black; font-size:9pt;"  ><span style="font-family:Times New Roman;"  >(2)</span><span style="font-family:宋体;"  >读键盘任务局部描述符表、任务状态段、堆栈段和代码段等；</span><span style="font-family:Times New Roman;"  >    </span></span></p><p><span style="color:black; font-size:9pt;"  ><span style="font-family:Times New Roman;"  >(3)</span><span style="font-family:宋体;"  >演示任务的局部描述符表、任务状态段、堆栈段、代码段和数据段等；</span><span style="font-family:Times New Roman;"  >    </span></span></p><p><span style="color:black; font-size:9pt;"  ><span style="font-family:Times New Roman;"  >(4)</span><span style="font-family:宋体;"  >作为演示任务一部分的有关陷阱处理和故障处理程序的代码段；</span><span style="font-family:Times New Roman;"  >    </span></span></p><p><span style="color:black; font-size:9pt;"  ><span style="font-family:Times New Roman;"  >(5)</span><span style="font-family:宋体;"  >作为演示任务一部分的显示出错码过程的代码段；</span><span style="font-family:Times New Roman;"  >    </span></span></p><p><span style="color:black; font-size:9pt;"  ><span style="font-family:Times New Roman;"  >(6)</span><span style="font-family:宋体;"  >实模式下执行的启动和结束程序代码段和数据段。</span><span style="font-family:Times New Roman;"  >    </span></span></p><p><span style="color:black; font-size:9pt;"  ><span style="font-family:宋体;"  >在切换到保护模式后，就进入临时代码段。为了简单，演示任务不发生特权级变换。演示步骤</span><span style="font-family:Times New Roman;"  >    </span><span style="font-family:宋体;"  >如下：</span><span style="font-family:Times New Roman;"  >    </span></span></p><p><span style="color:black; font-size:9pt;"  ><span style="font-family:Times New Roman;"  >(1)</span><span style="font-family:宋体;"  >从临时代码段转移到演示代码段。</span><span style="font-family:Times New Roman;"  >    </span></span></p><p><span style="color:black; font-size:9pt;"  ><span style="font-family:Times New Roman;"  >(2)</span><span style="font-family:宋体;"  >做演示准备。把演示任务的</span><span style="font-family:Times New Roman;"  >LDT</span><span style="font-family:宋体;"  >选择子装入</span><span style="font-family:Times New Roman;"  >LDTR</span><span style="font-family:宋体;"  >，并填入</span><span style="font-family:Times New Roman;"  >TSS</span><span style="font-family:宋体;"  >，装载任务寄存器</span><span style="font-family:Times New Roman;"  >TR</span><span style="font-family:宋体;"  >，建立演示</span><span style="font-family:Times New Roman;"  >    </span><span style="font-family:宋体;"  >任务堆栈，设置其它数据段寄存器。</span><span style="font-family:Times New Roman;"  >    </span></span></p><p><span style="color:black; font-size:9pt;"  ><span style="font-family:Times New Roman;"  >(3)</span><span style="font-family:宋体;"  >接收要模拟的异常类型号。通过软中断指令</span><span style="font-family:Times New Roman;"  >INT</span><span style="font-family:宋体;"  >调用读键盘任务完成该步骤。读键盘任务只</span><span style="font-family:Times New Roman;"  >    </span><span style="font-family:宋体;"  >有在接收到指定的字符后才结束。接收的字符是</span><span style="font-family:Times New Roman;"  >0</span><span style="font-family:宋体;"  >、</span><span style="font-family:Times New Roman;"  >4</span><span style="font-family:宋体;"  >、</span><span style="font-family:Times New Roman;"  >B</span><span style="font-family:宋体;"  >、</span><span style="font-family:Times New Roman;"  >C</span><span style="font-family:宋体;"  >和</span><span style="font-family:Times New Roman;"  >D</span><span style="font-family:宋体;"  >。</span><span style="font-family:Times New Roman;"  >    </span></span></p><p><span style="color:black; font-size:9pt;"  ><span style="font-family:宋体;"  >按接收的字符模拟异常。即根据键入的字符，执行有关程序片段。在这些片段中，有意安排了</span><span style="font-family:Times New Roman;"  >    </span><span style="font-family:宋体;"  >能引起有关故障或陷阱的指令。</span><span style="font-family:Times New Roman;"  >    </span></span></p><p><span style="color:black; font-size:9pt;"  ><span style="font-family:宋体;"  >结束演示，转临时代码段，返回</span><span style="font-family:Times New Roman;"  >DOS</span><span style="font-family:宋体;"  >。</span><span style="font-family:Times New Roman;"  >    </span></span></p><p><span style="color:black; font-size:9pt;"  ><span style="font-family:宋体;"  >程序清单如下：</span><span style="font-family:Times New Roman;"  >    </span></span></p><p><span style="color:#999999; font-size:9pt;"  ><em><span style="font-family:Times New Roman;"  >;</span><span style="font-family:宋体;"  >名称</span></em><span style="font-family:Times New Roman;"  ><em>:ASM7.ASM</em><span style="color:black;"  >     </span></span></span></p><p><span style="color:#999999; font-size:9pt;"  ><em><span style="font-family:Times New Roman;"  >;</span><span style="font-family:宋体;"  >功能</span><span style="font-family:Times New Roman;"  >:</span><span style="font-family:宋体;"  >模拟异常和演示异常处理</span></em><span style="color:black; font-family:Times New Roman;"  >    </span></span></p><p><span style="color:#999999; font-size:9pt;"  ><em><span style="font-family:Times New Roman;"  >;</span><span style="font-family:宋体;"  >编译</span></em><span style="font-family:Times New Roman;"  ><em>:TASM ASM7.ASM</em><span style="color:black;"  >     </span></span></span></p><p><span style="color:#999999; font-size:9pt;"  ><em><span style="font-family:Times New Roman;"  >;</span><span style="font-family:宋体;"  >连接</span></em><span style="font-family:Times New Roman;"  ><em>:TLINK ASM7.OBJ</em><span style="color:black;"  >     </span></span></span></p><p><span style="color:#999999; font-family:Times New Roman; font-size:9pt;"  ><em>;----------------------------------------------------------------------------</em><span style="color:black;"  >    </span></span></p><p><span style="color:#009999; font-family:Times New Roman; font-size:9pt;"  >INCLUDE<span style="color:black;"  >         386SCD.INC </span></span></p><p><span style="color:#999999; font-family:Times New Roman; font-size:9pt;"  ><em>;----------------------------------------------------------------------------</em><span style="color:black;"  >    </span></span></p><p><span style="color:black; font-size:9pt;"  ><span style="font-family:Times New Roman;"  >GDTSeg          <span style="color:#009999;"  >SEGMENT<span style="color:black;"  >       <span style="color:#009999;"  >PARA<span style="color:black;"  >         <span style="color:#009999;"  >USE16<span style="color:black;"  >           <span style="color:#999999;"  ><em>;</em></span></span></span></span></span></span></span></span><span style="font-family:宋体;"  ><em>全局描述符表数据段</em></span><span style="color:#999999;"  ><em><span style="font-family:Times New Roman;"  >(16</span><span style="font-family:宋体;"  >位</span></em><span style="font-family:Times New Roman;"  ><em>)</em><span style="color:black;"  >      </span></span></span></span></p><p><span style="color:#999999; font-family:Times New Roman; font-size:9pt;"  ><em>;----------------------------------------------------------------------------</em><span style="color:black;"  >    </span></span></p><p><span style="color:black; font-size:9pt;"  ><span style="font-family:Times New Roman;"  >     <span style="color:#999999;"  ><em>;</em></span></span><span style="font-family:宋体;"  ><em>全局描述符表</em></span><span style="color:#999999; font-family:Times New Roman;"  ><em>GDT</em><span style="color:black;"  >     </span></span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >GDT             <span style="color:#009999;"  >LABEL<span style="color:black;"  >      <span style="color:#009999;"  >BYTE<span style="color:black;"  >       </span></span></span></span></span></p><p><span style="color:black; font-size:9pt;"  ><span style="font-family:Times New Roman;"  >     <span style="color:#999999;"  ><em>;</em></span></span><span style="font-family:宋体;"  ><em>空描述符</em></span><span style="font-family:Times New Roman;"  >    </span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >DUMMY           Desc    <span style="color:red;"  >&lt;&gt;<span style="color:black;"  >     </span></span></span></p><p><span style="color:black; font-size:9pt;"  ><span style="font-family:Times New Roman;"  >     <span style="color:#999999;"  ><em>;</em></span></span><span style="font-family:宋体;"  ><em>规范段描述符及选择子</em></span><span style="font-family:Times New Roman;"  >    </span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >Normal          Desc    <span style="color:red;"  >&lt;<span style="color:#000099;"  >0ffffh<span style="color:red;"  >,,,<span style="color:black;"  >ATDW<span style="color:red;"  >,,&gt;<span style="color:black;"  >         </span></span></span></span></span></span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >Normal_Sel      <span style="color:red;"  >=<span style="color:black;"  >       Normal<span style="color:red;"  >-<span style="color:black;"  >GDT </span></span></span></span></span></p><p><span style="color:black; font-size:9pt;"  ><span style="font-family:Times New Roman;"  >     <span style="color:#999999;"  ><em>;</em></span></span><span style="font-family:宋体;"  ><em>视频缓冲区段描述符</em></span><span style="color:#999999;"  ><em><span style="font-family:Times New Roman;"  >(DPL=3)</span><span style="font-family:宋体;"  >及选择子</span></em><span style="color:black; font-family:Times New Roman;"  >     </span></span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >VideoBuf        Desc    <span style="color:red;"  >&lt;<span style="color:#000099;"  >0ffffh<span style="color:red;"  >,<span style="color:#000099;"  >8000h<span style="color:red;"  >,<span style="color:#000099;"  >0bh<span style="color:red;"  >,<span style="color:black;"  >ATDW<span style="color:red;"  >,,&gt;<span style="color:black;"  >             </span></span></span></span></span></span></span></span></span></span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >VideoBuf_Sel    <span style="color:red;"  >=<span style="color:black;"  >       VideoBuf<span style="color:red;"  >-<span style="color:black;"  >GDT </span></span></span></span></span></p><p><span style="color:#999999; font-family:Times New Roman; font-size:9pt;"  ><em>;----------------------------------------------------------------------------</em><span style="color:black;"  >    </span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >EFFGDT          <span style="color:#009999;"  >LABEL<span style="color:black;"  >      <span style="color:#009999;"  >BYTE<span style="color:black;"  >       </span></span></span></span></span></p><p><span style="color:black; font-size:9pt;"  ><span style="font-family:Times New Roman;"  >     <span style="color:#999999;"  ><em>;</em></span></span><span style="font-family:宋体;"  ><em>临时代码段描述符及选择子</em></span><span style="font-family:Times New Roman;"  >    </span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >TempCode        Desc    <span style="color:red;"  >&lt;<span style="color:#000099;"  >0ffffh<span style="color:red;"  >,<span style="color:black;"  >TempCodeSeg<span style="color:red;"  >,,<span style="color:black;"  >ATCE<span style="color:red;"  >,,&gt;<span style="color:black;"  >           </span></span></span></span></span></span></span></span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >TempCode_Sel    <span style="color:red;"  >=<span style="color:black;"  >       TempCode<span style="color:red;"  >-<span style="color:black;"  >GDT </span></span></span></span></span></p><p><span style="color:black; font-size:9pt;"  ><span style="font-family:Times New Roman;"  >     <span style="color:#999999;"  ><em>;</em></span></span><span style="font-family:宋体;"  ><em>演示代码段描述符及选择子</em></span><span style="font-family:Times New Roman;"  >    </span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >DemoCode        Desc    <span style="color:red;"  >&lt;<span style="color:black;"  >DemoCodeLen<span style="color:red;"  >-<span style="color:#000099;"  >1<span style="color:red;"  >,<span style="color:black;"  >DemoCodeSeg<span style="color:red;"  >,,<span style="color:black;"  >ATCE<span style="color:red;"  >,,&gt;<span style="color:black;"  >             </span></span></span></span></span></span></span></span></span></span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >DemoCode_Sel    <span style="color:red;"  >=<span style="color:black;"  >       DemoCode<span style="color:red;"  >-<span style="color:black;"  >GDT </span></span></span></span></span></p><p><span style="color:black; font-size:9pt;"  ><span style="font-family:Times New Roman;"  >     <span style="color:#999999;"  ><em>;</em></span></span><span style="font-family:宋体;"  ><em>演示任务局部描述符表段描述符及选择子</em></span><span style="font-family:Times New Roman;"  >    </span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >DemoLDT         Desc    <span style="color:red;"  >&lt;<span style="color:black;"  >DemoLDTLen<span style="color:red;"  >-<span style="color:#000099;"  >1<span style="color:red;"  >,<span style="color:black;"  >DemoLDTSeg<span style="color:red;"  >,,<span style="color:black;"  >ATLDT<span style="color:red;"  >,,&gt;<span style="color:black;"  >             </span></span></span></span></span></span></span></span></span></span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >DemoLDT_Sel     <span style="color:red;"  >=<span style="color:black;"  >       DemoLDT<span style="color:red;"  >-<span style="color:black;"  >GDT </span></span></span></span></span></p><p><span style="color:black; font-size:9pt;"  ><span style="font-family:Times New Roman;"  >     <span style="color:#999999;"  ><em>;</em></span></span><span style="font-family:宋体;"  ><em>演示任务</em></span><span style="color:#999999;"  ><em><span style="font-family:Times New Roman;"  >TSS</span><span style="font-family:宋体;"  >段描述符及选择子</span></em><span style="color:black; font-family:Times New Roman;"  >     </span></span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >DemoTSS         Desc    <span style="color:red;"  >&lt;<span style="color:black;"  >DemoTSSLen<span style="color:red;"  >-<span style="color:#000099;"  >1<span style="color:red;"  >,<span style="color:black;"  >DemoTSSSeg<span style="color:red;"  >,,<span style="color:black;"  >AT386TSS<span style="color:red;"  >,,&gt;<span style="color:black;"  >             </span></span></span></span></span></span></span></span></span></span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >DemoTSS_Sel     <span style="color:red;"  >=<span style="color:black;"  >       DemoTSS<span style="color:red;"  >-<span style="color:black;"  >GDT </span></span></span></span></span></p><p><span style="color:black; font-size:9pt;"  ><span style="font-family:Times New Roman;"  >     <span style="color:#999999;"  ><em>;</em></span></span><span style="font-family:宋体;"  ><em>缓冲数据段描述符及选择子</em></span><span style="font-family:Times New Roman;"  >    </span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >XBuffer         Desc    <span style="color:red;"  >&lt;<span style="color:black;"  >BufferLen<span style="color:red;"  >-<span style="color:#000099;"  >1<span style="color:red;"  >,<span style="color:black;"  >BufferSeg<span style="color:red;"  >,,<span style="color:black;"  >ATDW<span style="color:red;"  >,,&gt;<span style="color:black;"  >             </span></span></span></span></span></span></span></span></span></span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >XBuffer_Sel     <span style="color:red;"  >=<span style="color:black;"  >       XBuffer<span style="color:red;"  >-<span style="color:black;"  >GDT </span></span></span></span></span></p><p><span style="color:black; font-size:9pt;"  ><span style="font-family:Times New Roman;"  >     <span style="color:#999999;"  ><em>;</em></span></span><span style="font-family:宋体;"  ><em>读键盘任务局部描述符表段描<span style="color:#999999;"  >述符及选择子</span></em></span><span style="color:black; font-family:Times New Roman;"  >    </span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >GKeyLDT         Desc    <span style="color:red;"  >&lt;<span style="color:black;"  >GKeyLDTLen<span style="color:red;"  >-<span style="color:#000099;"  >1<span style="color:red;"  >,<span style="color:black;"  >GKeyLDTSeg<span style="color:red;"  >,,<span style="color:black;"  >ATLDT<span style="color:red;"  >,,&gt;<span style="color:black;"  >             </span></span></span></span></span></span></span></span></span></span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >GKeyLDT_Sel     <span style="color:red;"  >=<span style="color:black;"  >       GKeyLDT<span style="color:red;"  >-<span style="color:black;"  >GDT </span></span></span></span></span></p><p><span style="color:black; font-size:9pt;"  ><span style="font-family:Times New Roman;"  >     <span style="color:#999999;"  ><em>;</em></span></span><span style="font-family:宋体;"  ><em>读键盘任务</em></span><span style="color:#999999;"  ><em><span style="font-family:Times New Roman;"  >TSS</span><span style="font-family:宋体;"  >段描述符及选择子</span></em><span style="color:black; font-family:Times New Roman;"  >     </span></span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >GKeyTSS         Desc    <span style="color:red;"  >&lt;<span style="color:black;"  >GKeyTSSLen<span style="color:red;"  >-<span style="color:#000099;"  >1<span style="color:red;"  >,<span style="color:black;"  >GKeyTSSSeg<span style="color:red;"  >,,<span style="color:black;"  >AT386TSS<span style="color:red;"  >,,&gt;<span style="color:black;"  >             </span></span></span></span></span></span></span></span></span></span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >GKeyTSS_Sel     <span style="color:red;"  >=<span style="color:black;"  >       GKeyTSS<span style="color:red;"  >-<span style="color:black;"  >GDT </span></span></span></span></span></p><p><span style="color:black; font-size:9pt;"  ><span style="font-family:Times New Roman;"  >     <span style="color:#999999;"  ><em>;</em></span></span><span style="font-family:宋体;"  ><em>显示陷阱处理程序代码段描述符及选择子</em></span><span style="font-family:Times New Roman;"  >    </span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >EchoCode        Desc    <span style="color:red;"  >&lt;<span style="color:black;"  >EchoCodeLen<span style="color:red;"  >-<span style="color:#000099;"  >1<span style="color:red;"  >,<span style="color:black;"  >EchoCodeSeg<span style="color:red;"  >,,<span style="color:black;"  >ATCE<span style="color:red;"  >,,&gt;<span style="color:black;"  >             </span></span></span></span></span></span></span></span></span></span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >EchoCode_Sel    <span style="color:red;"  >=<span style="color:black;"  >       EchoCode<span style="color:red;"  >-<span style="color:black;"  >GDT </span></span></span></span></span></p><p><span style="color:black; font-size:9pt;"  ><span style="font-family:Times New Roman;"  >     <span style="color:#999999;"  ><em>;</em></span></span><span style="font-family:宋体;"  ><em>显示出错码过程代码段描述符及选择子</em></span><span style="font-family:Times New Roman;"  >    </span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >SubCode         Desc    <span style="color:red;"  >&lt;<span style="color:black;"  >SubCodeLen<span style="color:red;"  >-<span style="color:#000099;"  >1<span style="color:red;"  >,<span style="color:black;"  >SubCodeSeg<span style="color:red;"  >,,<span style="color:black;"  >ATCE<span style="color:red;"  >,,&gt;<span style="color:black;"  >             </span></span></span></span></span></span></span></span></span></span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >SubCode_Sel     <span style="color:red;"  >=<span style="color:black;"  >       SubCode<span style="color:red;"  >-<span style="color:black;"  >GDT </span></span></span></span></span></p><p><span style="color:black; font-size:9pt;"  ><span style="font-family:Times New Roman;"  >     <span style="color:#999999;"  ><em>;</em></span></span><span style="font-family:宋体;"  ><em>其它中断或异常处理程序代码段描述符及选择子</em></span><span style="font-family:Times New Roman;"  >    </span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >Other           Desc    <span style="color:red;"  >&lt;<span style="color:black;"  >OtherCodeLen<span style="color:red;"  >-<span style="color:#000099;"  >1<span style="color:red;"  >,<span style="color:black;"  >OtherCodeSeg<span style="color:red;"  >,,<span style="color:black;"  >ATCE<span style="color:red;"  >,,&gt;<span style="color:black;"  >             </span></span></span></span></span></span></span></span></span></span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >Other_Sel       <span style="color:red;"  >=<span style="color:black;"  >       Other<span style="color:red;"  >-<span style="color:black;"  >GDT </span></span></span></span></span></p><p><span style="color:#999999; font-family:Times New Roman; font-size:9pt;"  ><em>;----------------------------------------------------------------------------</em><span style="color:black;"  >    </span></span></p><p><span style="color:black; font-size:9pt;"  ><span style="font-family:Times New Roman;"  >GDTLen          <span style="color:red;"  >=<span style="color:black;"  >       <span style="color:red;"  >$-<span style="color:black;"  >GDT                     <span style="color:#999999;"  ><em>;</em></span></span></span></span></span></span><span style="font-family:宋体;"  ><em>全局<span style="color:#999999;"  >描述符表长度</span></em></span><span style="color:black; font-family:Times New Roman;"  >    </span></span></p><p><span style="color:black; font-size:9pt;"  ><span style="font-family:Times New Roman;"  >GDNum           <span style="color:red;"  >=<span style="color:black;"  >       <span style="color:red;"  >($-<span style="color:black;"  >EFFGDT<span style="color:red;"  >)/(<span style="color:#009999;"  >SIZE<span style="color:black;"  > Desc<span style="color:red;"  >)<span style="color:black;"  >              <span style="color:#999999;"  ><em>;</em></span></span></span></span></span></span></span></span></span></span></span><span style="font-family:宋体;"  ><em>需处理基地址的描述符个数</em></span><span style="font-family:Times New Roman;"  >    </span></span></p><p><span style="color:#999999; font-family:Times New Roman; font-size:9pt;"  ><em>;----------------------------------------------------------------------------</em><span style="color:black;"  >    </span></span></p><p><span style="color:black; font-size:9pt;"  ><span style="font-family:Times New Roman;"  >GDTSeg          <span style="color:#009999;"  >ENDS<span style="color:black;"  >       <span style="color:#999999;"  ><em>;</em></span></span></span></span><span style="font-family:宋体;"  ><em>全局描述符表段定义结束</em></span><span style="font-family:Times New Roman;"  >    </span></span></p><p><span style="color:#999999; font-family:Times New Roman; font-size:9pt;"  ><em>;----------------------------------------------------------------------------</em><span style="color:black;"  >    </span></span></p><p><span style="color:black; font-size:9pt;"  ><span style="font-family:Times New Roman;"  >IDTSeg          <span style="color:#009999;"  >SEGMENT<span style="color:black;"  >       <span style="color:#009999;"  >PARA<span style="color:black;"  >         <span style="color:#009999;"  >USE16<span style="color:black;"  >           <span style="color:#999999;"  ><em>;</em></span></span></span></span></span></span></span></span><span style="font-family:宋体;"  ><em>中断描述符表数据段</em></span><span style="color:#999999;"  ><em><span style="font-family:Times New Roman;"  >(16</span><span style="font-family:宋体;"  >位</span></em><span style="font-family:Times New Roman;"  ><em>)</em><span style="color:black;"  >      </span></span></span></span></p><p><span style="color:#999999; font-family:Times New Roman; font-size:9pt;"  ><em>;----------------------------------------------------------------------------</em><span style="color:black;"  >    </span></span></p><p><span style="color:black; font-size:9pt;"  ><span style="font-family:Times New Roman;"  >IDT             <span style="color:#009999;"  >LABEL<span style="color:black;"  >       <span style="color:#009999;"  >BYTE<span style="color:black;"  >         <span style="color:#999999;"  ><em>;</em></span></span></span></span></span></span><span style="font-family:宋体;"  ><em>中断描述符表</em></span><span style="font-family:Times New Roman;"  >    </span></span></p><p><span style="color:black; font-size:9pt;"  ><span style="font-family:Times New Roman;"  >     <span style="color:#999999;"  ><em>;0</em></span></span><span style="font-family:宋体;"  ><em>号陷阱门描述符</em></span><span style="color:#999999;"  ><em><span style="font-family:Times New Roman;"  >(</span><span style="font-family:宋体;"  >对应除法出错故障</span></em><span style="font-family:Times New Roman;"  ><em>)</em><span style="color:black;"  >      </span></span></span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >                Gate    <span style="color:red;"  >&lt;<span style="color:black;"  >DivBegin<span style="color:red;"  >,<span style="color:black;"  >Divide_Sel<span style="color:red;"  >,,<span style="color:black;"  >AT386TGate<span style="color:red;"  >,&gt;<span style="color:black;"  >           </span></span></span></span></span></span></span></span></span></p><p><span style="color:black; font-size:9pt;"  ><span style="font-family:Times New Roman;"  >     <span style="color:#999999;"  ><em>;</em></span></span><span style="font-family:宋体;"  ><em>从</em></span><span style="color:#999999;"  ><em><span style="font-family:Times New Roman;"  >1--3</span><span style="font-family:宋体;"  >的</span><span style="font-family:Times New Roman;"  >3</span><span style="font-family:宋体;"  >个陷阱门描述符</span></em><span style="color:black; font-family:Times New Roman;"  >     </span></span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >    <span style="color:#009999;"  >REPT<span style="color:black;"  >      <span style="color:#000099;"  >3<span style="color:black;"  >       </span></span></span></span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >                Gate    <span style="color:red;"  >&lt;<span style="color:black;"  >OtherBegin<span style="color:red;"  >,<span style="color:black;"  >Other_Sel<span style="color:red;"  >,,<span style="color:black;"  >AT386TGate<span style="color:red;"  >,&gt;<span style="color:black;"  >           </span></span></span></span></span></span></span></span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >    <span style="color:#009999;"  >ENDM<span style="color:black;"  >     </span></span></span></p><p><span style="color:black; font-size:9pt;"  ><span style="font-family:Times New Roman;"  >     <span style="color:#999999;"  ><em>;4</em></span></span><span style="font-family:宋体;"  ><em>号陷阱门描述符</em></span><span style="color:#999999;"  ><em><span style="font-family:Times New Roman;"  >(</span><span style="font-family:宋体;"  >对应溢出陷阱</span></em><span style="font-family:Times New Roman;"  ><em>)</em><span style="color:black;"  >      </span></span></span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >                Gate    <span style="color:red;"  >&lt;<span style="color:black;"  >OFBegin<span style="color:red;"  >,<span style="color:black;"  >OF_Sel<span style="color:red;"  >,,<span style="color:black;"  >AT386TGate<span style="color:red;"  >,&gt;<span style="color:black;"  >           </span></span></span></span></span></span></span></span></span></p><p><span style="color:black; font-size:9pt;"  ><span style="font-family:Times New Roman;"  >     <span style="color:#999999;"  ><em>;</em></span></span><span style="font-family:宋体;"  ><em>从</em></span><span style="color:#999999;"  ><em><span style="font-family:Times New Roman;"  >5--0ah</span><span style="font-family:宋体;"  >的的</span><span style="font-family:Times New Roman;"  >6</span><span style="font-family:宋体;"  >个陷阱门描述符</span></em><span style="color:black; font-family:Times New Roman;"  >     </span></span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >    <span style="color:#009999;"  >REPT<span style="color:black;"  >      <span style="color:#000099;"  >6<span style="color:black;"  >       </span></span></span></span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >                Gate    <span style="color:red;"  >&lt;<span style="color:black;"  >OtherBegin<span style="color:red;"  >,<span style="color:black;"  >Other_Sel<span style="color:red;"  >,,<span style="color:black;"  >AT386TGate<span style="color:red;"  >,&gt;<span style="color:black;"  >           </span></span></span></span></span></span></span></span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >    <span style="color:#009999;"  >ENDM<span style="color:black;"  >     </span></span></span></p><p><span style="color:black; font-size:9pt;"  ><span style="font-family:Times New Roman;"  >     <span style="color:#999999;"  ><em>;0bh</em></span></span><em><span style="font-family:宋体;"  >号陷阱门<span style="color:#999999;"  >描述符</span></span><span style="font-family:Times New Roman;"  >(</span></em><span style="color:#999999;"  ><span style="font-family:宋体;"  ><em>对应段不存在故障</em></span><span style="font-family:Times New Roman;"  ><em>)</em><span style="color:black;"  >      </span></span></span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >                Gate    <span style="color:red;"  >&lt;<span style="color:black;"  >SNPBegin<span style="color:red;"  >,<span style="color:black;"  >SNP_Sel<span style="color:red;"  >,,<span style="color:black;"  >AT386TGate<span style="color:red;"  >,&gt;<span style="color:black;"  >           </span></span></span></span></span></span></span></span></span></p><p><span style="color:black; font-size:9pt;"  ><span style="font-family:Times New Roman;"  >     <span style="color:#999999;"  ><em>;0ch</em></span></span><span style="font-family:宋体;"  ><em>号陷阱门描述符</em></span><span style="color:#999999;"  ><em><span style="font-family:Times New Roman;"  >(</span><span style="font-family:宋体;"  >对应堆栈段故障</span></em><span style="font-family:Times New Roman;"  ><em>)</em><span style="color:black;"  >      </span></span></span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >                Gate    <span style="color:red;"  >&lt;<span style="color:black;"  >SSEBegin<span style="color:red;"  >,<span style="color:black;"  >SSE_Sel<span style="color:red;"  >,,<span style="color:black;"  >AT386TGate<span style="color:red;"  >,&gt;<span style="color:black;"  >           </span></span></span></span></span></span></span></span></span></p><p><span style="color:black; font-size:9pt;"  ><span style="font-family:Times New Roman;"  >     <span style="color:#999999;"  ><em>;0dh</em></span></span><span style="font-family:宋体;"  ><em>号陷阱门描述符</em></span><span style="color:#999999;"  ><em><span style="font-family:Times New Roman;"  >(</span><span style="font-family:宋体;"  >对应通用保护故障</span></em><span style="font-family:Times New Roman;"  ><em>)</em><span style="color:black;"  >      </span></span></span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >                Gate    <span style="color:red;"  >&lt;<span style="color:black;"  >GPBegin<span style="color:red;"  >,<span style="color:black;"  >GP_Sel<span style="color:red;"  >,,<span style="color:black;"  >AT386TGate<span style="color:red;"  >,&gt;<span style="color:black;"  >           </span></span></span></span></span></span></span></span></span></p><p><span style="color:black; font-size:9pt;"  ><span style="font-family:Times New Roman;"  >     <span style="color:#999999;"  ><em>;</em></span></span><span style="font-family:宋体;"  ><em>从</em></span><span style="color:#999999;"  ><em><span style="font-family:Times New Roman;"  >0eh--0edh</span><span style="font-family:宋体;"  >的</span><span style="font-family:Times New Roman;"  >240</span><span style="font-family:宋体;"  >个陷阱门描述符</span></em><span style="color:black; font-family:Times New Roman;"  >     </span></span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >    <span style="color:#009999;"  >REPT<span style="color:black;"  >      <span style="color:#000099;"  >240<span style="color:black;"  >       </span></span></span></span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >                Gate    <span style="color:red;"  >&lt;<span style="color:black;"  >OtherBegin<span style="color:red;"  >,<span style="color:black;"  >Other_Sel<span style="color:red;"  >,,<span style="color:black;"  >AT386TGate<span style="color:red;"  >,&gt;<span style="color:black;"  >           </span></span></span></span></span></span></span></span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >    <span style="color:#009999;"  >ENDM<span style="color:black;"  >     </span></span></span></p><p><span style="color:black; font-size:9pt;"  ><span style="font-family:Times New Roman;"  >     <span style="color:#999999;"  ><em>;</em></span></span><span style="font-family:宋体;"  ><em>对应</em></span><span style="color:#999999;"  ><em><span style="font-family:Times New Roman;"  >0feh</span><span style="font-family:宋体;"  >号陷阱门描述符</span><span style="font-family:Times New Roman;"  >(</span><span style="font-family:宋体;"  >对应显示中断处理程序</span></em><span style="font-family:Times New Roman;"  ><em>)</em><span style="color:black;"  >      </span></span></span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >                Gate    <span style="color:red;"  >&lt;<span style="color:black;"  >EchoBegin<span style="color:red;"  >,<span style="color:black;"  >EchoCode_Sel<span style="color:red;"  >,,<span style="color:black;"  >AT386TGate<span style="color:red;"  >,&gt;<span style="color:black;"  >           </span></span></span></span></span></span></span></span></span></p><p><span style="color:black; font-size:9pt;"  ><span style="font-family:Times New Roman;"  >     <span style="color:#999999;"  ><em>;0ffh</em></span></span><span style="font-family:宋体;"  ><em>号任务门描述符</em></span><span style="color:#999999;"  ><em><span style="font-family:Times New Roman;"  >(</span><span style="font-family:宋体;"  >对应读键盘中断处理任务</span></em><span style="font-family:Times New Roman;"  ><em>)</em><span style="color:black;"  >      </span></span></span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >                Gate    <span style="color:red;"  >&lt;,<span style="color:black;"  >GKeyTSS_Sel<span style="color:red;"  >,,<span style="color:black;"  >ATTaskGate<span style="color:red;"  >,&gt;<span style="color:black;"  >         </span></span></span></span></span></span></span></p><p><span style="color:#999999; font-family:Times New Roman; font-size:9pt;"  ><em>;----------------------------------------------------------------------------</em><span style="color:black;"  >    </span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >IDTLen          <span style="color:red;"  >=<span style="color:black;"  >      <span style="color:red;"  >$-<span style="color:black;"  >IDT </span></span></span></span></span></p><p><span style="color:#999999; font-family:Times New Roman; font-size:9pt;"  ><em>;----------------------------------------------------------------------------</em><span style="color:black;"  >    </span></span></p><p><span style="color:black; font-size:9pt;"  ><span style="font-family:Times New Roman;"  >IDTSeg          <span style="color:#009999;"  >ENDS<span style="color:black;"  >       <span style="color:#999999;"  ><em>;</em></span></span></span></span><span style="font-family:宋体;"  ><em>中断描述符表段定义结束</em></span><span style="font-family:Times New Roman;"  >    </span></span></p><p><span style="color:#999999; font-family:Times New Roman; font-size:9pt;"  ><em>;----------------------------------------------------------------------------</em><span style="color:black;"  >    </span></span></p><p><span style="color:#999999; font-size:9pt;"  ><em><span style="font-family:Times New Roman;"  >;</span><span style="font-family:宋体;"  >读键盘任务局部描述符表段</span></em><span style="color:black; font-family:Times New Roman;"  >    </span></span></p><p><span style="color:#999999; font-family:Times New Roman; font-size:9pt;"  ><em>;----------------------------------------------------------------------------</em><span style="color:black;"  >    </span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >GKeyLDTSeg      <span style="color:#009999;"  >SEGMENT<span style="color:black;"  >      <span style="color:#009999;"  >PARA<span style="color:black;"  >        <span style="color:#009999;"  >USE16<span style="color:black;"  >         </span></span></span></span></span></span></span></p><p><span style="color:#999999; font-family:Times New Roman; font-size:9pt;"  ><em>;----------------------------------------------------------------------------</em><span style="color:black;"  >    </span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >GLDT            <span style="color:#009999;"  >LABEL<span style="color:black;"  >      <span style="color:#009999;"  >BYTE<span style="color:black;"  >       </span></span></span></span></span></p><p><span style="color:black; font-size:9pt;"  ><span style="font-family:Times New Roman;"  >     <span style="color:#999999;"  ><em>;</em></span></span><span style="font-family:宋体;"  ><em>代码段描述符及选择子</em></span><span style="font-family:Times New Roman;"  >    </span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >GKeyCode        Desc    <span style="color:red;"  >&lt;<span style="color:#000099;"  >0ffffh<span style="color:red;"  >,<span style="color:black;"  >GKeyCodeSeg<span style="color:red;"  >,,<span style="color:black;"  >ATCE<span style="color:red;"  >,,&gt;<span style="color:black;"  >           </span></span></span></span></span></span></span></span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >GKeyCode_Sel    <span style="color:red;"  >=<span style="color:black;"  >       GKeyCode<span style="color:red;"  >-<span style="color:black;"  >GLDT<span style="color:red;"  >+<span style="color:black;"  >TIL </span></span></span></span></span></span></span></p><p><span style="color:black; font-size:9pt;"  ><span style="font-family:Times New Roman;"  >     <span style="color:#999999;"  ><em>;</em></span></span><span style="font-family:宋体;"  ><em>堆栈段描述符及选择子</em></span><span style="font-family:Times New Roman;"  >    </span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >GKeyStack       Desc    <span style="color:red;"  >&lt;<span style="color:black;"  >GKeyStackLen<span style="color:red;"  >-<span style="color:#000099;"  >1<span style="color:red;"  >,<span style="color:black;"  >GKeyStackSeg<span style="color:red;"  >,,<span style="color:black;"  >ATDWA<span style="color:red;"  >,,&gt;<span style="color:black;"  >             </span></span></span></span></span></span></span></span></span></span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >GKeyStack_Sel   <span style="color:red;"  >=<span style="color:black;"  >       GKeyStack<span style="color:red;"  >-<span style="color:black;"  >GLDT<span style="color:red;"  >+<span style="color:black;"  >TIL </span></span></span></span></span></span></span></p><p><span style="color:#999999; font-family:Times New Roman; font-size:9pt;"  ><em>;----------------------------------------------------------------------------</em><span style="color:black;"  >    </span></span></p><p><span style="color:black; font-size:9pt;"  ><span style="font-family:Times New Roman;"  >GKeyLDNum       <span style="color:red;"  >=<span style="color:black;"  >       <span style="color:red;"  >($-<span style="color:black;"  >GLDT<span style="color:red;"  >)/(<span style="color:#009999;"  >SIZE<span style="color:black;"  > Desc<span style="color:red;"  >)<span style="color:black;"  >              <span style="color:#999999;"  ><em>;</em></span></span></span></span></span></span></span></span></span></span></span><span style="font-family:宋体;"  ><em>需初始化基地址的描述符个数</em></span><span style="font-family:Times New Roman;"  >    </span></span></p><p><span style="color:black; font-size:9pt;"  ><span style="font-family:Times New Roman;"  >GKeyLDTLen      <span style="color:red;"  >=<span style="color:black;"  >       <span style="color:red;"  >$<span style="color:black;"  >         <span style="color:#999999;"  ><em>;</em></span></span></span></span></span></span><span style="font-family:宋体;"  ><em>局部描述符表段长度</em></span><span style="font-family:Times New Roman;"  >    </span></span></p><p><span style="color:#999999; font-family:Times New Roman; font-size:9pt;"  ><em>;----------------------------------------------------------------------------</em><span style="color:black;"  >    </span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >GKeyLDTSeg      <span style="color:#009999;"  >ENDS<span style="color:black;"  >     </span></span></span></p><p><span style="color:#999999; font-family:Times New Roman; font-size:9pt;"  ><em>;----------------------------------------------------------------------------</em><span style="color:black;"  >    </span></span></p><p><span style="color:#999999; font-size:9pt;"  ><em><span style="font-family:Times New Roman;"  >;</span><span style="font-family:宋体;"  >读键盘任务</span><span style="font-family:Times New Roman;"  >TSS</span><span style="font-family:宋体;"  >段</span></em><span style="color:black; font-family:Times New Roman;"  >    </span></span></p><p><span style="color:#999999; font-family:Times New Roman; font-size:9pt;"  ><em>;----------------------------------------------------------------------------</em><span style="color:black;"  >    </span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >GKeyTSSSeg      <span style="color:#009999;"  >SEGMENT<span style="color:black;"  >      <span style="color:#009999;"  >PARA<span style="color:black;"  >        <span style="color:#009999;"  >USE16<span style="color:black;"  >         </span></span></span></span></span></span></span></p><p><span style="color:black; font-size:9pt;"  ><span style="font-family:Times New Roman;"  >     <span style="color:#009999;"  >DD<span style="color:black;"  >       <span style="color:#000099;"  >0<span style="color:black;"  >         <span style="color:#999999;"  ><em>;</em></span></span></span></span></span></span><span style="font-family:宋体;"  ><em>链接字</em></span><span style="font-family:Times New Roman;"  >    </span></span></p><p><span style="color:black; font-size:9pt;"  ><span style="font-family:Times New Roman;"  >     <span style="color:#009999;"  >DD<span style="color:black;"  >       <span style="color:red;"  >?<span style="color:black;"  >         <span style="color:#999999;"  ><em>;0</em></span></span></span></span></span></span><span style="font-family:宋体;"  ><em>级堆栈指针</em></span><span style="font-family:Times New Roman;"  >    </span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >    <span style="color:#009999;"  >DW<span style="color:black;"  >      <span style="color:red;"  >?,?<span style="color:black;"  >       </span></span></span></span></span></p><p><span style="color:black; font-size:9pt;"  ><span style="font-family:Times New Roman;"  >     <span style="color:#009999;"  >DD<span style="color:black;"  >       <span style="color:red;"  >?<span style="color:black;"  >         <span style="color:#999999;"  ><em>;1</em></span></span></span></span></span></span><span style="font-family:宋体;"  ><em>级堆栈指针</em></span><span style="font-family:Times New Roman;"  >    </span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >    <span style="color:#009999;"  >DW<span style="color:black;"  >      <span style="color:red;"  >?,?<span style="color:black;"  >       </span></span></span></span></span></p><p><span style="color:black; font-size:9pt;"  ><span style="font-family:Times New Roman;"  >     <span style="color:#009999;"  >DD<span style="color:black;"  >       <span style="color:red;"  >?<span style="color:black;"  >         <span style="color:#999999;"  ><em>;2</em></span></span></span></span></span></span><span style="font-family:宋体;"  ><em>级堆栈指针</em></span><span style="font-family:Times New Roman;"  >    </span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >    <span style="color:#009999;"  >DW<span style="color:black;"  >      <span style="color:red;"  >?,?<span style="color:black;"  >       </span></span></span></span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >    <span style="color:#009999;"  >DD<span style="color:black;"  >      <span style="color:#000099;"  >0<span style="color:black;"  >        <span style="color:#999999;"  ><em>;CR3</em><span style="color:black;"  >         </span></span></span></span></span></span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >    <span style="color:#009999;"  >DW<span style="color:black;"  >      GKeyBegin<span style="color:red;"  >,<span style="color:#000099;"  >0<span style="color:black;"  >         <span style="color:#999999;"  ><em>;EIP</em><span style="color:black;"  >          </span></span></span></span></span></span></span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >    <span style="color:#009999;"  >DD<span style="color:black;"  >      <span style="color:#000099;"  >0<span style="color:black;"  >        <span style="color:#999999;"  ><em>;EFLAGS</em><span style="color:black;"  >         </span></span></span></span></span></span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >    <span style="color:#009999;"  >DD<span style="color:black;"  >      <span style="color:#000099;"  >0<span style="color:black;"  >        <span style="color:#999999;"  ><em>;EAX</em><span style="color:black;"  >         </span></span></span></span></span></span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >    <span style="color:#009999;"  >DD<span style="color:black;"  >      <span style="color:#000099;"  >0<span style="color:black;"  >        <span style="color:#999999;"  ><em>;ECX</em><span style="color:black;"  >         </span></span></span></span></span></span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >    <span style="color:#009999;"  >DD<span style="color:black;"  >      <span style="color:#000099;"  >0<span style="color:black;"  >        <span style="color:#999999;"  ><em>;EDX</em><span style="color:black;"  >         </span></span></span></span></span></span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >    <span style="color:#009999;"  >DD<span style="color:black;"  >      <span style="color:#000099;"  >0<span style="color:black;"  >        <span style="color:#999999;"  ><em>;EBX</em><span style="color:black;"  >         </span></span></span></span></span></span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >    <span style="color:#009999;"  >DW<span style="color:black;"  >      GKeyStackLen<span style="color:red;"  >,<span style="color:#000099;"  >0<span style="color:black;"  >         <span style="color:#999999;"  ><em>;ESP</em><span style="color:black;"  >          </span></span></span></span></span></span></span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >    <span style="color:#009999;"  >DD<span style="color:black;"  >      <span style="color:#000099;"  >0<span style="color:black;"  >        <span style="color:#999999;"  ><em>;EBP</em><span style="color:black;"  >         </span></span></span></span></span></span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >    <span style="color:#009999;"  >DD<span style="color:black;"  >      <span style="color:#000099;"  >0<span style="color:black;"  >        <span style="color:#999999;"  ><em>;ESI</em><span style="color:black;"  >         </span></span></span></span></span></span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >    <span style="color:#009999;"  >DD<span style="color:black;"  >      <span style="color:#000099;"  >0<span style="color:black;"  >        <span style="color:#999999;"  ><em>;EDI</em><span style="color:black;"  >         </span></span></span></span></span></span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >    <span style="color:#009999;"  >DW<span style="color:black;"  >      Normal_Sel<span style="color:red;"  >,<span style="color:#000099;"  >0<span style="color:black;"  >         <span style="color:#999999;"  ><em>;ES</em><span style="color:black;"  >          </span></span></span></span></span></span></span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >    <span style="color:#009999;"  >DW<span style="color:black;"  >      GKeyCode_Sel<span style="color:red;"  >,<span style="color:#000099;"  >0<span style="color:black;"  >         <span style="color:#999999;"  ><em>;CS</em><span style="color:black;"  >          </span></span></span></span></span></span></span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >    <span style="color:#009999;"  >DW<span style="color:black;"  >      GKeyStack_Sel<span style="color:red;"  >,<span style="color:#000099;"  >0<span style="color:black;"  >         <span style="color:#999999;"  ><em>;SS</em><span style="color:black;"  >          </span></span></span></span></span></span></span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >    <span style="color:#009999;"  >DW<span style="color:black;"  >      Normal_Sel<span style="color:red;"  >,<span style="color:#000099;"  >0<span style="color:black;"  >         <span style="color:#999999;"  ><em>;DS</em><span style="color:black;"  >          </span></span></span></span></span></span></span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >    <span style="color:#009999;"  >DW<span style="color:black;"  >      Normal_Sel<span style="color:red;"  >,<span style="color:#000099;"  >0<span style="color:black;"  >         <span style="color:#999999;"  ><em>;FS</em><span style="color:black;"  >          </span></span></span></span></span></span></span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >    <span style="color:#009999;"  >DW<span style="color:black;"  >      Normal_Sel<span style="color:red;"  >,<span style="color:#000099;"  >0<span style="color:black;"  >         <span style="color:#999999;"  ><em>;GS</em><span style="color:black;"  >          </span></span></span></span></span></span></span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >    <span style="color:#009999;"  >DW<span style="color:black;"  >      GKeyLDT_Sel<span style="color:red;"  >,<span style="color:#000099;"  >0<span style="color:black;"  >         <span style="color:#999999;"  ><em>;LDTR</em><span style="color:black;"  >          </span></span></span></span></span></span></span></span></p><p><span style="color:black; font-size:9pt;"  ><span style="font-family:Times New Roman;"  >     <span style="color:#009999;"  >DW<span style="color:black;"  >       <span style="color:#000099;"  >0<span style="color:black;"  >         <span style="color:#999999;"  ><em>;</em></span></span></span></span></span></span><span style="font-family:宋体;"  ><em>调试陷阱标志</em></span><span style="font-family:Times New Roman;"  >    </span></span></p><p><span style="color:black; font-size:9pt;"  ><span style="font-family:Times New Roman;"  >     <span style="color:#009999;"  >DW<span style="color:black;"  >       <span style="color:red;"  >$+<span style="color:#000099;"  >2<span style="color:black;"  >          <span style="color:#999999;"  ><em>;</em></span></span></span></span></span></span></span><span style="font-family:宋体;"  ><em>指向</em></span><span style="color:#999999;"  ><em><span style="font-family:Times New Roman;"  >I/O</span><span style="font-family:宋体;"  >许可位图的偏移</span></em><span style="color:black; font-family:Times New Roman;"  >     </span></span></span></p><p><span style="color:black; font-size:9pt;"  ><span style="font-family:Times New Roman;"  >     <span style="color:#009999;"  >DB<span style="color:black;"  >       <span style="color:#000099;"  >0ffh<span style="color:black;"  >         <span style="color:#999999;"  ><em>;I/O</em></span></span></span></span></span></span><span style="font-family:宋体;"  ><em>许可位图结束字节</em></span><span style="font-family:Times New Roman;"  >    </span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >GKeyTSSLen      <span style="color:red;"  >=<span style="color:black;"  >      <span style="color:red;"  >$<span style="color:black;"  >       </span></span></span></span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >GKeyTSSSeg      <span style="color:#009999;"  >ENDS<span style="color:black;"  >     </span></span></span></p><p><span style="color:#999999; font-family:Times New Roman; font-size:9pt;"  ><em>;----------------------------------------------------------------------------</em><span style="color:black;"  >    </span></span></p><p><span style="color:#999999; font-size:9pt;"  ><em><span style="font-family:Times New Roman;"  >;</span><span style="font-family:宋体;"  >读键盘任务堆栈段</span></em><span style="color:black; font-family:Times New Roman;"  >    </span></span></p><p><span style="color:#999999; font-family:Times New Roman; font-size:9pt;"  ><em>;----------------------------------------------------------------------------</em><span style="color:black;"  >    </span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >GKeyStackSeg    <span style="color:#009999;"  >SEGMENT<span style="color:black;"  >      <span style="color:#009999;"  >PARA<span style="color:black;"  >        <span style="color:#009999;"  >USE16<span style="color:black;"  >         </span></span></span></span></span></span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >GKeyStackLen    <span style="color:red;"  >=<span style="color:black;"  >      <span style="color:#000099;"  >1024<span style="color:black;"  >       </span></span></span></span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >    <span style="color:#009999;"  >DB<span style="color:black;"  >      GKeyStackLen <span style="color:#009999;"  >DUP<span style="color:red;"  >(<span style="color:#000099;"  >0<span style="color:red;"  >)<span style="color:black;"  >          </span></span></span></span></span></span></span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >GKeyStackSeg    <span style="color:#009999;"  >ENDS<span style="color:black;"  >     </span></span></span></p><p><span style="color:#999999; font-family:Times New Roman; font-size:9pt;"  ><em>;----------------------------------------------------------------------------</em><span style="color:black;"  >    </span></span></p><p><span style="color:#999999; font-size:9pt;"  ><em><span style="font-family:Times New Roman;"  >;</span><span style="font-family:宋体;"  >读键盘任务代码段</span></em><span style="color:black; font-family:Times New Roman;"  >    </span></span></p><p><span style="color:#999999; font-family:Times New Roman; font-size:9pt;"  ><em>;----------------------------------------------------------------------------</em><span style="color:black;"  >    </span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >GKeyCodeSeg     <span style="color:#009999;"  >SEGMENT<span style="color:black;"  >      <span style="color:#009999;"  >PARA<span style="color:black;"  >        <span style="color:#009999;"  >USE16<span style="color:black;"  >         </span></span></span></span></span></span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >    <span style="color:#009999;"  >ASSUME<span style="color:black;"  >      <span style="color:fuchsia;"  >CS<span style="color:black;"  >:GKeyCodeSeg<span style="color:red;"  >,<span style="color:fuchsia;"  >DS<span style="color:black;"  >:RDataSeg<span style="color:red;"  >,<span style="color:fuchsia;"  >ES<span style="color:black;"  >:BufferSeg </span></span></span></span></span></span></span></span></span></span></span></p><p><span style="color:#999999; font-family:Times New Roman; font-size:9pt;"  ><em>;----------------------------------------------------------------------------</em><span style="color:black;"  >    </span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >GKeyBegin       <span style="color:#009999;"  >PROC<span style="color:black;"  >      <span style="color:#009999;"  >FAR<span style="color:black;"  >       </span></span></span></span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >    <span style="color:blue;"  >push<span style="color:black;"  >      <span style="color:fuchsia;"  >ds<span style="color:black;"  >       </span></span></span></span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >    <span style="color:blue;"  >push<span style="color:black;"  >      <span style="color:fuchsia;"  >es<span style="color:black;"  >       </span></span></span></span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >    <span style="color:blue;"  >push<span style="color:black;"  >      <span style="color:fuchsia;"  >fs<span style="color:black;"  >       </span></span></span></span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >    <span style="color:blue;"  >push<span style="color:black;"  >      <span style="color:fuchsia;"  >gs<span style="color:black;"  >       </span></span></span></span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >    <span style="color:blue;"  >mov<span style="color:black;"  >      <span style="color:fuchsia;"  >ax<span style="color:red;"  >,<span style="color:black;"  >Normal_Sel </span></span></span></span></span></span></p><p><span style="color:black; font-size:9pt;"  ><span style="font-family:Times New Roman;"  >     <span style="color:blue;"  >mov<span style="color:black;"  >       <span style="color:fuchsia;"  >ss<span style="color:red;"  >,<span style="color:fuchsia;"  >ax<span style="color:black;"  >           <span style="color:#999999;"  ><em>;</em></span></span></span></span></span></span></span></span><span style="font-family:宋体;"  ><em>准备转实方式</em></span><span style="font-family:Times New Roman;"  >    </span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >    <span style="color:blue;"  >mov<span style="color:black;"  >      <span style="color:fuchsia;"  >eax<span style="color:red;"  >,<span style="color:fuchsia;"  >cr0<span style="color:black;"  >         </span></span></span></span></span></span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >    <span style="color:blue;"  >and<span style="color:black;"  >      <span style="color:fuchsia;"  >al<span style="color:red;"  >,<span style="color:#000099;"  >11111110b<span style="color:black;"  >         </span></span></span></span></span></span></span></p><p><span style="color:black; font-size:9pt;"  ><span style="font-family:Times New Roman;"  >     <span style="color:blue;"  >mov<span style="color:black;"  >       <span style="color:fuchsia;"  >cr0<span style="color:red;"  >,<span style="color:fuchsia;"  >eax<span style="color:black;"  >           <span style="color:#999999;"  ><em>;</em></span></span></span></span></span></span></span></span><span style="font-family:宋体;"  ><em>转实方式</em></span><span style="font-family:Times New Roman;"  >    </span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >    <span style="color:#009900;"  >JUMP16<span style="color:black;"  >      <span style="color:red;"  >&lt;<span style="color:#009999;"  >SEG<span style="color:black;"  > GetKey<span style="color:red;"  >&gt;,&lt;<span style="color:#009999;"  >OFFSET<span style="color:black;"  > GetKey<span style="color:red;"  >&gt;<span style="color:black;"  >             </span></span></span></span></span></span></span></span></span></span></span></p><p><span style="color:#990000; font-size:9pt;"  ><span style="font-family:Times New Roman;"  >GetKey:<span style="color:black;"  >      <span style="color:blue;"  >mov<span style="color:black;"  >        <span style="color:fuchsia;"  >ax<span style="color:red;"  >,<span style="color:black;"  >RDataSeg               <span style="color:#999999;"  ><em>;</em></span></span></span></span></span></span></span></span><span style="font-family:宋体;"  ><em>实方式</em></span><span style="color:black; font-family:Times New Roman;"  >    </span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >    <span style="color:blue;"  >mov<span style="color:black;"  >      <span style="color:fuchsia;"  >ds<span style="color:red;"  >,<span style="color:fuchsia;"  >ax<span style="color:black;"  >         </span></span></span></span></span></span></span></p><p><span style="color:black; font-size:9pt;"  ><span style="font-family:Times New Roman;"  >     <span style="color:blue;"  >mov<span style="color:black;"  >       <span style="color:fuchsia;"  >ebp<span style="color:red;"  >,<span style="color:fuchsia;"  >esp<span style="color:black;"  >           <span style="color:#999999;"  ><em>;</em></span></span></span></span></span></span></span></span><span style="font-family:宋体;"  ><em>恢复实方式部分现场</em></span><span style="font-family:Times New Roman;"  >    </span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >    <span style="color:blue;"  >lss<span style="color:black;"  >      <span style="color:fuchsia;"  >sp<span style="color:red;"  >,<span style="color:#009999;"  >DWORD<span style="color:black;"  >          <span style="color:#009999;"  >PTR<span style="color:black;"  > SPVar </span></span></span></span></span></span></span></span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >    <span style="color:blue;"  >lidt<span style="color:black;"  >      <span style="color:#009999;"  >QWORD<span style="color:black;"  >        <span style="color:#009999;"  >PTR<span style="color:black;"  > NORVIDTR </span></span></span></span></span></span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >    <span style="color:blue;"  >sti<span style="color:black;"  >     </span></span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >    <span style="color:blue;"  >mov<span style="color:black;"  >      <span style="color:fuchsia;"  >dx<span style="color:red;"  >,<span style="color:#009999;"  >OFFSET<span style="color:black;"  > Mess </span></span></span></span></span></span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >    <span style="color:blue;"  >mov<span style="color:black;"  >      <span style="color:fuchsia;"  >ah<span style="color:red;"  >,<span style="color:#000099;"  >9<span style="color:black;"  >         </span></span></span></span></span></span></span></p><p><span style="color:black; font-size:9pt;"  ><span style="font-family:Times New Roman;"  >     <span style="color:blue;"  >int<span style="color:black;"  >       <span style="color:#000099;"  >21h<span style="color:black;"  >         <span style="color:#999999;"  ><em>;</em></span></span></span></span></span></span><span style="font-family:宋体;"  ><em>显示提示信息</em></span><span style="font-family:Times New Roman;"  >    </span></span></p><p><span style="color:#990000; font-family:Times New Roman; font-size:9pt;"  >GetKey1:<span style="color:black;"  >     <span style="color:blue;"  >mov<span style="color:black;"  >       <span style="color:fuchsia;"  >ah<span style="color:red;"  >,<span style="color:#000099;"  >0<span style="color:black;"  >          </span></span></span></span></span></span></span></span></p><p><span style="color:black; font-size:9pt;"  ><span style="font-family:Times New Roman;"  >     <span style="color:blue;"  >int<span style="color:black;"  >       <span style="color:#000099;"  >16h<span style="color:black;"  >         <span style="color:#999999;"  ><em>;</em></span></span></span></span></span></span><span style="font-family:宋体;"  ><em>读键盘</em></span><span style="font-family:Times New Roman;"  >    </span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >    <span style="color:blue;"  >cmp<span style="color:black;"  >      <span style="color:fuchsia;"  >al<span style="color:red;"  >,<span style="color:#999900;"  >'0'<span style="color:black;"  >         </span></span></span></span></span></span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >    <span style="color:blue;"  >jz<span style="color:black;"  >      GetKey2 </span></span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >    <span style="color:blue;"  >cmp<span style="color:black;"  >      <span style="color:fuchsia;"  >al<span style="color:red;"  >,<span style="color:#999900;"  >'4'<span style="color:black;"  >         </span></span></span></span></span></span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >    <span style="color:blue;"  >jz<span style="color:black;"  >      GetKey2 </span></span></span></p><p><span style="color:black; font-size:9pt;"  ><span style="font-family:Times New Roman;"  >     <span style="color:blue;"  >and<span style="color:black;"  >       <span style="color:fuchsia;"  >al<span style="color:red;"  >,<span style="color:#000099;"  >11011111b<span style="color:black;"  >           <span style="color:#999999;"  ><em>;</em></span></span></span></span></span></span></span></span><span style="font-family:宋体;"  ><em>小写转大写</em></span><span style="font-family:Times New Roman;"  >    </span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >    <span style="color:blue;"  >cmp<span style="color:black;"  >      <span style="color:fuchsia;"  >al<span style="color:red;"  >,<span style="color:#999900;"  >'B'<span style="color:black;"  >         </span></span></span></span></span></span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >    <span style="color:blue;"  >jb<span style="color:black;"  >      GetKey1 </span></span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >    <span style="color:blue;"  >cmp<span style="color:black;"  >      <span style="color:fuchsia;"  >al<span style="color:red;"  >,<span style="color:#999900;"  >'D'<span style="color:black;"  >         </span></span></span></span></span></span></span></p><p><span style="color:black; font-size:9pt;"  ><span style="font-family:Times New Roman;"  >     <span style="color:blue;"  >ja<span style="color:black;"  >      GetKey1                   <span style="color:#999999;"  ><em>;</em></span></span></span></span><span style="font-family:宋体;"  ><em>只有</em></span><span style="color:#999999;"  ><em><span style="font-family:Times New Roman;"  >[0,4,b,c,d]</span><span style="font-family:宋体;"  >有效</span></em><span style="color:black; font-family:Times New Roman;"  >     </span></span></span></p><p><span style="color:#990000; font-family:Times New Roman; font-size:9pt;"  >GetKey2:<span style="color:black;"  >     <span style="color:blue;"  >mov<span style="color:black;"  >       <span style="color:fuchsia;"  >dl<span style="color:red;"  >,<span style="color:fuchsia;"  >al<span style="color:black;"  >          </span></span></span></span></span></span></span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >    <span style="color:blue;"  >mov<span style="color:black;"  >      <span style="color:fuchsia;"  >ah<span style="color:red;"  >,<span style="color:#000099;"  >2<span style="color:black;"  >         </span></span></span></span></span></span></span></p><p><span style="color:black; font-size:9pt;"  ><span style="font-family:Times New Roman;"  >     <span style="color:blue;"  >int<span style="color:black;"  >       <span style="color:#000099;"  >21h<span style="color:black;"  >         <span style="color:#999999;"  ><em>;</em></span></span></span></span></span></span><span style="font-family:宋体;"  ><em>显示所按字符</em></span><span style="font-family:Times New Roman;"  >    </span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >    <span style="color:blue;"  >mov<span style="color:black;"  >      <span style="color:fuchsia;"  >ax<span style="color:red;"  >,<span style="color:black;"  >BufferSeg </span></span></span></span></span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >    <span style="color:blue;"  >mov<span style="color:black;"  >      <span style="color:fuchsia;"  >es<span style="color:red;"  >,<span style="color:fuchsia;"  >ax<span style="color:black;"  >         </span></span></span></span></span></span></span></p><p><span style="color:black; font-size:9pt;"  ><span style="font-family:Times New Roman;"  >     <span style="color:blue;"  >mov<span style="color:black;"  >       <span style="color:#009999;"  >BYTE<span style="color:black;"  >         <span style="color:#009999;"  >PTR<span style="color:black;"  >           <span style="color:fuchsia;"  >es<span style="color:black;"  >:KeyASCII<span style="color:red;"  >,<span style="color:fuchsia;"  >dl<span style="color:black;"  >                <span style="color:#999999;"  ><em>;</em></span></span></span></span></span></span></span></span></span></span></span></span></span><span style="font-family:宋体;"  ><em>保存到缓冲数据段</em></span><span style="font-family:Times New Roman;"  >    </span></span></p><p><span style="color:black; font-size:9pt;"  ><span style="font-family:Times New Roman;"  >     <span style="color:blue;"  >cli<span style="color:black;"  >       <span style="color:#999999;"  ><em>;</em></span></span></span></span><span style="font-family:宋体;"  ><em>准备返回保护方式</em></span><span style="font-family:Times New Roman;"  >    </span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >    <span style="color:blue;"  >lidt<span style="color:black;"  >      <span style="color:#009999;"  >QWORD<span style="color:black;"  >        <span style="color:#009999;"  >PTR<span style="color:black;"  > VIDTR </span></span></span></span></span></span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >    <span style="color:blue;"  >mov<span style="color:black;"  >      <span style="color:fuchsia;"  >eax<span style="color:red;"  >,<span style="color:fuchsia;"  >cr0<span style="color:black;"  >         </span></span></span></span></span></span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >    <span style="color:blue;"  >or<span style="color:black;"  >      <span style="color:fuchsia;"  >al<span style="color:red;"  >,<span style="color:#000099;"  >1<span style="color:black;"  >         </span></span></span></span></span></span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >    <span style="color:blue;"  >mov<span style="color:black;"  >      <span style="color:fuchsia;"  >cr0<span style="color:red;"  >,<span style="color:fuchsia;"  >eax<span style="color:black;"  >         </span></span></span></span></span></span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >    <span style="color:#009900;"  >JUMP16<span style="color:black;"  >      <span style="color:red;"  >&lt;<span style="color:black;"  >GKeyCode_Sel<span style="color:red;"  >&gt;,&lt;<span style="color:#009999;"  >OFFSET<span style="color:black;"  > GetKeyV<span style="color:red;"  >&gt;<span style="color:black;"  >            </span></span></span></span></span></span></span></span></span></span></p><p><span style="color:#990000; font-size:9pt;"  ><span style="font-family:Times New Roman;"  >GetKeyV:<span style="color:black;"  >      <span style="color:blue;"  >mov<span style="color:black;"  >        <span style="color:fuchsia;"  >ax<span style="color:red;"  >,<span style="color:black;"  >GKeyStack_Sel          <span style="color:#999999;"  ><em>;</em></span></span></span></span></span></span></span></span><span style="font-family:宋体;"  ><em>又进入保护方式</em></span><span style="color:black; font-family:Times New Roman;"  >    </span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >    <span style="color:blue;"  >mov<span style="color:black;"  >      <span style="color:fuchsia;"  >ss<span style="color:red;"  >,<span style="color:fuchsia;"  >ax<span style="color:black;"  >         </span></span></span></span></span></span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >    <span style="color:blue;"  >mov<span style="color:black;"  >      <span style="color:fuchsia;"  >esp<span style="color:red;"  >,<span style="color:fuchsia;"  >ebp<span style="color:black;"  >         </span></span></span></span></span></span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >    <span style="color:blue;"  >pop<span style="color:black;"  >      <span style="color:fuchsia;"  >gs<span style="color:black;"  >       </span></span></span></span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >    <span style="color:blue;"  >pop<span style="color:black;"  >      <span style="color:fuchsia;"  >fs<span style="color:black;"  >       </span></span></span></span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >    <span style="color:blue;"  >pop<span style="color:black;"  >      <span style="color:fuchsia;"  >es<span style="color:black;"  >       </span></span></span></span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >    <span style="color:blue;"  >pop<span style="color:black;"  >      <span style="color:fuchsia;"  >ds<span style="color:black;"  >       </span></span></span></span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >    <span style="color:blue;"  >iretd<span style="color:black;"  >     </span></span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >    <span style="color:blue;"  >jmp<span style="color:black;"  >     GKeyBegin </span></span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >GKeyBegin       <span style="color:#009999;"  >ENDP<span style="color:black;"  >     </span></span></span></p><p><span style="color:#999999; font-family:Times New Roman; font-size:9pt;"  ><em>;----------------------------------------------------------------------------</em><span style="color:black;"  >    </span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >GKeyCodeLen     <span style="color:red;"  >=<span style="color:black;"  >      <span style="color:red;"  >$<span style="color:black;"  >       </span></span></span></span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >GKeyCodeSeg     <span style="color:#009999;"  >ENDS<span style="color:black;"  >     </span></span></span></p><p><span style="color:#999999; font-family:Times New Roman; font-size:9pt;"  ><em>;----------------------------------------------------------------------------</em><span style="color:black;"  >    </span></span></p><p><span style="color:#999999; font-size:9pt;"  ><em><span style="font-family:Times New Roman;"  >;</span><span style="font-family:宋体;"  >其它中断或异常处理程序的代码段</span></em><span style="color:black; font-family:Times New Roman;"  >    </span></span></p><p><span style="color:#999999; font-family:Times New Roman; font-size:9pt;"  ><em>;----------------------------------------------------------------------------</em><span style="color:black;"  >    </span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >OtherCodeSeg    <span style="color:#009999;"  >SEGMENT<span style="color:black;"  >      <span style="color:#009999;"  >PARA<span style="color:black;"  >        <span style="color:#009999;"  >USE16<span style="color:black;"  >         </span></span></span></span></span></span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >    <span style="color:#009999;"  >ASSUME<span style="color:black;"  >      <span style="color:fuchsia;"  >CS<span style="color:black;"  >:OtherCodeSeg </span></span></span></span></span></p><p><span style="color:#999999; font-family:Times New Roman; font-size:9pt;"  ><em>;----------------------------------------------------------------------------</em><span style="color:black;"  >    </span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >OtherBegin      <span style="color:#009999;"  >PROC<span style="color:black;"  >      <span style="color:#009999;"  >FAR<span style="color:black;"  >       </span></span></span></span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >    <span style="color:blue;"  >mov<span style="color:black;"  >      <span style="color:fuchsia;"  >si<span style="color:red;"  >,<span style="color:#009999;"  >OFFSET<span style="color:black;"  > MessOther </span></span></span></span></span></span></span></p><p><span style="color:black; font-size:9pt;"  ><span style="font-family:Times New Roman;"  >     <span style="color:blue;"  >int<span style="color:black;"  >       <span style="color:#000099;"  >0feh<span style="color:black;"  >         <span style="color:#999999;"  ><em>;</em></span></span></span></span></span></span><span style="font-family:宋体;"  ><em>显示提示信息</em></span><span style="font-family:Times New Roman;"  >    </span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >    <span style="color:blue;"  >mov<span style="color:black;"  >      <span style="color:#009999;"  >WORD<span style="color:black;"  >        <span style="color:#009999;"  >PTR<span style="color:black;"  >          <span style="color:fuchsia;"  >es<span style="color:black;"  >:<span style="color:red;"  >[<span style="color:#000099;"  >0<span style="color:red;"  >],<span style="color:fuchsia;"  >ax<span style="color:black;"  >                </span></span></span></span></span></span></span></span></span></span></span></span></span></span></p><p><span style="color:black; font-size:9pt;"  ><span style="font-family:Times New Roman;"  >     <span style="color:blue;"  >jmp<span style="color:black;"  >       <span style="color:red;"  >$<span style="color:black;"  >         <span style="color:#999999;"  ><em>;</em></span></span></span></span></span></span><span style="font-family:宋体;"  ><em>进入无限循环</em></span><span style="font-family:Times New Roman;"  >    </span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >OtherBegin      <span style="color:#009999;"  >ENDP<span style="color:black;"  >     </span></span></span></p><p><span style="color:#999999; font-family:Times New Roman; font-size:9pt;"  ><em>;----------------------------------------------------------------------------</em><span style="color:black;"  >    </span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >OtherCodeLen    <span style="color:red;"  >=<span style="color:black;"  >      <span style="color:red;"  >$<span style="color:black;"  >       </span></span></span></span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >OtherCodeSeg    <span style="color:#009999;"  >ENDS<span style="color:black;"  >     </span></span></span></p><p><span style="color:#999999; font-family:Times New Roman; font-size:9pt;"  ><em>;----------------------------------------------------------------------------</em><span style="color:black;"  >    </span></span></p><p><span style="color:#999999; font-size:9pt;"  ><em><span style="font-family:Times New Roman;"  >;</span><span style="font-family:宋体;"  >除法出错故障处理程序代码段</span></em><span style="color:black; font-family:Times New Roman;"  >    </span></span></p><p><span style="color:#999999; font-family:Times New Roman; font-size:9pt;"  ><em>;----------------------------------------------------------------------------</em><span style="color:black;"  >    </span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >DivCodeSeg      <span style="color:#009999;"  >SEGMENT<span style="color:black;"  >      <span style="color:#009999;"  >PARA<span style="color:black;"  >        <span style="color:#009999;"  >USE16<span style="color:black;"  >         </span></span></span></span></span></span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >    <span style="color:#009999;"  >ASSUME<span style="color:black;"  >      <span style="color:fuchsia;"  >CS<span style="color:black;"  >:DivCodeSeg </span></span></span></span></span></p><p><span style="color:#999999; font-family:Times New Roman; font-size:9pt;"  ><em>;----------------------------------------------------------------------------</em><span style="color:black;"  >    </span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >DivBegin        <span style="color:#009999;"  >PROC<span style="color:black;"  >      <span style="color:#009999;"  >FAR<span style="color:black;"  >       </span></span></span></span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >    <span style="color:blue;"  >mov<span style="color:black;"  >      <span style="color:fuchsia;"  >si<span style="color:red;"  >,<span style="color:#009999;"  >OFFSET<span style="color:black;"  > Mess0 </span></span></span></span></span></span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >    <span style="color:blue;"  >mov<span style="color:black;"  >      <span style="color:fuchsia;"  >di<span style="color:red;"  >,<span style="color:#000099;"  >0<span style="color:black;"  >         </span></span></span></span></span></span></span></p><p><span style="color:black; font-size:9pt;"  ><span style="font-family:Times New Roman;"  >     <span style="color:blue;"  >int<span style="color:black;"  >       <span style="color:#000099;"  >0feh<span style="color:black;"  >         <span style="color:#999999;"  ><em>;</em></span></span></span></span></span></span><span style="font-family:宋体;"  ><em>显示提示信息</em></span><span style="font-family:Times New Roman;"  >    </span></span></p><p><span style="color:black; font-size:9pt;"  ><span style="font-family:Times New Roman;"  >     <span style="color:blue;"  >shr<span style="color:black;"  >       <span style="color:fuchsia;"  >ax<span style="color:red;"  >,<span style="color:#000099;"  >1<span style="color:black;"  >           <span style="color:#999999;"  ><em>;</em></span></span></span></span></span></span></span></span><span style="font-family:宋体;"  ><em>处理模拟的除法错误</em></span><span style="font-family:Times New Roman;"  >    </span></span></p><p><span style="color:black; font-size:9pt;"  ><span style="font-family:Times New Roman;"  >     <span style="color:blue;"  >iretd<span style="color:black;"  >       <span style="color:#999999;"  ><em>;</em></span></span></span></span><span style="font-family:宋体;"  ><em>返回</em></span><span style="font-family:Times New Roman;"  >    </span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >DivBegin        <span style="color:#009999;"  >ENDP<span style="color:black;"  >     </span></span></span></p><p><span style="color:#999999; font-family:Times New Roman; font-size:9pt;"  ><em>;----------------------------------------------------------------------------</em><span style="color:black;"  >    </span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >DivCodeLen      <span style="color:red;"  >=<span style="color:black;"  >      <span style="color:red;"  >$<span style="color:black;"  >       </span></span></span></span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >DivCodeSeg      <span style="color:#009999;"  >ENDS<span style="color:black;"  >     </span></span></span></p><p><span style="color:#999999; font-family:Times New Roman; font-size:9pt;"  ><em>;----------------------------------------------------------------------------</em><span style="color:black;"  >    </span></span></p><p><span style="color:#999999; font-size:9pt;"  ><em><span style="font-family:Times New Roman;"  >;</span><span style="font-family:宋体;"  >溢出陷阱处理程序代码段</span></em><span style="color:black; font-family:Times New Roman;"  >    </span></span></p><p><span style="color:#999999; font-family:Times New Roman; font-size:9pt;"  ><em>;----------------------------------------------------------------------------</em><span style="color:black;"  >    </span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >OFCodeSeg       <span style="color:#009999;"  >SEGMENT<span style="color:black;"  >      <span style="color:#009999;"  >PARA<span style="color:black;"  >        <span style="color:#009999;"  >USE16<span style="color:black;"  >         </span></span></span></span></span></span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >    <span style="color:#009999;"  >ASSUME<span style="color:black;"  >      <span style="color:fuchsia;"  >CS<span style="color:black;"  >:OFCodeSeg </span></span></span></span></span></p><p><span style="color:#999999; font-family:Times New Roman; font-size:9pt;"  ><em>;----------------------------------------------------------------------------</em><span style="color:black;"  >    </span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >OFBegin         <span style="color:#009999;"  >PROC<span style="color:black;"  >      <span style="color:#009999;"  >FAR<span style="color:black;"  >       </span></span></span></span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >    <span style="color:blue;"  >mov<span style="color:black;"  >      <span style="color:fuchsia;"  >si<span style="color:red;"  >,<span style="color:#009999;"  >OFFSET<span style="color:black;"  > Mess4 </span></span></span></span></span></span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >    <span style="color:blue;"  >mov<span style="color:black;"  >      <span style="color:fuchsia;"  >di<span style="color:red;"  >,<span style="color:#000099;"  >0<span style="color:black;"  >         </span></span></span></span></span></span></span></p><p><span style="color:black; font-size:9pt;"  ><span style="font-family:Times New Roman;"  >     <span style="color:blue;"  >int<span style="color:black;"  >       <span style="color:#000099;"  >0feh<span style="color:black;"  >         <span style="color:#999999;"  ><em>;</em></span></span></span></span></span></span><span style="font-family:宋体;"  ><em>显示提示信息</em></span><span style="font-family:Times New Roman;"  >    </span></span></p><p><span style="color:black; font-size:9pt;"  ><span style="font-family:Times New Roman;"  >     <span style="color:blue;"  >iretd<span style="color:black;"  >       <span style="color:#999999;"  ><em>;</em></span></span></span></span><span style="font-family:宋体;"  ><em>返回</em></span><span style="font-family:Times New Roman;"  >    </span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >OFBegin         <span style="color:#009999;"  >ENDP<span style="color:black;"  >     </span></span></span></p><p><span style="color:#999999; font-family:Times New Roman; font-size:9pt;"  ><em>;----------------------------------------------------------------------------</em><span style="color:black;"  >    </span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >OFCodeLen       <span style="color:red;"  >=<span style="color:black;"  >      <span style="color:red;"  >$<span style="color:black;"  >       </span></span></span></span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >OFCodeSeg       <span style="color:#009999;"  >ENDS<span style="color:black;"  >     </span></span></span></p><p><span style="color:#999999; font-family:Times New Roman; font-size:9pt;"  ><em>;----------------------------------------------------------------------------</em><span style="color:black;"  >    </span></span></p><p><span style="color:#999999; font-size:9pt;"  ><em><span style="font-family:Times New Roman;"  >;</span><span style="font-family:宋体;"  >段不存在故障处理程序代码段</span></em><span style="color:black; font-family:Times New Roman;"  >    </span></span></p><p><span style="color:#999999; font-family:Times New Roman; font-size:9pt;"  ><em>;----------------------------------------------------------------------------</em><span style="color:black;"  >    </span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >SNPCodeSeg      <span style="color:#009999;"  >SEGMENT<span style="color:black;"  >      <span style="color:#009999;"  >PARA<span style="color:black;"  >        <span style="color:#009999;"  >USE16<span style="color:black;"  >         </span></span></span></span></span></span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >    <span style="color:#009999;"  >ASSUME<span style="color:black;"  >      <span style="color:fuchsia;"  >CS<span style="color:black;"  >:SNPCodeSeg </span></span></span></span></span></p><p><span style="color:#999999; font-family:Times New Roman; font-size:9pt;"  ><em>;----------------------------------------------------------------------------</em><span style="color:black;"  >    </span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >SNPBegin        <span style="color:#009999;"  >PROC<span style="color:black;"  >      <span style="color:#009999;"  >FAR<span style="color:black;"  >       </span></span></span></span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >    <span style="color:blue;"  >mov<span style="color:black;"  >      <span style="color:fuchsia;"  >si<span style="color:red;"  >,<span style="color:#009999;"  >OFFSET<span style="color:black;"  > MessB </span></span></span></span></span></span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >    <span style="color:blue;"  >mov<span style="color:black;"  >      <span style="color:fuchsia;"  >di<span style="color:red;"  >,<span style="color:#000099;"  >0<span style="color:black;"  >         </span></span></span></span></span></span></span></p><p><span style="color:black; font-size:9pt;"  ><span style="font-family:Times New Roman;"  >     <span style="color:blue;"  >int<span style="color:black;"  >       <span style="color:#000099;"  >0feh<span style="color:black;"  >         <span style="color:#999999;"  ><em>;</em></span></span></span></span></span></span><span style="font-family:宋体;"  ><em>显示提示信息</em></span><span style="font-family:Times New Roman;"  >    </span></span></p><p><span style="color:black; font-size:9pt;"  ><span style="font-family:Times New Roman;"  >     <span style="color:blue;"  >pop<span style="color:black;"  >       <span style="color:fuchsia;"  >eax<span style="color:black;"  >         <span style="color:#999999;"  ><em>;</em></span></span></span></span></span></span><span style="font-family:宋体;"  ><em>弹出出错代码</em></span><span style="font-family:Times New Roman;"  >    </span></span></p><p><span style="color:black; font-size:9pt;"  ><span style="font-family:Times New Roman;"  >     <span style="color:#009900;"  >CALL16<span style="color:black;"  >  SubCode_Sel<span style="color:red;"  >,<span style="color:black;"  >SubBegin      <span style="color:#999999;"  ><em>;</em></span></span></span></span></span></span><span style="font-family:宋体;"  ><em>显示出错代码</em></span><span style="font-family:Times New Roman;"  >    </span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >    <span style="color:blue;"  >pop<span style="color:black;"  >      <span style="color:fuchsia;"  >eax<span style="color:black;"  >       </span></span></span></span></span></p><p><span style="color:black; font-size:9pt;"  ><span style="font-family:Times New Roman;"  >     <span style="color:blue;"  >add<span style="color:black;"  >       <span style="color:fuchsia;"  >eax<span style="color:red;"  >,<span style="color:#000099;"  >2<span style="color:black;"  >           <span style="color:#999999;"  ><em>;</em></span></span></span></span></span></span></span></span><span style="font-family:宋体;"  ><em>按模拟的引起段不存在指令</em></span><span style="font-family:Times New Roman;"  >    </span></span></p><p><span style="color:black; font-size:9pt;"  ><span style="font-family:Times New Roman;"  >     <span style="color:blue;"  >push<span style="color:black;"  >       <span style="color:fuchsia;"  >eax<span style="color:black;"  >         <span style="color:#999999;"  ><em>;</em></span></span></span></span></span></span><span style="font-family:宋体;"  ><em>调整返回地址</em></span><span style="font-family:Times New Roman;"  >    </span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >    <span style="color:blue;"  >iretd<span style="color:black;"  >     </span></span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >SNPBegin        <span style="color:#009999;"  >ENDP<span style="color:black;"  >     </span></span></span></p><p><span style="color:#999999; font-family:Times New Roman; font-size:9pt;"  ><em>;----------------------------------------------------------------------------</em><span style="color:black;"  >    </span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >SNPCodeLen      <span style="color:red;"  >=<span style="color:black;"  >      <span style="color:red;"  >$<span style="color:black;"  >       </span></span></span></span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >SNPCodeSeg      <span style="color:#009999;"  >ENDS<span style="color:black;"  >     </span></span></span></p><p><span style="color:#999999; font-family:Times New Roman; font-size:9pt;"  ><em>;----------------------------------------------------------------------------</em><span style="color:black;"  >    </span></span></p><p><span style="color:#999999; font-size:9pt;"  ><em><span style="font-family:Times New Roman;"  >;</span><span style="font-family:宋体;"  >堆栈段故障处理程序代码段</span></em><span style="color:black; font-family:Times New Roman;"  >    </span></span></p><p><span style="color:#999999; font-family:Times New Roman; font-size:9pt;"  ><em>;----------------------------------------------------------------------------</em><span style="color:black;"  >    </span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >SSECodeSeg      <span style="color:#009999;"  >SEGMENT<span style="color:black;"  >      <span style="color:#009999;"  >PARA<span style="color:black;"  >        <span style="color:#009999;"  >USE16<span style="color:black;"  >         </span></span></span></span></span></span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >    <span style="color:#009999;"  >ASSUME<span style="color:black;"  >      <span style="color:fuchsia;"  >CS<span style="color:black;"  >:SSECodeSeg </span></span></span></span></span></p><p><span style="color:#999999; font-family:Times New Roman; font-size:9pt;"  ><em>;----------------------------------------------------------------------------</em><span style="color:black;"  >    </span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >SSEBegin        <span style="color:#009999;"  >PROC<span style="color:black;"  >      <span style="color:#009999;"  >FAR<span style="color:black;"  >       </span></span></span></span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >    <span style="color:blue;"  >mov<span style="color:black;"  >      <span style="color:fuchsia;"  >si<span style="color:red;"  >,<span style="color:#009999;"  >OFFSET<span style="color:black;"  > MessC </span></span></span></span></span></span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >    <span style="color:blue;"  >mov<span style="color:black;"  >      <span style="color:fuchsia;"  >di<span style="color:red;"  >,<span style="color:#000099;"  >0<span style="color:black;"  >         </span></span></span></span></span></span></span></p><p><span style="color:black; font-size:9pt;"  ><span style="font-family:Times New Roman;"  >     <span style="color:blue;"  >int<span style="color:black;"  >       <span style="color:#000099;"  >0feh<span style="color:black;"  >         <span style="color:#999999;"  ><em>;</em></span></span></span></span></span></span><span style="font-family:宋体;"  ><em>显示提示信息</em></span><span style="font-family:Times New Roman;"  >    </span></span></p><p><span style="color:black; font-size:9pt;"  ><span style="font-family:Times New Roman;"  >     <span style="color:blue;"  >pop<span style="color:black;"  >       <span style="color:fuchsia;"  >eax<span style="color:black;"  >         <span style="color:#999999;"  ><em>;</em></span></span></span></span></span></span><span style="font-family:宋体;"  ><em>弹出出错代码</em></span><span style="font-family:Times New Roman;"  >    </span></span></p><p><span style="color:black; font-size:9pt;"  ><span style="font-family:Times New Roman;"  >     <span style="color:#009900;"  >CALL16<span style="color:black;"  >  SubCode_Sel<span style="color:red;"  >,<span style="color:black;"  >SubBegin      <span style="color:#999999;"  ><em>;</em></span></span></span></span></span></span><span style="font-family:宋体;"  ><em>显示出错代码</em></span><span style="font-family:Times New Roman;"  >    </span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >    <span style="color:blue;"  >pop<span style="color:black;"  >      <span style="color:fuchsia;"  >eax<span style="color:black;"  >       </span></span></span></span></span></p><p><span style="color:black; font-size:9pt;"  ><span style="font-family:Times New Roman;"  >     <span style="color:blue;"  >add<span style="color:black;"  >       <span style="color:fuchsia;"  >eax<span style="color:red;"  >,<span style="color:#000099;"  >4<span style="color:black;"  >           <span style="color:#999999;"  ><em>;</em></span></span></span></span></span></span></span></span><span style="font-family:宋体;"  ><em>按模拟的引起堆栈段错误的</em></span><span style="font-family:Times New Roman;"  >    </span></span></p><p><span style="color:black; font-size:9pt;"  ><span style="font-family:Times New Roman;"  >     <span style="color:blue;"  >push<span style="color:black;"  >       <span style="color:fuchsia;"  >eax<span style="color:black;"  >         <span style="color:#999999;"  ><em>;</em></span></span></span></span></span></span><span style="font-family:宋体;"  ><em>指令调整返回地址</em></span><span style="font-family:Times New Roman;"  >    </span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >    <span style="color:blue;"  >iretd<span style="color:black;"  >     </span></span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >SSEBegin        <span style="color:#009999;"  >ENDP<span style="color:black;"  >     </span></span></span></p><p><span style="color:#999999; font-family:Times New Roman; font-size:9pt;"  ><em>;----------------------------------------------------------------------------</em><span style="color:black;"  >    </span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >SSECodeLen      <span style="color:red;"  >=<span style="color:black;"  >      <span style="color:red;"  >$<span style="color:black;"  >       </span></span></span></span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >SSECodeSeg      <span style="color:#009999;"  >ENDS<span style="color:black;"  >     </span></span></span></p><p><span style="color:#999999; font-family:Times New Roman; font-size:9pt;"  ><em>;----------------------------------------------------------------------------</em><span style="color:black;"  >    </span></span></p><p><span style="color:#999999; font-size:9pt;"  ><em><span style="font-family:Times New Roman;"  >;</span><span style="font-family:宋体;"  >通用保护故障处理程序代码段</span></em><span style="color:black; font-family:Times New Roman;"  >    </span></span></p><p><span style="color:#999999; font-family:Times New Roman; font-size:9pt;"  ><em>;----------------------------------------------------------------------------</em><span style="color:black;"  >    </span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >GPCodeSeg       <span style="color:#009999;"  >SEGMENT<span style="color:black;"  >      <span style="color:#009999;"  >PARA<span style="color:black;"  >        <span style="color:#009999;"  >USE16<span style="color:black;"  >         </span></span></span></span></span></span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >    <span style="color:#009999;"  >ASSUME<span style="color:black;"  >      <span style="color:fuchsia;"  >CS<span style="color:black;"  >:GPCodeSeg </span></span></span></span></span></p><p><span style="color:#999999; font-family:Times New Roman; font-size:9pt;"  ><em>;----------------------------------------------------------------------------</em><span style="color:black;"  >    </span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >GPBegin         <span style="color:#009999;"  >PROC<span style="color:black;"  >      <span style="color:#009999;"  >FAR<span style="color:black;"  >       </span></span></span></span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >    <span style="color:blue;"  >push<span style="color:black;"  >      <span style="color:fuchsia;"  >ebp<span style="color:black;"  >       </span></span></span></span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >    <span style="color:blue;"  >mov<span style="color:black;"  >      <span style="color:fuchsia;"  >ebp<span style="color:red;"  >,<span style="color:fuchsia;"  >esp<span style="color:black;"  >         </span></span></span></span></span></span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >    <span style="color:blue;"  >push<span style="color:black;"  >      <span style="color:fuchsia;"  >eax<span style="color:black;"  >       </span></span></span></span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >    <span style="color:blue;"  >push<span style="color:black;"  >      <span style="color:fuchsia;"  >esi<span style="color:black;"  >       </span></span></span></span></span></p><p><span style="color:black; font-size:9pt;"  ><span style="font-family:Times New Roman;"  >     <span style="color:blue;"  >push<span style="color:black;"  >       <span style="color:fuchsia;"  >edi<span style="color:black;"  >         <span style="color:#999999;"  ><em>;</em></span></span></span></span></span></span><span style="font-family:宋体;"  ><em>保护现场</em></span><span style="font-family:Times New Roman;"  >    </span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >    <span style="color:blue;"  >mov<span style="color:black;"  >      <span style="color:fuchsia;"  >si<span style="color:red;"  >,<span style="color:#009999;"  >OFFSET<span style="color:black;"  > MessD </span></span></span></span></span></span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >    <span style="color:blue;"  >mov<span style="color:black;"  >      <span style="color:fuchsia;"  >di<span style="color:red;"  >,<span style="color:#000099;"  >0<span style="color:black;"  >         </span></span></span></span></span></span></span></p><p><span style="color:black; font-size:9pt;"  ><span style="font-family:Times New Roman;"  >     <span style="color:blue;"  >int<span style="color:black;"  >       <span style="color:#000099;"  >0feh<span style="color:black;"  >         <span style="color:#999999;"  ><em>;</em></span></span></span></span></span></span><span style="font-family:宋体;"  ><em>显示提示信息</em></span><span style="font-family:Times New Roman;"  >    </span></span></p><p><span style="color:black; font-size:9pt;"  ><span style="font-family:Times New Roman;"  >     <span style="color:blue;"  >mov<span style="color:black;"  >       <span style="color:fuchsia;"  >eax<span style="color:red;"  >,[<span style="color:fuchsia;"  >bp<span style="color:red;"  >+<span style="color:#000099;"  >4<span style="color:red;"  >]<span style="color:black;"  >              <span style="color:#999999;"  ><em>;</em></span></span></span></span></span></span></span></span></span></span></span><span style="font-family:宋体;"  ><em>从堆栈中取出出错代码</em></span><span style="font-family:Times New Roman;"  >    </span></span></p><p><span style="color:black; font-size:9pt;"  ><span style="font-family:Times New Roman;"  >     <span style="color:#009900;"  >CALL16<span style="color:black;"  >  SubCode_Sel<span style="color:red;"  >,<span style="color:black;"  >SubBegin      <span style="color:#999999;"  ><em>;</em></span></span></span></span></span></span><span style="font-family:宋体;"  ><em>显示出错代码</em></span><span style="font-family:Times New Roman;"  >    </span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >    <span style="color:blue;"  >pop<span style="color:black;"  >      <span style="color:fuchsia;"  >edi<span style="color:black;"  >       </span></span></span></span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >    <span style="color:blue;"  >pop<span style="color:black;"  >      <span style="color:fuchsia;"  >esi<span style="color:black;"  >       </span></span></span></span></span></p><p><span style="color:black; font-size:9pt;"  ><span style="font-family:Times New Roman;"  >     <span style="color:blue;"  >pop<span style="color:black;"  >       <span style="color:fuchsia;"  >eax<span style="color:black;"  >         <span style="color:#999999;"  ><em>;</em></span></span></span></span></span></span><span style="font-family:宋体;"  ><em>恢复部分现场</em></span><span style="font-family:Times New Roman;"  >    </span></span></p><p><span style="color:black; font-size:9pt;"  ><span style="font-family:Times New Roman;"  >     <span style="color:blue;"  >add<span style="color:black;"  >       <span style="color:#009999;"  >DWORD<span style="color:black;"  >         <span style="color:#009999;"  >PTR<span style="color:black;"  >           <span style="color:red;"  >[<span style="color:fuchsia;"  >ebp<span style="color:red;"  >+<span style="color:#000099;"  >8<span style="color:red;"  >],<span style="color:#000099;"  >2<span style="color:black;"  >                  <span style="color:#999999;"  ><em>;</em></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span style="font-family:宋体;"  ><em>按模拟的故障指令调整返回</em></span><span style="font-family:Times New Roman;"  >    </span></span></p><p><span style="color:black; font-size:9pt;"  ><span style="font-family:Times New Roman;"  >     <span style="color:blue;"  >pop<span style="color:black;"  >       <span style="color:fuchsia;"  >ebp<span style="color:black;"  >         <span style="color:#999999;"  ><em>;</em></span></span></span></span></span></span><span style="font-family:宋体;"  ><em>地址</em></span><span style="font-family:Times New Roman;"  >    </span></span></p><p><span style="color:black; font-size:9pt;"  ><span style="font-family:Times New Roman;"  >     <span style="color:blue;"  >add<span style="color:black;"  >       <span style="color:fuchsia;"  >esp<span style="color:red;"  >,<span style="color:#000099;"  >4<span style="color:black;"  >           <span style="color:#999999;"  ><em>;</em></span></span></span></span></span></span></span></span><span style="font-family:宋体;"  ><em>废除堆栈中的出错代码</em></span><span style="font-family:Times New Roman;"  >    </span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >    <span style="color:blue;"  >iretd<span style="color:black;"  >     </span></span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >GPBegin         <span style="color:#009999;"  >ENDP<span style="color:black;"  >     </span></span></span></p><p><span style="color:#999999; font-family:Times New Roman; font-size:9pt;"  ><em>;----------------------------------------------------------------------------</em><span style="color:black;"  >    </span></span></p><p><span style="color:#999999; font-size:9pt;"  ><em><span style="font-family:Times New Roman;"  >;</span><span style="font-family:宋体;"  >显示出错码过程代码段</span></em><span style="color:black; font-family:Times New Roman;"  >    </span></span></p><p><span style="color:#999999; font-family:Times New Roman; font-size:9pt;"  ><em>;----------------------------------------------------------------------------</em><span style="color:black;"  >    </span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >SubCodeSeg      <span style="color:#009999;"  >SEGMENT<span style="color:black;"  >      <span style="color:#009999;"  >PARA<span style="color:black;"  >        <span style="color:#009999;"  >USE16<span style="color:black;"  >         </span></span></span></span></span></span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >    <span style="color:#009999;"  >ASSUME<span style="color:black;"  >      <span style="color:fuchsia;"  >CS<span style="color:black;"  >:SubCodeSeG </span></span></span></span></span></p><p><span style="color:#999999; font-family:Times New Roman; font-size:9pt;"  ><em>;----------------------------------------------------------------------------</em><span style="color:black;"  >    </span></span></p><p><span style="color:black; font-size:9pt;"  ><span style="font-family:Times New Roman;"  >SubBegin        <span style="color:#009999;"  >PROC<span style="color:black;"  >       <span style="color:#999999;"  ><em>;AX</em></span></span></span></span><span style="font-family:宋体;"  ><em>中含出错代码</em></span><span style="font-family:Times New Roman;"  >    </span></span></p><p><span style="color:black; font-size:9pt;"  ><span style="font-family:Times New Roman;"  >     <span style="color:blue;"  >push<span style="color:black;"  >       <span style="color:fuchsia;"  >ax<span style="color:black;"  >         <span style="color:#999999;"  ><em>;</em></span></span></span></span></span></span><span style="font-family:宋体;"  ><em>保护现场</em></span><span style="font-family:Times New Roman;"  >    </span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >    <span style="color:blue;"  >push<span style="color:black;"  >      <span style="color:fuchsia;"  >cx<span style="color:black;"  >       </span></span></span></span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >    <span style="color:blue;"  >push<span style="color:black;"  >      <span style="color:fuchsia;"  >dx<span style="color:black;"  >       </span></span></span></span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >    <span style="color:blue;"  >push<span style="color:black;"  >      <span style="color:fuchsia;"  >si<span style="color:black;"  >       </span></span></span></span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >    <span style="color:blue;"  >push<span style="color:black;"  >      <span style="color:fuchsia;"  >di<span style="color:black;"  >       </span></span></span></span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >    <span style="color:blue;"  >mov<span style="color:black;"  >      <span style="color:fuchsia;"  >si<span style="color:red;"  >,<span style="color:#009999;"  >OFFSET<span style="color:black;"  > ErrCode </span></span></span></span></span></span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >    <span style="color:blue;"  >mov<span style="color:black;"  >      <span style="color:fuchsia;"  >dx<span style="color:red;"  >,<span style="color:fuchsia;"  >ax<span style="color:black;"  >         </span></span></span></span></span></span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >    <span style="color:blue;"  >mov<span style="color:black;"  >      <span style="color:fuchsia;"  >cx<span style="color:red;"  >,<span style="color:#000099;"  >4<span style="color:black;"  >         </span></span></span></span></span></span></span></p><p><span style="color:#990000; font-size:9pt;"  ><span style="font-family:Times New Roman;"  >SubR1:<span style="color:black;"  >      <span style="color:blue;"  >rol<span style="color:black;"  >        <span style="color:fuchsia;"  >dx<span style="color:red;"  >,<span style="color:#000099;"  >4<span style="color:black;"  >            <span style="color:#999999;"  ><em>;</em></span></span></span></span></span></span></span></span></span><span style="font-family:宋体;"  ><em>把</em></span><span style="color:#999999;"  ><em><span style="font-family:Times New Roman;"  >16</span><span style="font-family:宋体;"  >位出错代码转换成</span><span style="font-family:Times New Roman;"  >4</span><span style="font-family:宋体;"  >位</span></em><span style="color:black; font-family:Times New Roman;"  >     </span></span></span></p><p><span style="color:black; font-size:9pt;"  ><span style="font-family:Times New Roman;"  >     <span style="color:blue;"  >mov<span style="color:black;"  >       <span style="color:fuchsia;"  >al<span style="color:red;"  >,<span style="color:fuchsia;"  >dl<span style="color:black;"  >           <span style="color:#999999;"  ><em>;</em></span></span></span></span></span></span></span></span><span style="font-family:宋体;"  ><em>十六进制数的</em></span><span style="color:#999999;"  ><em><span style="font-family:Times New Roman;"  >ASCII</span><span style="font-family:宋体;"  >码并保存</span></em><span style="color:black; font-family:Times New Roman;"  >     </span></span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >    <span style="color:blue;"  >and<span style="color:black;"  >      <span style="color:fuchsia;"  >al<span style="color:red;"  >,<span style="color:#000099;"  >0fh<span style="color:black;"  >         </span></span></span></span></span></span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >    <span style="color:blue;"  >add<span style="color:black;"  >      <span style="color:fuchsia;"  >al<span style="color:red;"  >,<span style="color:#000099;"  >30h<span style="color:black;"  >         </span></span></span></span></span></span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >    <span style="color:blue;"  >cmp<span style="color:black;"  >      <span style="color:fuchsia;"  >al<span style="color:red;"  >,<span style="color:#999900;"  >'9'<span style="color:black;"  >         </span></span></span></span></span></span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >    <span style="color:blue;"  >jbe<span style="color:black;"  >     SubR2 </span></span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >    <span style="color:blue;"  >add<span style="color:black;"  >      <span style="color:fuchsia;"  >al<span style="color:red;"  >,<span style="color:#000099;"  >7<span style="color:black;"  >         </span></span></span></span></span></span></span></p><p><span style="color:#990000; font-family:Times New Roman; font-size:9pt;"  >SubR2:<span style="color:black;"  >     <span style="color:blue;"  >mov<span style="color:black;"  >       <span style="color:red;"  >[<span style="color:fuchsia;"  >si<span style="color:red;"  >],<span style="color:fuchsia;"  >al<span style="color:black;"  >           </span></span></span></span></span></span></span></span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >    <span style="color:blue;"  >inc<span style="color:black;"  >      <span style="color:fuchsia;"  >si<span style="color:black;"  >       </span></span></span></span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >    <span style="color:blue;"  >loop<span style="color:black;"  >    SubR1 </span></span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >    <span style="color:blue;"  >mov<span style="color:black;"  >      <span style="color:fuchsia;"  >si<span style="color:red;"  >,<span style="color:#009999;"  >OFFSET<span style="color:black;"  > ErrMess </span></span></span></span></span></span></span></p><p><span style="color:black; font-size:9pt;"  ><span style="font-family:Times New Roman;"  >     <span style="color:blue;"  >Mov<span style="color:black;"  >       <span style="color:fuchsia;"  >di<span style="color:red;"  >,<span style="color:#000099;"  >80<span style="color:red;"  >*<span style="color:#000099;"  >2<span style="color:black;"  >             <span style="color:#999999;"  ><em>;</em></span></span></span></span></span></span></span></span></span></span><span style="font-family:宋体;"  ><em>从第二行行首开始</em></span><span style="font-family:Times New Roman;"  >    </span></span></p><p><span style="color:black; font-size:9pt;"  ><span style="font-family:Times New Roman;"  >     <span style="color:blue;"  >int<span style="color:black;"  >       <span style="color:#000099;"  >0feh<span style="color:black;"  >         <span style="color:#999999;"  ><em>;</em></span></span></span></span></span></span><span style="font-family:宋体;"  ><em>显示出错码</em></span><span style="font-family:Times New Roman;"  >    </span></span></p><p><span style="color:black; font-size:9pt;"  ><span style="font-family:Times New Roman;"  >     <span style="color:blue;"  >pop<span style="color:black;"  >       <span style="color:fuchsia;"  >di<span style="color:black;"  >         <span style="color:#999999;"  ><em>;</em></span></span></span></span></span></span><span style="font-family:宋体;"  ><em>恢复现场</em></span><span style="font-family:Times New Roman;"  >    </span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >    <span style="color:blue;"  >pop<span style="color:black;"  >      <span style="color:fuchsia;"  >si<span style="color:black;"  >       </span></span></span></span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >    <span style="color:blue;"  >pop<span style="color:black;"  >      <span style="color:fuchsia;"  >dx<span style="color:black;"  >       </span></span></span></span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >    <span style="color:blue;"  >pop<span style="color:black;"  >      <span style="color:fuchsia;"  >cx<span style="color:black;"  >       </span></span></span></span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >    <span style="color:blue;"  >pop<span style="color:black;"  >      <span style="color:fuchsia;"  >ax<span style="color:black;"  >       </span></span></span></span></span></p><p><span style="color:black; font-size:9pt;"  ><span style="font-family:Times New Roman;"  >     <span style="color:blue;"  >retf<span style="color:black;"  >       <span style="color:#999999;"  ><em>;</em></span></span></span></span><span style="font-family:宋体;"  ><em>返回</em></span><span style="font-family:Times New Roman;"  >    </span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >SubBegin        <span style="color:#009999;"  >ENDP<span style="color:black;"  >     </span></span></span></p><p><span style="color:#999999; font-family:Times New Roman; font-size:9pt;"  ><em>;----------------------------------------------------------------------------</em><span style="color:black;"  >    </span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >SubCodeLen      <span style="color:red;"  >=<span style="color:black;"  >      <span style="color:red;"  >$<span style="color:black;"  >       </span></span></span></span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >SubCodeSeg      <span style="color:#009999;"  >ENDS<span style="color:black;"  >     </span></span></span></p><p><span style="color:#999999; font-family:Times New Roman; font-size:9pt;"  ><em>;----------------------------------------------------------------------------</em><span style="color:black;"  >    </span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >GPCodeLen       <span style="color:red;"  >=<span style="color:black;"  >      <span style="color:red;"  >$<span style="color:black;"  >       </span></span></span></span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >GPCodeSeg       <span style="color:#009999;"  >ENDS<span style="color:black;"  >     </span></span></span></p><p><span style="color:#999999; font-family:Times New Roman; font-size:9pt;"  ><em>;----------------------------------------------------------------------------</em><span style="color:black;"  >    </span></span></p><p><span style="color:#999999; font-size:9pt;"  ><em><span style="font-family:Times New Roman;"  >;</span><span style="font-family:宋体;"  >实现显示的陷阱处理程序代码段</span></em><span style="color:black; font-family:Times New Roman;"  >    </span></span></p><p><span style="color:#999999; font-size:9pt;"  ><em><span style="font-family:Times New Roman;"  >;</span><span style="font-family:宋体;"  >入口参数</span><span style="font-family:Times New Roman;"  >--DS:SI</span><span style="font-family:宋体;"  >指向显示信息串</span><span style="font-family:Times New Roman;"  >,ES:DI</span><span style="font-family:宋体;"  >指向显示缓冲区</span></em><span style="color:black; font-family:Times New Roman;"  >    </span></span></p><p><span style="color:#999999; font-family:Times New Roman; font-size:9pt;"  ><em>;----------------------------------------------------------------------------</em><span style="color:black;"  >    </span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >EchoCodeSeg     <span style="color:#009999;"  >SEGMENT<span style="color:black;"  >      <span style="color:#009999;"  >PARA<span style="color:black;"  >        <span style="color:#009999;"  >USE16<span style="color:black;"  >         </span></span></span></span></span></span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >    <span style="color:#009999;"  >ASSUME<span style="color:black;"  >      <span style="color:fuchsia;"  >CS<span style="color:black;"  >:EchoCodeSeg </span></span></span></span></span></p><p><span style="color:#999999; font-family:Times New Roman; font-size:9pt;"  ><em>;----------------------------------------------------------------------------</em><span style="color:black;"  >    </span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >EchoBegin       <span style="color:#009999;"  >PROC<span style="color:black;"  >      <span style="color:#009999;"  >FAR<span style="color:black;"  >       </span></span></span></span></span></p><p><span style="color:black; font-size:9pt;"  ><span style="font-family:Times New Roman;"  >     <span style="color:blue;"  >pushad<span style="color:black;"  >       <span style="color:#999999;"  ><em>;</em></span></span></span></span><span style="font-family:宋体;"  ><em>保护现场</em></span><span style="font-family:Times New Roman;"  >    </span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >    <span style="color:blue;"  >cld<span style="color:black;"  >     </span></span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >    <span style="color:blue;"  >mov<span style="color:black;"  >      <span style="color:fuchsia;"  >ah<span style="color:red;"  >,<span style="color:#000099;"  >7<span style="color:black;"  >         </span></span></span></span></span></span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >    <span style="color:blue;"  >mov<span style="color:black;"  >      <span style="color:fuchsia;"  >al<span style="color:red;"  >,<span style="color:#000099;"  >20h<span style="color:black;"  >         </span></span></span></span></span></span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >    <span style="color:blue;"  >mov<span style="color:black;"  >      <span style="color:fuchsia;"  >cx<span style="color:red;"  >,<span style="color:#000099;"  >80<span style="color:black;"  >         </span></span></span></span></span></span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >    <span style="color:blue;"  >push<span style="color:black;"  >      <span style="color:fuchsia;"  >di<span style="color:black;"  >       </span></span></span></span></span></p><p><span style="color:black; font-size:9pt;"  ><span style="font-family:Times New Roman;"  >     <span style="color:blue;"  >rep<span style="color:black;"  >       <span style="color:blue;"  >stosw<span style="color:black;"  >         <span style="color:#999999;"  ><em>;</em></span></span></span></span></span></span><span style="font-family:宋体;"  ><em>清所在显示行</em></span><span style="font-family:Times New Roman;"  >    </span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >    <span style="color:blue;"  >pop<span style="color:black;"  >      <span style="color:fuchsia;"  >di<span style="color:black;"  >       </span></span></span></span></span></p><p><span style="color:#990000; font-family:Times New Roman; font-size:9pt;"  >Echo1:<span style="color:black;"  >     <span style="color:blue;"  >lodsb<span style="color:black;"  >      </span></span></span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >    <span style="color:blue;"  >or<span style="color:black;"  >      <span style="color:fuchsia;"  >al<span style="color:red;"  >,<span style="color:fuchsia;"  >al<span style="color:black;"  >         </span></span></span></span></span></span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >    <span style="color:blue;"  >jz<span style="color:black;"  >      Echo2 </span></span></span></p><p><span style="color:black; font-size:9pt;"  ><span style="font-family:Times New Roman;"  >     <span style="color:blue;"  >stosw<span style="color:black;"  >       <span style="color:#999999;"  ><em>;</em></span></span></span></span><span style="font-family:宋体;"  ><em>显示指定信息串</em></span><span style="font-family:Times New Roman;"  >    </span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >    <span style="color:blue;"  >jmp<span style="color:black;"  >     Echo1 </span></span></span></p><p><span style="color:#990000; font-size:9pt;"  ><span style="font-family:Times New Roman;"  >Echo2:<span style="color:black;"  >      <span style="color:blue;"  >popad<span style="color:black;"  >        <span style="color:#999999;"  ><em>;</em></span></span></span></span></span><span style="font-family:宋体;"  ><em>恢复现场</em></span><span style="color:black; font-family:Times New Roman;"  >    </span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >    <span style="color:blue;"  >iretd<span style="color:black;"  >     </span></span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >EchoBegin       <span style="color:#009999;"  >ENDP<span style="color:black;"  >     </span></span></span></p><p><span style="color:#999999; font-family:Times New Roman; font-size:9pt;"  ><em>;----------------------------------------------------------------------------</em><span style="color:black;"  >    </span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >EchoCodeLen     <span style="color:red;"  >=<span style="color:black;"  >      <span style="color:red;"  >$<span style="color:black;"  >       </span></span></span></span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >EchoCodeSeg     <span style="color:#009999;"  >ENDS<span style="color:black;"  >     </span></span></span></p><p><span style="color:#999999; font-family:Times New Roman; font-size:9pt;"  ><em>;----------------------------------------------------------------------------</em><span style="color:black;"  >    </span></span></p><p><span style="color:#999999; font-size:9pt;"  ><em><span style="font-family:Times New Roman;"  >;</span><span style="font-family:宋体;"  >缓冲区数据段</span></em><span style="color:black; font-family:Times New Roman;"  >    </span></span></p><p><span style="color:#999999; font-family:Times New Roman; font-size:9pt;"  ><em>;----------------------------------------------------------------------------</em><span style="color:black;"  >    </span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >BufferSeg       <span style="color:#009999;"  >SEGMENT<span style="color:black;"  >      <span style="color:#009999;"  >PARA<span style="color:black;"  >        <span style="color:#009999;"  >USE16<span style="color:black;"  >         </span></span></span></span></span></span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >KeyASCII        <span style="color:#009999;"  >DB<span style="color:black;"  >      <span style="color:red;"  >?<span style="color:black;"  >       </span></span></span></span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >Buffer          <span style="color:#009999;"  >DB<span style="color:black;"  >      <span style="color:#000099;"  >128<span style="color:black;"  >        <span style="color:#009999;"  >DUP<span style="color:red;"  >(?)<span style="color:black;"  >          </span></span></span></span></span></span></span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >BufferLen       <span style="color:red;"  >=<span style="color:black;"  >      <span style="color:red;"  >$<span style="color:black;"  >       </span></span></span></span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >BufferSeg       <span style="color:#009999;"  >ENDS<span style="color:black;"  >     </span></span></span></p><p><span style="color:#999999; font-family:Times New Roman; font-size:9pt;"  ><em>;----------------------------------------------------------------------------</em><span style="color:black;"  >    </span></span></p><p><span style="color:#999999; font-size:9pt;"  ><em><span style="font-family:Times New Roman;"  >;</span><span style="font-family:宋体;"  >演示任务局部描述符表段</span></em><span style="color:black; font-family:Times New Roman;"  >    </span></span></p><p><span style="color:#999999; font-family:Times New Roman; font-size:9pt;"  ><em>;----------------------------------------------------------------------------</em><span style="color:black;"  >    </span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >DemoLDTSeg      <span style="color:#009999;"  >SEGMENT<span style="color:black;"  >      <span style="color:#009999;"  >PARA<span style="color:black;"  >        <span style="color:#009999;"  >USE16<span style="color:black;"  >         </span></span></span></span></span></span></span></p><p><span style="color:#999999; font-family:Times New Roman; font-size:9pt;"  ><em>;----------------------------------------------------------------------------</em><span style="color:black;"  >    </span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >DLDT            <span style="color:#009999;"  >LABEL<span style="color:black;"  >      <span style="color:#009999;"  >BYTE<span style="color:black;"  >       </span></span></span></span></span></p><p><span style="color:black; font-size:9pt;"  ><span style="font-family:Times New Roman;"  >     <span style="color:#999999;"  ><em>;</em></span></span><span style="font-family:宋体;"  ><em>演示任务</em></span><span style="color:#999999;"  ><em><span style="font-family:Times New Roman;"  >TSS</span><span style="font-family:宋体;"  >段作为数据段的描述符及选择子</span></em><span style="color:black; font-family:Times New Roman;"  >     </span></span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >ToDemoTSS       Desc    <span style="color:red;"  >&lt;<span style="color:black;"  >DemoTSSLen<span style="color:red;"  >-<span style="color:#000099;"  >1<span style="color:red;"  >,<span style="color:black;"  >DemoTSSSeg<span style="color:red;"  >,,<span style="color:black;"  >ATDW<span style="color:red;"  >,,&gt;<span style="color:black;"  >             </span></span></span></span></span></span></span></span></span></span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >ToDemoTSS_Sel   <span style="color:red;"  >=<span style="color:black;"  >       ToDemoTSS<span style="color:red;"  >-<span style="color:black;"  >DLDT<span style="color:red;"  >+<span style="color:black;"  >TIL </span></span></span></span></span></span></span></p><p><span style="color:black; font-size:9pt;"  ><span style="font-family:Times New Roman;"  >     <span style="color:#999999;"  ><em>;</em></span></span><span style="font-family:宋体;"  ><em>演示任务堆栈段描述符及选择子</em></span><span style="font-family:Times New Roman;"  >    </span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >DemoStack       Desc    <span style="color:red;"  >&lt;<span style="color:black;"  >DemoStackLen<span style="color:red;"  >-<span style="color:#000099;"  >1<span style="color:red;"  >,<span style="color:black;"  >DemoStackSeg<span style="color:red;"  >,,<span style="color:black;"  >ATDWA<span style="color:red;"  >,,&gt;<span style="color:black;"  >             </span></span></span></span></span></span></span></span></span></span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >DemoStack_Sel   <span style="color:red;"  >=<span style="color:black;"  >       DemoStack<span style="color:red;"  >-<span style="color:black;"  >DLDT<span style="color:red;"  >+<span style="color:black;"  >TIL </span></span></span></span></span></span></span></p><p><span style="color:black; font-size:9pt;"  ><span style="font-family:Times New Roman;"  >     <span style="color:#999999;"  ><em>;</em></span></span><span style="font-family:宋体;"  ><em>演示任务数据段描述符及选择子</em></span><span style="font-family:Times New Roman;"  >    </span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >DemoData        Desc    <span style="color:red;"  >&lt;<span style="color:black;"  >DemoDataLen<span style="color:red;"  >-<span style="color:#000099;"  >1<span style="color:red;"  >,<span style="color:black;"  >DemoDataSeg<span style="color:red;"  >,,<span style="color:black;"  >ATDW<span style="color:red;"  >,,&gt;<span style="color:black;"  >             </span></span></span></span></span></span></span></span></span></span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >DemoData_Sel    <span style="color:red;"  >=<span style="color:black;"  >       DemoData<span style="color:red;"  >-<span style="color:black;"  >DLDT<span style="color:red;"  >+<span style="color:black;"  >TIL </span></span></span></span></span></span></span></p><p><span style="color:black; font-size:9pt;"  ><span style="font-family:Times New Roman;"  >     <span style="color:#999999;"  ><em>;</em></span></span><span style="font-family:宋体;"  ><em>除法出错故障处理程序代码段描述符及选择子</em></span><span style="font-family:Times New Roman;"  >    </span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >Divide          Desc    <span style="color:red;"  >&lt;<span style="color:black;"  >DivCodeLen<span style="color:red;"  >-<span style="color:#000099;"  >1<span style="color:red;"  >,<span style="color:black;"  >DivCodeSeg<span style="color:red;"  >,,<span style="color:black;"  >ATCE<span style="color:red;"  >,,&gt;<span style="color:black;"  >             </span></span></span></span></span></span></span></span></span></span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >Divide_Sel      <span style="color:red;"  >=<span style="color:black;"  >       Divide<span style="color:red;"  >-<span style="color:black;"  >DLDT<span style="color:red;"  >+<span style="color:black;"  >TIL </span></span></span></span></span></span></span></p><p><span style="color:black; font-size:9pt;"  ><span style="font-family:Times New Roman;"  >     <span style="color:#999999;"  ><em>;</em></span></span><span style="font-family:宋体;"  ><em>溢出陷阱处理程序代码段描述符及选择子</em></span><span style="font-family:Times New Roman;"  >    </span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >OverFlow        Desc    <span style="color:red;"  >&lt;<span style="color:black;"  >OFCodeLen<span style="color:red;"  >-<span style="color:#000099;"  >1<span style="color:red;"  >,<span style="color:black;"  >OFCodeSeg<span style="color:red;"  >,,<span style="color:black;"  >ATCE<span style="color:red;"  >,,&gt;<span style="color:black;"  >             </span></span></span></span></span></span></span></span></span></span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >OF_Sel          <span style="color:red;"  >=<span style="color:black;"  >       OverFlow<span style="color:red;"  >-<span style="color:black;"  >DLDT<span style="color:red;"  >+<span style="color:black;"  >TIL </span></span></span></span></span></span></span></p><p><span style="color:black; font-size:9pt;"  ><span style="font-family:Times New Roman;"  >     <span style="color:#999999;"  ><em>;</em></span></span><span style="font-family:宋体;"  ><em>段不存在故障处理程序<span style="color:#999999;"  >代码段描述符及选择子</span></em></span><span style="color:black; font-family:Times New Roman;"  >    </span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >SNPCode         Desc    <span style="color:red;"  >&lt;<span style="color:black;"  >SNPCodeLen<span style="color:red;"  >-<span style="color:#000099;"  >1<span style="color:red;"  >,<span style="color:black;"  >SNPCodeSeg<span style="color:red;"  >,,<span style="color:black;"  >ATCE<span style="color:red;"  >,,&gt;<span style="color:black;"  >             </span></span></span></span></span></span></span></span></span></span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >SNP_Sel         <span style="color:red;"  >=<span style="color:black;"  >       SNPCode<span style="color:red;"  >-<span style="color:black;"  >DLDT<span style="color:red;"  >+<span style="color:black;"  >TIL </span></span></span></span></span></span></span></p><p><span style="color:black; font-size:9pt;"  ><span style="font-family:Times New Roman;"  >     <span style="color:#999999;"  ><em>;</em></span></span><span style="font-family:宋体;"  ><em>堆栈段出错故障处理程序代码段描述符及选择子</em></span><span style="font-family:Times New Roman;"  >    </span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >SSECode         Desc    <span style="color:red;"  >&lt;<span style="color:black;"  >SSECodeLen<span style="color:red;"  >-<span style="color:#000099;"  >1<span style="color:red;"  >,<span style="color:black;"  >SSECodeSeg<span style="color:red;"  >,,<span style="color:black;"  >ATCE<span style="color:red;"  >,,&gt;<span style="color:black;"  >             </span></span></span></span></span></span></span></span></span></span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >SSE_Sel         <span style="color:red;"  >=<span style="color:black;"  >       SSECode<span style="color:red;"  >-<span style="color:black;"  >DLDT<span style="color:red;"  >+<span style="color:black;"  >TIL </span></span></span></span></span></span></span></p><p><span style="color:black; font-size:9pt;"  ><span style="font-family:Times New Roman;"  >     <span style="color:#999999;"  ><em>;</em></span></span><span style="font-family:宋体;"  ><em>通用保护故障处理程序代码段描述符及选择子</em></span><span style="font-family:Times New Roman;"  >    </span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >GPCode          Desc    <span style="color:red;"  >&lt;<span style="color:black;"  >GPCodeLen<span style="color:red;"  >-<span style="color:#000099;"  >1<span style="color:red;"  >,<span style="color:black;"  >GPCodeSeg<span style="color:red;"  >,,<span style="color:black;"  >ATCE<span style="color:red;"  >,,&gt;<span style="color:black;"  >             </span></span></span></span></span></span></span></span></span></span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >GP_Sel          <span style="color:red;"  >=<span style="color:black;"  >       GPCode<span style="color:red;"  >-<span style="color:black;"  >DLDT<span style="color:red;"  >+<span style="color:black;"  >TIL </span></span></span></span></span></span></span></p><p><span style="color:black; font-size:9pt;"  ><span style="font-family:Times New Roman;"  >     <span style="color:#999999;"  ><em>;</em></span></span><span style="font-family:宋体;"  ><em>为模拟段不存在故障而安排的数据段描述符及选择子</em></span><span style="font-family:Times New Roman;"  >    </span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >TestNPS         Desc    <span style="color:red;"  >&lt;<span style="color:#000099;"  >0ffffh<span style="color:red;"  >,,,<span style="color:black;"  >ATDW<span style="color:red;"  >-<span style="color:#000099;"  >80h<span style="color:red;"  >,,&gt;<span style="color:black;"  >           </span></span></span></span></span></span></span></span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >TestNPS_Sel     <span style="color:red;"  >=<span style="color:black;"  >       TestNPS<span style="color:red;"  >-<span style="color:black;"  >DLDT<span style="color:red;"  >+<span style="color:black;"  >TIL </span></span></span></span></span></span></span></p><p><span style="color:#999999; font-family:Times New Roman; font-size:9pt;"  ><em>;----------------------------------------------------------------------------</em><span style="color:black;"  >    </span></span></p><p><span style="color:black; font-size:9pt;"  ><span style="font-family:Times New Roman;"  >DemoLDNum       <span style="color:red;"  >=<span style="color:black;"  >       <span style="color:red;"  >($-<span style="color:black;"  >DLDT<span style="color:red;"  >)/(<span style="color:#009999;"  >SIZE<span style="color:black;"  > Desc<span style="color:red;"  >)<span style="color:black;"  >              <span style="color:#999999;"  ><em>;LDT</em></span></span></span></span></span></span></span></span></span></span></span><span style="font-family:宋体;"  ><em>描述符个数</em></span><span style="font-family:Times New Roman;"  >    </span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >DemoLDTLen      <span style="color:red;"  >=$<span style="color:black;"  >     </span></span></span></p><p><span style="color:#999999; font-family:Times New Roman; font-size:9pt;"  ><em>;----------------------------------------------------------------------------</em><span style="color:black;"  >    </span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >DemoLDTSeg      <span style="color:#009999;"  >ENDS<span style="color:black;"  >     </span></span></span></p><p><span style="color:#999999; font-family:Times New Roman; font-size:9pt;"  ><em>;----------------------------------------------------------------------------</em><span style="color:black;"  >    </span></span></p><p><span style="color:#999999; font-size:9pt;"  ><em><span style="font-family:Times New Roman;"  >;</span><span style="font-family:宋体;"  >演示任务</span><span style="font-family:Times New Roman;"  >TSS</span><span style="font-family:宋体;"  >段</span></em><span style="color:black; font-family:Times New Roman;"  >    </span></span></p><p><span style="color:#999999; font-family:Times New Roman; font-size:9pt;"  ><em>;----------------------------------------------------------------------------</em><span style="color:black;"  >    </span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >DemoTSSSeg      <span style="color:#009999;"  >SEGMENT<span style="color:black;"  >      <span style="color:#009999;"  >PARA<span style="color:black;"  >        <span style="color:#009999;"  >USE16<span style="color:black;"  >         </span></span></span></span></span></span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >DemoTaskSS      TSS     <span style="color:red;"  >&lt;&gt;<span style="color:black;"  >     </span></span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >    <span style="color:#009999;"  >DB<span style="color:black;"  >      <span style="color:#000099;"  >0ffh<span style="color:black;"  >       </span></span></span></span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >DemoTSSLen      <span style="color:red;"  >=<span style="color:black;"  >      <span style="color:red;"  >$<span style="color:black;"  >       </span></span></span></span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >DemoTSSSeg      <span style="color:#009999;"  >ENDS<span style="color:black;"  >     </span></span></span></p><p><span style="color:#999999; font-family:Times New Roman; font-size:9pt;"  ><em>;----------------------------------------------------------------------------</em><span style="color:black;"  >    </span></span></p><p><span style="color:#999999; font-size:9pt;"  ><em><span style="font-family:Times New Roman;"  >;</span><span style="font-family:宋体;"  >演示任务的堆栈段</span></em><span style="color:black; font-family:Times New Roman;"  >    </span></span></p><p><span style="color:#999999; font-family:Times New Roman; font-size:9pt;"  ><em>;----------------------------------------------------------------------------</em><span style="color:black;"  >    </span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >DemoStackSeg    <span style="color:#009999;"  >SEGMENT<span style="color:black;"  >      <span style="color:#009999;"  >PARA<span style="color:black;"  >        <span style="color:#009999;"  >USE16<span style="color:black;"  >         </span></span></span></span></span></span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >DemoStackLen    <span style="color:red;"  >=<span style="color:black;"  >      <span style="color:#000099;"  >1024<span style="color:black;"  >       </span></span></span></span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >    <span style="color:#009999;"  >DB<span style="color:black;"  >      DemoStackLen <span style="color:#009999;"  >DUP<span style="color:red;"  >(<span style="color:#000099;"  >0<span style="color:red;"  >)<span style="color:black;"  >          </span></span></span></span></span></span></span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >DemoStackSeg    <span style="color:#009999;"  >ENDS<span style="color:black;"  >     </span></span></span></p><p><span style="color:#999999; font-family:Times New Roman; font-size:9pt;"  ><em>;----------------------------------------------------------------------------</em><span style="color:black;"  >    </span></span></p><p><span style="color:#999999; font-size:9pt;"  ><em><span style="font-family:Times New Roman;"  >;</span><span style="font-family:宋体;"  >演示任务的数据段</span></em><span style="color:black; font-family:Times New Roman;"  >    </span></span></p><p><span style="color:#999999; font-family:Times New Roman; font-size:9pt;"  ><em>;----------------------------------------------------------------------------</em><span style="color:black;"  >    </span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >DemoDataSeg     <span style="color:#009999;"  >SEGMENT<span style="color:black;"  >      <span style="color:#009999;"  >PARA<span style="color:black;"  >        <span style="color:#009999;"  >USE16<span style="color:black;"  >         </span></span></span></span></span></span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >Mess0           <span style="color:#009999;"  >DB<span style="color:black;"  >      <span style="color:#999900;"  >'Divide Error (Exception 0)'<span style="color:red;"  >,<span style="color:#000099;"  >0<span style="color:black;"  >         </span></span></span></span></span></span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >Mess4           <span style="color:#009999;"  >DB<span style="color:black;"  >      <span style="color:#999900;"  >'Overflow (Exception 4)'<span style="color:red;"  >,<span style="color:#000099;"  >0<span style="color:black;"  >         </span></span></span></span></span></span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >MessB           <span style="color:#009999;"  >DB<span style="color:black;"  >      <span style="color:#999900;"  >'Segment Not Present (Exception 11)'<span style="color:red;"  >,<span style="color:#000099;"  >0<span style="color:black;"  >         </span></span></span></span></span></span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >MessC           <span style="color:#009999;"  >DB<span style="color:black;"  >      <span style="color:#999900;"  >'Stack Segment (Exception 12)'<span style="color:red;"  >,<span style="color:#000099;"  >0<span style="color:black;"  >         </span></span></span></span></span></span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >MessD           <span style="color:#009999;"  >DB<span style="color:black;"  >      <span style="color:#999900;"  >'General Protection (Exception 13)'<span style="color:red;"  >,<span style="color:#000099;"  >0<span style="color:black;"  >         </span></span></span></span></span></span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >MessOther       <span style="color:#009999;"  >DB<span style="color:black;"  >      <span style="color:#999900;"  >'Other Exception'<span style="color:red;"  >,<span style="color:#000099;"  >0<span style="color:black;"  >         </span></span></span></span></span></span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >ErrMess         <span style="color:#009999;"  >DB<span style="color:black;"  >      <span style="color:#999900;"  >'Error Code = '<span style="color:black;"  >       </span></span></span></span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >ErrCode         <span style="color:#009999;"  >DB<span style="color:black;"  >      <span style="color:#000099;"  >4<span style="color:black;"  >        <span style="color:#009999;"  >DUP<span style="color:red;"  >(<span style="color:#000099;"  >0<span style="color:red;"  >),<span style="color:#999900;"  >'H'<span style="color:red;"  >,<span style="color:#000099;"  >0<span style="color:black;"  >               </span></span></span></span></span></span></span></span></span></span></span></span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >DemoDataLen     <span style="color:red;"  >=<span style="color:black;"  >      <span style="color:red;"  >$<span style="color:black;"  >       </span></span></span></span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >DemoDataSeg     <span style="color:#009999;"  >ENDS<span style="color:black;"  >     </span></span></span></p><p><span style="color:#999999; font-family:Times New Roman; font-size:9pt;"  ><em>;----------------------------------------------------------------------------</em><span style="color:black;"  >    </span></span></p><p><span style="color:#999999; font-size:9pt;"  ><em><span style="font-family:Times New Roman;"  >;</span><span style="font-family:宋体;"  >演示任务的代码段</span></em><span style="color:black; font-family:Times New Roman;"  >    </span></span></p><p><span style="color:#999999; font-family:Times New Roman; font-size:9pt;"  ><em>;----------------------------------------------------------------------------</em><span style="color:black;"  >    </span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >DemoCodeSeg     <span style="color:#009999;"  >SEGMENT<span style="color:black;"  >      <span style="color:#009999;"  >PARA<span style="color:black;"  >        <span style="color:#009999;"  >USE16<span style="color:black;"  >         </span></span></span></span></span></span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >    <span style="color:#009999;"  >ASSUME<span style="color:black;"  >      <span style="color:fuchsia;"  >CS<span style="color:black;"  >:DemoCodeSeg<span style="color:red;"  >,<span style="color:fuchsia;"  >DS<span style="color:black;"  >:DemoDataSeg </span></span></span></span></span></span></span></span></p><p><span style="color:#999999; font-family:Times New Roman; font-size:9pt;"  ><em>;----------------------------------------------------------------------------</em><span style="color:black;"  >    </span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >DemoBegin       <span style="color:#009999;"  >PROC<span style="color:black;"  >      <span style="color:#009999;"  >FAR<span style="color:black;"  >       </span></span></span></span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >    <span style="color:blue;"  >mov<span style="color:black;"  >      <span style="color:fuchsia;"  >ax<span style="color:red;"  >,<span style="color:black;"  >DemoLDT_Sel </span></span></span></span></span></span></p><p><span style="color:black; font-size:9pt;"  ><span style="font-family:Times New Roman;"  >     <span style="color:blue;"  >lldt<span style="color:black;"  >       <span style="color:fuchsia;"  >ax<span style="color:black;"  >         <span style="color:#999999;"  ><em>;</em></span></span></span></span></span></span><span style="font-family:宋体;"  ><em>装载</em></span><span style="color:#999999; font-family:Times New Roman;"  ><em>LDTR</em><span style="color:black;"  >     </span></span></span></p><p><span style="color:black; font-size:9pt;"  ><span style="font-family:Times New Roman;"  >     <span style="color:blue;"  >mov<span style="color:black;"  >       <span style="color:fuchsia;"  >ax<span style="color:red;"  >,<span style="color:black;"  >DemoStack_Sel          <span style="color:#999999;"  ><em>;</em></span></span></span></span></span></span></span><span style="font-family:宋体;"  ><em>置堆栈</em></span><span style="font-family:Times New Roman;"  >    </span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >    <span style="color:blue;"  >mov<span style="color:black;"  >      <span style="color:fuchsia;"  >ss<span style="color:red;"  >,<span style="color:fuchsia;"  >ax<span style="color:black;"  >         </span></span></span></span></span></span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >    <span style="color:blue;"  >mov<span style="color:black;"  >      <span style="color:fuchsia;"  >esp<span style="color:red;"  >,<span style="color:black;"  >DemoStackLen </span></span></span></span></span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >    <span style="color:blue;"  >mov<span style="color:black;"  >      <span style="color:fuchsia;"  >ax<span style="color:red;"  >,<span style="color:black;"  >ToDemoTSS_Sel </span></span></span></span></span></span></p><p><span style="color:black; font-size:9pt;"  ><span style="font-family:Times New Roman;"  >     <span style="color:blue;"  >mov<span style="color:black;"  >       <span style="color:fuchsia;"  >gs<span style="color:red;"  >,<span style="color:fuchsia;"  >ax<span style="color:black;"  >           <span style="color:#999999;"  ><em>;</em></span></span></span></span></span></span></span></span><span style="font-family:宋体;"  ><em>把演示任务</em></span><span style="color:#999999;"  ><em><span style="font-family:Times New Roman;"  >LDT</span><span style="font-family:宋体;"  >选择子填入</span></em><span style="font-family:Times New Roman;"  ><em>TSS</em><span style="color:black;"  >      </span></span></span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >    <span style="color:blue;"  >mov<span style="color:black;"  >      <span style="color:#009999;"  >WORD<span style="color:black;"  >        <span style="color:#009999;"  >PTR<span style="color:black;"  >          <span style="color:fuchsia;"  >gs<span style="color:black;"  >:DemoTaskSS<span style="color:red;"  >.<span style="color:black;"  >TRLDTR<span style="color:red;"  >,<span style="color:black;"  >DemoLDT_Sel </span></span></span></span></span></span></span></span></span></span></span></span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >    <span style="color:blue;"  >mov<span style="color:black;"  >      <span style="color:fuchsia;"  >ax<span style="color:red;"  >,<span style="color:black;"  >DemoTSS_Sel </span></span></span></span></span></span></p><p><span style="color:black; font-size:9pt;"  ><span style="font-family:Times New Roman;"  >     <span style="color:blue;"  >ltr<span style="color:black;"  >       <span style="color:fuchsia;"  >ax<span style="color:black;"  >         <span style="color:#999999;"  ><em>;</em></span></span></span></span></span></span><span style="font-family:宋体;"  ><em>装载</em></span><span style="color:#999999; font-family:Times New Roman;"  ><em>TR</em><span style="color:black;"  >     </span></span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >    <span style="color:blue;"  >mov<span style="color:black;"  >      <span style="color:fuchsia;"  >ax<span style="color:red;"  >,<span style="color:black;"  >DemoData_Sel </span></span></span></span></span></span></p><p><span style="color:black; font-size:9pt;"  ><span style="font-family:Times New Roman;"  >     <span style="color:blue;"  >mov<span style="color:black;"  >       <span style="color:fuchsia;"  >ds<span style="color:red;"  >,<span style="color:fuchsia;"  >ax<span style="color:black;"  >           <span style="color:#999999;"  ><em>;</em></span></span></span></span></span></span></span></span><span style="font-family:宋体;"  ><em>装载其它数据段寄存器</em></span><span style="font-family:Times New Roman;"  >    </span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >    <span style="color:blue;"  >mov<span style="color:black;"  >      <span style="color:fuchsia;"  >ax<span style="color:red;"  >,<span style="color:black;"  >VideoBuf_Sel </span></span></span></span></span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >    <span style="color:blue;"  >mov<span style="color:black;"  >      <span style="color:fuchsia;"  >es<span style="color:red;"  >,<span style="color:fuchsia;"  >ax<span style="color:black;"  >         </span></span></span></span></span></span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >    <span style="color:blue;"  >mov<span style="color:black;"  >      <span style="color:fuchsia;"  >ax<span style="color:red;"  >,<span style="color:black;"  >XBuffer_Sel </span></span></span></span></span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >    <span style="color:blue;"  >mov<span style="color:black;"  >      <span style="color:fuchsia;"  >fs<span style="color:red;"  >,<span style="color:fuchsia;"  >ax<span style="color:black;"  >         </span></span></span></span></span></span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >    <span style="color:blue;"  >mov<span style="color:black;"  >      <span style="color:fuchsia;"  >ax<span style="color:red;"  >,<span style="color:black;"  >XBuffer_Sel </span></span></span></span></span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >    <span style="color:blue;"  >mov<span style="color:black;"  >      <span style="color:fuchsia;"  >gs<span style="color:red;"  >,<span style="color:fuchsia;"  >ax<span style="color:black;"  >         </span></span></span></span></span></span></span></p><p><span style="color:black; font-size:9pt;"  ><span style="font-family:Times New Roman;"  >     <span style="color:blue;"  >int<span style="color:black;"  >       <span style="color:#000099;"  >0ffh<span style="color:black;"  >         <span style="color:#999999;"  ><em>;</em></span></span></span></span></span></span><span style="font-family:宋体;"  ><em>接收要模拟的异常类型号</em></span><span style="font-family:Times New Roman;"  >    </span></span></p><p><span style="color:black; font-size:9pt;"  ><span style="font-family:Times New Roman;"  >     <span style="color:blue;"  >mov<span style="color:black;"  >       <span style="color:fuchsia;"  >al<span style="color:red;"  >,<span style="color:#009999;"  >BYTE<span style="color:black;"  >           <span style="color:#009999;"  >PTR<span style="color:black;"  >             <span style="color:fuchsia;"  >fs<span style="color:black;"  >:KeyASCII   <span style="color:#999999;"  ><em>;</em></span></span></span></span></span></span></span></span></span></span></span></span><span style="font-family:宋体;"  ><em>按<span style="color:#999999;"  >接收的字符模拟异常号</span></em></span><span style="color:black; font-family:Times New Roman;"  >    </span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >    <span style="color:blue;"  >cmp<span style="color:black;"  >      <span style="color:fuchsia;"  >al<span style="color:red;"  >,<span style="color:#999900;"  >'0'<span style="color:black;"  >         </span></span></span></span></span></span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >    <span style="color:blue;"  >jnz<span style="color:black;"  >     Demo4 </span></span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >    <span style="color:blue;"  >mov<span style="color:black;"  >      <span style="color:fuchsia;"  >ax<span style="color:red;"  >,<span style="color:#000099;"  >2000<span style="color:black;"  >         </span></span></span></span></span></span></span></p><p><span style="color:black; font-size:9pt;"  ><span style="font-family:Times New Roman;"  >     <span style="color:blue;"  >mov<span style="color:black;"  >       <span style="color:fuchsia;"  >cl<span style="color:red;"  >,<span style="color:#000099;"  >2<span style="color:black;"  >           <span style="color:#999999;"  ><em>;</em></span></span></span></span></span></span></span></span><span style="font-family:宋体;"  ><em>模拟除法出错故障</em></span><span style="font-family:Times New Roman;"  >    </span></span></p><p><span style="color:black; font-size:9pt;"  ><span style="font-family:Times New Roman;"  >     <span style="color:blue;"  >div<span style="color:black;"  >       <span style="color:fuchsia;"  >cl<span style="color:black;"  >         <span style="color:#999999;"  ><em>;</em></span></span></span></span></span></span><span style="font-family:宋体;"  ><em>该指令长</em></span><span style="color:#999999;"  ><em><span style="font-family:Times New Roman;"  >2</span><span style="font-family:宋体;"  >字节</span></em><span style="color:black; font-family:Times New Roman;"  >     </span></span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >    <span style="color:blue;"  >jmp<span style="color:black;"  >     Over </span></span></span></p><p><span style="color:#990000; font-family:Times New Roman; font-size:9pt;"  >Demo4:<span style="color:black;"  >     <span style="color:blue;"  >cmp<span style="color:black;"  >       <span style="color:fuchsia;"  >al<span style="color:red;"  >,<span style="color:#999900;"  >'4'<span style="color:black;"  >          </span></span></span></span></span></span></span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >    <span style="color:blue;"  >jnz<span style="color:black;"  >     Demo11 </span></span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >    <span style="color:blue;"  >mov<span style="color:black;"  >      <span style="color:fuchsia;"  >al<span style="color:red;"  >,<span style="color:#000099;"  >100<span style="color:black;"  >         </span></span></span></span></span></span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >    <span style="color:blue;"  >add<span style="color:black;"  >      <span style="color:fuchsia;"  >al<span style="color:red;"  >,<span style="color:#000099;"  >50<span style="color:black;"  >         </span></span></span></span></span></span></span></p><p><span style="color:black; font-size:9pt;"  ><span style="font-family:Times New Roman;"  >     <span style="color:blue;"  >into<span style="color:black;"  >       <span style="color:#999999;"  ><em>;</em></span></span></span></span><span style="font-family:宋体;"  ><em>模拟溢出陷阱</em></span><span style="font-family:Times New Roman;"  >    </span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >    <span style="color:blue;"  >JMP<span style="color:black;"  >     OVER </span></span></span></p><p><span style="color:#990000; font-family:Times New Roman; font-size:9pt;"  >Demo11:<span style="color:black;"  >     <span style="color:blue;"  >cmp<span style="color:black;"  >       <span style="color:fuchsia;"  >al<span style="color:red;"  >,<span style="color:#999900;"  >'B'<span style="color:black;"  >          </span></span></span></span></span></span></span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >    <span style="color:blue;"  >jnz<span style="color:black;"  >     Demo12 </span></span></span></p><p><span style="color:black; font-size:9pt;"  ><span style="font-family:Times New Roman;"  >     <span style="color:blue;"  >mov<span style="color:black;"  >       <span style="color:fuchsia;"  >ax<span style="color:red;"  >,<span style="color:black;"  >TestNPS_Sel            <span style="color:#999999;"  ><em>;</em></span></span></span></span></span></span></span><span style="font-family:宋体;"  ><em>模拟段不存在故障</em></span><span style="font-family:Times New Roman;"  >    </span></span></p><p><span style="color:black; font-size:9pt;"  ><span style="font-family:Times New Roman;"  >     <span style="color:blue;"  >mov<span style="color:black;"  >       <span style="color:fuchsia;"  >gs<span style="color:red;"  >,<span style="color:fuchsia;"  >ax<span style="color:black;"  >           <span style="color:#999999;"  ><em>;</em></span></span></span></span></span></span></span></span><span style="font-family:宋体;"  ><em>该指令长</em></span><span style="color:#999999;"  ><em><span style="font-family:Times New Roman;"  >2</span><span style="font-family:宋体;"  >字节</span></em><span style="color:black; font-family:Times New Roman;"  >     </span></span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >    <span style="color:blue;"  >JMP<span style="color:black;"  >     Over </span></span></span></p><p><span style="color:#990000; font-family:Times New Roman; font-size:9pt;"  >Demo12:<span style="color:black;"  >     <span style="color:blue;"  >cmp<span style="color:black;"  >       <span style="color:fuchsia;"  >al<span style="color:red;"  >,<span style="color:#999900;"  >'C'<span style="color:black;"  >          </span></span></span></span></span></span></span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >    <span style="color:blue;"  >jnz<span style="color:black;"  >     Demo13 </span></span></span></p><p><span style="color:black; font-size:9pt;"  ><span style="font-family:Times New Roman;"  >     <span style="color:blue;"  >mov<span style="color:black;"  >       <span style="color:fuchsia;"  >ebp<span style="color:red;"  >,<span style="color:fuchsia;"  >esp<span style="color:black;"  >           <span style="color:#999999;"  ><em>;</em></span></span></span></span></span></span></span></span><span style="font-family:宋体;"  ><em>模拟堆栈出错故障</em></span><span style="font-family:Times New Roman;"  >    </span></span></p><p><span style="color:black; font-size:9pt;"  ><span style="font-family:Times New Roman;"  >     <span style="color:blue;"  >mov<span style="color:black;"  >       <span style="color:fuchsia;"  >al<span style="color:red;"  >,[<span style="color:fuchsia;"  >ebp<span style="color:red;"  >]<span style="color:black;"  >            <span style="color:#999999;"  ><em>;</em></span></span></span></span></span></span></span></span></span><span style="font-family:宋体;"  ><em>该指令长</em></span><span style="color:#999999;"  ><em><span style="font-family:Times New Roman;"  >4</span><span style="font-family:宋体;"  >字节</span></em><span style="color:black; font-family:Times New Roman;"  >     </span></span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >    <span style="color:blue;"  >jmp<span style="color:black;"  >     Over </span></span></span></p><p><span style="color:#990000; font-size:9pt;"  ><span style="font-family:Times New Roman;"  >Demo13:<span style="color:black;"  >      <span style="color:blue;"  >mov<span style="color:black;"  >        <span style="color:fuchsia;"  >ax<span style="color:red;"  >,<span style="color:black;"  >DemoTSS_Sel            <span style="color:#999999;"  ><em>;</em></span></span></span></span></span></span></span></span><span style="font-family:宋体;"  ><em>模拟通用保护故障</em></span><span style="color:black; font-family:Times New Roman;"  >    </span></span></p><p><span style="color:black; font-size:9pt;"  ><span style="font-family:Times New Roman;"  >     <span style="color:blue;"  >mov<span style="color:black;"  >       <span style="color:fuchsia;"  >gs<span style="color:red;"  >,<span style="color:fuchsia;"  >ax<span style="color:black;"  >           <span style="color:#999999;"  ><em>;</em></span></span></span></span></span></span></span></span><span style="font-family:宋体;"  ><em>该指令长</em></span><span style="color:#999999;"  ><em><span style="font-family:Times New Roman;"  >2</span><span style="font-family:宋体;"  >字节</span></em><span style="color:black; font-family:Times New Roman;"  >     </span></span></span></p><p><span style="color:#990000; font-size:9pt;"  ><span style="font-family:Times New Roman;"  >Over:<span style="color:black;"  >      <span style="color:#999999;"  ><em>;</em></span></span></span><span style="font-family:宋体;"  ><em>转临时代码段</em></span><span style="color:black; font-family:Times New Roman;"  >    </span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >    <span style="color:#009900;"  >JUMP16<span style="color:black;"  >  TempCode_Sel<span style="color:red;"  >,&lt;<span style="color:#009999;"  >OFFSET<span style="color:black;"  > ToDos<span style="color:red;"  >&gt;<span style="color:black;"  >          </span></span></span></span></span></span></span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >DemoBegin       <span style="color:#009999;"  >ENDP<span style="color:black;"  >     </span></span></span></p><p><span style="color:#999999; font-family:Times New Roman; font-size:9pt;"  ><em>;----------------------------------------------------------------------------</em><span style="color:black;"  >    </span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >DemoCodeLen     <span style="color:red;"  >=<span style="color:black;"  >      <span style="color:red;"  >$<span style="color:black;"  >       </span></span></span></span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >DemoCodeSeg     <span style="color:#009999;"  >ENDS<span style="color:black;"  >     </span></span></span></p><p><span style="color:#999999; font-family:Times New Roman; font-size:9pt;"  ><em>;----------------------------------------------------------------------------</em><span style="color:black;"  >    </span></span></p><p><span style="color:black; font-size:9pt;"  ><span style="font-family:Times New Roman;"  >TempCodeSeg     <span style="color:#009999;"  >SEGMENT<span style="color:black;"  >       <span style="color:#009999;"  >PARA<span style="color:black;"  >         <span style="color:#009999;"  >USE16<span style="color:black;"  >           <span style="color:#999999;"  ><em>;</em></span></span></span></span></span></span></span></span><span style="font-family:宋体;"  ><em>临时任务的代码段</em></span><span style="font-family:Times New Roman;"  >    </span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >    <span style="color:#009999;"  >ASSUME<span style="color:black;"  >      <span style="color:fuchsia;"  >CS<span style="color:black;"  >:TempCodeSeg </span></span></span></span></span></p><p><span style="color:#999999; font-family:Times New Roman; font-size:9pt;"  ><em>;----------------------------------------------------------------------------</em><span style="color:black;"  >    </span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >Virtual         <span style="color:#009999;"  >PROC<span style="color:black;"  >      <span style="color:#009999;"  >FAR<span style="color:black;"  >       </span></span></span></span></span></p><p><span style="color:black; font-size:9pt;"  ><span style="font-family:Times New Roman;"  >     <span style="color:#009900;"  >JUMP16<span style="color:black;"  >  DemoCode_Sel<span style="color:red;"  >,<span style="color:black;"  >DemoBegin    <span style="color:#999999;"  ><em>;</em></span></span></span></span></span></span><span style="font-family:宋体;"  ><em>转演示任务</em></span><span style="font-family:Times New Roman;"  >    </span></span></p><p><span style="color:#990000; font-size:9pt;"  ><span style="font-family:Times New Roman;"  >ToDos:<span style="color:black;"  >      <span style="color:blue;"  >mov<span style="color:black;"  >        <span style="color:fuchsia;"  >ax<span style="color:red;"  >,<span style="color:black;"  >Normal_Sel             <span style="color:#999999;"  ><em>;</em></span></span></span></span></span></span></span></span><span style="font-family:宋体;"  ><em>恢复实方式段描述符高速缓存</em></span><span style="color:black; font-family:Times New Roman;"  >    </span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >    <span style="color:blue;"  >mov<span style="color:black;"  >      <span style="color:fuchsia;"  >ds<span style="color:red;"  >,<span style="color:fuchsia;"  >ax<span style="color:black;"  >         </span></span></span></span></span></span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >    <span style="color:blue;"  >mov<span style="color:black;"  >      <span style="color:fuchsia;"  >es<span style="color:red;"  >,<span style="color:fuchsia;"  >ax<span style="color:black;"  >         </span></span></span></span></span></span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >    <span style="color:blue;"  >mov<span style="color:black;"  >      <span style="color:fuchsia;"  >fs<span style="color:red;"  >,<span style="color:fuchsia;"  >ax<span style="color:black;"  >         </span></span></span></span></span></span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >    <span style="color:blue;"  >mov<span style="color:black;"  >      <span style="color:fuchsia;"  >gs<span style="color:red;"  >,<span style="color:fuchsia;"  >ax<span style="color:black;"  >         </span></span></span></span></span></span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >    <span style="color:blue;"  >mov<span style="color:black;"  >      <span style="color:fuchsia;"  >ss<span style="color:red;"  >,<span style="color:fuchsia;"  >ax<span style="color:black;"  >         </span></span></span></span></span></span></span></p><p><span style="color:black; font-size:9pt;"  ><span style="font-family:Times New Roman;"  >     <span style="color:blue;"  >mov<span style="color:black;"  >       <span style="color:fuchsia;"  >eax<span style="color:red;"  >,<span style="color:fuchsia;"  >cr0<span style="color:black;"  >           <span style="color:#999999;"  ><em>;</em></span></span></span></span></span></span></span></span><span style="font-family:宋体;"  ><em>准备返回实模式</em></span><span style="font-family:Times New Roman;"  >    </span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >    <span style="color:blue;"  >and<span style="color:black;"  >      <span style="color:fuchsia;"  >al<span style="color:red;"  >,<span style="color:#000099;"  >11111110b<span style="color:black;"  >         </span></span></span></span></span></span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >    <span style="color:blue;"  >mov<span style="color:black;"  >      <span style="color:fuchsia;"  >cr0<span style="color:red;"  >,<span style="color:fuchsia;"  >eax<span style="color:black;"  >         </span></span></span></span></span></span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >    <span style="color:#009900;"  >JUMP16<span style="color:black;"  >      <span style="color:red;"  >&lt;<span style="color:#009999;"  >SEG<span style="color:black;"  > Real<span style="color:red;"  >&gt;,&lt;<span style="color:#009999;"  >OFFSET<span style="color:black;"  > Real<span style="color:red;"  >&gt;<span style="color:black;"  >             </span></span></span></span></span></span></span></span></span></span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >Virtual         <span style="color:#009999;"  >ENDP<span style="color:black;"  >     </span></span></span></p><p><span style="color:#999999; font-family:Times New Roman; font-size:9pt;"  ><em>;----------------------------------------------------------------------------</em><span style="color:black;"  >    </span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >TempCodeSeg     <span style="color:#009999;"  >ENDS<span style="color:black;"  >     </span></span></span></p><p><span style="color:#999999; font-family:Times New Roman; font-size:9pt;"  ><em>;============================================================================</em><span style="color:black;"  >    </span></span></p><p><span style="color:black; font-size:9pt;"  ><span style="font-family:Times New Roman;"  >RDataSeg        <span style="color:#009999;"  >SEGMENT<span style="color:black;"  >       <span style="color:#009999;"  >PARA<span style="color:black;"  >         <span style="color:#009999;"  >USE16<span style="color:black;"  >           <span style="color:#999999;"  ><em>;</em></span></span></span></span></span></span></span></span><span style="font-family:宋体;"  ><em>实方式数据段</em></span><span style="font-family:Times New Roman;"  >    </span></span></p><p><span style="color:black; font-size:9pt;"  ><span style="font-family:Times New Roman;"  >VGDTR           PDesc   <span style="color:red;"  >&lt;<span style="color:black;"  >GDTLen<span style="color:red;"  >-<span style="color:#000099;"  >1<span style="color:red;"  >,&gt;<span style="color:black;"  >           <span style="color:#999999;"  ><em>;GDT</em></span></span></span></span></span></span></span></span><span style="font-family:宋体;"  ><em>伪描述符</em></span><span style="font-family:Times New Roman;"  >    </span></span></p><p><span style="color:black; font-size:9pt;"  ><span style="font-family:Times New Roman;"  >VIDTR           PDesc   <span style="color:red;"  >&lt;<span style="color:black;"  >IDTLen<span style="color:red;"  >-<span style="color:#000099;"  >1<span style="color:red;"  >,&gt;<span style="color:black;"  >           <span style="color:#999999;"  ><em>;IDT</em></span></span></span></span></span></span></span></span><span style="font-family:宋体;"  ><em>伪描述符</em></span><span style="font-family:Times New Roman;"  >    </span></span></p><p><span style="color:black; font-size:9pt;"  ><span style="font-family:Times New Roman;"  >NORVIDTR        PDesc   <span style="color:red;"  >&lt;<span style="color:#000099;"  >3ffh<span style="color:red;"  >,&gt;<span style="color:black;"  >         <span style="color:#999999;"  ><em>;</em></span></span></span></span></span></span><span style="font-family:宋体;"  ><em>用于保存原</em></span><span style="color:#999999;"  ><em><span style="font-family:Times New Roman;"  >IDTR</span><span style="font-family:宋体;"  >值</span></em><span style="color:black; font-family:Times New Roman;"  >     </span></span></span></p><p><span style="color:black; font-size:9pt;"  ><span style="font-family:Times New Roman;"  >SPVar           <span style="color:#009999;"  >DW<span style="color:black;"  >       <span style="color:red;"  >?<span style="color:black;"  >         <span style="color:#999999;"  ><em>;</em></span></span></span></span></span></span><span style="font-family:宋体;"  ><em>用于保存实方式下的</em></span><span style="color:#999999; font-family:Times New Roman;"  ><em>SP</em><span style="color:black;"  >     </span></span></span></p><p><span style="color:black; font-size:9pt;"  ><span style="font-family:Times New Roman;"  >SSVar           <span style="color:#009999;"  >DW<span style="color:black;"  >       <span style="color:red;"  >?<span style="color:black;"  >         <span style="color:#999999;"  ><em>;</em></span></span></span></span></span></span><span style="font-family:宋体;"  ><em>用于保存实方式下的</em></span><span style="color:#999999; font-family:Times New Roman;"  ><em>SS</em><span style="color:black;"  >     </span></span></span></p><p><span style="color:black; font-size:9pt;"  ><span style="font-family:Times New Roman;"  >Mess            <span style="color:#009999;"  >DB<span style="color:black;"  >       <span style="color:#999900;"  >'Press a key[0,4,B,C,D]:$'<span style="color:#999999;"  ><em>;</em></span></span></span></span></span><span style="font-family:宋体;"  ><em>提示信息</em></span><span style="font-family:Times New Roman;"  >    </span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >RDataSeg        <span style="color:#009999;"  >ENDS<span style="color:black;"  >     </span></span></span></p><p><span style="color:#999999; font-family:Times New Roman; font-size:9pt;"  ><em>;----------------------------------------------------------------------------</em><span style="color:black;"  >    </span></span></p><p><span style="color:black; font-size:9pt;"  ><span style="font-family:Times New Roman;"  >RCodeSeg        <span style="color:#009999;"  >SEGMENT<span style="color:black;"  >       <span style="color:#009999;"  >PARA<span style="color:black;"  >         <span style="color:#009999;"  >USE16<span style="color:black;"  >           <span style="color:#999999;"  ><em>;</em></span></span></span></span></span></span></span></span><span style="font-family:宋体;"  ><em>实方式代码段</em></span><span style="font-family:Times New Roman;"  >    </span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >    <span style="color:#009999;"  >ASSUME<span style="color:black;"  >      <span style="color:fuchsia;"  >CS<span style="color:black;"  >:RCodeSeg<span style="color:red;"  >,<span style="color:fuchsia;"  >DS<span style="color:black;"  >:RDataSeg </span></span></span></span></span></span></span></span></p><p><span style="color:#999999; font-family:Times New Roman; font-size:9pt;"  ><em>;----------------------------------------------------------------------------</em><span style="color:black;"  >    </span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >Start           <span style="color:#009999;"  >PROC<span style="color:black;"  >     </span></span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >    <span style="color:blue;"  >mov<span style="color:black;"  >      <span style="color:fuchsia;"  >ax<span style="color:red;"  >,<span style="color:black;"  >RDataSeg </span></span></span></span></span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >    <span style="color:blue;"  >mov<span style="color:black;"  >      <span style="color:fuchsia;"  >ds<span style="color:red;"  >,<span style="color:fuchsia;"  >ax<span style="color:black;"  >         </span></span></span></span></span></span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >    <span style="color:blue;"  >cld<span style="color:black;"  >     </span></span></span></p><p><span style="color:black; font-size:9pt;"  ><span style="font-family:Times New Roman;"  >     <span style="color:blue;"  >call<span style="color:black;"  >    InitGDT                   <span style="color:#999999;"  ><em>;</em></span></span></span></span><span style="font-family:宋体;"  ><em>初始化全局描述符表</em></span><span style="color:#999999; font-family:Times New Roman;"  ><em>GDT</em><span style="color:black;"  >     </span></span></span></p><p><span style="color:black; font-size:9pt;"  ><span style="font-family:Times New Roman;"  >     <span style="color:blue;"  >call<span style="color:black;"  >    InitIDT                   <span style="color:#999999;"  ><em>;</em></span></span></span></span><span style="font-family:宋体;"  ><em>初始化中断描述符表</em></span><span style="color:#999999; font-family:Times New Roman;"  ><em>IDT</em><span style="color:black;"  >     </span></span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >    <span style="color:blue;"  >mov<span style="color:black;"  >      <span style="color:fuchsia;"  >ax<span style="color:red;"  >,<span style="color:black;"  >GKeyLDTSeg </span></span></span></span></span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >    <span style="color:blue;"  >mov<span style="color:black;"  >      <span style="color:fuchsia;"  >fs<span style="color:red;"  >,<span style="color:fuchsia;"  >ax<span style="color:black;"  >         </span></span></span></span></span></span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >    <span style="color:blue;"  >mov<span style="color:black;"  >      <span style="color:fuchsia;"  >cx<span style="color:red;"  >,<span style="color:black;"  >GKeyLDNum </span></span></span></span></span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >    <span style="color:blue;"  >mov<span style="color:black;"  >      <span style="color:fuchsia;"  >si<span style="color:red;"  >,<span style="color:#009999;"  >OFFSET<span style="color:black;"  > GLDT </span></span></span></span></span></span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >    <span style="color:blue;"  >CALL<span style="color:black;"  >    InitLDT </span></span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >    <span style="color:blue;"  >mov<span style="color:black;"  >      <span style="color:fuchsia;"  >ax<span style="color:red;"  >,<span style="color:black;"  >DemoLDTSeg </span></span></span></span></span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >    <span style="color:blue;"  >mov<span style="color:black;"  >      <span style="color:fuchsia;"  >fs<span style="color:red;"  >,<span style="color:fuchsia;"  >ax<span style="color:black;"  >         </span></span></span></span></span></span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >    <span style="color:blue;"  >mov<span style="color:black;"  >      <span style="color:fuchsia;"  >cx<span style="color:red;"  >,<span style="color:black;"  >DemoLDNum </span></span></span></span></span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >    <span style="color:blue;"  >mov<span style="color:black;"  >      <span style="color:fuchsia;"  >si<span style="color:red;"  >,<span style="color:#009999;"  >OFFSET<span style="color:black;"  > DLDT </span></span></span></span></span></span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >    <span style="color:blue;"  >CALL<span style="color:black;"  >    InitLDT </span></span></span></p><p><span style="color:black; font-size:9pt;"  ><span style="font-family:Times New Roman;"  >     <span style="color:blue;"  >mov<span style="color:black;"  >     SSVar<span style="color:red;"  >,<span style="color:fuchsia;"  >ss<span style="color:black;"  >          <span style="color:#999999;"  ><em>;</em></span></span></span></span></span></span></span><span style="font-family:宋体;"  ><em>保存堆栈指针</em></span><span style="font-family:Times New Roman;"  >    </span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >    <span style="color:blue;"  >mov<span style="color:black;"  >     SPVar<span style="color:red;"  >,<span style="color:fuchsia;"  >sp<span style="color:black;"  >        </span></span></span></span></span></span></p><p><span style="color:black; font-size:9pt;"  ><span style="font-family:Times New Roman;"  >     <span style="color:blue;"  >lgdt<span style="color:black;"  >       <span style="color:#009999;"  >QWORD<span style="color:black;"  >         <span style="color:#009999;"  >PTR<span style="color:black;"  > VGDTR           <span style="color:#999999;"  ><em>;</em></span></span></span></span></span></span></span></span><span style="font-family:宋体;"  ><em>装载</em></span><span style="color:#999999; font-family:Times New Roman;"  ><em>GDTR</em><span style="color:black;"  >     </span></span></span></p><p><span style="color:black; font-size:9pt;"  ><span style="font-family:Times New Roman;"  >     <span style="color:blue;"  >sidt<span style="color:black;"  >       <span style="color:#009999;"  >QWORD<span style="color:black;"  >         <span style="color:#009999;"  >PTR<span style="color:black;"  > NORVIDTR        <span style="color:#999999;"  ><em>;</em></span></span></span></span></span></span></span></span><span style="font-family:宋体;"  ><em>保存</em></span><span style="color:#999999; font-family:Times New Roman;"  ><em>IDTR</em><span style="color:black;"  >     </span></span></span></p><p><span style="color:black; font-size:9pt;"  ><span style="font-family:Times New Roman;"  >     <span style="color:blue;"  >cli<span style="color:black;"  >       <span style="color:#999999;"  ><em>;</em></span></span></span></span><span style="font-family:宋体;"  ><em>关中断</em></span><span style="font-family:Times New Roman;"  >    </span></span></p><p><span style="color:black; font-size:9pt;"  ><span style="font-family:Times New Roman;"  >     <span style="color:blue;"  >lidt<span style="color:black;"  >       <span style="color:#009999;"  >QWORD<span style="color:black;"  >         <span style="color:#009999;"  >PTR<span style="color:black;"  > VIDTR           <span style="color:#999999;"  ><em>;</em></span></span></span></span></span></span></span></span><span style="font-family:宋体;"  ><em>装载</em></span><span style="color:#999999; font-family:Times New Roman;"  ><em>IDTR</em><span style="color:black;"  >     </span></span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >    <span style="color:blue;"  >mov<span style="color:black;"  >      <span style="color:fuchsia;"  >eax<span style="color:red;"  >,<span style="color:fuchsia;"  >cr0<span style="color:black;"  >         </span></span></span></span></span></span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >    <span style="color:blue;"  >or<span style="color:black;"  >      <span style="color:fuchsia;"  >al<span style="color:red;"  >,<span style="color:#000099;"  >1<span style="color:black;"  >         </span></span></span></span></span></span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >    <span style="color:blue;"  >mov<span style="color:black;"  >      <span style="color:fuchsia;"  >cr0<span style="color:red;"  >,<span style="color:fuchsia;"  >eax<span style="color:black;"  >         </span></span></span></span></span></span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >    <span style="color:#009900;"  >JUMP16<span style="color:black;"  >      <span style="color:red;"  >&lt;<span style="color:black;"  >TempCode_Sel<span style="color:red;"  >&gt;,&lt;<span style="color:#009999;"  >OFFSET<span style="color:black;"  > Virtual<span style="color:red;"  >&gt;<span style="color:black;"  >            </span></span></span></span></span></span></span></span></span></span></p><p><span style="color:#990000; font-family:Times New Roman; font-size:9pt;"  >Real:<span style="color:black;"  >     <span style="color:blue;"  >mov<span style="color:black;"  >       <span style="color:fuchsia;"  >ax<span style="color:red;"  >,<span style="color:black;"  >RDataSeg </span></span></span></span></span></span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >    <span style="color:blue;"  >mov<span style="color:black;"  >      <span style="color:fuchsia;"  >ds<span style="color:red;"  >,<span style="color:fuchsia;"  >ax<span style="color:black;"  >         </span></span></span></span></span></span></span></p><p><span style="color:black; font-size:9pt;"  ><span style="font-family:Times New Roman;"  >     <span style="color:blue;"  >lss<span style="color:black;"  >       <span style="color:fuchsia;"  >sp<span style="color:red;"  >,<span style="color:#009999;"  >DWORD<span style="color:black;"  >           <span style="color:#009999;"  >PTR<span style="color:black;"  > SPVar        <span style="color:#999999;"  ><em>;</em></span></span></span></span></span></span></span></span></span></span><span style="font-family:宋体;"  ><em>又回到实方式</em></span><span style="font-family:Times New Roman;"  >    </span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >    <span style="color:blue;"  >lidt<span style="color:black;"  >      <span style="color:#009999;"  >QWORD<span style="color:black;"  >        <span style="color:#009999;"  >PTR<span style="color:black;"  > NORVIDTR </span></span></span></span></span></span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >    <span style="color:blue;"  >sti<span style="color:black;"  >     </span></span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >    <span style="color:blue;"  >mov<span style="color:black;"  >      <span style="color:fuchsia;"  >ax<span style="color:red;"  >,<span style="color:#000099;"  >4c00h<span style="color:black;"  >         </span></span></span></span></span></span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >    <span style="color:blue;"  >int<span style="color:black;"  >      <span style="color:#000099;"  >21h<span style="color:black;"  >       </span></span></span></span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >Start           <span style="color:#009999;"  >ENDP<span style="color:black;"  >     </span></span></span></p><p><span style="color:#999999; font-family:Times New Roman; font-size:9pt;"  ><em>;----------------------------------------------------------------------------</em><span style="color:black;"  >    </span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >InitGDT         <span style="color:#009999;"  >PROC<span style="color:black;"  >     </span></span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >    <span style="color:blue;"  >push<span style="color:black;"  >      <span style="color:fuchsia;"  >ds<span style="color:black;"  >       </span></span></span></span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >    <span style="color:blue;"  >mov<span style="color:black;"  >      <span style="color:fuchsia;"  >ax<span style="color:red;"  >,<span style="color:black;"  >GDTSeg </span></span></span></span></span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >    <span style="color:blue;"  >mov<span style="color:black;"  >      <span style="color:fuchsia;"  >ds<span style="color:red;"  >,<span style="color:fuchsia;"  >ax<span style="color:black;"  >         </span></span></span></span></span></span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >    <span style="color:blue;"  >mov<span style="color:black;"  >      <span style="color:fuchsia;"  >cx<span style="color:red;"  >,<span style="color:black;"  >GDNum </span></span></span></span></span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >    <span style="color:blue;"  >mov<span style="color:black;"  >      <span style="color:fuchsia;"  >si<span style="color:red;"  >,<span style="color:#009999;"  >OFFSET<span style="color:black;"  > EFFGDT </span></span></span></span></span></span></span></p><p><span style="color:#990000; font-family:Times New Roman; font-size:9pt;"  >InitG:<span style="color:black;"  >     <span style="color:blue;"  >mov<span style="color:black;"  >       <span style="color:fuchsia;"  >ax<span style="color:red;"  >,[<span style="color:fuchsia;"  >si<span style="color:red;"  >].<span style="color:black;"  >BaseL </span></span></span></span></span></span></span></span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >    <span style="color:blue;"  >movzx<span style="color:black;"  >      <span style="color:fuchsia;"  >eax<span style="color:red;"  >,<span style="color:fuchsia;"  >ax<span style="color:black;"  >         </span></span></span></span></span></span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >    <span style="color:blue;"  >shl<span style="color:black;"  >      <span style="color:fuchsia;"  >eax<span style="color:red;"  >,<span style="color:#000099;"  >4<span style="color:black;"  >         </span></span></span></span></span></span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >    <span style="color:blue;"  >shld<span style="color:black;"  >      <span style="color:fuchsia;"  >edx<span style="color:red;"  >,<span style="color:fuchsia;"  >eax<span style="color:red;"  >,<span style="color:#000099;"  >16<span style="color:black;"  >           </span></span></span></span></span></span></span></span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >    <span style="color:blue;"  >mov<span style="color:black;"  >      <span style="color:#009999;"  >WORD<span style="color:black;"  >        <span style="color:#009999;"  >PTR<span style="color:black;"  >          <span style="color:red;"  >[<span style="color:fuchsia;"  >si<span style="color:red;"  >].<span style="color:black;"  >BaseL<span style="color:red;"  >,<span style="color:fuchsia;"  >ax<span style="color:black;"  >                </span></span></span></span></span></span></span></span></span></span></span></span></span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >    <span style="color:blue;"  >mov<span style="color:black;"  >      <span style="color:#009999;"  >BYTE<span style="color:black;"  >        <span style="color:#009999;"  >PTR<span style="color:black;"  >          <span style="color:red;"  >[<span style="color:fuchsia;"  >si<span style="color:red;"  >].<span style="color:black;"  >BaseM<span style="color:red;"  >,<span style="color:fuchsia;"  >dl<span style="color:black;"  >                </span></span></span></span></span></span></span></span></span></span></span></span></span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >    <span style="color:blue;"  >mov<span style="color:black;"  >      <span style="color:#009999;"  >BYTE<span style="color:black;"  >        <span style="color:#009999;"  >PTR<span style="color:black;"  >          <span style="color:red;"  >[<span style="color:fuchsia;"  >si<span style="color:red;"  >].<span style="color:black;"  >BaseH<span style="color:red;"  >,<span style="color:fuchsia;"  >dh<span style="color:black;"  >                </span></span></span></span></span></span></span></span></span></span></span></span></span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >    <span style="color:blue;"  >add<span style="color:black;"  >      <span style="color:fuchsia;"  >si<span style="color:red;"  >,<span style="color:#009999;"  >SIZE<span style="color:black;"  > Desc </span></span></span></span></span></span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >    <span style="color:blue;"  >loop<span style="color:black;"  >    InitG </span></span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >    <span style="color:blue;"  >pop<span style="color:black;"  >      <span style="color:fuchsia;"  >ds<span style="color:black;"  >       </span></span></span></span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >    <span style="color:blue;"  >mov<span style="color:black;"  >      <span style="color:fuchsia;"  >bx<span style="color:red;"  >,<span style="color:#000099;"  >16<span style="color:black;"  >         </span></span></span></span></span></span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >    <span style="color:blue;"  >mov<span style="color:black;"  >      <span style="color:fuchsia;"  >ax<span style="color:red;"  >,<span style="color:black;"  >GDTSeg </span></span></span></span></span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >    <span style="color:blue;"  >mul<span style="color:black;"  >      <span style="color:fuchsia;"  >bx<span style="color:black;"  >       </span></span></span></span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >    <span style="color:blue;"  >mov<span style="color:black;"  >      <span style="color:#009999;"  >WORD<span style="color:black;"  >        <span style="color:#009999;"  >PTR<span style="color:black;"  > VGDTR<span style="color:red;"  >.<span style="color:black;"  >Base<span style="color:red;"  >,<span style="color:fuchsia;"  >ax<span style="color:black;"  >              </span></span></span></span></span></span></span></span></span></span></span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >    <span style="color:blue;"  >mov<span style="color:black;"  >      <span style="color:#009999;"  >WORD<span style="color:black;"  >        <span style="color:#009999;"  >PTR<span style="color:black;"  > VGDTR<span style="color:red;"  >.<span style="color:black;"  >Base<span style="color:red;"  >+<span style="color:#000099;"  >2<span style="color:red;"  >,<span style="color:fuchsia;"  >dx<span style="color:black;"  >                </span></span></span></span></span></span></span></span></span></span></span></span></span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >    <span style="color:blue;"  >ret<span style="color:black;"  >     </span></span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >InitGDT         <span style="color:#009999;"  >ENDP<span style="color:black;"  >     </span></span></span></p><p><span style="color:#999999; font-family:Times New Roman; font-size:9pt;"  ><em>;----------------------------------------------------------------------------</em><span style="color:black;"  >    </span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >InitIDT         <span style="color:#009999;"  >PROC<span style="color:black;"  >     </span></span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >    <span style="color:blue;"  >mov<span style="color:black;"  >      <span style="color:fuchsia;"  >bx<span style="color:red;"  >,<span style="color:#000099;"  >16<span style="color:black;"  >         </span></span></span></span></span></span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >    <span style="color:blue;"  >mov<span style="color:black;"  >      <span style="color:fuchsia;"  >ax<span style="color:red;"  >,<span style="color:black;"  >IDTSeg </span></span></span></span></span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >    <span style="color:blue;"  >mul<span style="color:black;"  >      <span style="color:fuchsia;"  >bx<span style="color:black;"  >       </span></span></span></span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >    <span style="color:blue;"  >mov<span style="color:black;"  >      <span style="color:#009999;"  >WORD<span style="color:black;"  >        <span style="color:#009999;"  >PTR<span style="color:black;"  > VIDTR<span style="color:red;"  >.<span style="color:black;"  >Base<span style="color:red;"  >,<span style="color:fuchsia;"  >ax<span style="color:black;"  >              </span></span></span></span></span></span></span></span></span></span></span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >    <span style="color:blue;"  >mov<span style="color:black;"  >      <span style="color:#009999;"  >WORD<span style="color:black;"  >        <span style="color:#009999;"  >PTR<span style="color:black;"  > VIDTR<span style="color:red;"  >.<span style="color:black;"  >Base<span style="color:red;"  >+<span style="color:#000099;"  >2<span style="color:red;"  >,<span style="color:fuchsia;"  >dx<span style="color:black;"  >                </span></span></span></span></span></span></span></span></span></span></span></span></span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >    <span style="color:blue;"  >ret<span style="color:black;"  >     </span></span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >InitIDT         <span style="color:#009999;"  >ENDP<span style="color:black;"  >     </span></span></span></p><p><span style="color:#999999; font-family:Times New Roman; font-size:9pt;"  ><em>;----------------------------------------------------------------------------</em><span style="color:black;"  >    </span></span></p><p><span style="color:#999999; font-size:9pt;"  ><em><span style="font-family:Times New Roman;"  >;</span><span style="font-family:宋体;"  >入口参数</span><span style="font-family:Times New Roman;"  >:FS:SI=</span><span style="font-family:宋体;"  >第一个要初始化的描述符</span><span style="font-family:Times New Roman;"  >,CX=</span><span style="font-family:宋体;"  >要初始化的描述符数</span></em><span style="color:black; font-family:Times New Roman;"  >    </span></span></p><p><span style="color:#999999; font-family:Times New Roman; font-size:9pt;"  ><em>;----------------------------------------------------------------------------</em><span style="color:black;"  >    </span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >InitLDT         <span style="color:#009999;"  >PROC<span style="color:black;"  >     </span></span></span></p><p><span style="color:#990000; font-family:Times New Roman; font-size:9pt;"  >ILDT:<span style="color:black;"  >     <span style="color:blue;"  >mov<span style="color:black;"  >       <span style="color:fuchsia;"  >ax<span style="color:red;"  >,<span style="color:#009999;"  >WORD<span style="color:black;"  >           <span style="color:#009999;"  >PTR<span style="color:black;"  >             <span style="color:fuchsia;"  >FS<span style="color:black;"  >:<span style="color:red;"  >[<span style="color:fuchsia;"  >si<span style="color:red;"  >].<span style="color:black;"  >BaseL </span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >    <span style="color:blue;"  >movzx<span style="color:black;"  >      <span style="color:fuchsia;"  >eax<span style="color:red;"  >,<span style="color:fuchsia;"  >ax<span style="color:black;"  >         </span></span></span></span></span></span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >    <span style="color:blue;"  >shl<span style="color:black;"  >      <span style="color:fuchsia;"  >eax<span style="color:red;"  >,<span style="color:#000099;"  >4<span style="color:black;"  >         </span></span></span></span></span></span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >    <span style="color:blue;"  >shld<span style="color:black;"  >      <span style="color:fuchsia;"  >edx<span style="color:red;"  >,<span style="color:fuchsia;"  >eax<span style="color:red;"  >,<span style="color:#000099;"  >16<span style="color:black;"  >           </span></span></span></span></span></span></span></span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >    <span style="color:blue;"  >mov<span style="color:black;"  >      <span style="color:#009999;"  >WORD<span style="color:black;"  >        <span style="color:#009999;"  >PTR<span style="color:black;"  >          <span style="color:fuchsia;"  >fs<span style="color:black;"  >:<span style="color:red;"  >[<span style="color:fuchsia;"  >si<span style="color:red;"  >].<span style="color:black;"  >BaseL<span style="color:red;"  >,<span style="color:fuchsia;"  >ax<span style="color:black;"  >                  </span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >    <span style="color:blue;"  >mov<span style="color:black;"  >      <span style="color:#009999;"  >BYTE<span style="color:black;"  >        <span style="color:#009999;"  >PTR<span style="color:black;"  >          <span style="color:fuchsia;"  >fs<span style="color:black;"  >:<span style="color:red;"  >[<span style="color:fuchsia;"  >si<span style="color:red;"  >].<span style="color:black;"  >BaseM<span style="color:red;"  >,<span style="color:fuchsia;"  >dl<span style="color:black;"  >                  </span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >    <span style="color:blue;"  >mov<span style="color:black;"  >      <span style="color:#009999;"  >BYTE<span style="color:black;"  >        <span style="color:#009999;"  >PTR<span style="color:black;"  >          <span style="color:fuchsia;"  >fs<span style="color:black;"  >:<span style="color:red;"  >[<span style="color:fuchsia;"  >si<span style="color:red;"  >].<span style="color:black;"  >BaseH<span style="color:red;"  >,<span style="color:fuchsia;"  >dh<span style="color:black;"  >                  </span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >    <span style="color:blue;"  >add<span style="color:black;"  >      <span style="color:fuchsia;"  >si<span style="color:red;"  >,<span style="color:#009999;"  >SIZE<span style="color:black;"  > Desc </span></span></span></span></span></span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >    <span style="color:blue;"  >loop<span style="color:black;"  >    ILDT </span></span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >    <span style="color:blue;"  >ret<span style="color:black;"  >     </span></span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >InitLDT         <span style="color:#009999;"  >ENDP<span style="color:black;"  >     </span></span></span></p><p><span style="color:#999999; font-family:Times New Roman; font-size:9pt;"  ><em>;----------------------------------------------------------------------------</em><span style="color:black;"  >    </span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >RCodeSeg        <span style="color:#009999;"  >ENDS<span style="color:black;"  >     </span></span></span></p><p><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >    <span style="color:#009999;"  >END<span style="color:black;"  >     Start </span></span></span></p><p><span style="color:red; font-family:Batang; font-size:13pt;"  ><strong>2.关于实例七的说明 </strong></span></p><p><span style="color:black; font-size:9pt;"  ><span style="font-family:宋体;"  >上述模拟与演示程序的许多内容与实例六相同，下面就各异常处理程序和读键盘任务的实现</span><span style="font-family:Times New Roman;"  >    </span><span style="font-family:宋体;"  >作些说明：</span><span style="font-family:Times New Roman;"  >    </span></span></p><p><span style="color:fuchsia; font-family:Batang; font-size:12pt;"  ><strong>(1)除法出错故障处理程序的实现 </strong></span></p><p><span style="color:black; font-size:9pt;"  ><span style="font-family:宋体;"  >从源程序可见，除法出错是在执行故意安排的被除数为</span><span style="font-family:Times New Roman;"  >2000</span><span style="font-family:宋体;"  >，而除数为</span><span style="font-family:Times New Roman;"  >2</span><span style="font-family:宋体;"  >的无符号除指令时</span><span style="font-family:Times New Roman;"  >    </span><span style="font-family:宋体;"  >引起的。作为演示，除法出错故障处理程序先显示一条提示信息，然后把存放被除数</span><span style="font-family:Times New Roman;"  >AX</span><span style="font-family:宋体;"  >的内</span><span style="font-family:Times New Roman;"  >    </span><span style="font-family:宋体;"  >容右移一位，然后就返回。由于除法出错为故障类异常，所以在故障处理结束后，仍执行该</span><span style="font-family:Times New Roman;"  >    </span><span style="font-family:宋体;"  >无符号除指令。显然将再次引起同样的故障，仍把被除数右移一位。由于每次处理时都把被</span><span style="font-family:Times New Roman;"  >    </span><span style="font-family:宋体;"  >除数减半，所以几次故障后就不发生该故障了。</span><span style="font-family:Times New Roman;"  >    </span></span></p><p><span style="color:fuchsia; font-family:Batang; font-size:12pt;"  ><strong>(2)溢出陷阱处理程序的实现 </strong></span></p><p><span style="color:black; font-size:9pt;"  ><span style="font-family:宋体;"  >作为演示的溢出陷阱处理程序较简单。先显示一条提示信息，然后就返回。因为溢出异常为</span><span style="font-family:Times New Roman;"  >    </span><span style="font-family:宋体;"  >陷阱类异常，所以在陷阱处理结束后，就直接返回到引起陷阱指令的下一条指令。</span><span style="font-family:Times New Roman;"  >    </span></span></p><p><span style="color:fuchsia; font-family:Batang; font-size:12pt;"  ><strong>(3)段不存在故障处理程序的实现 </strong></span></p><p><span style="color:black; font-size:9pt;"  ><span style="font-family:宋体;"  >从源程序可见，段不存在故障是在执行故意安排的把一个选择子送段寄存器</span><span style="font-family:Times New Roman;"  >GS</span><span style="font-family:宋体;"  >的指令时引起</span><span style="font-family:Times New Roman;"  >    </span><span style="font-family:宋体;"  >的。该选择子索引的描述符中的存在位</span><span style="font-family:Times New Roman;"  >P</span><span style="font-family:宋体;"  >被置为</span><span style="font-family:Times New Roman;"  >0</span><span style="font-family:宋体;"  >，表示对应段不在内存。在正常情况下，段</span><span style="font-family:Times New Roman;"  >    </span><span style="font-family:宋体;"  >不存在故障处理程序要把对应的段装入内存，再把描述符内的</span><span style="font-family:Times New Roman;"  >P</span><span style="font-family:宋体;"  >位修改为</span><span style="font-family:Times New Roman;"  >1</span><span style="font-family:宋体;"  >，于是，在故障处</span><span style="font-family:Times New Roman;"  >    </span><span style="font-family:宋体;"  >理结束后，引起故障的指令可得到顺序执行。为了简单，这里安排的故障处理程序先显示一</span><span style="font-family:Times New Roman;"  >    </span><span style="font-family:宋体;"  >条提示信息，然后显示出错码，最后调整堆栈中的返回地址并返回。段不存在故障提供一个</span><span style="font-family:Times New Roman;"  >    </span><span style="font-family:宋体;"  >出错码，该故障处理程序利用</span><span style="font-family:Times New Roman;"  >POP</span><span style="font-family:宋体;"  >指令把它用堆栈中弹出，这样堆栈指针就指向返回地址。由</span><span style="font-family:Times New Roman;"  >    </span><span style="font-family:宋体;"  >于段不存在异常属于故障类异常，所以返回点仍是引起故障的指令。因此，演示程序调整了</span><span style="font-family:Times New Roman;"  >    </span><span style="font-family:宋体;"  >堆栈中的返回地址，使其返回到引起故障的指令的下一条指令。</span><span style="font-family:Times New Roman;"  >    </span></span></p><p><span style="color:fuchsia; font-family:Batang; font-size:12pt;"  ><strong>(4)堆栈段出错故障处理程序的实现 </strong></span></p><p><span style="color:black; font-size:9pt;"  ><span style="font-family:宋体;"  >引起堆栈出错故障的原因有多种，实例通过执行故意安排的偏移超过段界限的堆栈段访问指</span><span style="font-family:Times New Roman;"  >    </span><span style="font-family:宋体;"  >令来模拟堆栈段出错故障的产生。作为演示的堆栈出错故障处理程序比较简单，先显示一条</span><span style="font-family:Times New Roman;"  >    </span><span style="font-family:宋体;"  >信息，然后显示出错码，最后调整堆栈中的返回地址并返回。</span><span style="font-family:Times New Roman;"  >    </span></span></p><p><span style="color:fuchsia; font-family:Batang; font-size:12pt;"  ><strong>(5)通用保护障处理程序的实现 </strong></span></p><p><span style="color:black; font-size:9pt;"  ><span style="font-family:宋体;"  >引起通用保护故障处理程序的原因有多种，实例通过把一个指向系统段描述符的选择子装入</span><span style="font-family:Times New Roman;"  >    </span><span style="font-family:宋体;"  >数据段寄存器</span><span style="font-family:Times New Roman;"  >GS</span><span style="font-family:宋体;"  >来模拟通用保护故障的产生。作为演示的通用保护故障处理程序，象上述两</span><span style="font-family:Times New Roman;"  >    </span><span style="font-family:宋体;"  >个故障处理程序一样比较简单，先显示一条提示信息，然后显示出错码，最后调整堆栈中的</span><span style="font-family:Times New Roman;"  >    </span><span style="font-family:宋体;"  >返回地址并返回，但在废除堆栈中的出错码和调整堆栈中的返回地址时采用了其它方法。</span><span style="font-family:Times New Roman;"  >    </span></span></p><p><span style="color:fuchsia; font-family:Batang; font-size:12pt;"  ><strong>(6)异常处理程序的一般说明 </strong></span></p><p><span style="color:black; font-size:9pt;"  ><span style="font-family:宋体;"  >在实例中，通向上述各种异常处理程序的门都是陷阱门。所以，在发生异常而转入这些异常</span><span style="font-family:Times New Roman;"  >    </span><span style="font-family:宋体;"  >处理程序时，都不发生任务切换。于是，这些异常处理仍作为演示任务的一部分。</span><span style="font-family:Times New Roman;"  >    </span></span></p><p><span style="color:black; font-size:9pt;"  ><span style="font-family:宋体;"  >正常情况下，异常处理程序应该注意现场的保护和恢复，但为了简单，作为演示的异常处理</span><span style="font-family:Times New Roman;"  >    </span><span style="font-family:宋体;"  >程序没有能够切实地保护现场。注意，这些异常处理程序所采用的处理方法与所模拟的指令</span><span style="font-family:Times New Roman;"  >    </span><span style="font-family:宋体;"  >有关，不适用于一般情况。</span><span style="font-family:Times New Roman;"  >    </span></span></p><p><span style="color:fuchsia; font-family:Batang; font-size:12pt;"  ><strong>(7)显示出错代码的过程 </strong></span></p><p><span style="color:black; font-size:9pt;"  ><span style="font-family:宋体;"  >实例采用一个过程用于显示出错代码，该过程的入口参数是</span><span style="font-family:Times New Roman;"  >AX</span><span style="font-family:宋体;"  >含出错码。利用该过程不仅缩</span><span style="font-family:Times New Roman;"  >    </span><span style="font-family:宋体;"  >短程序，而且也用于表现异常处理程序的实现。</span><span style="font-family:Times New Roman;"  >    </span></span></p><p><span style="color:fuchsia; font-family:Batang; font-size:12pt;"  ><strong>(8)读键盘任务的实现 </strong></span></p><p><span style="color:black; font-size:9pt;"  ><span style="font-family:宋体;"  >在实例的</span><span style="font-family:Times New Roman;"  >IDT</span><span style="font-family:宋体;"  >中，</span><span style="font-family:Times New Roman;"  >0FFH</span><span style="font-family:宋体;"  >号门描述符是任务门，指向一个独立的任务。该任务的功能是读键盘，</span><span style="font-family:Times New Roman;"  >    </span><span style="font-family:宋体;"  >接收一个指定范围内的字符。演示任务通过指令</span><span style="font-family:Times New Roman;"  >"INT 0FFH"</span><span style="font-family:宋体;"  >来调用它，接收一个代表需要</span><span style="font-family:Times New Roman;"  >    </span><span style="font-family:宋体;"  >模拟异常的字符。</span><span style="font-family:Times New Roman;"  >    </span></span></p><p><span style="color:black; font-size:9pt;"  ><span style="font-family:宋体;"  >为了简单，该任务在实模式下读键盘，接收指定范围内的字符。为此，该任务每次经历如下</span><span style="font-family:Times New Roman;"  >    </span><span style="font-family:宋体;"  >步骤：</span><span style="font-family:Times New Roman;"  >(1)</span><span style="font-family:宋体;"  >转到实模式。此前要作必要的准备，转到实模式后，要恢复必须的实模式下的部</span><span style="font-family:Times New Roman;"  >    </span><span style="font-family:宋体;"  >分现场。</span><span style="font-family:Times New Roman;"  >(2)</span><span style="font-family:宋体;"  >接收指定的字符。调用</span><span style="font-family:Times New Roman;"  >DOS</span><span style="font-family:宋体;"  >功能显示提示信息，调用</span><span style="font-family:Times New Roman;"  >BIOS</span><span style="font-family:宋体;"  >中断读键盘，如果在指</span><span style="font-family:Times New Roman;"  >    </span><span style="font-family:宋体;"  >定范围内，那么就显示，并保存在约定的数据段中。</span><span style="font-family:Times New Roman;"  >(3)</span><span style="font-family:宋体;"  >转回到保护模式，此前也要作必要</span><span style="font-family:Times New Roman;"  >    </span><span style="font-family:宋体;"  >的准备。</span><span style="font-family:Times New Roman;"  >    </span></span></p><p><span style="color:black; font-size:9pt;"  ><span style="font-family:宋体;"  >尽管在任务切换时，自动利用</span><span style="font-family:Times New Roman;"  >TSS</span><span style="font-family:宋体;"  >保护和恢复现场，但由于该任务相当于一个读键盘的过程，</span><span style="font-family:Times New Roman;"  >    </span><span style="font-family:宋体;"  >所以在开始任务时，还通过堆栈保护必要的现场，在结束任务时恢复现场。请特别注意，安</span><span style="font-family:Times New Roman;"  >    </span><span style="font-family:宋体;"  >排在该任务代码段中的</span><span style="font-family:Times New Roman;"  >IRETD</span><span style="font-family:宋体;"  >指令之后的转移指令的作用。当执行</span><span style="font-family:Times New Roman;"  >IRETD</span><span style="font-family:宋体;"  >指令时，由于</span><span style="font-family:Times New Roman;"  >NT</span><span style="font-family:宋体;"  >位</span><span style="font-family:Times New Roman;"  >    </span><span style="font-family:宋体;"  >为</span><span style="font-family:Times New Roman;"  >1</span><span style="font-family:宋体;"  >，所以按反向链进行任务切换，同时保存各寄存器到当前的</span><span style="font-family:Times New Roman;"  >TSS</span><span style="font-family:宋体;"  >，为了下次进入时仍能从</span><span style="font-family:Times New Roman;"  >    </span><span style="font-family:宋体;"  >头开始执行此任务，所以在</span><span style="font-family:Times New Roman;"  >IRETD</span><span style="font-family:宋体;"  >后加一条转移到该任务开头的指令。</span><span style="font-family:Times New Roman;"  >    </span></span></p><p><span style="color:red; font-family:Batang; font-size:18pt;"  ><strong>&lt;六&gt;各种转移途径小结 </strong></span></p><p><span style="color:black; font-size:9pt;"  ><span style="font-family:宋体;"  >如上所述，中断</span><span style="font-family:Times New Roman;"  >/</span><span style="font-family:宋体;"  >异常可引起任务切换、任务内特权级变换和任务内无特权级变换的转移。</span><span style="font-family:Times New Roman;"  >    </span><span style="font-family:宋体;"  >至此，任务切换、任务内特权级变换和任务内无特权级变换转移的各种途径已全部列出。</span><span style="font-family:Times New Roman;"  >    </span></span></p><p><span style="color:red; font-family:Batang; font-size:13pt;"  ><strong>1.任务切换的途径 </strong></span></p><p><span style="color:black; font-size:9pt;"  ><span style="font-family:宋体;"  >任务之间切换的途径如下图所示。段间转移指令</span><span style="font-family:Times New Roman;"  >JMP</span><span style="font-family:宋体;"  >、段间调用指令</span><span style="font-family:Times New Roman;"  >CALL</span><span style="font-family:宋体;"  >、软中断指令</span><span style="font-family:Times New Roman;"  >INT</span><span style="font-family:宋体;"  >和</span><span style="font-family:Times New Roman;"  >    </span><span style="font-family:宋体;"  >中断返回指令</span><span style="font-family:Times New Roman;"  >IRET</span><span style="font-family:宋体;"  >引起的任务切换是主动的任务切换，或者说是当前任务要求的任务切换。</span><span style="font-family:Times New Roman;"  >    </span><span style="font-family:宋体;"  >中断和异常</span><span style="font-family:Times New Roman;"  >(</span><span style="font-family:宋体;"  >不包括软中断指令</span><span style="font-family:Times New Roman;"  >)</span><span style="font-family:宋体;"  >引起的任务切换是被动的任务切换，或者说是不受当前任务</span><span style="font-family:Times New Roman;"  >    </span><span style="font-family:宋体;"  >左右的任务切换。</span><span style="font-family:Times New Roman;"  >    </span></span></p><p style="text-align: center;"  ><img title="七.中断和异常 - Howie - Dspace"  src="pic/img7.ph.126.net_SYlEpkAT7f1W7c4nBHrW0Q==_634726072500063937.jpg"  alt=""  /><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >   </span></p><p><span style="color:black; font-size:9pt;"  ><span style="font-family:宋体;"  >伴随着任务切换，特权级当然可能发生变换。只要任务切换发生，这种特权级的变换取决于</span><span style="font-family:Times New Roman;"  >    </span><span style="font-family:宋体;"  >目标任务，而与当前任务无关。</span><span style="font-family:Times New Roman;"  >    </span></span></p><p><span style="color:red; font-family:Batang; font-size:13pt;"  ><strong>2.任务内特权级变换的途径 </strong></span></p><p><span style="color:black; font-size:9pt;"  ><span style="font-family:宋体;"  >任务内特权级变换的途径如下图所示。图中特权级</span><span style="font-family:Times New Roman;"  >m</span><span style="font-family:宋体;"  >是外层特权级，特权级</span><span style="font-family:Times New Roman;"  >n</span><span style="font-family:宋体;"  >是内层特权级。</span><span style="font-family:Times New Roman;"  >    </span><span style="font-family:宋体;"  >通常</span><span style="font-family:Times New Roman;"  >RET</span><span style="font-family:宋体;"  >与</span><span style="font-family:Times New Roman;"  >CALL</span><span style="font-family:宋体;"  >对应；</span><span style="font-family:Times New Roman;"  >IRET</span><span style="font-family:宋体;"  >与</span><span style="font-family:Times New Roman;"  >INT</span><span style="font-family:宋体;"  >、中断</span><span style="font-family:Times New Roman;"  >/</span><span style="font-family:宋体;"  >异常对应。但也可以通过在堆栈中建立合适环境的</span><span style="font-family:Times New Roman;"  >    </span><span style="font-family:宋体;"  >手段，使</span><span style="font-family:Times New Roman;"  >RET</span><span style="font-family:宋体;"  >或</span><span style="font-family:Times New Roman;"  >IRET</span><span style="font-family:宋体;"  >从内层特权级变换到外层特权级。</span><span style="font-family:Times New Roman;"  >    </span></span></p><p style="text-align: center;"  ><img title="七.中断和异常 - Howie - Dspace"  src="pic/img8.ph.126.net_sGAp4kxrMsufun9mEVafzw==_3065262496396393998.jpg"  alt=""  /><span style="color:black; font-family:Times New Roman; font-size:9pt;"  >   </span></p><p><span style="color:red; font-family:Batang; font-size:13pt;"  ><strong>3.任务内相同特权级转移的途径 </strong></span></p><p><span style="color:black; font-size:9pt;"  ><span style="font-family:宋体;"  >任务内相同特权级转移的途径如下图所示。由图可见，任务内相同特权级转移的途径多种</span><span style="font-family:Times New Roman;"  >    </span><span style="font-family:宋体;"  >多样。</span><span style="font-family:Times New Roman;"  >    </span></span></p><p style="text-align: center;"  ><img title="七.中断和异常 - Howie - Dspace"  src="pic/img2.ph.126.net_3tC0zPsFftduq-97R3cMig==_2601110259800716452.jpg"  alt=""  /></p>
</body></html>