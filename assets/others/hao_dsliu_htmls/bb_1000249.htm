<html><head><meta http-equiv="Content-Type" content="text/html; charset=utf8"><title>163 blogs的博客：MFC COM 笔记</title>
<style type="text/css">
a{color: #000000;text-decoration : none;font-size: 10pt;}
a:hover {color: red;text-decoration : underline;}
.replyBox{padding:4px;border:1px solid #D8D8D8;}
</style></head><body><h2>MFC COM 笔记</h2>
<p align="right">发布时间：2011-3-13 17:40
<br>分类名称：COM</p><br>
  <P style="MARGIN: 0cm 0cm 0pt;"  ><SPAN style="FONT-FAMILY: 宋体; mso-ascii-font-family: Calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: Calibri; mso-hansi-theme-font: minor-latin;"  >使用嵌套类来实现接口</SPAN><SPAN lang="EN-US" ><FONT face="Calibri" >&nbsp;</FONT></SPAN></P>  <P style="MARGIN: 0cm 0cm 0pt;"  ><SPAN style="FONT-FAMILY: 宋体; mso-ascii-font-family: Calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: Calibri; mso-hansi-theme-font: minor-latin;"  >例子：</SPAN><SPAN lang="EN-US" ></SPAN></P>  <P style="MARGIN: 0cm 0cm 0pt;"  ><SPAN lang="EN-US" ><FONT face="Calibri" >class CDictionaryObj : public CCmdTarget</FONT></SPAN></P>  <P style="MARGIN: 0cm 0cm 0pt;"  ><SPAN lang="EN-US" ><FONT face="Calibri" >{</FONT></SPAN></P>  <P style="MARGIN: 0cm 0cm 0pt;"  ><SPAN lang="EN-US" ><FONT face="Calibri" ><SPAN style="mso-tab-count: 1;"  >&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </SPAN>DECLARE_DYNCREATE(CDictionaryObj)</FONT></SPAN></P>  <P style="MARGIN: 0cm 0cm 0pt;"  ><SPAN lang="EN-US" ><FONT face="Calibri" ><SPAN style="mso-tab-count: 1;"  >&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </SPAN>CDictionaryObj();</FONT></SPAN></P>  <P style="MARGIN: 0cm 0cm 0pt;"  ><SPAN lang="EN-US" ><FONT face="Calibri" >&nbsp;</FONT></SPAN></P>  <P style="MARGIN: 0cm 0cm 0pt;"  ><SPAN lang="EN-US" ><FONT face="Calibri" >public:</FONT></SPAN></P>  <P style="MARGIN: 0cm 0cm 0pt;"  ><SPAN lang="EN-US" ><FONT face="Calibri" ><SPAN style="mso-tab-count: 1;"  >&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </SPAN>class XDictionary : public IDictionary </FONT></SPAN></P>  <P style="MARGIN: 0cm 0cm 0pt;"  ><SPAN lang="EN-US" ><FONT face="Calibri" ><SPAN style="mso-tab-count: 1;"  >&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </SPAN>{ </FONT></SPAN></P>  <P style="MARGIN: 0cm 0cm 0pt;"  ><SPAN lang="EN-US" ><FONT face="Calibri" ><SPAN style="mso-tab-count: 1;"  >&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </SPAN>public: </FONT></SPAN></P>  <P style="MARGIN: 0cm 0cm 0pt;"  ><SPAN lang="EN-US" ><FONT face="Calibri" ><SPAN style="mso-tab-count: 2;"  >&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </SPAN>virtual ULONG __stdcall AddRef();</FONT></SPAN></P>  <P style="MARGIN: 0cm 0cm 0pt;"  ><SPAN lang="EN-US" ><FONT face="Calibri" ><SPAN style="mso-tab-count: 2;"  >&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </SPAN>virtual ULONG __stdcall Release();</FONT></SPAN></P>  <P style="MARGIN: 0cm 0cm 0pt;"  ><SPAN lang="EN-US" ><FONT face="Calibri" ><SPAN style="mso-tab-count: 2;"  >&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </SPAN>virtual HRESULT __stdcall QueryInterface(REFIID iid, LPVOID* ppvObj);</FONT></SPAN></P>  <P style="MARGIN: 0cm 0cm 0pt;"  ><SPAN lang="EN-US" ><FONT face="Calibri" ><SPAN style="mso-tab-count: 2;"  >&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </SPAN></FONT></SPAN></P>  <P style="MARGIN: 0cm 0cm 0pt;"  ><SPAN lang="EN-US" ><FONT face="Calibri" ><SPAN style="mso-tab-count: 2;"  >&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </SPAN>virtual BOOL __stdcall Initialize();</FONT></SPAN></P>  <P style="MARGIN: 0cm 0cm 0pt;"  ><SPAN lang="EN-US" ><FONT face="Calibri" ><SPAN style="mso-tab-count: 2;"  >&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </SPAN>......</FONT></SPAN></P>  <P style="MARGIN: 0cm 0cm 0pt;"  ><SPAN lang="EN-US" ><FONT face="Calibri" ><SPAN style="mso-tab-count: 1;"  >&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </SPAN>} m_xDictionary;</FONT></SPAN></P>  <P style="MARGIN: 0cm 0cm 0pt;"  ><SPAN lang="EN-US" ><FONT face="Calibri" ><SPAN style="mso-tab-count: 1;"  >&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </SPAN>friend class XDictionary;</FONT></SPAN></P>  <P style="MARGIN: 0cm 0cm 0pt;"  ><SPAN lang="EN-US" ><FONT face="Calibri" >&nbsp;</FONT></SPAN></P>  <P style="MARGIN: 0cm 0cm 0pt;"  ><SPAN lang="EN-US" ><FONT face="Calibri" >protected:</FONT></SPAN></P>  <P style="MARGIN: 0cm 0cm 0pt;"  ><SPAN lang="EN-US" ><FONT face="Calibri" ><SPAN style="mso-tab-count: 1;"  >&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </SPAN>virtual ~CDictionaryObj();</FONT></SPAN></P>  <P style="MARGIN: 0cm 0cm 0pt;"  ><SPAN lang="EN-US" ><FONT face="Calibri" ><SPAN style="mso-tab-count: 1;"  >&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </SPAN>DECLARE_MESSAGE_MAP()</FONT></SPAN></P>  <P style="MARGIN: 0cm 0cm 0pt;"  ><SPAN lang="EN-US" ><FONT face="Calibri" ><SPAN style="mso-tab-count: 1;"  >&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </SPAN>DECLARE_INTERFACE_MAP()</FONT></SPAN></P>  <P style="MARGIN: 0cm 0cm 0pt;"  ><SPAN lang="EN-US" ><FONT face="Calibri" ><SPAN style="mso-tab-count: 1;"  >&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </SPAN>DECLARE_OLECREATE(CDictionaryObj)</FONT></SPAN></P>  <P style="MARGIN: 0cm 0cm 0pt;"  ><SPAN lang="EN-US" ><FONT face="Calibri" >};</FONT></SPAN></P>  <P style="MARGIN: 0cm 0cm 0pt;"  ><SPAN lang="EN-US" ><FONT face="Calibri" >&nbsp;</FONT></SPAN></P>  <P style="MARGIN: 0cm 0cm 0pt;"  ><SPAN style="FONT-FAMILY: 宋体; mso-ascii-font-family: Calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: Calibri; mso-hansi-theme-font: minor-latin;"  >效果和</SPAN><SPAN lang="EN-US" ><FONT face="Calibri" >class CDictionaryObj : public IDictionary </FONT></SPAN><SPAN style="FONT-FAMILY: 宋体; mso-ascii-font-family: Calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: Calibri; mso-hansi-theme-font: minor-latin;"  >一样。因为对外部而言，使用</SPAN><SPAN lang="EN-US" ><FONT face="Calibri" >QueryInterface</FONT></SPAN><SPAN style="FONT-FAMILY: 宋体; mso-ascii-font-family: Calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: Calibri; mso-hansi-theme-font: minor-latin;"  >来获取接口指针，获取</SPAN><SPAN lang="EN-US" ><FONT face="Calibri" >IDictionary</FONT></SPAN><SPAN style="FONT-FAMILY: 宋体; mso-ascii-font-family: Calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: Calibri; mso-hansi-theme-font: minor-latin;"  >指针，相当于返回</SPAN><SPAN lang="EN-US" ><FONT face="Calibri" >m_xDictionary</FONT></SPAN><SPAN style="FONT-FAMILY: 宋体; mso-ascii-font-family: Calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: Calibri; mso-hansi-theme-font: minor-latin;"  >的地址。然后就可以通过此指针来操作</SPAN><SPAN lang="EN-US" ><FONT face="Calibri" >IDictionary</FONT></SPAN><SPAN style="FONT-FAMILY: 宋体; mso-ascii-font-family: Calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: Calibri; mso-hansi-theme-font: minor-latin;"  >提供的接口了。</SPAN><SPAN lang="EN-US" ></SPAN></P>  <P style="MARGIN: 0cm 0cm 0pt;"  ><SPAN lang="EN-US" ><FONT face="Calibri" >&nbsp;</FONT></SPAN></P>  <P style="MARGIN: 0cm 0cm 0pt;"  ><SPAN style="FONT-FAMILY: 宋体; mso-ascii-font-family: Calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: Calibri; mso-hansi-theme-font: minor-latin;"  >上面的例子能够看出</SPAN><SPAN lang="EN-US" ><FONT face="Calibri" >CDictionaryObj </FONT></SPAN><SPAN style="FONT-FAMILY: 宋体; mso-ascii-font-family: Calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: Calibri; mso-hansi-theme-font: minor-latin;"  >并没有实现</SPAN><SPAN lang="EN-US" ><FONT face="Calibri" >QueryInterface, AddRef, Release</FONT></SPAN><SPAN style="FONT-FAMILY: 宋体; mso-ascii-font-family: Calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: Calibri; mso-hansi-theme-font: minor-latin;"  >函数。这是因为他继承于</SPAN><SPAN lang="EN-US" ><FONT face="Calibri" >CCmdTarget</FONT></SPAN><SPAN style="FONT-FAMILY: 宋体; mso-ascii-font-family: Calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: Calibri; mso-hansi-theme-font: minor-latin;"  >，</SPAN><SPAN lang="EN-US" ><FONT face="Calibri" >CCmdTarget</FONT></SPAN><SPAN style="FONT-FAMILY: 宋体; mso-ascii-font-family: Calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: Calibri; mso-hansi-theme-font: minor-latin;"  >已经实现了。而且它的实现还可以调用到内部类的三个接口函数。</SPAN><SPAN lang="EN-US" ></SPAN></P>  <P style="MARGIN: 0cm 0cm 0pt;"  ><SPAN lang="EN-US" ><FONT face="Calibri" >&nbsp;</FONT></SPAN></P>  <P style="MARGIN: 0cm 0cm 0pt;"  ><SPAN lang="EN-US" ><FONT face="Calibri" >CCmdTarget</FONT></SPAN><SPAN style="FONT-FAMILY: 宋体; mso-ascii-font-family: Calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: Calibri; mso-hansi-theme-font: minor-latin;"  >提供的消息机制中</SPAN><SPAN lang="EN-US" ><FONT face="Calibri" >,</FONT></SPAN><SPAN style="FONT-FAMILY: 宋体; mso-ascii-font-family: Calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: Calibri; mso-hansi-theme-font: minor-latin;"  >使用了静态映射表（消息</SPAN><SPAN lang="EN-US" ><FONT face="Calibri" >ID</FONT></SPAN><SPAN style="FONT-FAMILY: 宋体; mso-ascii-font-family: Calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: Calibri; mso-hansi-theme-font: minor-latin;"  >和处理函数在</SPAN><SPAN lang="EN-US" ><FONT face="Calibri" >WinMain</FONT></SPAN><SPAN style="FONT-FAMILY: 宋体; mso-ascii-font-family: Calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: Calibri; mso-hansi-theme-font: minor-latin;"  >执行之前，就已经建立好对应关系了）。同样，</SPAN><SPAN lang="EN-US" ><FONT face="Calibri" >COM</FONT></SPAN><SPAN style="FONT-FAMILY: 宋体; mso-ascii-font-family: Calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: Calibri; mso-hansi-theme-font: minor-latin;"  >机制中使用接口映射表。</SPAN><SPAN lang="EN-US" ></SPAN></P><SPAN style="FONT-FAMILY: 'Calibri','sans-serif'; FONT-SIZE: 10.5pt; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-theme-font: minor-latin; mso-bidi-font-size: 11.0pt; mso-bidi-font-family: 'Times New Roman'; mso-bidi-theme-font: minor-bidi; mso-ansi-language: EN-US; mso-fareast-language: ZH-CN; mso-bidi-language: AR-SA;"  lang="EN-US" ><BR style="PAGE-BREAK-BEFORE: always; mso-special-character: line-break;"  clear="all" ></SPAN>  <P style="TEXT-ALIGN: left; MARGIN: 0cm 0cm 0pt; mso-pagination: widow-orphan;"  align="left" ><SPAN lang="EN-US" ><FONT face="Calibri" >&nbsp;</FONT></SPAN></P>  <TABLE style="BORDER-BOTTOM: medium none; BORDER-LEFT: medium none; MARGIN: auto auto auto 5.4pt; WIDTH: 98.14%; BORDER-COLLAPSE: collapse; BORDER-TOP: medium none; BORDER-RIGHT: medium none; mso-border-alt: solid windowtext .5pt; mso-yfti-tbllook: 1184; mso-padding-alt: 0cm 5.4pt 0cm 5.4pt;"  border="1" cellSpacing="0" cellPadding="0" width="98%"  >  <TBODY>  <TR style="HEIGHT: 14.5pt; mso-yfti-irow: 0; mso-yfti-firstrow: yes;"  >  <TD style="BORDER-BOTTOM: windowtext 1pt solid; BORDER-LEFT: windowtext 1pt solid; PADDING-BOTTOM: 0cm; BACKGROUND-COLOR: transparent; PADDING-LEFT: 5.4pt; WIDTH: 39.94%; PADDING-RIGHT: 5.4pt; HEIGHT: 14.5pt; BORDER-TOP: windowtext 1pt solid; BORDER-RIGHT: windowtext 1pt solid; PADDING-TOP: 0cm; mso-border-alt: solid windowtext .5pt;"  vAlign="top" width="39%"  >  <P style="TEXT-ALIGN: left; MARGIN: 0cm 0cm 0pt; mso-pagination: widow-orphan;"  align="left" ><SPAN style="FONT-FAMILY: 宋体; mso-ascii-font-family: Calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: Calibri; mso-hansi-theme-font: minor-latin;"  >宏</SPAN><SPAN lang="EN-US" ></SPAN></P></TD>  <TD style="BORDER-BOTTOM: windowtext 1pt solid; BORDER-LEFT: #f0f0f0; PADDING-BOTTOM: 0cm; BACKGROUND-COLOR: transparent; PADDING-LEFT: 5.4pt; WIDTH: 60.06%; PADDING-RIGHT: 5.4pt; HEIGHT: 14.5pt; BORDER-TOP: windowtext 1pt solid; BORDER-RIGHT: windowtext 1pt solid; PADDING-TOP: 0cm; mso-border-alt: solid windowtext .5pt; mso-border-left-alt: solid windowtext .5pt;"  vAlign="top" width="60%"  >  <P style="TEXT-ALIGN: left; MARGIN: 0cm 0cm 0pt; mso-pagination: widow-orphan;"  align="left" ><SPAN style="FONT-FAMILY: 宋体; mso-ascii-font-family: Calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: Calibri; mso-hansi-theme-font: minor-latin;"  >代码</SPAN><SPAN lang="EN-US" ></SPAN></P></TD></TR>  <TR style="HEIGHT: 105.75pt; mso-yfti-irow: 1;"  >  <TD style="BORDER-BOTTOM: windowtext 1pt solid; BORDER-LEFT: windowtext 1pt solid; PADDING-BOTTOM: 0cm; BACKGROUND-COLOR: transparent; PADDING-LEFT: 5.4pt; WIDTH: 39.94%; PADDING-RIGHT: 5.4pt; HEIGHT: 105.75pt; BORDER-TOP: #f0f0f0; BORDER-RIGHT: windowtext 1pt solid; PADDING-TOP: 0cm; mso-border-alt: solid windowtext .5pt; mso-border-top-alt: solid windowtext .5pt;"  vAlign="top" width="39%"  >  <P style="TEXT-ALIGN: left; MARGIN: 0cm 0cm 0pt; mso-pagination: widow-orphan;"  align="left" ><B style="mso-bidi-font-weight: normal;"  ><SPAN style="FONT-SIZE: 10pt; mso-bidi-font-size: 11.0pt;"  lang="EN-US" ><FONT face="Calibri" >DECLARE_INTERFACE_MAP()</FONT></SPAN></B></P></TD>  <TD style="BORDER-BOTTOM: windowtext 1pt solid; BORDER-LEFT: #f0f0f0; PADDING-BOTTOM: 0cm; BACKGROUND-COLOR: transparent; PADDING-LEFT: 5.4pt; WIDTH: 60.06%; PADDING-RIGHT: 5.4pt; HEIGHT: 105.75pt; BORDER-TOP: #f0f0f0; BORDER-RIGHT: windowtext 1pt solid; PADDING-TOP: 0cm; mso-border-alt: solid windowtext .5pt; mso-border-left-alt: solid windowtext .5pt; mso-border-top-alt: solid windowtext .5pt;"  vAlign="top" width="60%"  >  <P style="TEXT-ALIGN: left; MARGIN: 0cm 0cm 0pt; mso-pagination: widow-orphan;"  align="left" ><SPAN style="FONT-SIZE: 10pt; mso-bidi-font-size: 11.0pt;"  lang="EN-US" ><FONT face="Calibri" >private: </FONT></SPAN></P>  <P style="TEXT-ALIGN: left; MARGIN: 0cm 0cm 0pt; mso-pagination: widow-orphan;"  align="left" ><SPAN style="FONT-SIZE: 10pt; mso-bidi-font-size: 11.0pt;"  lang="EN-US" ><FONT face="Calibri" >static const <B style="mso-bidi-font-weight: normal;"  >AFX_INTERFACEMAP_ENTRY</B> _interfaceEntries[]; </FONT></SPAN></P>  <P style="TEXT-ALIGN: left; MARGIN: 0cm 0cm 0pt; mso-pagination: widow-orphan;"  align="left" ><SPAN style="FONT-SIZE: 10pt; mso-bidi-font-size: 11.0pt;"  lang="EN-US" ><FONT face="Calibri" >protected: </FONT></SPAN></P>  <P style="TEXT-ALIGN: left; MARGIN: 0cm 0cm 0pt; mso-pagination: widow-orphan;"  align="left" ><SPAN style="FONT-SIZE: 10pt; mso-bidi-font-size: 11.0pt;"  lang="EN-US" ><FONT face="Calibri" >static<B style="mso-bidi-font-weight: normal;"  > AFX_DATA const AFX_INTERFACEMAP</B> interfaceMap; </FONT></SPAN></P>  <P style="TEXT-ALIGN: left; MARGIN: 0cm 0cm 0pt; mso-pagination: widow-orphan;"  align="left" ><SPAN style="FONT-SIZE: 10pt; mso-bidi-font-size: 11.0pt;"  lang="EN-US" ><FONT face="Calibri" >static const <B style="mso-bidi-font-weight: normal;"  >AFX_INTERFACEMAP</B>* PASCAL _GetBaseInterfaceMap(); </FONT></SPAN></P>  <P style="TEXT-ALIGN: left; MARGIN: 0cm 0cm 0pt; mso-pagination: widow-orphan;"  align="left" ><FONT face="Calibri" ><SPAN style="FONT-SIZE: 10pt; mso-bidi-font-size: 11.0pt;"  lang="EN-US" >virtual const <B style="mso-bidi-font-weight: normal;"  >AFX_INTERFACEMAP</B>* GetInterfaceMap() const; </SPAN><SPAN lang="EN-US" ></SPAN></FONT></P></TD></TR>  <TR style="HEIGHT: 74.6pt; mso-yfti-irow: 2;"  >  <TD style="BORDER-BOTTOM: windowtext 1pt solid; BORDER-LEFT: windowtext 1pt solid; PADDING-BOTTOM: 0cm; BACKGROUND-COLOR: transparent; PADDING-LEFT: 5.4pt; WIDTH: 39.94%; PADDING-RIGHT: 5.4pt; HEIGHT: 74.6pt; BORDER-TOP: #f0f0f0; BORDER-RIGHT: windowtext 1pt solid; PADDING-TOP: 0cm; mso-border-alt: solid windowtext .5pt; mso-border-top-alt: solid windowtext .5pt;"  vAlign="top" width="39%"  >  <P style="TEXT-ALIGN: left; MARGIN: 0cm 0cm 0pt; mso-pagination: widow-orphan;"  align="left" ><FONT face="Calibri" ><B style="mso-bidi-font-weight: normal;"  ><SPAN style="FONT-SIZE: 10pt; mso-bidi-font-size: 11.0pt;"  lang="EN-US" >struct</SPAN></B><SPAN style="FONT-SIZE: 10pt; mso-bidi-font-size: 11.0pt;"  lang="EN-US" > <B style="mso-bidi-font-weight: normal;"  >AFX_INTERFACEMAP_ENTRY</B></SPAN><SPAN lang="EN-US" ></SPAN></FONT></P></TD>  <TD style="BORDER-BOTTOM: windowtext 1pt solid; BORDER-LEFT: #f0f0f0; PADDING-BOTTOM: 0cm; BACKGROUND-COLOR: transparent; PADDING-LEFT: 5.4pt; WIDTH: 60.06%; PADDING-RIGHT: 5.4pt; HEIGHT: 74.6pt; BORDER-TOP: #f0f0f0; BORDER-RIGHT: windowtext 1pt solid; PADDING-TOP: 0cm; mso-border-alt: solid windowtext .5pt; mso-border-left-alt: solid windowtext .5pt; mso-border-top-alt: solid windowtext .5pt;"  vAlign="top" width="60%"  >  <P style="TEXT-ALIGN: left; MARGIN: 0cm 0cm 0pt; mso-pagination: widow-orphan;"  align="left" ><SPAN style="FONT-SIZE: 10pt; mso-bidi-font-size: 11.0pt;"  lang="EN-US" ><FONT face="Calibri" >struct <B style="mso-bidi-font-weight: normal;"  >AFX_INTERFACEMAP_ENTRY</B> {</FONT></SPAN></P>  <P style="TEXT-ALIGN: left; TEXT-INDENT: 5pt; MARGIN: 0cm 0cm 0pt; mso-pagination: widow-orphan; mso-char-indent-count: .5;"  align="left" ><SPAN style="FONT-SIZE: 10pt; mso-bidi-font-size: 11.0pt;"  lang="EN-US" ><FONT face="Calibri" >const void* piid; // the interface id (IID) (NULL for aggregate)</FONT></SPAN></P>  <P style="TEXT-ALIGN: left; TEXT-INDENT: 5pt; MARGIN: 0cm 0cm 0pt; mso-pagination: widow-orphan; mso-char-indent-count: .5;"  align="left" ><SPAN style="FONT-SIZE: 10pt; mso-bidi-font-size: 11.0pt;"  lang="EN-US" ><FONT face="Calibri" >size_t nOffset; <SPAN style="mso-spacerun: yes;"  >&nbsp;</SPAN>// offset of the interface vtable from m_unknown</FONT></SPAN></P>  <P style="TEXT-ALIGN: left; MARGIN: 0cm 0cm 0pt; mso-pagination: widow-orphan;"  align="left" ><SPAN style="FONT-SIZE: 10pt; mso-bidi-font-size: 11.0pt;"  lang="EN-US" ><FONT face="Calibri" >};</FONT></SPAN></P></TD></TR>  <TR style="HEIGHT: 90.5pt; mso-yfti-irow: 3;"  >  <TD style="BORDER-BOTTOM: windowtext 1pt solid; BORDER-LEFT: windowtext 1pt solid; PADDING-BOTTOM: 0cm; BACKGROUND-COLOR: transparent; PADDING-LEFT: 5.4pt; WIDTH: 39.94%; PADDING-RIGHT: 5.4pt; HEIGHT: 90.5pt; BORDER-TOP: #f0f0f0; BORDER-RIGHT: windowtext 1pt solid; PADDING-TOP: 0cm; mso-border-alt: solid windowtext .5pt; mso-border-top-alt: solid windowtext .5pt;"  vAlign="top" width="39%"  >  <P style="TEXT-ALIGN: left; MARGIN: 0cm 0cm 0pt; mso-pagination: widow-orphan;"  align="left" ><FONT face="Calibri" ><B style="mso-bidi-font-weight: normal;"  ><SPAN style="FONT-SIZE: 10pt; mso-bidi-font-size: 11.0pt;"  lang="EN-US" >struct AFX_INTERFACEMAP</SPAN></B><SPAN lang="EN-US" ></SPAN></FONT></P></TD>  <TD style="BORDER-BOTTOM: windowtext 1pt solid; BORDER-LEFT: #f0f0f0; PADDING-BOTTOM: 0cm; BACKGROUND-COLOR: transparent; PADDING-LEFT: 5.4pt; WIDTH: 60.06%; PADDING-RIGHT: 5.4pt; HEIGHT: 90.5pt; BORDER-TOP: #f0f0f0; BORDER-RIGHT: windowtext 1pt solid; PADDING-TOP: 0cm; mso-border-alt: solid windowtext .5pt; mso-border-left-alt: solid windowtext .5pt; mso-border-top-alt: solid windowtext .5pt;"  vAlign="top" width="60%"  >  <P style="TEXT-ALIGN: left; MARGIN: 0cm 0cm 0pt; mso-pagination: widow-orphan;"  align="left" ><SPAN style="FONT-SIZE: 10pt; mso-bidi-font-size: 11.0pt;"  lang="EN-US" ><FONT face="Calibri" >struct<B style="mso-bidi-font-weight: normal;"  > AFX_INTERFACEMAP</B> {</FONT></SPAN></P>  <P style="TEXT-ALIGN: left; MARGIN: 0cm 0cm 0pt; mso-pagination: widow-orphan;"  align="left" ><SPAN style="FONT-SIZE: 10pt; mso-bidi-font-size: 11.0pt;"  lang="EN-US" ><FONT face="Calibri" ><SPAN style="mso-spacerun: yes;"  >&nbsp;</SPAN>// NULL is root class</FONT></SPAN></P>  <P style="TEXT-ALIGN: left; TEXT-INDENT: 5pt; MARGIN: 0cm 0cm 0pt; mso-pagination: widow-orphan; mso-char-indent-count: .5;"  align="left" ><SPAN style="FONT-SIZE: 10pt; mso-bidi-font-size: 11.0pt;"  lang="EN-US" ><FONT face="Calibri" >const AFX_INTERFACEMAP* (PASCAL* pfnGetBaseMap)(); </FONT></SPAN></P>  <P style="TEXT-ALIGN: left; TEXT-INDENT: 5pt; MARGIN: 0cm 0cm 0pt; mso-pagination: widow-orphan; mso-char-indent-count: .5;"  align="left" ><SPAN style="FONT-SIZE: 10pt; mso-bidi-font-size: 11.0pt;"  lang="EN-US" ><FONT face="Calibri" >// map for this class</FONT></SPAN></P>  <P style="TEXT-ALIGN: left; TEXT-INDENT: 5pt; MARGIN: 0cm 0cm 0pt; mso-pagination: widow-orphan; mso-char-indent-count: .5;"  align="left" ><SPAN style="FONT-SIZE: 10pt; mso-bidi-font-size: 11.0pt;"  lang="EN-US" ><FONT face="Calibri" >const AFX_INTERFACEMAP_ENTRY* pEntry;</FONT></SPAN></P>  <P style="TEXT-ALIGN: left; MARGIN: 0cm 0cm 0pt; mso-pagination: widow-orphan;"  align="left" ><SPAN style="FONT-SIZE: 10pt; mso-bidi-font-size: 11.0pt;"  lang="EN-US" ><FONT face="Calibri" >};</FONT></SPAN></P></TD></TR>  <TR style="HEIGHT: 180.3pt; mso-yfti-irow: 4;"  >  <TD style="BORDER-BOTTOM: windowtext 1pt solid; BORDER-LEFT: windowtext 1pt solid; PADDING-BOTTOM: 0cm; BACKGROUND-COLOR: transparent; PADDING-LEFT: 5.4pt; WIDTH: 39.94%; PADDING-RIGHT: 5.4pt; HEIGHT: 180.3pt; BORDER-TOP: #f0f0f0; BORDER-RIGHT: windowtext 1pt solid; PADDING-TOP: 0cm; mso-border-alt: solid windowtext .5pt; mso-border-top-alt: solid windowtext .5pt;"  vAlign="top" width="39%"  >  <P style="TEXT-ALIGN: left; MARGIN: 0cm 0cm 0pt; mso-pagination: widow-orphan;"  align="left" ><FONT face="Calibri" ><B style="mso-bidi-font-weight: normal;"  ><SPAN style="FONT-SIZE: 10pt; mso-bidi-font-size: 11.0pt;"  lang="EN-US" >BEGIN_INTERFACE_MAP(theClass, theBase)</SPAN></B><SPAN lang="EN-US" ></SPAN></FONT></P></TD>  <TD style="BORDER-BOTTOM: windowtext 1pt solid; BORDER-LEFT: #f0f0f0; PADDING-BOTTOM: 0cm; BACKGROUND-COLOR: transparent; PADDING-LEFT: 5.4pt; WIDTH: 60.06%; PADDING-RIGHT: 5.4pt; HEIGHT: 180.3pt; BORDER-TOP: #f0f0f0; BORDER-RIGHT: windowtext 1pt solid; PADDING-TOP: 0cm; mso-border-alt: solid windowtext .5pt; mso-border-left-alt: solid windowtext .5pt; mso-border-top-alt: solid windowtext .5pt;"  vAlign="top" width="60%"  >  <P style="TEXT-ALIGN: left; TEXT-INDENT: 5pt; MARGIN: 0cm 0cm 0pt; mso-pagination: widow-orphan; mso-char-indent-count: .5;"  align="left" ><SPAN style="FONT-SIZE: 10pt; mso-bidi-font-size: 11.0pt;"  lang="EN-US" ><FONT face="Calibri" >const AFX_INTERFACEMAP* PASCAL theClass::_GetBaseInterfaceMap() </FONT></SPAN></P>  <P style="TEXT-ALIGN: left; TEXT-INDENT: 5pt; MARGIN: 0cm 0cm 0pt; mso-pagination: widow-orphan; mso-char-indent-count: .5;"  align="left" ><SPAN style="FONT-SIZE: 10pt; mso-bidi-font-size: 11.0pt;"  lang="EN-US" ><FONT face="Calibri" ><SPAN style="mso-tab-count: 1;"  >&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </SPAN>{ return &amp;theBase::interfaceMap; } </FONT></SPAN></P>  <P style="TEXT-ALIGN: left; TEXT-INDENT: 5pt; MARGIN: 0cm 0cm 0pt; mso-pagination: widow-orphan; mso-char-indent-count: .5;"  align="left" ><SPAN style="FONT-SIZE: 10pt; mso-bidi-font-size: 11.0pt;"  lang="EN-US" ><FONT face="Calibri" >const AFX_INTERFACEMAP* theClass::GetInterfaceMap() const </FONT></SPAN></P>  <P style="TEXT-ALIGN: left; TEXT-INDENT: 5pt; MARGIN: 0cm 0cm 0pt; mso-pagination: widow-orphan; mso-char-indent-count: .5;"  align="left" ><SPAN style="FONT-SIZE: 10pt; mso-bidi-font-size: 11.0pt;"  lang="EN-US" ><FONT face="Calibri" ><SPAN style="mso-tab-count: 1;"  >&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </SPAN>{ return &amp;theClass::interfaceMap; } </FONT></SPAN></P>  <P style="TEXT-ALIGN: left; TEXT-INDENT: 5pt; MARGIN: 0cm 0cm 0pt; mso-pagination: widow-orphan; mso-char-indent-count: .5;"  align="left" ><SPAN style="FONT-SIZE: 10pt; mso-bidi-font-size: 11.0pt;"  lang="EN-US" ><FONT face="Calibri" >AFX_COMDAT const AFX_DATADEF AFX_INTERFACEMAP theClass::interfaceMap = </FONT></SPAN></P>  <P style="TEXT-ALIGN: left; TEXT-INDENT: 5pt; MARGIN: 0cm 0cm 0pt; mso-pagination: widow-orphan; mso-char-indent-count: .5;"  align="left" ><SPAN style="FONT-SIZE: 10pt; mso-bidi-font-size: 11.0pt;"  lang="EN-US" ><FONT face="Calibri" ><SPAN style="mso-tab-count: 1;"  >&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </SPAN>{ &amp;theClass::_GetBaseInterfaceMap, &amp;theClass::_interfaceEntries[0], }; </FONT></SPAN></P>  <P style="TEXT-ALIGN: left; TEXT-INDENT: 5pt; MARGIN: 0cm 0cm 0pt; mso-pagination: widow-orphan; mso-char-indent-count: .5;"  align="left" ><SPAN style="FONT-SIZE: 10pt; mso-bidi-font-size: 11.0pt;"  lang="EN-US" ><FONT face="Calibri" >AFX_COMDAT const AFX_DATADEF AFX_INTERFACEMAP_ENTRY theClass::_interfaceEntries[] = </FONT></SPAN></P>  <P style="TEXT-ALIGN: left; TEXT-INDENT: 5pt; MARGIN: 0cm 0cm 0pt; mso-pagination: widow-orphan; mso-char-indent-count: .5;"  align="left" ><FONT face="Calibri" ><SPAN style="FONT-SIZE: 10pt; mso-bidi-font-size: 11.0pt;"  lang="EN-US" >{</SPAN><SPAN lang="EN-US" ></SPAN></FONT></P></TD></TR>  <TR style="HEIGHT: 29.7pt; mso-yfti-irow: 5;"  >  <TD style="BORDER-BOTTOM: windowtext 1pt solid; BORDER-LEFT: windowtext 1pt solid; PADDING-BOTTOM: 0cm; BACKGROUND-COLOR: transparent; PADDING-LEFT: 5.4pt; WIDTH: 39.94%; PADDING-RIGHT: 5.4pt; HEIGHT: 29.7pt; BORDER-TOP: #f0f0f0; BORDER-RIGHT: windowtext 1pt solid; PADDING-TOP: 0cm; mso-border-alt: solid windowtext .5pt; mso-border-top-alt: solid windowtext .5pt;"  vAlign="top" width="39%"  >  <P style="TEXT-ALIGN: left; MARGIN: 0cm 0cm 0pt; mso-pagination: widow-orphan;"  align="left" ><FONT face="Calibri" ><B style="mso-bidi-font-weight: normal;"  ><SPAN style="FONT-SIZE: 10pt; mso-bidi-font-size: 11.0pt;"  lang="EN-US" >INTERFACE_PART(theClass, iid, localClass)</SPAN></B><SPAN lang="EN-US" ></SPAN></FONT></P></TD>  <TD style="BORDER-BOTTOM: windowtext 1pt solid; BORDER-LEFT: #f0f0f0; PADDING-BOTTOM: 0cm; BACKGROUND-COLOR: transparent; PADDING-LEFT: 5.4pt; WIDTH: 60.06%; PADDING-RIGHT: 5.4pt; HEIGHT: 29.7pt; BORDER-TOP: #f0f0f0; BORDER-RIGHT: windowtext 1pt solid; PADDING-TOP: 0cm; mso-border-alt: solid windowtext .5pt; mso-border-left-alt: solid windowtext .5pt; mso-border-top-alt: solid windowtext .5pt;"  vAlign="top" width="60%"  >  <P style="TEXT-ALIGN: left; MARGIN: 0cm 0cm 0pt; mso-pagination: widow-orphan;"  align="left" ><FONT face="Calibri" ><SPAN lang="EN-US" >{</SPAN><SPAN style="FONT-SIZE: 10pt; mso-bidi-font-size: 11.0pt;"  lang="EN-US" > &amp;iid, offsetof(theClass, m_x##localClass) },</SPAN><SPAN lang="EN-US" ></SPAN></FONT></P></TD></TR>  <TR style="HEIGHT: 30.4pt; mso-yfti-irow: 6;"  >  <TD style="BORDER-BOTTOM: windowtext 1pt solid; BORDER-LEFT: windowtext 1pt solid; PADDING-BOTTOM: 0cm; BACKGROUND-COLOR: transparent; PADDING-LEFT: 5.4pt; WIDTH: 39.94%; PADDING-RIGHT: 5.4pt; HEIGHT: 30.4pt; BORDER-TOP: #f0f0f0; BORDER-RIGHT: windowtext 1pt solid; PADDING-TOP: 0cm; mso-border-alt: solid windowtext .5pt; mso-border-top-alt: solid windowtext .5pt;"  vAlign="top" width="39%"  >  <P style="TEXT-ALIGN: left; MARGIN: 0cm 0cm 0pt; mso-pagination: widow-orphan;"  align="left" ><FONT face="Calibri" ><B style="mso-bidi-font-weight: normal;"  ><SPAN style="FONT-SIZE: 10pt; mso-bidi-font-size: 11.0pt;"  lang="EN-US" >END_INTERFACE_MAP()</SPAN></B><SPAN lang="EN-US" ></SPAN></FONT></P></TD>  <TD style="BORDER-BOTTOM: windowtext 1pt solid; BORDER-LEFT: #f0f0f0; PADDING-BOTTOM: 0cm; BACKGROUND-COLOR: transparent; PADDING-LEFT: 5.4pt; WIDTH: 60.06%; PADDING-RIGHT: 5.4pt; HEIGHT: 30.4pt; BORDER-TOP: #f0f0f0; BORDER-RIGHT: windowtext 1pt solid; PADDING-TOP: 0cm; mso-border-alt: solid windowtext .5pt; mso-border-left-alt: solid windowtext .5pt; mso-border-top-alt: solid windowtext .5pt;"  vAlign="top" width="60%"  >  <P style="TEXT-ALIGN: left; MARGIN: 0cm 0cm 0pt; mso-pagination: widow-orphan;"  align="left" ><FONT face="Calibri" ><SPAN lang="EN-US" ><SPAN style="mso-tab-count: 1;"  >&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </SPAN></SPAN><SPAN style="FONT-SIZE: 10pt; mso-bidi-font-size: 11.0pt;"  lang="EN-US" >{ NULL, (size_t)-1 } </SPAN></FONT></P>  <P style="TEXT-ALIGN: left; MARGIN: 0cm 0cm 0pt; mso-pagination: widow-orphan;"  align="left" ><FONT face="Calibri" ><SPAN style="FONT-SIZE: 10pt; mso-bidi-font-size: 11.0pt;"  lang="EN-US" >};</SPAN><SPAN lang="EN-US" ></SPAN></FONT></P></TD></TR>  <TR style="HEIGHT: 44.9pt; mso-yfti-irow: 7;"  >  <TD style="BORDER-BOTTOM: windowtext 1pt solid; BORDER-LEFT: windowtext 1pt solid; PADDING-BOTTOM: 0cm; BACKGROUND-COLOR: transparent; PADDING-LEFT: 5.4pt; WIDTH: 39.94%; PADDING-RIGHT: 5.4pt; HEIGHT: 44.9pt; BORDER-TOP: #f0f0f0; BORDER-RIGHT: windowtext 1pt solid; PADDING-TOP: 0cm; mso-border-alt: solid windowtext .5pt; mso-border-top-alt: solid windowtext .5pt;"  vAlign="top" width="39%"  >  <P style="TEXT-ALIGN: left; MARGIN: 0cm 0cm 0pt; mso-pagination: widow-orphan;"  align="left" ><B style="mso-bidi-font-weight: normal;"  ><SPAN style="FONT-SIZE: 10pt; mso-bidi-font-size: 11.0pt;"  lang="EN-US" ><FONT face="Calibri" >DECLARE_OLECREATE(class_name)</FONT></SPAN></B></P></TD>  <TD style="BORDER-BOTTOM: windowtext 1pt solid; BORDER-LEFT: #f0f0f0; PADDING-BOTTOM: 0cm; BACKGROUND-COLOR: transparent; PADDING-LEFT: 5.4pt; WIDTH: 60.06%; PADDING-RIGHT: 5.4pt; HEIGHT: 44.9pt; BORDER-TOP: #f0f0f0; BORDER-RIGHT: windowtext 1pt solid; PADDING-TOP: 0cm; mso-border-alt: solid windowtext .5pt; mso-border-left-alt: solid windowtext .5pt; mso-border-top-alt: solid windowtext .5pt;"  vAlign="top" width="60%"  >  <P style="TEXT-ALIGN: left; MARGIN: 0cm 0cm 0pt; mso-pagination: widow-orphan;"  align="left" ><SPAN style="FONT-SIZE: 10pt; mso-bidi-font-size: 11.0pt;"  lang="EN-US" ><FONT face="Calibri" >public: </FONT></SPAN></P>  <P style="TEXT-ALIGN: left; MARGIN: 0cm 0cm 0pt; mso-pagination: widow-orphan;"  align="left" ><SPAN style="FONT-SIZE: 10pt; mso-bidi-font-size: 11.0pt;"  lang="EN-US" ><FONT face="Calibri" ><SPAN style="mso-tab-count: 1;"  >&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </SPAN>static AFX_DATA COleObjectFactory factory; </FONT></SPAN></P>  <P style="TEXT-ALIGN: left; MARGIN: 0cm 0cm 0pt; mso-pagination: widow-orphan;"  align="left" ><SPAN style="FONT-SIZE: 10pt; mso-bidi-font-size: 11.0pt;"  lang="EN-US" ><FONT face="Calibri" ><SPAN style="mso-tab-count: 1;"  >&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </SPAN>static AFX_DATA const GUID guid; </FONT></SPAN></P></TD></TR>  <TR style="HEIGHT: 75.3pt; mso-yfti-irow: 8; mso-yfti-lastrow: yes;"  >  <TD style="BORDER-BOTTOM: windowtext 1pt solid; BORDER-LEFT: windowtext 1pt solid; PADDING-BOTTOM: 0cm; BACKGROUND-COLOR: transparent; PADDING-LEFT: 5.4pt; WIDTH: 39.94%; PADDING-RIGHT: 5.4pt; HEIGHT: 75.3pt; BORDER-TOP: #f0f0f0; BORDER-RIGHT: windowtext 1pt solid; PADDING-TOP: 0cm; mso-border-alt: solid windowtext .5pt; mso-border-top-alt: solid windowtext .5pt;"  vAlign="top" width="39%"  >  <P style="TEXT-ALIGN: left; MARGIN: 0cm 0cm 0pt; mso-pagination: widow-orphan;"  align="left" ><B style="mso-bidi-font-weight: normal;"  ><SPAN style="FONT-SIZE: 10pt; mso-bidi-font-size: 11.0pt;"  lang="EN-US" ><FONT face="Calibri" >IMPLEMENT_OLECREATE(class_name, external_name, l, w1, w2, b1, b2, b3, b4, b5, b6, b7, b8)</FONT></SPAN></B></P></TD>  <TD style="BORDER-BOTTOM: windowtext 1pt solid; BORDER-LEFT: #f0f0f0; PADDING-BOTTOM: 0cm; BACKGROUND-COLOR: transparent; PADDING-LEFT: 5.4pt; WIDTH: 60.06%; PADDING-RIGHT: 5.4pt; HEIGHT: 75.3pt; BORDER-TOP: #f0f0f0; BORDER-RIGHT: windowtext 1pt solid; PADDING-TOP: 0cm; mso-border-alt: solid windowtext .5pt; mso-border-left-alt: solid windowtext .5pt; mso-border-top-alt: solid windowtext .5pt;"  vAlign="top" width="60%"  >  <P style="TEXT-ALIGN: left; MARGIN: 0cm 0cm 0pt; mso-pagination: widow-orphan;"  align="left" ><SPAN style="FONT-SIZE: 10pt; mso-bidi-font-size: 11.0pt;"  lang="EN-US" ><FONT face="Calibri" >AFX_DATADEF COleObjectFactory class_name::factory(class_name::guid, RUNTIME_CLASS(class_name), FALSE, _T(external_name)); </FONT></SPAN></P>  <P style="TEXT-ALIGN: left; MARGIN: 0cm 0cm 0pt; mso-pagination: widow-orphan;"  align="left" ><SPAN style="FONT-SIZE: 10pt; mso-bidi-font-size: 11.0pt;"  lang="EN-US" ><FONT face="Calibri" >AFX_COMDAT const AFX_DATADEF GUID class_name::guid = </FONT></SPAN></P>  <P style="TEXT-ALIGN: left; MARGIN: 0cm 0cm 0pt; mso-pagination: widow-orphan;"  align="left" ><SPAN style="FONT-SIZE: 10pt; mso-bidi-font-size: 11.0pt;"  lang="EN-US" ><FONT face="Calibri" >{ l, w1, w2, { b1, b2, b3, b4, b5, b6, b7, b8 } }; </FONT></SPAN></P></TD></TR></TABLE>  <P style="TEXT-ALIGN: left; MARGIN: 0cm 0cm 0pt; mso-pagination: widow-orphan;"  align="left" ><SPAN lang="EN-US" ><FONT face="Calibri" >&nbsp;</FONT></SPAN></P>  <P style="TEXT-ALIGN: left; MARGIN: 0cm 0cm 0pt; mso-pagination: widow-orphan;"  align="left" ><SPAN style="FONT-FAMILY: 宋体; mso-ascii-font-family: Calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: Calibri; mso-hansi-theme-font: minor-latin;"  >说明：</SPAN><FONT face="Calibri" > <SPAN lang="EN-US" >_interfaceEntries[] </SPAN></FONT><SPAN style="FONT-FAMILY: 宋体; mso-ascii-font-family: Calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: Calibri; mso-hansi-theme-font: minor-latin;"  >保存了</SPAN><B style="mso-bidi-font-weight: normal;"  ><SPAN style="FONT-SIZE: 10pt; mso-bidi-font-size: 11.0pt;"  lang="EN-US" ><FONT face="Calibri" >AFX_INTERFACEMAP_ENTRY </FONT></SPAN></B><SPAN style="FONT-FAMILY: 宋体; mso-ascii-font-family: Calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: Calibri; mso-hansi-theme-font: minor-latin;"  >数组，这个数组也就是接口</SPAN><SPAN lang="EN-US" ><FONT face="Calibri" >ID</FONT></SPAN><SPAN style="FONT-FAMILY: 宋体; mso-ascii-font-family: Calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: Calibri; mso-hansi-theme-font: minor-latin;"  >和接口</SPAN><SPAN lang="EN-US" ><FONT face="Calibri" >vtable</FONT></SPAN><SPAN style="FONT-FAMILY: 宋体; mso-ascii-font-family: Calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: Calibri; mso-hansi-theme-font: minor-latin;"  >与父类指针的偏移量的映射表。</SPAN><SPAN lang="EN-US" ><FONT face="Calibri" >interfaceMap </FONT></SPAN><SPAN style="FONT-FAMILY: 宋体; mso-ascii-font-family: Calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: Calibri; mso-hansi-theme-font: minor-latin;"  >其中一个指针指向父类，另外一个指向</SPAN><SPAN lang="EN-US" ><FONT face="Calibri" >_interfaceEntries[]</FONT></SPAN><SPAN style="FONT-FAMILY: 宋体; mso-ascii-font-family: Calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: Calibri; mso-hansi-theme-font: minor-latin;"  >。</SPAN><SPAN lang="EN-US" ><FONT face="Calibri" >_GetBaseInterfaceMap</FONT></SPAN><SPAN style="FONT-FAMILY: 宋体; mso-ascii-font-family: Calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: Calibri; mso-hansi-theme-font: minor-latin;"  >函数返回</SPAN><SPAN lang="EN-US" ><FONT face="Calibri" >interfaceMap</FONT></SPAN><SPAN style="FONT-FAMILY: 宋体; mso-ascii-font-family: Calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: Calibri; mso-hansi-theme-font: minor-latin;"  >的地址。这张映射表的实现是通过</SPAN><SPAN lang="EN-US" ><FONT face="Calibri" >BEGIN_INTERFACE_MAP(theClass, theBase), INTERFACE_PART(theClass, iid, localClass), END_INTERFACE_MAP() </FONT></SPAN><SPAN style="FONT-FAMILY: 宋体; mso-ascii-font-family: Calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: Calibri; mso-hansi-theme-font: minor-latin;"  >三个宏实现的。</SPAN><SPAN lang="EN-US" ></SPAN></P>  <P style="TEXT-ALIGN: left; MARGIN: 0cm 0cm 0pt; mso-pagination: widow-orphan;"  align="left" ><SPAN lang="EN-US" ><FONT face="Calibri" >&nbsp;</FONT></SPAN></P>  <P style="TEXT-ALIGN: left; MARGIN: 0cm 0cm 0pt; mso-pagination: widow-orphan;"  align="left" ><SPAN lang="EN-US" ><FONT face="Calibri" >CCmdTarget </FONT></SPAN><SPAN style="FONT-FAMILY: 宋体; mso-ascii-font-family: Calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: Calibri; mso-hansi-theme-font: minor-latin;"  >实现了俩个版本的</SPAN><SPAN lang="EN-US" ><FONT face="Calibri" >IUnkown</FONT></SPAN><SPAN style="FONT-FAMILY: 宋体; mso-ascii-font-family: Calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: Calibri; mso-hansi-theme-font: minor-latin;"  >，非委托、委托</SPAN><SPAN lang="EN-US" ><FONT face="Calibri" >IUnkown</FONT></SPAN><SPAN style="FONT-FAMILY: 宋体; mso-ascii-font-family: Calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: Calibri; mso-hansi-theme-font: minor-latin;"  >。</SPAN><SPAN lang="EN-US" ></SPAN></P>  <P style="TEXT-ALIGN: left; MARGIN: 0cm 0cm 0pt; mso-pagination: widow-orphan;"  align="left" ><SPAN lang="EN-US" ><FONT face="Calibri" >&nbsp;</FONT></SPAN></P>  <P style="TEXT-ALIGN: left; MARGIN: 0cm 0cm 0pt; mso-pagination: widow-orphan;"  align="left" ><SPAN style="FONT-FAMILY: 宋体; mso-ascii-font-family: Calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: Calibri; mso-hansi-theme-font: minor-latin;"  >从</SPAN><SPAN lang="EN-US" ><FONT face="Calibri" >CCmdTarget</FONT></SPAN><SPAN style="FONT-FAMILY: 宋体; mso-ascii-font-family: Calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: Calibri; mso-hansi-theme-font: minor-latin;"  >继承下来的，为了实现聚合，调用的应该是委托</SPAN><SPAN lang="EN-US" ><FONT face="Calibri" >IUnkown</FONT></SPAN><SPAN style="FONT-FAMILY: 宋体; mso-ascii-font-family: Calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: Calibri; mso-hansi-theme-font: minor-latin;"  >接口（</SPAN><SPAN lang="EN-US" ><FONT face="Calibri" >External</FONT></SPAN><SPAN style="FONT-FAMILY: 宋体; mso-ascii-font-family: Calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: Calibri; mso-hansi-theme-font: minor-latin;"  >）。</SPAN><SPAN lang="EN-US" ></SPAN></P>  <P style="TEXT-ALIGN: left; MARGIN: 0cm 0cm 0pt; mso-pagination: widow-orphan;"  align="left" ><SPAN style="FONT-FAMILY: 宋体; mso-ascii-font-family: Calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: Calibri; mso-hansi-theme-font: minor-latin;"  >目前为止，只有接口的实现，没有出现类厂，类厂已经被</SPAN><SPAN lang="EN-US" ><FONT face="Calibri" >MFC</FONT></SPAN><SPAN style="FONT-FAMILY: 宋体; mso-ascii-font-family: Calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: Calibri; mso-hansi-theme-font: minor-latin;"  >自动生成了。</SPAN><SPAN lang="EN-US" ></SPAN></P>  <P style="TEXT-ALIGN: left; MARGIN: 0cm 0cm 0pt; mso-pagination: widow-orphan;"  align="left" ><SPAN lang="EN-US" ><FONT face="Calibri" >&nbsp;</FONT></SPAN></P>  <P style="TEXT-ALIGN: left; MARGIN: 0cm 0cm 0pt; mso-pagination: widow-orphan;"  align="left" ><SPAN style="FONT-FAMILY: 宋体; mso-ascii-font-family: Calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: Calibri; mso-hansi-theme-font: minor-latin;"  >在</SPAN><SPAN lang="EN-US" ><FONT face="Calibri" >DLL </FONT></SPAN><SPAN style="FONT-FAMILY: 宋体; mso-ascii-font-family: Calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: Calibri; mso-hansi-theme-font: minor-latin;"  >的</SPAN><SPAN lang="EN-US" ><FONT face="Calibri" >AppWizard</FONT></SPAN><SPAN style="FONT-FAMILY: 宋体; mso-ascii-font-family: Calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: Calibri; mso-hansi-theme-font: minor-latin;"  >向导中选中：</SPAN><SPAN lang="EN-US" ><FONT face="Calibri" >Automation</FONT></SPAN><SPAN style="FONT-FAMILY: 宋体; mso-ascii-font-family: Calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: Calibri; mso-hansi-theme-font: minor-latin;"  >，向导会生成如下代码：</SPAN><SPAN lang="EN-US" ></SPAN></P>  <P style="TEXT-ALIGN: left; MARGIN: 0cm 0cm 0pt; mso-pagination: widow-orphan;"  align="left" ><SPAN lang="EN-US" ><FONT face="Calibri" >STDAPI DllGetClassObject(REFCLSID rclsid, REFIID riid, LPVOID* ppv)</FONT></SPAN></P>  <P style="TEXT-ALIGN: left; MARGIN: 0cm 0cm 0pt; mso-pagination: widow-orphan;"  align="left" ><SPAN lang="EN-US" ><FONT face="Calibri" >{</FONT></SPAN></P>  <P style="TEXT-ALIGN: left; MARGIN: 0cm 0cm 0pt; mso-pagination: widow-orphan;"  align="left" ><SPAN lang="EN-US" ><FONT face="Calibri" ><SPAN style="mso-tab-count: 1;"  >&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </SPAN>AFX_MANAGE_STATE(AfxGetStaticModuleState());</FONT></SPAN></P>  <P style="TEXT-ALIGN: left; MARGIN: 0cm 0cm 0pt; mso-pagination: widow-orphan;"  align="left" ><SPAN lang="EN-US" ><FONT face="Calibri" ><SPAN style="mso-tab-count: 1;"  >&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </SPAN>return AfxDllGetClassObject(rclsid, riid, ppv);</FONT></SPAN></P>  <P style="TEXT-ALIGN: left; MARGIN: 0cm 0cm 0pt; mso-pagination: widow-orphan;"  align="left" ><SPAN lang="EN-US" ><FONT face="Calibri" >}</FONT></SPAN></P>  <P style="TEXT-ALIGN: left; MARGIN: 0cm 0cm 0pt; mso-pagination: widow-orphan;"  align="left" ><SPAN lang="EN-US" ><FONT face="Calibri" >&nbsp;</FONT></SPAN></P>  <P style="TEXT-ALIGN: left; MARGIN: 0cm 0cm 0pt; mso-pagination: widow-orphan;"  align="left" ><SPAN lang="EN-US" ><FONT face="Calibri" >STDAPI DllCanUnloadNow(void)</FONT></SPAN></P>  <P style="TEXT-ALIGN: left; MARGIN: 0cm 0cm 0pt; mso-pagination: widow-orphan;"  align="left" ><SPAN lang="EN-US" ><FONT face="Calibri" >{</FONT></SPAN></P>  <P style="TEXT-ALIGN: left; MARGIN: 0cm 0cm 0pt; mso-pagination: widow-orphan;"  align="left" ><SPAN lang="EN-US" ><FONT face="Calibri" ><SPAN style="mso-tab-count: 1;"  >&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </SPAN>AFX_MANAGE_STATE(AfxGetStaticModuleState());</FONT></SPAN></P>  <P style="TEXT-ALIGN: left; MARGIN: 0cm 0cm 0pt; mso-pagination: widow-orphan;"  align="left" ><SPAN lang="EN-US" ><FONT face="Calibri" ><SPAN style="mso-tab-count: 1;"  >&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </SPAN>return AfxDllCanUnloadNow();</FONT></SPAN></P>  <P style="TEXT-ALIGN: left; MARGIN: 0cm 0cm 0pt; mso-pagination: widow-orphan;"  align="left" ><SPAN lang="EN-US" ><FONT face="Calibri" >}</FONT></SPAN></P>  <P style="TEXT-ALIGN: left; MARGIN: 0cm 0cm 0pt; mso-pagination: widow-orphan;"  align="left" ><SPAN lang="EN-US" ><FONT face="Calibri" >&nbsp;</FONT></SPAN></P>  <P style="TEXT-ALIGN: left; MARGIN: 0cm 0cm 0pt; mso-pagination: widow-orphan;"  align="left" ><SPAN lang="EN-US" ><FONT face="Calibri" >// by exporting DllRegisterServer, you can use regsvr.exe</FONT></SPAN></P>  <P style="TEXT-ALIGN: left; MARGIN: 0cm 0cm 0pt; mso-pagination: widow-orphan;"  align="left" ><SPAN lang="EN-US" ><FONT face="Calibri" >STDAPI DllRegisterServer(void)</FONT></SPAN></P>  <P style="TEXT-ALIGN: left; MARGIN: 0cm 0cm 0pt; mso-pagination: widow-orphan;"  align="left" ><SPAN lang="EN-US" ><FONT face="Calibri" >{</FONT></SPAN></P>  <P style="TEXT-ALIGN: left; MARGIN: 0cm 0cm 0pt; mso-pagination: widow-orphan;"  align="left" ><SPAN lang="EN-US" ><FONT face="Calibri" ><SPAN style="mso-tab-count: 1;"  >&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </SPAN>AFX_MANAGE_STATE(AfxGetStaticModuleState());</FONT></SPAN></P>  <P style="TEXT-ALIGN: left; MARGIN: 0cm 0cm 0pt; mso-pagination: widow-orphan;"  align="left" ><SPAN lang="EN-US" ><FONT face="Calibri" ><SPAN style="mso-tab-count: 1;"  >&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </SPAN>COleObjectFactory::UpdateRegistryAll();</FONT></SPAN></P>  <P style="TEXT-ALIGN: left; MARGIN: 0cm 0cm 0pt; mso-pagination: widow-orphan;"  align="left" ><SPAN lang="EN-US" ><FONT face="Calibri" ><SPAN style="mso-tab-count: 1;"  >&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </SPAN>return S_OK;</FONT></SPAN></P>  <P style="TEXT-ALIGN: left; MARGIN: 0cm 0cm 0pt; mso-pagination: widow-orphan;"  align="left" ><SPAN lang="EN-US" ><FONT face="Calibri" >}</FONT></SPAN></P>  <P style="TEXT-ALIGN: left; MARGIN: 0cm 0cm 0pt; mso-pagination: widow-orphan;"  align="left" ><SPAN lang="EN-US" ><FONT face="Calibri" >&nbsp;</FONT></SPAN></P>  <P style="TEXT-ALIGN: left; MARGIN: 0cm 0cm 0pt; mso-pagination: widow-orphan;"  align="left" ><SPAN style="FONT-FAMILY: 宋体; mso-ascii-font-family: Calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: Calibri; mso-hansi-theme-font: minor-latin;"  >我们知道，类厂应该是</SPAN><SPAN lang="EN-US" ><FONT face="Calibri" >DllGetClassObject</FONT></SPAN><SPAN style="FONT-FAMILY: 宋体; mso-ascii-font-family: Calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: Calibri; mso-hansi-theme-font: minor-latin;"  >里面创建的，这个函数调用了</SPAN><SPAN lang="EN-US" ><FONT face="Calibri" >AfxDllGetClassObject</FONT></SPAN><SPAN style="FONT-FAMILY: 宋体; mso-ascii-font-family: Calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: Calibri; mso-hansi-theme-font: minor-latin;"  >。秘密就在其后。</SPAN><SPAN lang="EN-US" ></SPAN></P>  <P style="TEXT-ALIGN: left; MARGIN: 0cm 0cm 0pt; mso-pagination: widow-orphan;"  align="left" ><SPAN lang="EN-US" ><FONT face="Calibri" >&nbsp;</FONT></SPAN></P>  <P style="TEXT-ALIGN: left; MARGIN: 0cm 0cm 0pt; mso-pagination: widow-orphan;"  align="left" ><SPAN lang="EN-US" ><FONT face="Calibri" >SCODE AFXAPI <B style="mso-bidi-font-weight: normal;"  >AfxDllGetClassObject</B>(REFCLSID rclsid, REFIID riid, LPVOID* ppv)</FONT></SPAN></P>  <P style="TEXT-ALIGN: left; MARGIN: 0cm 0cm 0pt; mso-pagination: widow-orphan;"  align="left" ><SPAN lang="EN-US" ><FONT face="Calibri" >{</FONT></SPAN></P>  <P style="TEXT-ALIGN: left; MARGIN: 0cm 0cm 0pt; mso-pagination: widow-orphan;"  align="left" ><SPAN lang="EN-US" ><FONT face="Calibri" ><SPAN style="mso-tab-count: 1;"  >&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </SPAN>*ppv = NULL;</FONT></SPAN></P>  <P style="TEXT-ALIGN: left; MARGIN: 0cm 0cm 0pt; mso-pagination: widow-orphan;"  align="left" ><SPAN lang="EN-US" ><FONT face="Calibri" ><SPAN style="mso-tab-count: 1;"  >&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </SPAN>DWORD lData1 = rclsid.Data1;</FONT></SPAN></P>  <P style="TEXT-ALIGN: left; MARGIN: 0cm 0cm 0pt; mso-pagination: widow-orphan;"  align="left" ><SPAN lang="EN-US" ><FONT face="Calibri" >&nbsp;</FONT></SPAN></P>  <P style="TEXT-ALIGN: left; MARGIN: 0cm 0cm 0pt; mso-pagination: widow-orphan;"  align="left" ><SPAN lang="EN-US" ><FONT face="Calibri" ><SPAN style="mso-tab-count: 1;"  >&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </SPAN>// search factories defined in the application</FONT></SPAN></P>  <P style="TEXT-ALIGN: left; MARGIN: 0cm 0cm 0pt; mso-pagination: widow-orphan;"  align="left" ><SPAN lang="EN-US" ><FONT face="Calibri" ><SPAN style="mso-tab-count: 1;"  >&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </SPAN>AFX_MODULE_STATE* pModuleState = AfxGetModuleState();</FONT></SPAN></P>  <P style="TEXT-ALIGN: left; MARGIN: 0cm 0cm 0pt; mso-pagination: widow-orphan;"  align="left" ><SPAN lang="EN-US" ><FONT face="Calibri" ><SPAN style="mso-tab-count: 1;"  >&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </SPAN>AfxLockGlobals(CRIT_OBJECTFACTORYLIST);</FONT></SPAN></P>  <P style="TEXT-ALIGN: left; MARGIN: 0cm 0cm 0pt; mso-pagination: widow-orphan;"  align="left" ><SPAN lang="EN-US" ><FONT face="Calibri" ><SPAN style="mso-tab-count: 1;"  >&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </SPAN>for (<B style="mso-bidi-font-weight: normal;"  >COleObjectFactory</B>* pFactory = pModuleState-&gt;m_factoryList;</FONT></SPAN></P>  <P style="TEXT-ALIGN: left; MARGIN: 0cm 0cm 0pt; mso-pagination: widow-orphan;"  align="left" ><SPAN lang="EN-US" ><FONT face="Calibri" ><SPAN style="mso-tab-count: 2;"  >&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </SPAN>pFactory != NULL; pFactory = pFactory-&gt;m_pNextFactory)</FONT></SPAN></P>  <P style="TEXT-ALIGN: left; MARGIN: 0cm 0cm 0pt; mso-pagination: widow-orphan;"  align="left" ><SPAN lang="EN-US" ><FONT face="Calibri" ><SPAN style="mso-tab-count: 1;"  >&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </SPAN>{</FONT></SPAN></P>  <P style="TEXT-ALIGN: left; MARGIN: 0cm 0cm 0pt; mso-pagination: widow-orphan;"  align="left" ><SPAN lang="EN-US" ><FONT face="Calibri" ><SPAN style="mso-tab-count: 2;"  >&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </SPAN>if (pFactory-&gt;m_bRegistered != 0 &amp;&amp;</FONT></SPAN></P>  <P style="TEXT-ALIGN: left; MARGIN: 0cm 0cm 0pt; mso-pagination: widow-orphan;"  align="left" ><SPAN lang="EN-US" ><FONT face="Calibri" ><SPAN style="mso-tab-count: 3;"  >&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </SPAN>lData1 == pFactory-&gt;m_clsid.Data1 &amp;&amp;</FONT></SPAN></P>  <P style="TEXT-ALIGN: left; MARGIN: 0cm 0cm 0pt; mso-pagination: widow-orphan;"  align="left" ><SPAN lang="EN-US" ><FONT face="Calibri" ><SPAN style="mso-tab-count: 3;"  >&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </SPAN>((DWORD*)&amp;rclsid)[1] == ((DWORD*)&amp;pFactory-&gt;m_clsid)[1] &amp;&amp;</FONT></SPAN></P>  <P style="TEXT-ALIGN: left; MARGIN: 0cm 0cm 0pt; mso-pagination: widow-orphan;"  align="left" ><SPAN lang="EN-US" ><FONT face="Calibri" ><SPAN style="mso-tab-count: 3;"  >&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </SPAN>((DWORD*)&amp;rclsid)[2] == ((DWORD*)&amp;pFactory-&gt;m_clsid)[2] &amp;&amp;</FONT></SPAN></P>  <P style="TEXT-ALIGN: left; MARGIN: 0cm 0cm 0pt; mso-pagination: widow-orphan;"  align="left" ><SPAN lang="EN-US" ><FONT face="Calibri" ><SPAN style="mso-tab-count: 3;"  >&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </SPAN>((DWORD*)&amp;rclsid)[3] == ((DWORD*)&amp;pFactory-&gt;m_clsid)[3])</FONT></SPAN></P>  <P style="TEXT-ALIGN: left; MARGIN: 0cm 0cm 0pt; mso-pagination: widow-orphan;"  align="left" ><SPAN lang="EN-US" ><FONT face="Calibri" ><SPAN style="mso-tab-count: 2;"  >&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </SPAN>{</FONT></SPAN></P>  <P style="TEXT-ALIGN: left; MARGIN: 0cm 0cm 0pt; mso-pagination: widow-orphan;"  align="left" ><SPAN lang="EN-US" ><FONT face="Calibri" ><SPAN style="mso-tab-count: 3;"  >&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </SPAN>// found suitable class factory -- query for correct interface</FONT></SPAN></P>  <P style="TEXT-ALIGN: left; MARGIN: 0cm 0cm 0pt; mso-pagination: widow-orphan;"  align="left" ><SPAN lang="EN-US" ><FONT face="Calibri" ><SPAN style="mso-tab-count: 3;"  >&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </SPAN>SCODE sc = pFactory-&gt;InternalQueryInterface(&amp;riid, ppv);</FONT></SPAN></P>  <P style="TEXT-ALIGN: left; MARGIN: 0cm 0cm 0pt; mso-pagination: widow-orphan;"  align="left" ><SPAN lang="EN-US" ><FONT face="Calibri" ><SPAN style="mso-tab-count: 3;"  >&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </SPAN>AfxUnlockGlobals(CRIT_OBJECTFACTORYLIST);</FONT></SPAN></P>  <P style="TEXT-ALIGN: left; MARGIN: 0cm 0cm 0pt; mso-pagination: widow-orphan;"  align="left" ><SPAN lang="EN-US" ><FONT face="Calibri" ><SPAN style="mso-tab-count: 3;"  >&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </SPAN>return sc;</FONT></SPAN></P>  <P style="TEXT-ALIGN: left; MARGIN: 0cm 0cm 0pt; mso-pagination: widow-orphan;"  align="left" ><SPAN lang="EN-US" ><FONT face="Calibri" ><SPAN style="mso-tab-count: 2;"  >&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </SPAN>}</FONT></SPAN></P>  <P style="TEXT-ALIGN: left; MARGIN: 0cm 0cm 0pt; mso-pagination: widow-orphan;"  align="left" ><SPAN lang="EN-US" ><FONT face="Calibri" ><SPAN style="mso-tab-count: 1;"  >&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </SPAN>}</FONT></SPAN></P>  <P style="TEXT-ALIGN: left; MARGIN: 0cm 0cm 0pt; mso-pagination: widow-orphan;"  align="left" ><SPAN lang="EN-US" ><FONT face="Calibri" ><SPAN style="mso-tab-count: 1;"  >&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </SPAN>AfxUnlockGlobals(CRIT_OBJECTFACTORYLIST);</FONT></SPAN></P>  <P style="TEXT-ALIGN: left; MARGIN: 0cm 0cm 0pt; mso-pagination: widow-orphan;"  align="left" ><SPAN lang="EN-US" ><FONT face="Calibri" >#ifdef _AFXDLL</FONT></SPAN></P>  <P style="TEXT-ALIGN: left; MARGIN: 0cm 0cm 0pt; mso-pagination: widow-orphan;"  align="left" ><SPAN lang="EN-US" ><FONT face="Calibri" ><SPAN style="mso-tab-count: 1;"  >&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </SPAN>AfxLockGlobals(CRIT_DYNLINKLIST);</FONT></SPAN></P>  <P style="TEXT-ALIGN: left; MARGIN: 0cm 0cm 0pt; mso-pagination: widow-orphan;"  align="left" ><SPAN lang="EN-US" ><FONT face="Calibri" ><SPAN style="mso-tab-count: 1;"  >&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </SPAN>// search factories defined in extension DLLs</FONT></SPAN></P>  <P style="TEXT-ALIGN: left; MARGIN: 0cm 0cm 0pt; mso-pagination: widow-orphan;"  align="left" ><SPAN lang="EN-US" ><FONT face="Calibri" ><SPAN style="mso-tab-count: 1;"  >&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </SPAN>for (CDynLinkLibrary* pDLL = pModuleState-&gt;m_libraryList; pDLL != NULL;</FONT></SPAN></P>  <P style="TEXT-ALIGN: left; MARGIN: 0cm 0cm 0pt; mso-pagination: widow-orphan;"  align="left" ><SPAN lang="EN-US" ><FONT face="Calibri" ><SPAN style="mso-tab-count: 2;"  >&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </SPAN>pDLL = pDLL-&gt;m_pNextDLL)</FONT></SPAN></P>  <P style="TEXT-ALIGN: left; MARGIN: 0cm 0cm 0pt; mso-pagination: widow-orphan;"  align="left" ><SPAN lang="EN-US" ><FONT face="Calibri" ><SPAN style="mso-tab-count: 1;"  >&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </SPAN>{</FONT></SPAN></P>  <P style="TEXT-ALIGN: left; MARGIN: 0cm 0cm 0pt; mso-pagination: widow-orphan;"  align="left" ><SPAN lang="EN-US" ><FONT face="Calibri" ><SPAN style="mso-tab-count: 2;"  >&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </SPAN>for (pFactory = pDLL-&gt;m_factoryList;</FONT></SPAN></P>  <P style="TEXT-ALIGN: left; MARGIN: 0cm 0cm 0pt; mso-pagination: widow-orphan;"  align="left" ><SPAN lang="EN-US" ><FONT face="Calibri" ><SPAN style="mso-tab-count: 3;"  >&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </SPAN>pFactory != NULL; pFactory = pFactory-&gt;m_pNextFactory)</FONT></SPAN></P>  <P style="TEXT-ALIGN: left; MARGIN: 0cm 0cm 0pt; mso-pagination: widow-orphan;"  align="left" ><SPAN lang="EN-US" ><FONT face="Calibri" ><SPAN style="mso-tab-count: 2;"  >&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </SPAN>{</FONT></SPAN></P>  <P style="TEXT-ALIGN: left; MARGIN: 0cm 0cm 0pt; mso-pagination: widow-orphan;"  align="left" ><SPAN lang="EN-US" ><FONT face="Calibri" ><SPAN style="mso-tab-count: 3;"  >&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </SPAN>if (pFactory-&gt;m_bRegistered != 0 &amp;&amp;</FONT></SPAN></P>  <P style="TEXT-ALIGN: left; MARGIN: 0cm 0cm 0pt; mso-pagination: widow-orphan;"  align="left" ><SPAN lang="EN-US" ><FONT face="Calibri" ><SPAN style="mso-tab-count: 4;"  >&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </SPAN>lData1 == pFactory-&gt;m_clsid.Data1 &amp;&amp;</FONT></SPAN></P>  <P style="TEXT-ALIGN: left; MARGIN: 0cm 0cm 0pt; mso-pagination: widow-orphan;"  align="left" ><SPAN lang="EN-US" ><FONT face="Calibri" ><SPAN style="mso-tab-count: 4;"  >&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </SPAN>((DWORD*)&amp;rclsid)[1] == ((DWORD*)&amp;pFactory-&gt;m_clsid)[1] &amp;&amp;</FONT></SPAN></P>  <P style="TEXT-ALIGN: left; MARGIN: 0cm 0cm 0pt; mso-pagination: widow-orphan;"  align="left" ><SPAN lang="EN-US" ><FONT face="Calibri" ><SPAN style="mso-tab-count: 4;"  >&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </SPAN>((DWORD*)&amp;rclsid)[2] == ((DWORD*)&amp;pFactory-&gt;m_clsid)[2] &amp;&amp;</FONT></SPAN></P>  <P style="TEXT-ALIGN: left; MARGIN: 0cm 0cm 0pt; mso-pagination: widow-orphan;"  align="left" ><SPAN lang="EN-US" ><FONT face="Calibri" ><SPAN style="mso-tab-count: 4;"  >&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </SPAN>((DWORD*)&amp;rclsid)[3] == ((DWORD*)&amp;pFactory-&gt;m_clsid)[3])</FONT></SPAN></P>  <P style="TEXT-ALIGN: left; MARGIN: 0cm 0cm 0pt; mso-pagination: widow-orphan;"  align="left" ><SPAN lang="EN-US" ><FONT face="Calibri" ><SPAN style="mso-tab-count: 3;"  >&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </SPAN>{</FONT></SPAN></P>  <P style="TEXT-ALIGN: left; MARGIN: 0cm 0cm 0pt; mso-pagination: widow-orphan;"  align="left" ><SPAN lang="EN-US" ><FONT face="Calibri" ><SPAN style="mso-tab-count: 4;"  >&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </SPAN>// found suitable class factory -- query for correct interface</FONT></SPAN></P>  <P style="TEXT-ALIGN: left; MARGIN: 0cm 0cm 0pt; mso-pagination: widow-orphan;"  align="left" ><SPAN lang="EN-US" ><FONT face="Calibri" ><SPAN style="mso-tab-count: 4;"  >&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </SPAN>SCODE sc = pFactory-&gt;InternalQueryInterface(&amp;riid, ppv);</FONT></SPAN></P>  <P style="TEXT-ALIGN: left; MARGIN: 0cm 0cm 0pt; mso-pagination: widow-orphan;"  align="left" ><SPAN lang="EN-US" ><FONT face="Calibri" ><SPAN style="mso-tab-count: 4;"  >&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </SPAN>AfxUnlockGlobals(CRIT_DYNLINKLIST);</FONT></SPAN></P>  <P style="TEXT-ALIGN: left; MARGIN: 0cm 0cm 0pt; mso-pagination: widow-orphan;"  align="left" ><SPAN lang="EN-US" ><FONT face="Calibri" ><SPAN style="mso-tab-count: 4;"  >&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </SPAN>return sc;</FONT></SPAN></P>  <P style="TEXT-ALIGN: left; MARGIN: 0cm 0cm 0pt; mso-pagination: widow-orphan;"  align="left" ><SPAN lang="EN-US" ><FONT face="Calibri" ><SPAN style="mso-tab-count: 3;"  >&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </SPAN>}</FONT></SPAN></P>  <P style="TEXT-ALIGN: left; MARGIN: 0cm 0cm 0pt; mso-pagination: widow-orphan;"  align="left" ><SPAN lang="EN-US" ><FONT face="Calibri" ><SPAN style="mso-tab-count: 2;"  >&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </SPAN>}</FONT></SPAN></P>  <P style="TEXT-ALIGN: left; MARGIN: 0cm 0cm 0pt; mso-pagination: widow-orphan;"  align="left" ><SPAN lang="EN-US" ><FONT face="Calibri" ><SPAN style="mso-tab-count: 1;"  >&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </SPAN>}</FONT></SPAN></P>  <P style="TEXT-ALIGN: left; MARGIN: 0cm 0cm 0pt; mso-pagination: widow-orphan;"  align="left" ><SPAN lang="EN-US" ><FONT face="Calibri" ><SPAN style="mso-tab-count: 1;"  >&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </SPAN>AfxUnlockGlobals(CRIT_DYNLINKLIST);</FONT></SPAN></P>  <P style="TEXT-ALIGN: left; MARGIN: 0cm 0cm 0pt; mso-pagination: widow-orphan;"  align="left" ><SPAN lang="EN-US" ><FONT face="Calibri" >#endif</FONT></SPAN></P>  <P style="TEXT-ALIGN: left; MARGIN: 0cm 0cm 0pt; mso-pagination: widow-orphan;"  align="left" ><SPAN lang="EN-US" ><FONT face="Calibri" >&nbsp;</FONT></SPAN></P>  <P style="TEXT-ALIGN: left; MARGIN: 0cm 0cm 0pt; mso-pagination: widow-orphan;"  align="left" ><SPAN lang="EN-US" ><FONT face="Calibri" ><SPAN style="mso-tab-count: 1;"  >&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </SPAN>// factory not registered -- return error</FONT></SPAN></P>  <P style="TEXT-ALIGN: left; MARGIN: 0cm 0cm 0pt; mso-pagination: widow-orphan;"  align="left" ><SPAN lang="EN-US" ><FONT face="Calibri" ><SPAN style="mso-tab-count: 1;"  >&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </SPAN>return CLASS_E_CLASSNOTAVAILABLE;</FONT></SPAN></P>  <P style="TEXT-ALIGN: left; MARGIN: 0cm 0cm 0pt; mso-pagination: widow-orphan;"  align="left" ><SPAN lang="EN-US" ><FONT face="Calibri" >}</FONT></SPAN></P>  <P style="TEXT-ALIGN: left; MARGIN: 0cm 0cm 0pt; mso-pagination: widow-orphan;"  align="left" ><SPAN lang="EN-US" ><FONT face="Calibri" >&nbsp;</FONT></SPAN></P>  <P style="TEXT-ALIGN: left; MARGIN: 0cm 0cm 0pt; mso-pagination: widow-orphan;"  align="left" ><SPAN lang="EN-US" ><FONT face="Calibri" >MFC</FONT></SPAN><SPAN style="FONT-FAMILY: 宋体; mso-ascii-font-family: Calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: Calibri; mso-hansi-theme-font: minor-latin;"  >使用的就是</SPAN><B style="mso-bidi-font-weight: normal;"  ><SPAN lang="EN-US" ><FONT face="Calibri" >COleObjectFactory </FONT></SPAN></B><SPAN style="FONT-FAMILY: 宋体; mso-ascii-font-family: Calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: Calibri; mso-hansi-theme-font: minor-latin;"  >这个通用的类厂（</SPAN><SPAN lang="EN-US" ><FONT face="Calibri" >Ole</FONT></SPAN><SPAN style="FONT-FAMILY: 宋体; mso-ascii-font-family: Calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: Calibri; mso-hansi-theme-font: minor-latin;"  >是历史原因导致的，其实</SPAN><SPAN lang="EN-US" ><FONT face="Calibri" >CComObjectFactory</FONT></SPAN><SPAN style="FONT-FAMILY: 宋体; mso-ascii-font-family: Calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: Calibri; mso-hansi-theme-font: minor-latin;"  >更加合适）。</SPAN><SPAN lang="EN-US" ></SPAN></P>  <P style="TEXT-ALIGN: left; MARGIN: 0cm 0cm 0pt; mso-pagination: widow-orphan;"  align="left" ><SPAN lang="EN-US" ><FONT face="Calibri" >COleObjectFactory </FONT></SPAN><SPAN style="FONT-FAMILY: 宋体; mso-ascii-font-family: Calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: Calibri; mso-hansi-theme-font: minor-latin;"  >从</SPAN><SPAN lang="EN-US" ><FONT face="Calibri" > CCmdTarget</FONT></SPAN><SPAN style="FONT-FAMILY: 宋体; mso-ascii-font-family: Calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: Calibri; mso-hansi-theme-font: minor-latin;"  >派生，实现了</SPAN><SPAN lang="EN-US" ><FONT face="Calibri" >IClassFactory2</FONT></SPAN><SPAN style="FONT-FAMILY: 宋体; mso-ascii-font-family: Calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: Calibri; mso-hansi-theme-font: minor-latin;"  >接口。此类厂使用</SPAN><SPAN lang="EN-US" ><FONT face="Calibri" >MFC</FONT></SPAN><SPAN style="FONT-FAMILY: 宋体; mso-ascii-font-family: Calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: Calibri; mso-hansi-theme-font: minor-latin;"  >动态创建机制（</SPAN><SPAN lang="EN-US" ><FONT face="Calibri" >DECLARE_DYNCREATE</FONT></SPAN><SPAN style="FONT-FAMILY: 宋体; mso-ascii-font-family: Calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: Calibri; mso-hansi-theme-font: minor-latin;"  >），创建对象。那么如何将此类厂和某个类关联？使用</SPAN><SPAN lang="EN-US" ><FONT face="Calibri" >DECLARE_OLECREATE</FONT></SPAN><SPAN style="FONT-FAMILY: 宋体; mso-ascii-font-family: Calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: Calibri; mso-hansi-theme-font: minor-latin;"  >，</SPAN><SPAN lang="EN-US" ><FONT face="Calibri" >IMPLEMENT_OLECREATE</FONT></SPAN><SPAN style="FONT-FAMILY: 宋体; mso-ascii-font-family: Calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: Calibri; mso-hansi-theme-font: minor-latin;"  >。他们将类的</SPAN><SPAN lang="EN-US" ><FONT face="Calibri" >CLSID</FONT></SPAN><SPAN style="FONT-FAMILY: 宋体; mso-ascii-font-family: Calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: Calibri; mso-hansi-theme-font: minor-latin;"  >和类的</SPAN><SPAN lang="EN-US" ><FONT face="Calibri" >RUNTIME</FONT></SPAN><SPAN style="FONT-FAMILY: 宋体; mso-ascii-font-family: Calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: Calibri; mso-hansi-theme-font: minor-latin;"  >信息传递给</SPAN><SPAN lang="EN-US" ><FONT face="Calibri" >CComObjectFactory</FONT></SPAN><SPAN style="FONT-FAMILY: 宋体; mso-ascii-font-family: Calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: Calibri; mso-hansi-theme-font: minor-latin;"  >类厂。这样类厂就能使用</SPAN><SPAN lang="EN-US" ><FONT face="Calibri" >CLSID</FONT></SPAN><SPAN style="FONT-FAMILY: 宋体; mso-ascii-font-family: Calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: Calibri; mso-hansi-theme-font: minor-latin;"  >和动态信息进行创建对象了。那么类厂是如何被</SPAN><SPAN lang="EN-US" ><FONT face="Calibri" >Afx</FONT></SPAN><SPAN style="FONT-FAMILY: 宋体; mso-ascii-font-family: Calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: Calibri; mso-hansi-theme-font: minor-latin;"  >找到的呢。从代码中看出，类厂指针的是从模块信息里面的类厂链来获取的。而类厂构造函数中调用了</SPAN><SPAN lang="EN-US" ><FONT face="Calibri" >pModuleState-&gt;m_factoryList.AddHead(this); </FONT></SPAN><SPAN style="FONT-FAMILY: 宋体; mso-ascii-font-family: Calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: Calibri; mso-hansi-theme-font: minor-latin;"  >将自己的信息加入模块信息里面，模块信息是全局的变量。这样就跑通了。流程如下：</SPAN><SPAN lang="EN-US" ></SPAN></P>  <P style="TEXT-ALIGN: left; MARGIN: 0cm 0cm 0pt; mso-pagination: widow-orphan;"  align="left" ><SPAN lang="EN-US" ><FONT face="Calibri" >AfxDllGetClassObject -&gt; </FONT></SPAN></P>  <P style="TEXT-ALIGN: left; MARGIN: 0cm 0cm 0pt; mso-pagination: widow-orphan;"  align="left" ><SPAN lang="EN-US" ><FONT face="Calibri" >Module State (factoryList), look up Factory’s clsid. -&gt; </FONT></SPAN></P>  <P style="TEXT-ALIGN: left; MARGIN: 0cm 0cm 0pt; mso-pagination: widow-orphan;"  align="left" ><SPAN lang="EN-US" ><FONT face="Calibri" >Get IClassFactory2 reference -&gt;</FONT></SPAN></P>  <P style="TEXT-ALIGN: left; MARGIN: 0cm 0cm 0pt; mso-pagination: widow-orphan;"  align="left" ><SPAN lang="EN-US" ><FONT face="Calibri" >CreateInstance -&gt; </FONT></SPAN></P>  <P style="TEXT-ALIGN: left; MARGIN: 0cm 0cm 0pt; mso-pagination: widow-orphan;"  align="left" ><SPAN lang="EN-US" ><FONT face="Calibri" >Dynamic create object using Dynamic information. -&gt;</FONT></SPAN></P>  <P style="TEXT-ALIGN: left; MARGIN: 0cm 0cm 0pt; mso-pagination: widow-orphan;"  align="left" ><SPAN lang="EN-US" ><FONT face="Calibri" >Finish.</FONT></SPAN></P>  <P style="TEXT-ALIGN: left; MARGIN: 0cm 0cm 0pt; mso-pagination: widow-orphan;"  align="left" ><SPAN lang="EN-US" ><FONT face="Calibri" >&nbsp;</FONT></SPAN></P>  <P style="TEXT-ALIGN: left; MARGIN: 0cm 0cm 0pt; mso-pagination: widow-orphan;"  align="left" ><B style="mso-bidi-font-weight: normal;"  ><SPAN lang="EN-US" ><FONT face="Calibri" >What should we do?</FONT></SPAN></B></P>  <P style="TEXT-ALIGN: left; MARGIN: 0cm 0cm 0pt; mso-pagination: widow-orphan;"  align="left" ><SPAN lang="EN-US" ><FONT face="Calibri" >VC++ 6.0 </FONT></SPAN><SPAN style="FONT-FAMILY: 宋体; mso-ascii-font-family: Calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: Calibri; mso-hansi-theme-font: minor-latin;"  >提供了</SPAN><SPAN lang="EN-US" ><FONT face="Calibri" >MFC</FONT></SPAN><SPAN style="FONT-FAMILY: 宋体; mso-ascii-font-family: Calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: Calibri; mso-hansi-theme-font: minor-latin;"  >和</SPAN><SPAN lang="EN-US" ><FONT face="Calibri" >ATL</FONT></SPAN><SPAN style="FONT-FAMILY: 宋体; mso-ascii-font-family: Calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: Calibri; mso-hansi-theme-font: minor-latin;"  >两套库，用来开发</SPAN><SPAN lang="EN-US" ><FONT face="Calibri" >COM</FONT></SPAN><SPAN style="FONT-FAMILY: 宋体; mso-ascii-font-family: Calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: Calibri; mso-hansi-theme-font: minor-latin;"  >。</SPAN><SPAN lang="EN-US" ><FONT face="Calibri" ><SPAN style="mso-tab-count: 1;"  >&nbsp; </SPAN></FONT></SPAN></P>  <P style="TEXT-ALIGN: left; MARGIN: 0cm 0cm 0pt; mso-pagination: widow-orphan;"  align="left" ><SPAN style="FONT-FAMILY: 宋体; mso-ascii-font-family: Calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: Calibri; mso-hansi-theme-font: minor-latin;"  >这里使用</SPAN><SPAN lang="EN-US" ><FONT face="Calibri" >MFC</FONT></SPAN><SPAN style="FONT-FAMILY: 宋体; mso-ascii-font-family: Calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: Calibri; mso-hansi-theme-font: minor-latin;"  >：</SPAN><SPAN lang="EN-US" ></SPAN></P>  <P style="TEXT-ALIGN: left; MARGIN: 0cm 0cm 0pt; mso-pagination: widow-orphan;"  align="left" ><SPAN lang="EN-US" ><FONT face="Calibri" >1. </FONT></SPAN><SPAN style="FONT-FAMILY: 宋体; mso-ascii-font-family: Calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: Calibri; mso-hansi-theme-font: minor-latin;"  >使用</SPAN><SPAN lang="EN-US" ><FONT face="Calibri" >AppWizard</FONT></SPAN><SPAN style="FONT-FAMILY: 宋体; mso-ascii-font-family: Calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: Calibri; mso-hansi-theme-font: minor-latin;"  >生产</SPAN><SPAN lang="EN-US" ><FONT face="Calibri" >MFC exe/dll, </FONT></SPAN><SPAN style="FONT-FAMILY: 宋体; mso-ascii-font-family: Calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: Calibri; mso-hansi-theme-font: minor-latin;"  >选择</SPAN><SPAN lang="EN-US" ><FONT face="Calibri" >Automation</FONT></SPAN></P>  <P style="TEXT-ALIGN: left; MARGIN: 0cm 0cm 0pt; mso-pagination: widow-orphan;"  align="left" ><SPAN lang="EN-US" ><FONT face="Calibri" >2. </FONT></SPAN><SPAN style="FONT-FAMILY: 宋体; mso-ascii-font-family: Calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: Calibri; mso-hansi-theme-font: minor-latin;"  >定义接口</SPAN><SPAN lang="EN-US" ></SPAN></P>  <P style="TEXT-ALIGN: left; MARGIN: 0cm 0cm 0pt; mso-pagination: widow-orphan;"  align="left" ><SPAN lang="EN-US" ><FONT face="Calibri" >3. </FONT></SPAN><SPAN style="FONT-FAMILY: 宋体; mso-ascii-font-family: Calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: Calibri; mso-hansi-theme-font: minor-latin;"  >继承</SPAN><SPAN lang="EN-US" ><FONT face="Calibri" >CCmdTarget</FONT></SPAN><SPAN style="FONT-FAMILY: 宋体; mso-ascii-font-family: Calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: Calibri; mso-hansi-theme-font: minor-latin;"  >，实现接口，（嵌入式）</SPAN><SPAN lang="EN-US" ><FONT face="Calibri" >BEGIN_INTERFACE_PART, INIT_INTERFACE_PART, STDMETHOD, STDMETHOD_, END_INTERFACE_PART.</FONT></SPAN></P>  <P style="TEXT-ALIGN: left; MARGIN: 0cm 0cm 0pt; mso-pagination: widow-orphan;"  align="left" ><SPAN lang="EN-US" ><FONT face="Calibri" >4. </FONT></SPAN><SPAN style="FONT-FAMILY: 宋体; mso-ascii-font-family: Calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: Calibri; mso-hansi-theme-font: minor-latin;"  >定义各个接口函数体：</SPAN><SPAN lang="EN-US" ><FONT face="Calibri" >Class::XlocalClass::AddRef/Release/QueryInterface(), </FONT></SPAN><SPAN style="FONT-FAMILY: 宋体; mso-ascii-font-family: Calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: Calibri; mso-hansi-theme-font: minor-latin;"  >实现接口的各个接口</SPAN><SPAN lang="EN-US" ></SPAN></P>  <P style="TEXT-ALIGN: left; MARGIN: 0cm 0cm 0pt; mso-pagination: widow-orphan;"  align="left" ><SPAN lang="EN-US" ><FONT face="Calibri" >5. </FONT></SPAN><SPAN style="FONT-FAMILY: 宋体; mso-ascii-font-family: Calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: Calibri; mso-hansi-theme-font: minor-latin;"  >定义类的静态信息，</SPAN><SPAN lang="EN-US" ><FONT face="Calibri" >DECLARE_INTERFACE_MAP</FONT></SPAN><SPAN style="FONT-FAMILY: 宋体; mso-ascii-font-family: Calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: Calibri; mso-hansi-theme-font: minor-latin;"  >，实现使用：</SPAN><SPAN lang="EN-US" ><FONT face="Calibri" >BEGIN_INTERFACE_MAP, INTERFACE_PART, END_INTERFACE_MAP</FONT></SPAN></P><SPAN style="FONT-FAMILY: 'Calibri','sans-serif'; FONT-SIZE: 10.5pt; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-theme-font: minor-latin; mso-bidi-font-size: 11.0pt; mso-bidi-font-family: 'Times New Roman'; mso-bidi-theme-font: minor-bidi; mso-ansi-language: EN-US; mso-fareast-language: ZH-CN; mso-bidi-language: AR-SA;"  lang="EN-US" >6. </SPAN><SPAN style="FONT-FAMILY: 宋体; FONT-SIZE: 10.5pt; mso-ascii-font-family: Calibri; mso-ascii-theme-font: minor-latin; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: Calibri; mso-hansi-theme-font: minor-latin; mso-bidi-font-size: 11.0pt; mso-bidi-font-family: 'Times New Roman'; mso-bidi-theme-font: minor-bidi; mso-ansi-language: EN-US; mso-fareast-language: ZH-CN; mso-bidi-language: AR-SA;"  >使用</SPAN><SPAN style="FONT-FAMILY: 'Calibri','sans-serif'; FONT-SIZE: 10.5pt; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-theme-font: minor-latin; mso-bidi-font-size: 11.0pt; mso-bidi-font-family: 'Times New Roman'; mso-bidi-theme-font: minor-bidi; mso-ansi-language: EN-US; mso-fareast-language: ZH-CN; mso-bidi-language: AR-SA;"  lang="EN-US" >MFC</SPAN><SPAN style="FONT-FAMILY: 宋体; FONT-SIZE: 10.5pt; mso-ascii-font-family: Calibri; mso-ascii-theme-font: minor-latin; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: Calibri; mso-hansi-theme-font: minor-latin; mso-bidi-font-size: 11.0pt; mso-bidi-font-family: 'Times New Roman'; mso-bidi-theme-font: minor-bidi; mso-ansi-language: EN-US; mso-fareast-language: ZH-CN; mso-bidi-language: AR-SA;"  >类厂，类里面使用：</SPAN><SPAN style="FONT-FAMILY: 'Calibri','sans-serif'; FONT-SIZE: 10.5pt; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-theme-font: minor-latin; mso-bidi-font-size: 11.0pt; mso-bidi-font-family: 'Times New Roman'; mso-bidi-theme-font: minor-bidi; mso-ansi-language: EN-US; mso-fareast-language: ZH-CN; mso-bidi-language: AR-SA;"  lang="EN-US" >DECLARE_OLECREATE, </SPAN><SPAN style="FONT-FAMILY: 宋体; FONT-SIZE: 10.5pt; mso-ascii-font-family: Calibri; mso-ascii-theme-font: minor-latin; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: Calibri; mso-hansi-theme-font: minor-latin; mso-bidi-font-size: 11.0pt; mso-bidi-font-family: 'Times New Roman'; mso-bidi-theme-font: minor-bidi; mso-ansi-language: EN-US; mso-fareast-language: ZH-CN; mso-bidi-language: AR-SA;"  >实现使用</SPAN><SPAN style="FONT-FAMILY: 'Calibri','sans-serif'; FONT-SIZE: 10.5pt; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-theme-font: minor-latin; mso-bidi-font-size: 11.0pt; mso-bidi-font-family: 'Times New Roman'; mso-bidi-theme-font: minor-bidi; mso-ansi-language: EN-US; mso-fareast-language: ZH-CN; mso-bidi-language: AR-SA;"  lang="EN-US" > IMPLEMENT_OLECREATE</SPAN><WBR>
</body></html>