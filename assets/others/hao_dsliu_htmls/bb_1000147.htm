<html><head><meta http-equiv="Content-Type" content="text/html; charset=utf8"><title>163 blogs的博客：通过Windbg利用VMware虚拟机进行双机调试</title>
<style type="text/css">
a{color: #000000;text-decoration : none;font-size: 10pt;}
a:hover {color: red;text-decoration : underline;}
.replyBox{padding:4px;border:1px solid #D8D8D8;}
</style></head><body><h2>通过Windbg利用VMware虚拟机进行双机调试</h2>
<p align="right">发布时间：2012-5-28 23:10
<br>分类名称：Debug_Crack</p><br>
<p style="background: white;"  ><span style="color:#333333; font-family:宋体; font-size:10pt;"  >看《Windows核心编程》总是想把每一个细节都搞明白，所以调试内核是必不可少的，<br>不想使用Win7下的本地内核调试。索性拿出《寒江独钓》配置一下虚拟机，双机调试XP系统吧。 </span></p><p style="background: white;"  ><span style="color:#333333; font-family:宋体; font-size:10pt;"  >WinDbg毕竟是微软支持的调试器，虽然OllyDbg也非常优秀，但是调试内核以及系统机制，<br>还是一点点学习WinDbg的使用吧。 &nbsp;www.2cto.com &nbsp; </span></p><p style="background: white;"  ><span style="color:#333333; font-family:宋体; font-size:10pt;"  >1.在VMware下安装纯净Win XP操作系统。 </span></p><p style="background: white;"  ><span style="color:#333333; font-family:宋体; font-size:10pt;"  >2.<a target="_blank" rel="nofollow" href="http://www.2cto.com/soft"  >下载</a>符合操作系统版本的WinDbg（http://msdn.microsoft.com/en-us/windows/hardware/<br>gg463009.<a target="_blank" rel="nofollow" href="http://www.2cto.com/kf/web/asp/"  >asp</a>x），进行安装。 </span></p><p style="background: white;"  ><span style="color:#333333; font-family:宋体; font-size:10pt;"  >3.设置<a target="_blank" rel="nofollow" href="http://www.2cto.com/os/xuniji/"  >虚拟机</a>操作系统boot.ini文件，boot.ini文件是隐藏属性，需要设置一下文件夹选项。<br>使用记事本打开后，在后面编辑，填入如下内容。（Win7系统设置请Google） </span></p><p style="background: white;"  ><span style="color:#333333; font-family:宋体; font-size:10pt;"  >multi(0)disk(0)rdisk(0)partition(1)\WINDOWS="Microsoft Windows XP Professional Debug" /noexecute=optin /fastdetect /debug /debugport=com1 /baudrate=115200 </span></p><p style="background: white;"  ><span style="color:#333333; font-family:宋体; font-size:10pt;"  ><br><img title="通过Windbg利用VMware虚拟机进行双机调试 - Howie - Dspace"  src="pic/img8.ph.126.net_Yan7YAleGMfamHN72NIReA==_1020065315616987638.jpg"  alt=""  />   </span></p><p style="background: white;"  >&nbsp; &nbsp;</p><p style="background: white;"  ><span style="color:#333333; font-family:宋体; font-size:10pt;"  >4.设置虚拟机的管道虚拟串口 </span></p><p style="background: white;"  ><span style="color:#333333; font-family:宋体; font-size:10pt;"  >1).运行 VMware ，点击"Edit virtual machine settings" </span></p><p style="background: white;"  ><span style="color:#333333; font-family:宋体; font-size:10pt;"  >2).点击"Add"运行VMware的Hardware Wizard </span></p><p style="background: white;"  ><span style="color:#333333; font-family:宋体; font-size:10pt;"  >3).选择"Serial Port"，点"下一步" </span></p><p style="background: white;"  ><span style="color:#333333; font-family:宋体; font-size:10pt;"  >4).选择"Output to named pipe"，点"下一步" </span></p><p style="background: white;"  ><span style="color:#333333; font-family:宋体; font-size:10pt;"  >5).保持第一框里默认的"\\.\pipe\com_1" </span></p><p style="background: white;"  ><span style="color:#333333; font-family:宋体; font-size:10pt;"  >6).第二框里选"This end is the server."（不同VMware默认选项不同） </span></p><p style="background: white;"  ><span style="color:#333333; font-family:宋体; font-size:10pt;"  >7).第三框里选"The other end is an application."&nbsp; </span></p><p style="background: white;"  ><span style="color:#333333; font-family:宋体; font-size:10pt;"  >8).勾选"Connect at power on" </span></p><p style="background: white;"  >&nbsp; &nbsp;</p><p style="background: white;"  ><img title="通过Windbg利用VMware虚拟机进行双机调试 - Howie - Dspace"  src="pic/img3.ph.126.net_bTWok8uaPyIC7dbRjEFdaA==_3063573646536163763.jpg"  alt=""  /><span style="color:#333333; font-family:宋体; font-size:10pt;"  >&nbsp; &nbsp; &nbsp;&nbsp; </span></p><p style="background: white;"  ><img title="通过Windbg利用VMware虚拟机进行双机调试 - Howie - Dspace"  src="pic/img8.ph.126.net_sgeV7jHOP-q3kzc6nC9zjQ==_6597140135400243598.jpg"  alt=""  /><img title="通过Windbg利用VMware虚拟机进行双机调试 - Howie - Dspace"  src="pic/img6.ph.126.net_DfuPNPbbnNO0rbljl-2tDA==_1024568915244349406.jpg"  alt=""  /><span style="color:#333333; font-family:宋体; font-size:10pt;"  >   </span></p><p style="background: white;"  >&nbsp; &nbsp;</p><p style="background: white;"  ><span style="color:#333333; font-family:宋体; font-size:10pt;"  >5.设置WinDbg，建立桌面快捷方式，在查看属性中的目标项后添加如下运行参数。<br>将此快捷方式命名为VMWinDbg用于双机调试。 &nbsp;www.2cto.com &nbsp; </span></p><p style="background: white;"  ><span style="color:#333333; font-family:宋体; font-size:10pt;"  >C:\windbg\windbg.exe -b -k com:port=\\.\pipe\com_1,baud=115200,pipe </span></p><p style="background: white;"  ><span style="color:#333333; font-family:宋体; font-size:10pt;"  ><br><img title="通过Windbg利用VMware虚拟机进行双机调试 - Howie - Dspace"  src="pic/img3.ph.126.net__vTOmhCN6niHHoc7zDQuhw==_2801520443218703333.jpg"  alt=""  />   </span></p><p style="background: white;"  >&nbsp; &nbsp;</p><p style="background: white;"  ><span style="color:#333333; font-family:宋体; font-size:10pt;"  >完成上述步骤，基本的设置就完成了，设置符号表就不赘述了，现在只需要在虚拟机系统启动时，<br>选择启动调试程序。 </span></p><p style="background: white;"  >&nbsp; &nbsp;</p><p style="background: white;"  ><img title="通过Windbg利用VMware虚拟机进行双机调试 - Howie - Dspace"  src="pic/img7.ph.126.net_-uBBeVQ5a_oqJBDTcko8EA==_3075395595558196127.jpg"  alt=""  /><span style="color:#333333; font-family:宋体; font-size:10pt;"  ><br>&nbsp; </span></p><p style="background: white;"  ><span style="color:#333333; font-family:宋体; font-size:10pt;"  >在主机开启VMWinDbg，就能发现通过虚拟串口已经跟虚拟机系统连接上，能够进行内核调试了。 </span></p><p style="background: white;"  >&nbsp; &nbsp;</p><p style="background: white;"  ><img title="通过Windbg利用VMware虚拟机进行双机调试 - Howie - Dspace"  src="pic/img0.ph.126.net_xV4zw6IuyssBFpg6IvRVrQ==_2555511313573608980.jpg"  alt=""  /><span style="color:#333333; font-family:宋体; font-size:10pt;"  ><br>&nbsp; </span></p><p style="background: white;"  ><span style="color:#333333; font-family:宋体; font-size:10pt;"  >PS：如果还是无法调试，可以正常启动虚拟机（非调试），在设备管理器，对COM1串口进行<br>"每秒位数项"的设置，设置为115200。 </span></p><p style="background: white;"  >&nbsp; &nbsp;</p><p style="background: white;"  ><img title="通过Windbg利用VMware虚拟机进行双机调试 - Howie - Dspace"  src="pic/img7.ph.126.net_UR6N7T6AvkcwgUbSM6_DgA==_3063573646536163767.jpg"  alt=""  /></p>
</body></html>