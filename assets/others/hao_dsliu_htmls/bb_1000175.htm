<html><head><meta http-equiv="Content-Type" content="text/html; charset=utf8"><title>163 blogs的博客：[原]PKCS#15 - Overview</title>
<style type="text/css">
a{color: #000000;text-decoration : none;font-size: 10pt;}
a:hover {color: red;text-decoration : underline;}
.replyBox{padding:4px;border:1px solid #D8D8D8;}
</style></head><body><h2>[原]PKCS#15 - Overview</h2>
<p align="right">发布时间：2011-12-12 18:05
<br>分类名称：PKI</p><br>
<p><span style="font-size:14pt;"  ><strong>PKCS15 Objects Hierarchy<br>    </strong></span></p><p style="text-align: center;"  ><img title="[原]PKCS15 - Overview - Dsliu - Dspace"  src="pic/img0.ph.126.net_4U3t-gWDVBtvIuPf7-zvbA==_2679923253279291200.jpg"  alt=""  >  </p><p style="text-align: center;"  ><strong>PKCS #15 Object hierarchy </strong></p><p> &nbsp;</p><p><span style="font-size:14pt;"  ><strong>Card file structure </strong></span></p><p style="text-align: center;"  ><img title="[原]PKCS15 - Overview - Dsliu - Dspace"  src="pic/img1.ph.126.net_ZCBs2kqkeI-0HhL1OgrUIg==_2679923253279291201.jpg"  alt=""  >  </p><p style="text-align: center;"  ><strong>Typical PKCS15 Card Layout </strong></p><p> &nbsp;</p><p style="text-align: center;"  ><img title="[原]PKCS15 - Overview - Dsliu - Dspace"  src="pic/img9.ph.126.net_KsFncYIY93eiGfR0335prg==_67272519450987589.jpg"  alt=""  >  </p><p style="text-align: center;"  ><strong>Contents of DF(PKCS15) (Example) </strong></p><p><span style="font-size:12pt;"  ><strong>MF下面的EF(DIR) </strong></span></p><p>如果有EF(DIR)的话，其中包含一个或者多个应用程序模板（Application templates），至少包含两项内容：</p><p>1. Application Identifier(tag '4F'H)<br></p><p>2. Path(tag '51'H)</p><p><br> </p><p style="margin-left: 22pt;"  >  </p>  <p><span lang="EN-GB"  >DIRRecord ::= [APPLICATION 1] SEQUENCE {</span></p>  <p><span lang="SV"  >aid<span style="mso-spacerun:yes;"  >&nbsp; </span><span style="mso-tab-count:1;"  >&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>[APPLICATION 15] OCTET STRING,</span></p>  <p><span lang="SV"  >label <span style="mso-tab-count:1;"  >&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>[APPLICATION 16] UTF8String OPTIONAL,</span></p>  <p><span lang="SV"  >path <span style="mso-tab-count:1;"  >&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>[APPLICATION 17] OCTET STRING,</span></p>  <p><span lang="SV"  >ddo<span style="mso-spacerun:yes;"  >&nbsp; </span><span style="mso-tab-count:1;"  >&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>[APPLICATION 19] DDO OPTIONAL</span></p>  <p><span lang="SV"  >}</span></p>  <p><strong>为何要使用这个EF呢？</strong></p><p><strong>1. 卡上可能有多个DF，相当于一个索引。</strong></p><p><strong>2. </strong><font size="2"  ><span style="font-size:12.0pt;mso-bidi-font-size: 10.0pt;font-family:"Times New Roman","serif";mso-fareast-font-family:宋体; mso-fareast-theme-font:minor-fareast;mso-ansi-language:EN-US;mso-fareast-language: ZH-CN;mso-bidi-language:AR-SA;"  lang="EN-US"  >This provides a way for issuers to use non-standard file identifiers for these files without sacrificing interoperability. It also provides card issuers with the opportunity to share TokenInfo files between PKCS #15 applications, when several PKCS #15 applications reside on one card. </span></font></p><p> &nbsp;</p><p>下面看看DF(PKCS15)里面的内容： </p><p><strong>EF(ODF) </strong></p><p>它算是个总目录，指向其余的EFs（PrKDFs, PuKDFs, SKDFs, CDFs, DODFs and AODFs）。指向的这些文件又是一些目录（算是二级目录）。 </p><p style="text-align: center;"  ><img title="[原]PKCS15 - Overview - Dsliu - Dspace"  src="pic/img6.ph.126.net_p7N0PCaGxo4PtCnUV0QYiQ==_67272519450987596.jpg"  alt=""  >  </p><p> &nbsp;</p><p><strong>Private Key Directory Files(PrKDFs) </strong></p><p>这个目录文件可以有多个，至少得有一个（通常情况的话，也就是一个）。They contain general key attributes such as labels, intended usage, identifiers, etc. When applicable, they also contain cross-reference pointers to authentication objects used to protect access to the keys. Furthermore, they contain pointers to the keys themselves. </p><p style="text-align: center;"  ><img title="[原]PKCS15 - Overview - Dsliu - Dspace"  src="pic/img7.ph.126.net_yYNu17uutK83G6Z0QIiuzg==_2679923253279291217.jpg"  alt=""  >  </p><p> &nbsp;</p><p><strong>Public Key Directory Files(PuKDFs) </strong></p><p>和PrKDFs类似，要说明的是，公钥和私钥需要共享同一个identifier。通过<strong>EF(ODF)</strong>这张图，可以看到PrKDFs和PuKDFs有一条虚线。还有，如果此公钥还有对应的一个证书，那么对应的证书也要共享此id。图中也有虚线。They contain general key attributes such as labels, intended usage, identifiers, etc. Furthermore, they contain pointers to the keys themselves. </p><p style="text-align: center;"  ><img title="[原]PKCS15 - Overview - Dsliu - Dspace"  src="pic/img9.ph.126.net_XsTGyG7Dy6ROqcQgdz5jjg==_43628621407286359.jpg"  alt=""  >  </p><p> &nbsp;</p><p><strong>Secret Key Directory Files(SKDFs) </strong></p><p>这个目录文件可以有多个，至少得有一个（通常情况的话，也就是一个）。They contain general key attributes such as labels, intended usage, identifiers, etc. When applicable, they also contain cross-reference pointers to authentication objects used to protect access to the keys. Furthermore, they contain pointers to the keys themselves. </p><p style="text-align: center;"  ><img title="[原]PKCS15 - Overview - Dsliu - Dspace"  src="pic/img4.ph.126.net_bUWAiRkBnhCg_R99BCjpjQ==_1011339591338522364.jpg"  alt=""  >  </p><p> &nbsp;</p><p><strong>Certificate Directory Files (CDFs) </strong></p><p>这个目录文件可以有多个，至少得有一个（通常情况的话，有一个或者是俩个）。原话这么说的：They contain general certificate attributes such as labels, identifiers, etc. When a certificate contains a public key whose private key also resides on the card, the certificate and the private key must share the same identifier. Furthermore, certificate directory files contain pointers to the certificates themselves.There can be any number of CDFs in a PKCS #15 DF, but it is anticipated that in the normal case there will only be one or two <strong>(one for trusted certificates and one which the cardholder may update)</strong>. </p><p> &nbsp;</p><p style="text-align: center;"  ><img title="[原]PKCS15 - Overview - Dsliu - Dspace"  src="pic/img2.ph.126.net_b4T8ke0t-NQt_nXhC35aWg==_1011339591338522372.jpg"  alt=""  >  </p><p> &nbsp;</p><p><strong>Data Object Directory Files (DODFs) </strong></p><p>这个目录文件可以有多个，至少得有一个（通常情况的话，也就是一个）。They contain general data object attributes such as identifiers of the application to which the data object belongs, whether it is a private or public object, etc. Furthermore, they contain pointers to the data objects themselves. </p><p style="text-align: center;"  ><img title="[原]PKCS15 - Overview - Dsliu - Dspace"  src="pic/img7.ph.126.net_XAc5TfdE2vOG5uCcPfRmsQ==_67272519450987607.jpg"  alt=""  >  </p><p> &nbsp;</p><p><strong>Authentication Object Directory Files (AODFs) </strong></p><p>There can be any number of AODFs in a PKCS #15 DF, but it is anticipated that in most cases there will only be one or two. They contain generic authentication object attributes such as (in the case of PINs) allowed characters, PIN length, PIN padding character, etc. Furthermore, they contain pointers to the authentication objects themselves (e.g. in the case of PINs, pointers to the DF in which the PIN file resides). </p><p style="text-align: center;"  ><img title="[原]PKCS15 - Overview - Dsliu - Dspace"  src="pic/img7.ph.126.net_uZLQ1f35ebqmqSorc_4HMQ==_2679923253279291267.jpg"  alt=""  >  </p><p><strong>EF(TokenInfo) </strong></p><p>The mandatory TokenInfo elementary file with <strong>transparent structure</strong> shall contain generic information about the card as such and it's capabilities, as seen by the PKCS15 application. This information includes the card serial number, supported file types, algorithms implemented on the card, etc.  </p><p> &nbsp;</p><p><strong>EF(UnusedSpace) </strong></p><p>The optional UnusedSpace elementary file with <strong>transparent structure</strong> is used to <strong>keep track of unused space</strong> in already created elementary files. When present, it must initially contain at least one record pointing to an empty space in a file that is possible to update by the cardholder.  </p><p> &nbsp;</p><p><strong>Other elementary files in the PKCS #15 directory </strong></p><p>These (optional) files will contain the actual values of objects (such as private keys, public keys, secret keys, certificates and application specific data) referenced from within PrKDFs, SKDFs, PuKDFs, CDFs or DODFs. </p><p> &nbsp;</p><p><strong>File identifiers </strong></p><p>The following file identifiers are defined for the PKCS15 files. Note that the RID (see ISO/IEC 7816-5) is A0 00 00 00 63. </p><div style="margin-left: 32pt;"  ><table style="border-collapse:collapse;"  border="0"  ><colgroup><col style="width:114px;"  ><col style="width:42px;"  ><col style="width:402px;"  ><tbody valign="top"  ><tr style="height: 18px;"  ><td style="padding-left: 7px; padding-right: 7px; border-top:  solid 0.5pt; border-left:  solid 0.5pt; border-bottom:  solid 0.5pt; border-right:  solid 0.5pt;"  ><p><strong>File</strong></p></td><td style="padding-left: 7px; padding-right: 7px; border-top:  solid 0.5pt; border-left:  none; border-bottom:  solid 0.5pt; border-right:  solid 0.5pt;"  ><p style="text-align: justify;"  ><strong>DF</strong></p></td><td style="padding-left: 7px; padding-right: 7px; border-top:  solid 0.5pt; border-left:  none; border-bottom:  solid 0.5pt; border-right:  solid 0.5pt;"  ><p style="text-align: justify;"  ><strong>File Identifier (relative to nearest DF)</strong></p></td></tr><tr><td style="padding-left: 7px; padding-right: 7px; border-top:  none; border-left:  solid 0.5pt; border-bottom:  solid 0.5pt; border-right:  solid 0.5pt;"  ><p>MF</p></td><td style="padding-left: 7px; padding-right: 7px; border-top:  none; border-left:  none; border-bottom:  solid 0.5pt; border-right:  solid 0.5pt;"  ><p style="text-align: justify;"  >X</p></td><td style="padding-left: 7px; padding-right: 7px; border-top:  none; border-left:  none; border-bottom:  solid 0.5pt; border-right:  solid 0.5pt;"  ><p style="text-align: justify;"  >3F00<sub>16</sub> (ISO/IEC 7816-4)</p></td></tr><tr><td style="padding-left: 7px; padding-right: 7px; border-top:  none; border-left:  solid 0.5pt; border-bottom:  solid 0.5pt; border-right:  solid 0.5pt;"  ><p>DIR</p></td><td style="padding-left: 7px; padding-right: 7px; border-top:  none; border-left:  none; border-bottom:  solid 0.5pt; border-right:  solid 0.5pt;"  >&nbsp;</td><td style="padding-left: 7px; padding-right: 7px; border-top:  none; border-left:  none; border-bottom:  solid 0.5pt; border-right:  solid 0.5pt;"  ><p style="text-align: justify;"  ><span style="font-family:Times New Roman; font-size:12pt;"  >2F00<sub>16</sub> (ISO/IEC 7816-4)</span></p></td></tr><tr><td style="padding-left: 7px; padding-right: 7px; border-top:  none; border-left:  solid 0.5pt; border-bottom:  solid 0.5pt; border-right:  solid 0.5pt;"  ><p>PKCS15</p></td><td style="padding-left: 7px; padding-right: 7px; border-top:  none; border-left:  none; border-bottom:  solid 0.5pt; border-right:  solid 0.5pt;"  ><p style="text-align: justify;"  >X</p></td><td style="padding-left: 7px; padding-right: 7px; border-top:  none; border-left:  none; border-bottom:  solid 0.5pt; border-right:  solid 0.5pt;"  ><p style="text-align: justify;"  >Decided by application issuer (AID is RID || "PKCS-15")</p></td></tr><tr><td style="padding-left: 7px; padding-right: 7px; border-top:  none; border-left:  solid 0.5pt; border-bottom:  solid 0.5pt; border-right:  solid 0.5pt;"  ><p>ODF</p></td><td style="padding-left: 7px; padding-right: 7px; border-top:  none; border-left:  none; border-bottom:  solid 0.5pt; border-right:  solid 0.5pt;"  >&nbsp;</td><td style="padding-left: 7px; padding-right: 7px; border-top:  none; border-left:  none; border-bottom:  solid 0.5pt; border-right:  solid 0.5pt;"  ><p style="text-align: justify;"  >5031<sub>16</sub> by default (but see also Section 6.4.1)</p></td></tr><tr><td style="padding-left: 7px; padding-right: 7px; border-top:  none; border-left:  solid 0.5pt; border-bottom:  solid 0.5pt; border-right:  solid 0.5pt;"  ><p>TokenInfo</p></td><td style="padding-left: 7px; padding-right: 7px; border-top:  none; border-left:  none; border-bottom:  solid 0.5pt; border-right:  solid 0.5pt;"  >&nbsp;</td><td style="padding-left: 7px; padding-right: 7px; border-top:  none; border-left:  none; border-bottom:  solid 0.5pt; border-right:  solid 0.5pt;"  ><p style="text-align: justify;"  >5032<sub>16</sub> by default (but see also Section 6.4.1)</p></td></tr><tr><td style="padding-left: 7px; padding-right: 7px; border-top:  none; border-left:  solid 0.5pt; border-bottom:  solid 0.5pt; border-right:  solid 0.5pt;"  ><p>UnusedSpace</p></td><td style="padding-left: 7px; padding-right: 7px; border-top:  none; border-left:  none; border-bottom:  solid 0.5pt; border-right:  solid 0.5pt;"  >&nbsp;</td><td style="padding-left: 7px; padding-right: 7px; border-top:  none; border-left:  none; border-bottom:  solid 0.5pt; border-right:  solid 0.5pt;"  ><p style="text-align: justify;"  >5033<sub>16</sub> by default (but see also Section 6.4.1)</p></td></tr><tr><td style="padding-left: 7px; padding-right: 7px; border-top:  none; border-left:  solid 0.5pt; border-bottom:  solid 0.5pt; border-right:  solid 0.5pt;"  ><p>AODFs</p></td><td style="padding-left: 7px; padding-right: 7px; border-top:  none; border-left:  none; border-bottom:  solid 0.5pt; border-right:  solid 0.5pt;"  >&nbsp;</td><td style="padding-left: 7px; padding-right: 7px; border-top:  none; border-left:  none; border-bottom:  solid 0.5pt; border-right:  solid 0.5pt;"  ><p style="text-align: justify;"  >Decided by application issuer</p></td></tr><tr><td style="padding-left: 7px; padding-right: 7px; border-top:  none; border-left:  solid 0.5pt; border-bottom:  solid 0.5pt; border-right:  solid 0.5pt;"  ><p>PrKDFs</p></td><td style="padding-left: 7px; padding-right: 7px; border-top:  none; border-left:  none; border-bottom:  solid 0.5pt; border-right:  solid 0.5pt;"  >&nbsp;</td><td style="padding-left: 7px; padding-right: 7px; border-top:  none; border-left:  none; border-bottom:  solid 0.5pt; border-right:  solid 0.5pt;"  ><p style="text-align: justify;"  >Decided by application issuer</p></td></tr><tr><td style="padding-left: 7px; padding-right: 7px; border-top:  none; border-left:  solid 0.5pt; border-bottom:  solid 0.5pt; border-right:  solid 0.5pt;"  ><p>PuKDFs</p></td><td style="padding-left: 7px; padding-right: 7px; border-top:  none; border-left:  none; border-bottom:  solid 0.5pt; border-right:  solid 0.5pt;"  >&nbsp;</td><td style="padding-left: 7px; padding-right: 7px; border-top:  none; border-left:  none; border-bottom:  solid 0.5pt; border-right:  solid 0.5pt;"  ><p style="text-align: justify;"  >Decided by application issuer</p></td></tr><tr><td style="padding-left: 7px; padding-right: 7px; border-top:  none; border-left:  solid 0.5pt; border-bottom:  solid 0.5pt; border-right:  solid 0.5pt;"  ><p>SKDFs</p></td><td style="padding-left: 7px; padding-right: 7px; border-top:  none; border-left:  none; border-bottom:  solid 0.5pt; border-right:  solid 0.5pt;"  >&nbsp;</td><td style="padding-left: 7px; padding-right: 7px; border-top:  none; border-left:  none; border-bottom:  solid 0.5pt; border-right:  solid 0.5pt;"  ><p style="text-align: justify;"  >Decided by application issuer</p></td></tr><tr><td style="padding-left: 7px; padding-right: 7px; border-top:  none; border-left:  solid 0.5pt; border-bottom:  solid 0.5pt; border-right:  solid 0.5pt;"  ><p>CDFs</p></td><td style="padding-left: 7px; padding-right: 7px; border-top:  none; border-left:  none; border-bottom:  solid 0.5pt; border-right:  solid 0.5pt;"  >&nbsp;</td><td style="padding-left: 7px; padding-right: 7px; border-top:  none; border-left:  none; border-bottom:  solid 0.5pt; border-right:  solid 0.5pt;"  ><p style="text-align: justify;"  >Decided by application issuer</p></td></tr><tr><td style="padding-left: 7px; padding-right: 7px; border-top:  none; border-left:  solid 0.5pt; border-bottom:  solid 0.5pt; border-right:  solid 0.5pt;"  ><p>DODFs</p></td><td style="padding-left: 7px; padding-right: 7px; border-top:  none; border-left:  none; border-bottom:  solid 0.5pt; border-right:  solid 0.5pt;"  >&nbsp;</td><td style="padding-left: 7px; padding-right: 7px; border-top:  none; border-left:  none; border-bottom:  solid 0.5pt; border-right:  solid 0.5pt;"  ><p style="text-align: justify;"  >Decided by application issuer</p></td></tr><tr><td style="padding-left: 7px; padding-right: 7px; border-top:  none; border-left:  solid 0.5pt; border-bottom:  solid 0.5pt; border-right:  solid 0.5pt;"  ><p>Other EFs</p></td><td style="padding-left: 7px; padding-right: 7px; border-top:  none; border-left:  none; border-bottom:  solid 0.5pt; border-right:  solid 0.5pt;"  >&nbsp;</td><td style="padding-left: 7px; padding-right: 7px; border-top:  none; border-left:  none; border-bottom:  solid 0.5pt; border-right:  solid 0.5pt;"  ><p style="text-align: justify;"  >Decided by application issuer</p></td></tr><tr><td style="padding-left: 7px; padding-right: 7px; border-top:  none; border-left:  solid 0.5pt; border-bottom:  solid 0.5pt; border-right:  solid 0.5pt;"  ><p>- (Reserved)</p></td><td style="padding-left: 7px; padding-right: 7px; border-top:  none; border-left:  none; border-bottom:  solid 0.5pt; border-right:  solid 0.5pt;"  >&nbsp;</td><td style="padding-left: 7px; padding-right: 7px; border-top:  none; border-left:  none; border-bottom:  solid 0.5pt; border-right:  solid 0.5pt;"  ><p style="text-align: justify;"  >5034<sub>16</sub> - 5100<sub>16</sub> (Reserved for future use)</p></td></tr></table></div><p> &nbsp;</p>
</body></html>