<html><head><meta http-equiv="Content-Type" content="text/html; charset=utf8"><title>163 blogs的博客：【转】VC++ warning C4786 详解</title>
<style type="text/css">
a{color: #000000;text-decoration : none;font-size: 10pt;}
a:hover {color: red;text-decoration : underline;}
.replyBox{padding:4px;border:1px solid #D8D8D8;}
</style></head><body><h2>【转】VC++ warning C4786 详解</h2>
<p align="right">发布时间：2011-11-25 14:15
<br>分类名称：C++</p><br>
<div id="article_content"  >     <span><font style="FONT-SIZE: 12pt;"  size="2"  >出自：http://blog.csdn.net/alvin969/article/details/3177100<br><br>在使用std::vector的过程中，编译器报了如下的warning：</font></span>  <div><span></span>&nbsp;</div> <div><font size="2"  ><em>c:/program files/vc98/include/vector(61) : warning C4786: <font color="#000000"  >'??0?$vector@V?$basic_string@DU?$char_traits@D@std@@V?$allocator@D@2@@std@@V?$allocator@V?$basic_string@DU?$char_traits@D@std@@V?$allocator@D@2@@std@@@2@@std@@QAE@PBV?$basic_string@DU?$char_t</font><br><font color="#000000"  >raits@D@std@@V?$allocator@D@2@@1@0ABV?$allocator@V?$basic_string@DU?$char_traits@D@std@@V?$allocator@D@2@@std@@@1@@Z</font> : identifier was truncated to '255' characters in the browser information<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  d:/rtd/ruleloader/treenode.h(15) : see reference to class template  instantiation 'std::vector&lt;class std::basic_string&lt;char,struct  std::char_traits&lt;char&gt;,class std::allocator&lt;char&gt; &gt;,class  std::allocator&lt;class std::basic_string&lt;char,struct st<br>d::char_traits&lt;char&gt;,class std::allocator&lt;char&gt; &gt; &gt; &gt;' being compiled</em></font></div> <div>&nbsp;</div> <div><font style="FONT-SIZE: 12pt;"  size="2"  >此warning产生的原因是因为标识符过长，超过了最大限定<span>255个字。例如：</span></font></div> <div><font size="2"  ><span><em>#define a_really_long_class_name a_really_really_really_really_really_really_really_ / </em></span></font></div> <div><font size="2"  ><span><em>really_really_really_really_really_really_really_really_really_really_really_really_ / </em></span></font></div> <div><font size="2"  ><span><em>really_really_really_really_really_really_really_really_really_really_really_really_really_really_really</em></span></font></div> <div><font size="2"  ><span><em></em></span></font>&nbsp;</div> <div><font size="2"  ><span><em>&nbsp;class a_really_long_class_name<br>{<br>public:<br>&nbsp;&nbsp; a_really_long_class_name() {};<br>&nbsp;&nbsp; int m_data;<br>};<br>void main()<br>{<br>&nbsp;&nbsp;&nbsp; a_really_long_class_name test_obj;<br>&nbsp;&nbsp;&nbsp; test_obj.m_data = 12;<br>}<br></em></span></font></div> <div><font size="2"  ><span style="FONT-SIZE: 12pt;"  >类名超过了255个字，使用时就会报4786的waring。在使用STL（C++标准模板库）的时候经常引发类似的错误，尤其是vector，map这类模板类，模板中套模板，一不小心就超长了。例如：</span></font></div> <div><font size="2"  ><span></span></font>&nbsp;</div> <div><font size="2"  ><span><em>template &lt;class A1, class A2, class A3, class A4&gt;<br>class VeryLongClassNameA{};<br><br>template &lt;class B1, class B2, class B3&gt;<br>class VeryLongClassNameB{};<br><br>template &lt;class C1, class C2&gt;<br>class VeryLongClassNameC{};<br><br>template &lt;class D1&gt;<br>class VeryLongClassNameD{};<br><br>class SomeRandomClass{};<br><br>typedef VeryLongClassNameD&lt;SomeRandomClass&gt; ClassD ;<br>typedef VeryLongClassNameC&lt;SomeRandomClass, ClassD&gt; ClassC;<br>typedef VeryLongClassNameB&lt;SomeRandomClass, ClassC, ClassD&gt; ClassB;<br>typedef VeryLongClassNameA&lt;SomeRandomClass, ClassB, ClassC, ClassD&gt; ClassA;<br><br>void SomeRandomFunction(ClassA aobj){}<br><br>void main()<br>{<br>&nbsp;&nbsp; ClassA AObj ;<br>&nbsp;&nbsp; SomeRandomFunction(AObj) ;<br>}</em></span></font></div> <div><font size="2"  ><span><em></em></span></font>&nbsp;</div> <div><font size="2"  ><span style="FONT-SIZE: 12pt;"  >解决方法有两种，一种是直接定义别名：</span></font></div> <div><font size="2"  ><span style="FONT-SIZE: 10pt;"  ><em>#ifdef _DEBUG<br>#define VeryLongClassNameA A<br>#define VeryLongClassNameB B<br>#endif</em></span></font></div> <div><font size="2"  ><span style="FONT-SIZE: 12pt;"  ><br>另一种是屏蔽4786warning：</span></font></div> <div><font size="2"  ><span><em>#pragma warning(disable : 4786)</em></span></font></div> <div><font size="2"  ><span><em></em></span></font>&nbsp;</div> <div><font size="2"  ><span style="FONT-SIZE: 12pt;"  >注意屏蔽语句必须放在报错的模板类的引用声明（如#include &lt;vector&gt;）之前，否则还是不起作用。</span></font></div> </div>
</body></html>