<html><head><meta http-equiv="Content-Type" content="text/html; charset=utf8"><title>163 blogs的博客：使用vc6进行远程调试csp</title>
<style type="text/css">
a{color: #000000;text-decoration : none;font-size: 10pt;}
a:hover {color: red;text-decoration : underline;}
.replyBox{padding:4px;border:1px solid #D8D8D8;}
</style></head><body><h2>使用vc6进行远程调试csp</h2>
<p align="right">发布时间：2010-2-12 12:01
<br>分类名称：Private</p><br>
<p>  最近在查错，因涉及到不同平台，所以需要在虚拟机里调试程序，但总不能在每一个虚拟机里安装vc及拷贝编译代码，工作量太大了。另外有时候测试部能够复现  的bug,在研发部无法复测。这两种情况搞得人很头疼。  </p>    <p>  其实对VC进行程序调试时，除了常规的单机调试方式外,   也可以双机调试，即一台计算机作为主机，显示调试器窗口，而另一台计算机作为客户机，显示被调试程序的输出值。在VC里称这种方式为远程调试，但这种调试  方法与常规方法有少许不同，需要进行必要的设置,下面以调试csp代码举例说明.  </p>    <p>  环境: 调试机器(以下称client)WinXP cn+vc6 被调试机器(以下称server)WinME 运行于VMWare中  </p>    <p>  步骤:  </p>    <p>  1.从<a title="ftservervm" target="_blank" rel="nofollow" href="/file://///ftserver/vm"    >\\ftserver\vm</a>中下载winme_cn.rar  </p>    <p>  2.配置VMWare的网络模式为NAT模式  </p>    <p>  3.配置服务器IP地址获取方式为DHCP  </p>    <p>  <a target="_blank" href="pic/img616.ph.126.net_hx6CJMJmlFLTvbP1V7bZNg==_1992279885159431856.jpg"    ><img title="使用vc6进行远程调试csp - Dsliu - Dspace"    alt="使用vc6进行远程调试csp - Dsliu - Dspace"    src="pic/img616.ph.126.net_hx6CJMJmlFLTvbP1V7bZNg==_1992279885159431856.jpg"    ></a>  </p>    <p>  4.在服务器上安装ePass1000nd  </p>    <p>  5.从client端的Microsoft Visual   Studio\Common\MSDev98\Bin中拷贝tlnot.dll,msdis110.dll,dm.dll,msvcmon.exe到  server上  </p>    <p>  <a target="_blank" href="pic/img238.ph.126.net_Doo0hjSvnt49UxLQQ8Cf_Q==_2229000340573111275.jpg"    ><img title="使用vc6进行远程调试csp - Dsliu - Dspace"    alt="使用vc6进行远程调试csp - Dsliu - Dspace"    src="pic/img238.ph.126.net_Doo0hjSvnt49UxLQQ8Cf_Q==_2229000340573111275.jpg"    ></a>  </p>    <p>  6.使用在client机器上编译好的待调试动态库替换server上系统安装目录下的文件  </p>    <p>  <a target="_blank" href="pic/img851.ph.126.net_43wz8KldYXllQXFiBzn3SQ==_2719892699955864445.jpg"    ><img title="使用vc6进行远程调试csp - Dsliu - Dspace"    alt="使用vc6进行远程调试csp - Dsliu - Dspace"    src="pic/img851.ph.126.net_43wz8KldYXllQXFiBzn3SQ==_2719892699955864445.jpg"    ></a>  </p>    <p>  7.在server上启动msvcmon.exe,点击setting按钮,设置ip为调试器所在机器的ip(client的ip),然后点击  connect  </p>    <p>  <a target="_blank" href="pic/img246.ph.126.net_B14zJlWPAu_mxGQlqo9obg==_2233222465223399099.jpg"    ><img title="使用vc6进行远程调试csp - Dsliu - Dspace"    alt="使用vc6进行远程调试csp - Dsliu - Dspace"    src="pic/img246.ph.126.net_B14zJlWPAu_mxGQlqo9obg==_2233222465223399099.jpg"    ></a>  </p>    <p>  8.在client启动VC6打开工程  </p>    <p>  9.在vc6中点击菜单build&gt;debugger remote   connection…出现对话框,选择network(tcp/ip),然后点击设置,在对话框中设置server机器(待调试机器)的ip  </p>    <p>  <a target="_blank" href="pic/img169.ph.126.net_C3n0-NUqdTp02FYf1oZ6nw==_2163416670999433197.jpg"    ><img title="使用vc6进行远程调试csp - Dsliu - Dspace"    alt="使用vc6进行远程调试csp - Dsliu - Dspace"    src="pic/img169.ph.126.net_C3n0-NUqdTp02FYf1oZ6nw==_2163416670999433197.jpg"    ></a>  </p>    <p>  10.在vc的工程属性的debug&gt;general选项里面设置本地和远程可执行程序路径  </p>    <p>  <a target="_blank" href="pic/img845.ph.126.net_JHwdP08bsgoGV2MFhkLwJA==_903816150219541733.jpg"    ><img title="使用vc6进行远程调试csp - Dsliu - Dspace"    alt="使用vc6进行远程调试csp - Dsliu - Dspace"    src="pic/img845.ph.126.net_JHwdP08bsgoGV2MFhkLwJA==_903816150219541733.jpg"    ></a>  </p>    <p>  11.将编译好的待调试dll拷贝到client机器的相应位置(我这里是windows/system32/ngcsp.dat等)  </p>    <p>  12.在vc的工程属性的debug&gt;debug   dlls里面设置本地dll与远程待调试dll的关联(重要,设置错误的话无法导入调试符号,无法打断点)  </p><a target="_blank" href="pic/img154.ph.126.net_zO_7o6ElDCVF0ssyJaqjMg==_2272066012009814051.jpg"    ><img title="使用vc6进行远程调试csp - Dsliu - Dspace"    alt="使用vc6进行远程调试csp - Dsliu - Dspace"    src="pic/img154.ph.126.net_zO_7o6ElDCVF0ssyJaqjMg==_2272066012009814051.jpg"    ></a><p>  13.代码中打断点然后vc中F5 go…………  </p>    <p>  14.yeah,断下了  </p>    <p>  <a target="_blank" href="pic/img128.ph.126.net_yw31RHPv75mFn1RNTp5XrQ==_1619888490971387970.jpg"    ><img title="使用vc6进行远程调试csp - Dsliu - Dspace"    alt="使用vc6进行远程调试csp - Dsliu - Dspace"    src="pic/img128.ph.126.net_yw31RHPv75mFn1RNTp5XrQ==_1619888490971387970.jpg"    ></a>  </p>    <p>  15.看到vmware中ie停止了  </p>    <p>  <a target="_blank" href="pic/img242.ph.126.net_ZGCwNq7Tue2C3pliMfGAwA==_2131047048677684217.jpg"    ><img title="使用vc6进行远程调试csp - Dsliu - Dspace"    alt="使用vc6进行远程调试csp - Dsliu - Dspace"    src="pic/img242.ph.126.net_ZGCwNq7Tue2C3pliMfGAwA==_2131047048677684217.jpg"    ></a>  </p>    <p>   另外在XP或VISTA系统上需要做额外工作：  </p>    <p>  关闭防火墙  </p>    <p>  本地安全策略中〉网络访问：本地帐户的共享和安全模式改为“经典：本地用户以自己的帐户登陆”  </p>    <p>  调试机器和被调试机器最好使用相同的帐户和密码  </p>    <p>  创建文本文件包含以下内容（注意没有这一步不能单步调试）：  </p>  <pre>REGEDIT4<br><br>[HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows NT\CurrentVersion\DebugObjectRPCEnabled]<br></pre>    <p>  如果是98系列把Windows NT改为Windows  </p>    <p>  改名为something.reg,双击运行  </p>    <p>  over  </p>
</body></html>