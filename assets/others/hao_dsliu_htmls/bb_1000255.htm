<html><head><meta http-equiv="Content-Type" content="text/html; charset=utf8"><title>163 blogs的博客：PKI Elements (MSDN)</title>
<style type="text/css">
a{color: #000000;text-decoration : none;font-size: 10pt;}
a:hover {color: red;text-decoration : underline;}
.replyBox{padding:4px;border:1px solid #D8D8D8;}
</style></head><body><h2>PKI Elements (MSDN)</h2>
<p align="right">发布时间：2011-2-28 15:42
<br>分类名称：PKI</p><br>
<span style="font-size:11.0pt;mso-bidi-font-size:9.5pt;"  Segoe UIsans-serif mso-fareast-font-familycolorblackmso-font-kerningpt  lang="EN-US"   >A typical Microsoft public key infrastructure (PKI) includes the following elements.</span>    <table class="MsoNormalTable"   style="width:100.0%;border-collapse:collapse;border:none;mso-border-alt:solid #BBBBBB .75pt;  mso-yfti-tbllook:1184;"   border="1"   cellpadding="0"   cellspacing="0"   width="100%"   >  <tbody><tr style="mso-yfti-irow:0;mso-yfti-firstrow:yes;height:15.75pt;"   >   <td style="width:20.08%;border:solid #BBBBBB 1.0pt;   mso-border-alt:solid #BBBBBB .75pt;background:#E5E5E5;padding:3.0pt 3.0pt 3.0pt 3.0pt;   height:15.75pt;"   valign="top"   width="20%"   >   <p style="text-align:left;mso-pagination:widow-orphan;"   align="left"   ><span style="font-size:14.0pt;mso-bidi-font-size:10.5pt;font-family:   ;"  Segoe UIsans-serifmso-fareast-font-familycolorblackmso-font-kerning   pt  lang="EN-US"   >Element</span></p>   </td>   <td style="width:79.92%;border:solid #BBBBBB 1.0pt;   border-left:none;mso-border-left-alt:solid #BBBBBB .75pt;mso-border-alt:solid #BBBBBB .75pt;   background:#E5E5E5;padding:3.0pt 3.0pt 3.0pt 3.0pt;height:15.75pt;"   valign="top"   width="79%"   >   <p style="text-align:left;mso-pagination:widow-orphan;"   align="left"   ><span style="font-size:14.0pt;mso-bidi-font-size:10.5pt;font-family:   ;"  Segoe UIsans-serifmso-fareast-font-familycolorblackmso-font-kerning   pt  lang="EN-US"   >Description</span></p>   </td>  </tr>  <tr style="mso-yfti-irow:1;"   >   <td style="width:20.08%;border:solid #BBBBBB 1.0pt;   border-top:none;mso-border-top-alt:solid #BBBBBB .75pt;mso-border-alt:solid #BBBBBB .75pt;   background:white;padding:3.0pt 3.0pt 3.0pt 3.0pt;"   valign="top"   width="20%"   >   <p class="MsoNormal"   style="mso-margin-top-alt:auto;margin-right:   .75pt;mso-margin-bottom-alt:auto;margin-left:.75pt;text-align:left;   line-height:140%;mso-pagination:widow-orphan;"   align="left"   ><b style="mso-bidi-font-weight:   normal;"   ><span style="font-size:11.0pt;mso-bidi-font-size:9.5pt;   line-height:140%;font-family:宋体;mso-bidi-font-family:宋体;color:#1364C4;   mso-font-kerning:0pt;"   lang="EN-US"   >Certification Authorities</span></b><b style="mso-bidi-font-weight:normal;"   ><span style="font-size:11.0pt;   mso-bidi-font-size:9.5pt;line-height:140%;"  Segoe UIsans-serif   mso-fareast-font-familycolorblackmso-font-kerningpt  lang="EN-US"   ></span></b></p>   </td>   <td style="width:79.92%;border-top:none;border-left:   none;border-bottom:solid #BBBBBB 1.0pt;border-right:solid #BBBBBB 1.0pt;   mso-border-top-alt:solid #BBBBBB .75pt;mso-border-left-alt:solid #BBBBBB .75pt;   mso-border-alt:solid #BBBBBB .75pt;background:white;padding:3.0pt 3.0pt 3.0pt 3.0pt;"   valign="top"   width="79%"   >   <p class="MsoNormal"   style="mso-margin-top-alt:auto;margin-right:   .75pt;mso-margin-bottom-alt:auto;margin-left:.75pt;text-align:left;   line-height:140%;mso-pagination:widow-orphan;"   align="left"   ><span style="font-size:11.0pt;mso-bidi-font-size:9.5pt;line-height:140%;font-family:   ;"  Segoe UIsans-serifmso-fareast-font-familycolorblackmso-font-kerning   pt  lang="EN-US"   >Provide services that authenticate the identity of individuals,   computers, and other entities in a network. This encompasses both root   certification authorities and subordinate authorities.</span></p>   </td>  </tr>  <tr style="mso-yfti-irow:2;"   >   <td style="width:20.08%;border:solid #BBBBBB 1.0pt;   border-top:none;mso-border-top-alt:solid #BBBBBB .75pt;mso-border-alt:solid #BBBBBB .75pt;   background:white;padding:3.0pt 3.0pt 3.0pt 3.0pt;"   valign="top"   width="20%"   >   <p class="MsoNormal"   style="mso-margin-top-alt:auto;margin-right:   .75pt;mso-margin-bottom-alt:auto;margin-left:.75pt;text-align:left;   line-height:140%;mso-pagination:widow-orphan;"   align="left"   ><b style="mso-bidi-font-weight:   normal;"   ><span style="font-size:11.0pt;mso-bidi-font-size:9.5pt;   line-height:140%;font-family:宋体;mso-bidi-font-family:宋体;color:#1364C4;   mso-font-kerning:0pt;"   lang="EN-US"   >Certificate Directory</span></b><b style="mso-bidi-font-weight:   normal;"   ><span style="font-size:11.0pt;mso-bidi-font-size:9.5pt;   line-height:140%;"  Segoe UIsans-serifmso-fareast-font-family   colorblackmso-font-kerningpt  lang="EN-US"   ></span></b></p>   </td>   <td style="width:79.92%;border-top:none;border-left:   none;border-bottom:solid #BBBBBB 1.0pt;border-right:solid #BBBBBB 1.0pt;   mso-border-top-alt:solid #BBBBBB .75pt;mso-border-left-alt:solid #BBBBBB .75pt;   mso-border-alt:solid #BBBBBB .75pt;background:white;padding:3.0pt 3.0pt 3.0pt 3.0pt;"   valign="top"   width="79%"   >   <p class="MsoNormal"   style="mso-margin-top-alt:auto;margin-right:   .75pt;mso-margin-bottom-alt:auto;margin-left:.75pt;text-align:left;   line-height:140%;mso-pagination:widow-orphan;"   align="left"   ><span style="font-size:11.0pt;mso-bidi-font-size:9.5pt;line-height:140%;font-family:   ;"  Segoe UIsans-serifmso-fareast-font-familycolorblackmso-font-kerning   pt  lang="EN-US"   >Saves certificate requests and issued and revoked certificates and   certificate requests.</span></p>   </td>  </tr>  <tr style="mso-yfti-irow:3;mso-yfti-lastrow:yes;"   >   <td style="width:20.08%;border:solid #BBBBBB 1.0pt;   border-top:none;mso-border-top-alt:solid #BBBBBB .75pt;mso-border-alt:solid #BBBBBB .75pt;   background:white;padding:3.0pt 3.0pt 3.0pt 3.0pt;"   valign="top"   width="20%"   >   <p class="MsoNormal"   style="mso-margin-top-alt:auto;margin-right:   .75pt;mso-margin-bottom-alt:auto;margin-left:.75pt;text-align:left;   line-height:140%;mso-pagination:widow-orphan;"   align="left"   ><b style="mso-bidi-font-weight:   normal;"   ><span style="font-size:11.0pt;mso-bidi-font-size:9.5pt;   line-height:140%;font-family:宋体;mso-bidi-font-family:宋体;color:#1364C4;   mso-font-kerning:0pt;"   lang="EN-US"   >Key Recovery Server</span></b><b style="mso-bidi-font-weight:   normal;"   ><span style="font-size:11.0pt;mso-bidi-font-size:9.5pt;   line-height:140%;"  Segoe UIsans-serifmso-fareast-font-family   colorblackmso-font-kerningpt  lang="EN-US"   ></span></b></p>   </td>   <td style="width:79.92%;border-top:none;border-left:   none;border-bottom:solid #BBBBBB 1.0pt;border-right:solid #BBBBBB 1.0pt;   mso-border-top-alt:solid #BBBBBB .75pt;mso-border-left-alt:solid #BBBBBB .75pt;   mso-border-alt:solid #BBBBBB .75pt;background:white;padding:3.0pt 3.0pt 3.0pt 3.0pt;"   valign="top"   width="79%"   >   <p class="MsoNormal"   style="mso-margin-top-alt:auto;margin-right:   .75pt;mso-margin-bottom-alt:auto;margin-left:.75pt;text-align:left;   line-height:140%;mso-pagination:widow-orphan;"   align="left"   ><span style="font-size:11.0pt;mso-bidi-font-size:9.5pt;line-height:140%;font-family:   ;"  Segoe UIsans-serifmso-fareast-font-familycolorblackmso-font-kerning   pt  lang="EN-US"   >Saves encrypted private keys in the certificate database for recovery   after loss.</span></p>   </td>  </tr> </table>  <p><span style="font-size:14.0pt;mso-bidi-font-size: 11.0pt;"   lang="EN-US"   >&nbsp;</span></p>  <h1 style="margin-bottom:7.5pt;"   ><span style="font-size:11.0pt; mso-bidi-font-size:17.0pt;"   lang="EN-US"   >Certification Authorities</span></h1>  <p style="margin-top:0cm;margin-right:0cm;margin-bottom:7.8pt;margin-left:0cm; mso-para-margin-top:0cm;mso-para-margin-right:0cm;mso-para-margin-bottom:.5gd; mso-para-margin-left:0cm;"   ><span style="font-size:11.0pt;mso-bidi-font-size: 9.5pt;"  Segoe UIsans-serifcolorblack  lang="EN-US"   >A </span><span lang="EN-US"   ><a rel="nofollow" href="http://msdn.microsoft.com/en-us/library/ms721572%28v=VS.85%29.aspx#_security_certification_authority_gly"   ><em><span style="font-size:11.0pt;mso-bidi-font-size:9.5pt;"  Segoe UIsans-serif colorCtext-decorationnonetext-underlinenone  >certification authority</span></em></a></span><span style="font-size:11.0pt;mso-bidi-font-size:9.5pt;"  Segoe UIsans-serif colorblack  lang="EN-US"   > (CA) is responsible for attesting to the identity of users, computers, and organizations. The CA authenticates an entity and vouches for that identity by issuing a digitally signed certificate. The CA can also manage, revoke, and renew certificates. </span></p>  <p style="margin-top:0cm;margin-right:0cm;margin-bottom:7.8pt;margin-left:0cm; mso-para-margin-top:0cm;mso-para-margin-right:0cm;mso-para-margin-bottom:.5gd; mso-para-margin-left:0cm;"   ><span style="font-size:11.0pt;mso-bidi-font-size: 9.5pt;"  Segoe UIsans-serifcolorblack  lang="EN-US"   >A CA can be public or private. A public CA provides certification services, typically for a fee, to the public over the Internet. A private CA provides this service to the members of a delimited population such as the employees of a business or members of some other private group.</span></p>  <p style="margin-top:0cm;margin-right:0cm;margin-bottom:7.8pt;margin-left:0cm; mso-para-margin-top:0cm;mso-para-margin-right:0cm;mso-para-margin-bottom:.5gd; mso-para-margin-left:0cm;"   ><span style="font-size:11.0pt;mso-bidi-font-size: 9.5pt;"  Segoe UIsans-serifcolorblack  lang="EN-US"   >The means by which a CA authenticates an end user are varied and beyond the scope of this documentation. Clearly, however, methods of authentication vary by type of provider. For example, a private CA can establish the identity of end users by referring to a group roster such as an employee database or Active Directory. The authentication methods performed by a public CA are generally more complex and depend partly on the level of assurance being promised by the certificate.</span></p>  <p style="margin-top:0cm;margin-right:0cm;margin-bottom:7.8pt;margin-left:0cm; mso-para-margin-top:0cm;mso-para-margin-right:0cm;mso-para-margin-bottom:.5gd; mso-para-margin-left:0cm;"   ><span style="font-size:11.0pt;mso-bidi-font-size: 9.5pt;"  Segoe UIsans-serifcolorblack  lang="EN-US"   >As the population of a public key infrastructure (PKI) grows, it can become difficult for a single CA to effectively manage all of the certificates it has issued. The CA can compensate by authorizing other CAs in the PKI to issue certificates. The initial CA is called the root, and the CAs it authorizes are called subordinates. Subordinate CAs can also designate their own subsidiaries within the limits set by the root. The resulting structure is called a certificate hierarchy. The certificates issued to CAs lower in the hierarchy contain enough certificates to trace a path back to the root. This is called a certificate chain.</span></p>  <p style="margin-top:0cm;margin-right:0cm;margin-bottom:7.8pt;margin-left:0cm; mso-para-margin-top:0cm;mso-para-margin-right:0cm;mso-para-margin-bottom:.5gd; mso-para-margin-left:0cm;"   ><span style="font-size:11.0pt;mso-bidi-font-size: 9.5pt;"  Segoe UIsans-serifcolorblack  lang="EN-US"   >The term certification authority can refer to both the organization that vouches for the identity of an end user and the server used by the organization to issue and manage certificates. A Windows server can be configured to act as a CA server, and this documentation usually refers to the server when using the term CA.</span></p>  <p style="margin-top:0cm;margin-right:0cm;margin-bottom:7.8pt;margin-left:0cm; mso-para-margin-top:0cm;mso-para-margin-right:0cm;mso-para-margin-bottom:.5gd; mso-para-margin-left:0cm;"   ><span style="font-size:11.0pt;mso-bidi-font-size: 9.5pt;"  Segoe UIsans-serifcolorblack  lang="EN-US"   >The Certificate Enrollment API interacts with a CA mainly by using the </span><span lang="EN-US"   ><a rel="nofollow" href="http://msdn.microsoft.com/en-us/library/aa377809%28v=VS.85%29.aspx"   ><strong><span style="font-size:11.0pt;mso-bidi-font-size:9.5pt;"  Segoe UIsans-serif colorCtext-decorationnonetext-underlinenone  >IX509Enrollment</span></strong></a></span><span style="font-size:11.0pt;mso-bidi-font-size:9.5pt;"  Segoe UIsans-serif colorblack  lang="EN-US"   > object. The </span><span lang="EN-US"   ><a rel="nofollow" href="http://msdn.microsoft.com/en-us/library/aa377871%28v=VS.85%29.aspx"   ><strong><span style="font-size:11.0pt;mso-bidi-font-size:9.5pt;"  Segoe UIsans-serif colorCtext-decorationnonetext-underlinenone  >Enroll</span></strong></a></span><span style="font-size:11.0pt;mso-bidi-font-size:9.5pt;"  Segoe UIsans-serif colorblack  lang="EN-US"   > method on this object can automatically encode a certificate request, submit it to the CA, and install the issued certificate. You can also use an initialized <strong><span style=""  Segoe UIsans-serif  >IX509Enrollment</span></strong> object for out-of-band enrollment or for delayed enrollment. In addition, you can use the </span><span lang="EN-US"   ><a rel="nofollow" href="http://msdn.microsoft.com/en-us/library/aa377818%28v=VS.85%29.aspx"   ><strong><span style="font-size:11.0pt;mso-bidi-font-size:9.5pt;"  Segoe UIsans-serif colorCtext-decorationnonetext-underlinenone  >IX509EnrollmentStatus</span></strong></a></span><span style="font-size:11.0pt;mso-bidi-font-size:9.5pt;"  Segoe UIsans-serif colorblack  lang="EN-US"   > object to monitor enrollment status.</span></p>  <p><span style="font-size:14.0pt;mso-bidi-font-size: 11.0pt;"   lang="EN-US"   >&nbsp;</span></p>  <h1 style="margin-bottom:7.5pt;"   ><span style="font-size:11.0pt; mso-bidi-font-size:17.0pt;"   lang="EN-US"   >Certificate Directory</span></h1>  <p style="margin-top:0cm;margin-right:0cm;margin-bottom:7.8pt;margin-left:0cm; mso-para-margin-top:0cm;mso-para-margin-right:0cm;mso-para-margin-bottom:.5gd; mso-para-margin-left:0cm;"   ><span style="font-size:11.0pt;mso-bidi-font-size: 9.5pt;"  Segoe UIsans-serifcolorblack  lang="EN-US"   >A Windows public key infrastructure (PKI) saves certificates on the server that hosts the certification authority (CA) and on the local computer or device. CA storage is typically referred to as the certificate database, and local storage is known as the certificate store.</span></p>  <h3 style="margin-top:0cm;margin-right:0cm;margin-bottom:7.8pt;margin-left: 0cm;mso-para-margin-top:0cm;mso-para-margin-right:0cm;mso-para-margin-bottom: .5gd;mso-para-margin-left:0cm;"   ><span style="font-size:14.0pt; mso-bidi-font-size:10.5pt;line-height:173%;"   lang="EN-US"   >Certificate Database</span><span style="font-size:14.0pt;mso-bidi-font-size:10.5pt;line-height:173%;"  Segoe UIsans-serifcolorFC  lang="EN-US"   ></span></h3>  <p style="margin-top:0cm;margin-right:0cm;margin-bottom:7.8pt;margin-left:0cm; mso-para-margin-top:0cm;mso-para-margin-right:0cm;mso-para-margin-bottom:.5gd; mso-para-margin-left:0cm;"   ><span style="font-size:11.0pt;mso-bidi-font-size: 9.5pt;"  Segoe UIsans-serifcolorblack  lang="EN-US"   >When you add Certificate Services on a Windows server and configure a CA, a certificate database is created. By default, the database is contained in the <em><span style=""  Segoe UIsans-serif  >%SystemRoot%</span></em>\System32\Certlog folder, and the name is based on the CA name with an .edb extension. The database can contain:</span></p>  <p class="MsoNormal"   style="margin-left:35.7pt;text-align:left; text-indent:-17.85pt;mso-pagination:widow-orphan;mso-list:l0 level1 lfo1; tab-stops:list 36.0pt;"   align="left"   ><span style="font-size: 10.0pt;mso-bidi-font-size:9.5pt;font-family:Symbol;mso-fareast-font-family: Symbol;mso-bidi-font-family:Symbol;color:black;"   lang="EN-US"   ><span style="mso-list:Ignore;"   >·<span style="font:7.0pt ;"  Times New Roman  >&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span></span><span style="font-size:11.0pt; mso-bidi-font-size:9.5pt;"  Segoe UIsans-serifcolorblack  lang="EN-US"   >Issued certificates</span></p>  <p class="MsoNormal"   style="margin-left:35.7pt;text-align:left; text-indent:-17.85pt;mso-pagination:widow-orphan;mso-list:l0 level1 lfo1; tab-stops:list 36.0pt;"   align="left"   ><span style="font-size: 10.0pt;mso-bidi-font-size:9.5pt;font-family:Symbol;mso-fareast-font-family: Symbol;mso-bidi-font-family:Symbol;color:black;"   lang="EN-US"   ><span style="mso-list:Ignore;"   >·<span style="font:7.0pt ;"  Times New Roman  >&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span></span><span style="font-size:11.0pt; mso-bidi-font-size:9.5pt;"  Segoe UIsans-serifcolorblack  lang="EN-US"   >Revoked certificates</span></p>  <p class="MsoNormal"   style="margin-left:35.7pt;text-align:left; text-indent:-17.85pt;mso-pagination:widow-orphan;mso-list:l0 level1 lfo1; tab-stops:list 36.0pt;"   align="left"   ><span style="font-size: 10.0pt;mso-bidi-font-size:9.5pt;font-family:Symbol;mso-fareast-font-family: Symbol;mso-bidi-font-family:Symbol;color:black;"   lang="EN-US"   ><span style="mso-list:Ignore;"   >·<span style="font:7.0pt ;"  Times New Roman  >&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span></span><span style="font-size:11.0pt; mso-bidi-font-size:9.5pt;"  Segoe UIsans-serifcolorblack  lang="EN-US"   >Archived private keys</span></p>  <p class="MsoNormal"   style="margin-left:35.7pt;text-align:left; text-indent:-17.85pt;mso-pagination:widow-orphan;mso-list:l0 level1 lfo1; tab-stops:list 36.0pt;"   align="left"   ><span style="font-size: 10.0pt;mso-bidi-font-size:9.5pt;font-family:Symbol;mso-fareast-font-family: Symbol;mso-bidi-font-family:Symbol;color:black;"   lang="EN-US"   ><span style="mso-list:Ignore;"   >·<span style="font:7.0pt ;"  Times New Roman  >&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span></span><span style="font-size:11.0pt; mso-bidi-font-size:9.5pt;"  Segoe UIsans-serifcolorblack  lang="EN-US"   >Certificate requests</span></p>  <p style="margin-top:7.8pt;margin-right:0cm;margin-bottom:7.8pt;margin-left: 0cm;mso-para-margin-top:.5gd;mso-para-margin-right:0cm;mso-para-margin-bottom: .5gd;mso-para-margin-left:0cm;"   ><span style="font-size:11.0pt; mso-bidi-font-size:9.5pt;"  Segoe UIsans-serifcolorblack  lang="EN-US"   >You cannot use the Certificate Enrollment API to manipulate the database. The enrollment process automatically creates the necessary entries.</span></p>  <h3 style="margin-top:0cm;margin-right:0cm;margin-bottom:7.8pt;margin-left: 0cm;mso-para-margin-top:0cm;mso-para-margin-right:0cm;mso-para-margin-bottom: .5gd;mso-para-margin-left:0cm;"   ><span style="font-size:14.0pt; mso-bidi-font-size:10.5pt;line-height:173%;"   lang="EN-US"   >Certificate Stores</span><span style="font-size:14.0pt;mso-bidi-font-size:10.5pt;line-height:173%;"  Segoe UIsans-serifcolorFC  lang="EN-US"   ></span></h3>  <p style="margin-top:0cm;margin-right:0cm;margin-bottom:7.8pt;margin-left:0cm; mso-para-margin-top:0cm;mso-para-margin-right:0cm;mso-para-margin-bottom:.5gd; mso-para-margin-left:0cm;"   ><span style="font-size:11.0pt;mso-bidi-font-size: 9.5pt;"  Segoe UIsans-serifcolorblack  lang="EN-US"   >Microsoft Certificate Services copies issued certificates and pending or rejected requests to local computers and devices. The storage location is called the certificate store and consists of the following logical stores.</span></p>  <table class="MsoNormalTable"   style="width:100.0%;border-collapse:collapse;border:none;mso-border-alt:solid #BBBBBB .75pt;  mso-yfti-tbllook:1184;"   border="1"   cellpadding="0"   cellspacing="0"   width="100%"   >  <tbody><tr style="mso-yfti-irow:0;mso-yfti-firstrow:yes;height:15.75pt;"   >   <td style="border:solid #BBBBBB 1.0pt;mso-border-alt:solid #BBBBBB .75pt;   background:#E5E5E5;padding:3.0pt 3.0pt 3.0pt 3.0pt;height:15.75pt;"   valign="top"   >   <p><span style="font-size:14.0pt;mso-bidi-font-size:   10.5pt;"  Segoe UIsans-serifcolorblack  lang="EN-US"   >Logical store</span><span style="font-size:14.0pt;mso-bidi-font-size:10.5pt;font-family:   ;"  Segoe UIsans-serifmso-fareast-font-familycolorblack  lang="EN-US"   ></span></p>   </td>   <td style="border:solid #BBBBBB 1.0pt;border-left:none;mso-border-left-alt:   solid #BBBBBB .75pt;mso-border-alt:solid #BBBBBB .75pt;background:#E5E5E5;   padding:3.0pt 3.0pt 3.0pt 3.0pt;height:15.75pt;"   valign="top"   >   <p><span style="font-size:14.0pt;mso-bidi-font-size:   10.5pt;"  Segoe UIsans-serifcolorblack  lang="EN-US"   >Description</span><span style="font-size:14.0pt;mso-bidi-font-size:10.5pt;font-family:   ;"  Segoe UIsans-serifmso-fareast-font-familycolorblack  lang="EN-US"   ></span></p>   </td>  </tr>  <tr style="mso-yfti-irow:1;"   >   <td style="border:solid #BBBBBB 1.0pt;border-top:none;mso-border-top-alt:   solid #BBBBBB .75pt;mso-border-alt:solid #BBBBBB .75pt;background:white;   padding:3.0pt 3.0pt 3.0pt 3.0pt;"   valign="top"   >   <p style="margin-top:5.0pt;margin-right:.75pt;margin-bottom:5.0pt;margin-left:   .75pt;line-height:140%;"   ><span style="font-size:11.0pt;mso-bidi-font-size:   9.5pt;line-height:140%;"  Segoe UIsans-serifcolorblack  lang="EN-US"   >Personal</span></p>   </td>   <td style="border-top:none;border-left:none;border-bottom:solid #BBBBBB 1.0pt;   border-right:solid #BBBBBB 1.0pt;mso-border-top-alt:solid #BBBBBB .75pt;   mso-border-left-alt:solid #BBBBBB .75pt;mso-border-alt:solid #BBBBBB .75pt;   background:white;padding:3.0pt 3.0pt 3.0pt 3.0pt;"   valign="top"   >   <p style="margin-top:5.0pt;margin-right:.75pt;margin-bottom:5.0pt;margin-left:   .75pt;line-height:140%;"   ><span style="font-size:11.0pt;mso-bidi-font-size:   9.5pt;line-height:140%;"  Segoe UIsans-serifcolorblack  lang="EN-US"   >Contains   certificates associated with a private key controlled by the user or   computer.</span></p>   </td>  </tr>  <tr style="mso-yfti-irow:2;"   >   <td style="border:solid #BBBBBB 1.0pt;border-top:none;mso-border-top-alt:   solid #BBBBBB .75pt;mso-border-alt:solid #BBBBBB .75pt;background:white;   padding:3.0pt 3.0pt 3.0pt 3.0pt;"   valign="top"   >   <p style="margin-top:5.0pt;margin-right:.75pt;margin-bottom:5.0pt;margin-left:   .75pt;line-height:140%;"   ><span style="font-size:11.0pt;mso-bidi-font-size:   9.5pt;line-height:140%;"  Segoe UIsans-serifcolorblack  lang="EN-US"   >Trusted   Root Certification Authorities</span></p>   </td>   <td style="border-top:none;border-left:none;border-bottom:solid #BBBBBB 1.0pt;   border-right:solid #BBBBBB 1.0pt;mso-border-top-alt:solid #BBBBBB .75pt;   mso-border-left-alt:solid #BBBBBB .75pt;mso-border-alt:solid #BBBBBB .75pt;   background:white;padding:3.0pt 3.0pt 3.0pt 3.0pt;"   valign="top"   >   <p style="margin-top:5.0pt;margin-right:.75pt;margin-bottom:5.0pt;margin-left:   .75pt;line-height:140%;"   ><span style="font-size:11.0pt;mso-bidi-font-size:   9.5pt;line-height:140%;"  Segoe UIsans-serifcolorblack  lang="EN-US"   >Contains   certificates from implicitly trusted certification authorities (CAs).</span></p>   </td>  </tr>  <tr style="mso-yfti-irow:3;"   >   <td style="border:solid #BBBBBB 1.0pt;border-top:none;mso-border-top-alt:   solid #BBBBBB .75pt;mso-border-alt:solid #BBBBBB .75pt;background:white;   padding:3.0pt 3.0pt 3.0pt 3.0pt;"   valign="top"   >   <p style="margin-top:5.0pt;margin-right:.75pt;margin-bottom:5.0pt;margin-left:   .75pt;line-height:140%;"   ><span style="font-size:11.0pt;mso-bidi-font-size:   9.5pt;line-height:140%;"  Segoe UIsans-serifcolorblack  lang="EN-US"   >Enterprise   Trust</span></p>   </td>   <td style="border-top:none;border-left:none;border-bottom:solid #BBBBBB 1.0pt;   border-right:solid #BBBBBB 1.0pt;mso-border-top-alt:solid #BBBBBB .75pt;   mso-border-left-alt:solid #BBBBBB .75pt;mso-border-alt:solid #BBBBBB .75pt;   background:white;padding:3.0pt 3.0pt 3.0pt 3.0pt;"   valign="top"   >   <p style="margin-top:5.0pt;margin-right:.75pt;margin-bottom:5.0pt;margin-left:   .75pt;line-height:140%;"   ><span style="font-size:11.0pt;mso-bidi-font-size:   9.5pt;line-height:140%;"  Segoe UIsans-serifcolorblack  lang="EN-US"   >Contains   certificate trust lists typically used to trust self-signed certificates from   other organizations.</span></p>   </td>  </tr>  <tr style="mso-yfti-irow:4;"   >   <td style="border:solid #BBBBBB 1.0pt;border-top:none;mso-border-top-alt:   solid #BBBBBB .75pt;mso-border-alt:solid #BBBBBB .75pt;background:white;   padding:3.0pt 3.0pt 3.0pt 3.0pt;"   valign="top"   >   <p style="margin-top:5.0pt;margin-right:.75pt;margin-bottom:5.0pt;margin-left:   .75pt;line-height:140%;"   ><span style="font-size:11.0pt;mso-bidi-font-size:   9.5pt;line-height:140%;"  Segoe UIsans-serifcolorblack  lang="EN-US"   >Intermediate   Certification Authorities</span></p>   </td>   <td style="border-top:none;border-left:none;border-bottom:solid #BBBBBB 1.0pt;   border-right:solid #BBBBBB 1.0pt;mso-border-top-alt:solid #BBBBBB .75pt;   mso-border-left-alt:solid #BBBBBB .75pt;mso-border-alt:solid #BBBBBB .75pt;   background:white;padding:3.0pt 3.0pt 3.0pt 3.0pt;"   valign="top"   >   <p style="margin-top:5.0pt;margin-right:.75pt;margin-bottom:5.0pt;margin-left:   .75pt;line-height:140%;"   ><span style="font-size:11.0pt;mso-bidi-font-size:   9.5pt;line-height:140%;"  Segoe UIsans-serifcolorblack  lang="EN-US"   >Contains   certificates issued to subordinate CAs in the certification hierarchy.</span></p>   </td>  </tr>  <tr style="mso-yfti-irow:5;"   >   <td style="border:solid #BBBBBB 1.0pt;border-top:none;mso-border-top-alt:   solid #BBBBBB .75pt;mso-border-alt:solid #BBBBBB .75pt;background:white;   padding:3.0pt 3.0pt 3.0pt 3.0pt;"   valign="top"   >   <p style="margin-top:5.0pt;margin-right:.75pt;margin-bottom:5.0pt;margin-left:   .75pt;line-height:140%;"   ><span style="font-size:11.0pt;mso-bidi-font-size:   9.5pt;line-height:140%;"  Segoe UIsans-serifcolorblack  lang="EN-US"   >Active   Directory User Object</span></p>   </td>   <td style="border-top:none;border-left:none;border-bottom:solid #BBBBBB 1.0pt;   border-right:solid #BBBBBB 1.0pt;mso-border-top-alt:solid #BBBBBB .75pt;   mso-border-left-alt:solid #BBBBBB .75pt;mso-border-alt:solid #BBBBBB .75pt;   background:white;padding:3.0pt 3.0pt 3.0pt 3.0pt;"   valign="top"   >   <p style="margin-top:5.0pt;margin-right:.75pt;margin-bottom:5.0pt;margin-left:   .75pt;line-height:140%;"   ><span style="font-size:11.0pt;mso-bidi-font-size:   9.5pt;line-height:140%;"  Segoe UIsans-serifcolorblack  lang="EN-US"   >Contains   the user object certificate or certificates published in Active Directory.</span></p>   </td>  </tr>  <tr style="mso-yfti-irow:6;"   >   <td style="border:solid #BBBBBB 1.0pt;border-top:none;mso-border-top-alt:   solid #BBBBBB .75pt;mso-border-alt:solid #BBBBBB .75pt;background:white;   padding:3.0pt 3.0pt 3.0pt 3.0pt;"   valign="top"   >   <p style="margin-top:5.0pt;margin-right:.75pt;margin-bottom:5.0pt;margin-left:   .75pt;line-height:140%;"   ><span style="font-size:11.0pt;mso-bidi-font-size:   9.5pt;line-height:140%;"  Segoe UIsans-serifcolorblack  lang="EN-US"   >Trusted   Publishers</span></p>   </td>   <td style="border-top:none;border-left:none;border-bottom:solid #BBBBBB 1.0pt;   border-right:solid #BBBBBB 1.0pt;mso-border-top-alt:solid #BBBBBB .75pt;   mso-border-left-alt:solid #BBBBBB .75pt;mso-border-alt:solid #BBBBBB .75pt;   background:white;padding:3.0pt 3.0pt 3.0pt 3.0pt;"   valign="top"   >   <p style="margin-top:5.0pt;margin-right:.75pt;margin-bottom:5.0pt;margin-left:   .75pt;line-height:140%;"   ><span style="font-size:11.0pt;mso-bidi-font-size:   9.5pt;line-height:140%;"  Segoe UIsans-serifcolorblack  lang="EN-US"   >Contains   certificates from trusted CAs.</span></p>   </td>  </tr>  <tr style="mso-yfti-irow:7;"   >   <td style="border:solid #BBBBBB 1.0pt;border-top:none;mso-border-top-alt:   solid #BBBBBB .75pt;mso-border-alt:solid #BBBBBB .75pt;background:white;   padding:3.0pt 3.0pt 3.0pt 3.0pt;"   valign="top"   >   <p style="margin-top:5.0pt;margin-right:.75pt;margin-bottom:5.0pt;margin-left:   .75pt;line-height:140%;"   ><span style="font-size:11.0pt;mso-bidi-font-size:   9.5pt;line-height:140%;"  Segoe UIsans-serifcolorblack  lang="EN-US"   >Untrusted   Certificates</span></p>   </td>   <td style="border-top:none;border-left:none;border-bottom:solid #BBBBBB 1.0pt;   border-right:solid #BBBBBB 1.0pt;mso-border-top-alt:solid #BBBBBB .75pt;   mso-border-left-alt:solid #BBBBBB .75pt;mso-border-alt:solid #BBBBBB .75pt;   background:white;padding:3.0pt 3.0pt 3.0pt 3.0pt;"   valign="top"   >   <p style="margin-top:5.0pt;margin-right:.75pt;margin-bottom:5.0pt;margin-left:   .75pt;line-height:140%;"   ><span style="font-size:11.0pt;mso-bidi-font-size:   9.5pt;line-height:140%;"  Segoe UIsans-serifcolorblack  lang="EN-US"   >Contains   certificates that have been explicitly identified as untrusted.</span></p>   </td>  </tr>  <tr style="mso-yfti-irow:8;"   >   <td style="border:solid #BBBBBB 1.0pt;border-top:none;mso-border-top-alt:   solid #BBBBBB .75pt;mso-border-alt:solid #BBBBBB .75pt;background:white;   padding:3.0pt 3.0pt 3.0pt 3.0pt;"   valign="top"   >   <p style="margin-top:5.0pt;margin-right:.75pt;margin-bottom:5.0pt;margin-left:   .75pt;line-height:140%;"   ><span style="font-size:11.0pt;mso-bidi-font-size:   9.5pt;line-height:140%;"  Segoe UIsans-serifcolorblack  lang="EN-US"   >Third-Party   Root Certification Authorities</span></p>   </td>   <td style="border-top:none;border-left:none;border-bottom:solid #BBBBBB 1.0pt;   border-right:solid #BBBBBB 1.0pt;mso-border-top-alt:solid #BBBBBB .75pt;   mso-border-left-alt:solid #BBBBBB .75pt;mso-border-alt:solid #BBBBBB .75pt;   background:white;padding:3.0pt 3.0pt 3.0pt 3.0pt;"   valign="top"   >   <p style="margin-top:5.0pt;margin-right:.75pt;margin-bottom:5.0pt;margin-left:   .75pt;line-height:140%;"   ><span style="font-size:11.0pt;mso-bidi-font-size:   9.5pt;line-height:140%;"  Segoe UIsans-serifcolorblack  lang="EN-US"   >Contains   trusted root certificates from CAs outside the internal certificate   hierarchy.</span></p>   </td>  </tr>  <tr style="mso-yfti-irow:9;"   >   <td style="border:solid #BBBBBB 1.0pt;border-top:none;mso-border-top-alt:   solid #BBBBBB .75pt;mso-border-alt:solid #BBBBBB .75pt;background:white;   padding:3.0pt 3.0pt 3.0pt 3.0pt;"   valign="top"   >   <p style="margin-top:5.0pt;margin-right:.75pt;margin-bottom:5.0pt;margin-left:   .75pt;line-height:140%;"   ><span style="font-size:11.0pt;mso-bidi-font-size:   9.5pt;line-height:140%;"  Segoe UIsans-serifcolorblack  lang="EN-US"   >Trusted   People</span></p>   </td>   <td style="border-top:none;border-left:none;border-bottom:solid #BBBBBB 1.0pt;   border-right:solid #BBBBBB 1.0pt;mso-border-top-alt:solid #BBBBBB .75pt;   mso-border-left-alt:solid #BBBBBB .75pt;mso-border-alt:solid #BBBBBB .75pt;   background:white;padding:3.0pt 3.0pt 3.0pt 3.0pt;"   valign="top"   >   <p style="margin-top:5.0pt;margin-right:.75pt;margin-bottom:5.0pt;margin-left:   .75pt;line-height:140%;"   ><span style="font-size:11.0pt;mso-bidi-font-size:   9.5pt;line-height:140%;"  Segoe UIsans-serifcolorblack  lang="EN-US"   >Contains   certificates issued to users or entities that have been explicitly trusted.</span></p>   </td>  </tr>  <tr style="mso-yfti-irow:10;"   >   <td style="border:solid #BBBBBB 1.0pt;border-top:none;mso-border-top-alt:   solid #BBBBBB .75pt;mso-border-alt:solid #BBBBBB .75pt;background:white;   padding:3.0pt 3.0pt 3.0pt 3.0pt;"   valign="top"   >   <p style="margin-top:5.0pt;margin-right:.75pt;margin-bottom:5.0pt;margin-left:   .75pt;line-height:140%;"   ><span style="font-size:11.0pt;mso-bidi-font-size:   9.5pt;line-height:140%;"  Segoe UIsans-serifcolorblack  lang="EN-US"   >Other   People</span></p>   </td>   <td style="border-top:none;border-left:none;border-bottom:solid #BBBBBB 1.0pt;   border-right:solid #BBBBBB 1.0pt;mso-border-top-alt:solid #BBBBBB .75pt;   mso-border-left-alt:solid #BBBBBB .75pt;mso-border-alt:solid #BBBBBB .75pt;   background:white;padding:3.0pt 3.0pt 3.0pt 3.0pt;"   valign="top"   >   <p style="margin-top:5.0pt;margin-right:.75pt;margin-bottom:5.0pt;margin-left:   .75pt;line-height:140%;"   ><span style="font-size:11.0pt;mso-bidi-font-size:   9.5pt;line-height:140%;"  Segoe UIsans-serifcolorblack  lang="EN-US"   >Contains   certificates issued to users or entities that have been implicitly trusted.</span></p>   </td>  </tr>  <tr style="mso-yfti-irow:11;mso-yfti-lastrow:yes;"   >   <td style="border:solid #BBBBBB 1.0pt;border-top:none;mso-border-top-alt:   solid #BBBBBB .75pt;mso-border-alt:solid #BBBBBB .75pt;background:white;   padding:3.0pt 3.0pt 3.0pt 3.0pt;"   valign="top"   >   <p style="margin-top:5.0pt;margin-right:.75pt;margin-bottom:5.0pt;margin-left:   .75pt;line-height:140%;"   ><span style="font-size:11.0pt;mso-bidi-font-size:   9.5pt;line-height:140%;"  Segoe UIsans-serifcolorblack  lang="EN-US"   >Certificate   Enrollment Requests</span></p>   </td>   <td style="border-top:none;border-left:none;border-bottom:solid #BBBBBB 1.0pt;   border-right:solid #BBBBBB 1.0pt;mso-border-top-alt:solid #BBBBBB .75pt;   mso-border-left-alt:solid #BBBBBB .75pt;mso-border-alt:solid #BBBBBB .75pt;   background:white;padding:3.0pt 3.0pt 3.0pt 3.0pt;"   valign="top"   >   <p style="margin-top:5.0pt;margin-right:.75pt;margin-bottom:5.0pt;margin-left:   .75pt;line-height:140%;"   ><span style="font-size:11.0pt;mso-bidi-font-size:   9.5pt;line-height:140%;"  Segoe UIsans-serifcolorblack  lang="EN-US"   >Contains   pending or rejected certificate requests.</span></p>   </td>  </tr> </table>  <p><span style="font-size:11.0pt;mso-bidi-font-size:9.5pt;"  Segoe UIsans-serifcolorblack  lang="EN-US"   >You cannot use the Certificate Enrollment API to specify or retrieve store properties or copy certificates to specific stores.</span></p>  <h1 style="margin-bottom:7.8pt;mso-para-margin-bottom:.5gd;"   ><span style="font-size:11.0pt;mso-bidi-font-size:17.0pt;"   lang="EN-US"   >Key Recovery Server</span></h1>  <p style="margin-top:0cm;margin-right:0cm;margin-bottom:7.8pt;margin-left:0cm; mso-para-margin-top:0cm;mso-para-margin-right:0cm;mso-para-margin-bottom:.5gd; mso-para-margin-left:0cm;"   ><span style="font-size:11.0pt;mso-bidi-font-size: 9.5pt;"  Segoe UIsans-serifcolorblack  lang="EN-US"   >A Microsoft certification authority (CA) can be configured to archive and recover the private key associated with the public key submitted in the certificate request. Recovery is useful if a key is lost. By default, only encryption keys can be archived. It is not necessary to archive keys intended only for signing because only the public key is needed to verify a signature if the private signing key is lost.</span></p>  <p style="margin-top:0cm;margin-right:0cm;margin-bottom:7.8pt;margin-left:0cm; mso-para-margin-top:0cm;mso-para-margin-right:0cm;mso-para-margin-bottom:.5gd; mso-para-margin-left:0cm;"   ><span style="font-size:11.0pt;mso-bidi-font-size: 9.5pt;"  Segoe UIsans-serifcolorblack  lang="EN-US"   >To archive a key, the CA must be configured to issue key recovery agent (KRA) certificates and to have already issued at least one. A key recovery agent is an administrator authorized by an organization to decrypt private keys. To enhance security, we recommend that the key recovery agent and the certificate manager roles be assigned to different individuals, that the certificate manager be permitted to retrieve but not decrypt archived keys, and that the key recovery agent be permitted to decrypt keys but not retrieve them.</span></p>  <h3 style="margin-top:0cm;margin-right:0cm;margin-bottom:7.8pt;margin-left: 0cm;mso-para-margin-top:0cm;mso-para-margin-right:0cm;mso-para-margin-bottom: .5gd;mso-para-margin-left:0cm;"   ><span style="font-size:14.0pt; mso-bidi-font-size:10.5pt;line-height:173%;"   lang="EN-US"   >Key Archival</span><span style="font-size:14.0pt;mso-bidi-font-size:10.5pt;line-height:173%;"  Segoe UIsans-serifcolorFC  lang="EN-US"   ></span></h3>  <p style="margin-top:0cm;margin-right:0cm;margin-bottom:7.8pt;margin-left:0cm; mso-para-margin-top:0cm;mso-para-margin-right:0cm;mso-para-margin-bottom:.5gd; mso-para-margin-left:0cm;"   ><span style="font-size:11.0pt;mso-bidi-font-size: 9.5pt;"  Segoe UIsans-serifcolorblack  lang="EN-US"   >A client typically requests a certificate by using a template. If the template requires that the private key be archived, the following steps are performed by the client and the CA:</span></p>  <ol start="1"   type="1"   ><li class="MsoNormal"   style="color:black;mso-margin-top-alt:auto;mso-margin-bottom-alt:      auto;text-align:left;mso-pagination:widow-orphan;mso-list:l1 level1 lfo2;      tab-stops:list 36.0pt;"   ><span style="font-size:11.0pt;      mso-bidi-font-size:9.5pt;"  Segoe UIsans-serif  lang="EN-US"   >The client      retrieves and validates the CA exchange certificate to determine whether      it has been signed by the same key that was used to sign the CA signing      certificate. This ensures that the only CA that can decrypt the private      key is the CA from which a certificate is being requested.</span></li><li class="MsoNormal"   style="color:black;mso-margin-top-alt:auto;mso-margin-bottom-alt:      auto;text-align:left;mso-pagination:widow-orphan;mso-list:l1 level1 lfo2;      tab-stops:list 36.0pt;"   ><span style="font-size:11.0pt;      mso-bidi-font-size:9.5pt;"  Segoe UIsans-serif  lang="EN-US"   >The public      key in the CA exchange certificate is used to encrypt the private key      associated with the certificate request, and the request is sent to the      CA.</span></li><li class="MsoNormal"   style="color:black;mso-margin-top-alt:auto;mso-margin-bottom-alt:      auto;text-align:left;mso-pagination:widow-orphan;mso-list:l1 level1 lfo2;      tab-stops:list 36.0pt;"   ><span style="font-size:11.0pt;      mso-bidi-font-size:9.5pt;"  Segoe UIsans-serif  lang="EN-US"   >The CA uses      the private key associated with its exchange certificate to decrypt the      private key sent by the client and verifies that the public and private      keys in the request are related.</span></li><li class="MsoNormal"   style="color:black;mso-margin-top-alt:auto;mso-margin-bottom-alt:      auto;text-align:left;mso-pagination:widow-orphan;mso-list:l1 level1 lfo2;      tab-stops:list 36.0pt;"   ><span style="font-size:11.0pt;      mso-bidi-font-size:9.5pt;"  Segoe UIsans-serif  lang="EN-US"   >The CA      encrypts the private key by using the public key in the KRA certificate.      If the CA has issued multiple KRA certificates, it encrypts the private      key once with each available public key so that any authorized key      recovery agent can recover a key. The encrypted private keys are stored in      the certificate database.</span></li><li class="MsoNormal"   style="color:black;mso-margin-top-alt:auto;mso-margin-bottom-alt:      auto;text-align:left;mso-pagination:widow-orphan;mso-list:l1 level1 lfo2;      tab-stops:list 36.0pt;"   ><span style="font-size:11.0pt;      mso-bidi-font-size:9.5pt;"  Segoe UIsans-serif  lang="EN-US"   >The CA      releases all references to the private key and securely frees and zeroes      all memory that contained the key. This ensures that the CA has no further      access to the key in clear text format.</span></li></ol>  <p><strong><span style="font-size:11.0pt;mso-bidi-font-size: 9.5pt;"  Segoe UIsans-serifcolorblack  lang="EN-US"   >Note</span></strong><span style="font-size:11.0pt;mso-bidi-font-size:9.5pt;"  Segoe UIsans-serif colorblack  lang="EN-US"   > Only a CMC request can be used for key archival. CMC requests are represented by the </span><span lang="EN-US"   ><a rel="nofollow" href="http://msdn.microsoft.com/en-us/library/aa377133%28v=VS.85%29.aspx"   ><strong><span style="font-size:11.0pt;mso-bidi-font-size:9.5pt;"  Segoe UIsans-serif colorCtext-decorationnonetext-underlinenone  >IX509CertificateRequestCmc</span></strong></a></span><span style="font-size:11.0pt;mso-bidi-font-size:9.5pt;"  Segoe UIsans-serif colorblack  lang="EN-US"   > interface.</span></p>  <h3 style="margin-top:0cm;margin-right:0cm;margin-bottom:7.8pt;margin-left: 0cm;mso-para-margin-top:0cm;mso-para-margin-right:0cm;mso-para-margin-bottom: .5gd;mso-para-margin-left:0cm;"   ><span style="font-size:14.0pt; mso-bidi-font-size:10.5pt;line-height:173%;"   lang="EN-US"   >Key Recovery</span><span style="font-size:14.0pt;mso-bidi-font-size:10.5pt;line-height:173%;"  Segoe UIsans-serifcolorFC  lang="EN-US"   ></span></h3>  <p style="margin-top:0cm;margin-right:0cm;margin-bottom:7.8pt;margin-left:0cm; mso-para-margin-top:0cm;mso-para-margin-right:0cm;mso-para-margin-bottom:.5gd; mso-para-margin-left:0cm;"   ><span style="font-size:11.0pt;mso-bidi-font-size: 9.5pt;"  Segoe UIsans-serifcolorblack  lang="EN-US"   >Key recovery is not directly supported by Active Directory Certificate Services or the Certificate Enrollment API. Microsoft does, however, provide the following applications to help with the process:</span></p>  <ul type="disc"   ><li class="MsoNormal"   style="color:black;mso-margin-top-alt:auto;mso-margin-bottom-alt:      auto;text-align:left;mso-pagination:widow-orphan;mso-list:l2 level1 lfo3;      tab-stops:list 36.0pt;"   ><span style="font-size:11.0pt;      mso-bidi-font-size:9.5pt;"  Segoe UIsans-serif  lang="EN-US"   >Certutil.exe      is a command line program that can be used to retrieve CA configuration      information, verify certificates, key pairs, and certificate chains, and      back up and restore keys. It is included in server operating systems      beginning with Windows Server 2003.</span></li><li class="MsoNormal"   style="color:black;mso-margin-top-alt:auto;mso-margin-bottom-alt:      auto;text-align:left;mso-pagination:widow-orphan;mso-list:l2 level1 lfo3;      tab-stops:list 36.0pt;"   ><span style="font-size:11.0pt;      mso-bidi-font-size:9.5pt;"  Segoe UIsans-serif  lang="EN-US"   >Krecover.exe      is a dialog box–based program that enables key recovery. It is included      with the Resource Kit beginning with Windows Server 2003.</span></li></ul>  <p style="margin-top:0cm;margin-right:0cm;margin-bottom:7.8pt;margin-left:0cm; mso-para-margin-top:0cm;mso-para-margin-right:0cm;mso-para-margin-bottom:.5gd; mso-para-margin-left:0cm;"   ><span style="font-size:11.0pt;mso-bidi-font-size: 9.5pt;"  Segoe UIsans-serifcolorblack  lang="EN-US"   >The following steps are performed to recover a private key:</span></p>  <ol start="1"   type="1"   ><li class="MsoNormal"   style="color:black;mso-margin-top-alt:auto;mso-margin-bottom-alt:      auto;text-align:left;mso-pagination:widow-orphan;mso-list:l3 level1 lfo4;      tab-stops:list 36.0pt;"   ><span style="font-size:11.0pt;      mso-bidi-font-size:9.5pt;"  Segoe UIsans-serif  lang="EN-US"   >The      certificate manager locates potential candidates for key recovery in the      certificate database by using the name of the certificate, requester, or      user. The <strong><span style=""  Segoe UIsans-serif  >Certutil      -getkey</span></strong> command can be used for this purpose.</span></li><li class="MsoNormal"   style="color:black;mso-margin-top-alt:auto;mso-margin-bottom-alt:      auto;text-align:left;mso-pagination:widow-orphan;mso-list:l3 level1 lfo4;      tab-stops:list 36.0pt;"   ><span style="font-size:11.0pt;      mso-bidi-font-size:9.5pt;"  Segoe UIsans-serif  lang="EN-US"   >Once the      certificate manager has a list of certificates, the <strong><span style=""  Segoe UIsans-serif  >-getkey</span></strong>      command is called again with a specific certificate serial number or thumb      print to retrieve a PKCS #7 file that contains the KRA certificate, user      certificate chain, and the private key that was encrypted during archival      by using the KRA public key.</span></li><li class="MsoNormal"   style="color:black;mso-margin-top-alt:auto;mso-margin-bottom-alt:      auto;text-align:left;mso-pagination:widow-orphan;mso-list:l3 level1 lfo4;      tab-stops:list 36.0pt;"   ><span style="font-size:11.0pt;      mso-bidi-font-size:9.5pt;"  Segoe UIsans-serif  lang="EN-US"   >The      certificate manager passes control of the process to the key recovery      agent whose private key matches the public key contained in the KRA      certificate.</span></li><li class="MsoNormal"   style="color:black;mso-margin-top-alt:auto;mso-margin-bottom-alt:      auto;text-align:left;mso-pagination:widow-orphan;mso-list:l3 level1 lfo4;      tab-stops:list 36.0pt;"   ><span style="font-size:11.0pt;      mso-bidi-font-size:9.5pt;"  Segoe UIsans-serif  lang="EN-US"   >The key      recovery agent decrypts the archived private key returned in the PKCS #7      file by using the KRA private key. This can be done by using the <strong><span style=""  Segoe UIsans-serif  >Certutil -recoverkey</span></strong>      command which places the key in a password-protected PKCS #12 file. The      client must be given the password through a secure out-of-band mechanism.</span></li><li class="MsoNormal"   style="color:black;mso-margin-top-alt:auto;mso-margin-bottom-alt:      auto;text-align:left;mso-pagination:widow-orphan;mso-list:l3 level1 lfo4;      tab-stops:list 36.0pt;"   ><span style="font-size:11.0pt;      mso-bidi-font-size:9.5pt;"  Segoe UIsans-serif  lang="EN-US"   >The client      imports the PKCS #12 file and uses the password to retrieve the key.</span></li></ol>
</body></html>