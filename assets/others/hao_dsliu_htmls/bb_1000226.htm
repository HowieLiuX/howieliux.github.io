<html><head><meta http-equiv="Content-Type" content="text/html; charset=utf8"><title>163 blogs的博客：谈谈Unicode编码，简要解释UCS、UTF、BMP、BOM等名词</title>
<style type="text/css">
a{color: #000000;text-decoration : none;font-size: 10pt;}
a:hover {color: red;text-decoration : underline;}
.replyBox{padding:4px;border:1px solid #D8D8D8;}
</style></head><body><h2>谈谈Unicode编码，简要解释UCS、UTF、BMP、BOM等名词</h2>
<p align="right">发布时间：2011-4-14 11:07
<br>分类名称：windows</p><br>
<P style="TEXT-ALIGN: left; MARGIN: 0cm 0cm 0pt; mso-margin-top-alt: auto; mso-margin-bottom-alt: auto; mso-pagination: widow-orphan;" align="left"><SPAN style="FONT-FAMILY: 宋体; FONT-SIZE: 12pt; mso-bidi-font-family: 宋体; mso-font-kerning: 0pt;">这是一篇程序员写给程序员的趣味读物。所谓趣味是指可以比较轻松地了解一些原来不清楚的概念，增进知识，类似于打<SPAN lang="EN-US">RPG</SPAN>游戏的升级。整理这篇文章的动机是两个问题：<SPAN lang="EN-US"></SPAN></SPAN></P>  <P style="TEXT-ALIGN: left; MARGIN: 0cm 0cm 0pt; mso-pagination: widow-orphan;" align="left"><SPAN style="FONT-FAMILY: 宋体; FONT-SIZE: 12pt; mso-bidi-font-family: 宋体; mso-font-kerning: 0pt;">问题一：<SPAN lang="EN-US"></SPAN></SPAN></P>  <P style="TEXT-ALIGN: left; MARGIN: 0cm 0cm 0pt 36pt; mso-margin-top-alt: auto; mso-margin-bottom-alt: auto; mso-pagination: widow-orphan;" align="left"><SPAN style="FONT-FAMILY: 宋体; FONT-SIZE: 12pt; mso-bidi-font-family: 宋体; mso-font-kerning: 0pt;">使用<SPAN lang="EN-US">Windows</SPAN>记事本的<SPAN lang="EN-US">“</SPAN>另存为<SPAN lang="EN-US">”</SPAN>，可以在<SPAN lang="EN-US">GBK</SPAN>、<SPAN lang="EN-US">Unicode</SPAN>、<SPAN lang="EN-US">Unicode big endian</SPAN>和<SPAN lang="EN-US">UTF-8</SPAN>这几种编码方式间相互转换。同样是<SPAN lang="EN-US">txt</SPAN>文件，<SPAN lang="EN-US">Windows</SPAN>是怎样识别编码方式的呢？<SPAN lang="EN-US"></SPAN></SPAN></P>  <P style="TEXT-ALIGN: left; MARGIN: 0cm 0cm 0pt 36pt; mso-margin-top-alt: auto; mso-margin-bottom-alt: auto; mso-pagination: widow-orphan;" align="left"><SPAN style="FONT-FAMILY: 宋体; FONT-SIZE: 12pt; mso-bidi-font-family: 宋体; mso-font-kerning: 0pt;">我很早前就发现<SPAN lang="EN-US">Unicode</SPAN>、<SPAN lang="EN-US">Unicode big endian</SPAN>和<SPAN lang="EN-US">UTF-8</SPAN>编码的<SPAN lang="EN-US">txt</SPAN>文件的开头会多出几个字节，分别是<SPAN lang="EN-US">FF</SPAN>、<SPAN lang="EN-US">FE</SPAN>（<SPAN lang="EN-US">Unicode</SPAN>）<SPAN lang="EN-US">,FE</SPAN>、<SPAN lang="EN-US">FF</SPAN>（<SPAN lang="EN-US">Unicode big endian</SPAN>）<SPAN lang="EN-US">,EF</SPAN>、<SPAN lang="EN-US">BB</SPAN>、<SPAN lang="EN-US">BF</SPAN>（<SPAN lang="EN-US">UTF-8</SPAN>）。但这些标记是基于什么标准呢？<SPAN lang="EN-US"></SPAN></SPAN></P>  <P style="TEXT-ALIGN: left; MARGIN: 0cm 0cm 0pt; mso-pagination: widow-orphan;" align="left"><SPAN style="FONT-FAMILY: 宋体; FONT-SIZE: 12pt; mso-bidi-font-family: 宋体; mso-font-kerning: 0pt;">问题二：<SPAN lang="EN-US"></SPAN></SPAN></P>  <P style="TEXT-ALIGN: left; MARGIN: 0cm 0cm 0pt 36pt; mso-pagination: widow-orphan;" align="left"><SPAN style="FONT-FAMILY: 宋体; FONT-SIZE: 12pt; mso-bidi-font-family: 宋体; mso-font-kerning: 0pt;">最近在网上看到一个<SPAN lang="EN-US">ConvertUTF.c</SPAN>，实现了<SPAN lang="EN-US">UTF-32</SPAN>、<SPAN lang="EN-US">UTF-16</SPAN>和<SPAN lang="EN-US">UTF-8</SPAN>这三种编码方式的相互转换。对于<SPAN lang="EN-US"> Unicode(UCS2)</SPAN>、<SPAN lang="EN-US">GBK</SPAN>、<SPAN lang="EN-US">UTF-8</SPAN>这些编码方式，我原来就了解。但这个程序让我有些糊涂，想不起来<SPAN lang="EN-US">UTF-16</SPAN>和<SPAN lang="EN-US">UCS2</SPAN>有什么关系。<SPAN lang="EN-US"></SPAN></SPAN></P>  <P style="TEXT-ALIGN: left; MARGIN: 0cm 0cm 0pt; mso-margin-top-alt: auto; mso-margin-bottom-alt: auto; mso-pagination: widow-orphan;" align="left"><SPAN style="FONT-FAMILY: 宋体; FONT-SIZE: 12pt; mso-bidi-font-family: 宋体; mso-font-kerning: 0pt;">查了查相关资料，总算将这些问题弄清楚了，顺带也了解了一些<SPAN lang="EN-US">Unicode</SPAN>的细节。写成一篇文章，送给有过类似疑问的朋友。本文在写作时尽量做到通俗易懂，但要求读者知道什么是字节，什么是十六进制。</SPAN></P>  <P style="TEXT-ALIGN: left; MARGIN: 0cm 0cm 0pt; mso-margin-top-alt: auto; mso-margin-bottom-alt: auto; mso-pagination: widow-orphan;" align="left"><SPAN style="FONT-FAMILY: 宋体; FONT-SIZE: 12pt; mso-bidi-font-family: 宋体; mso-font-kerning: 0pt;"><SPAN lang="EN-US"></SPAN></SPAN>&nbsp;</P>  <P style="TEXT-ALIGN: left; MARGIN: 0cm 0cm 0pt; mso-margin-top-alt: auto; mso-margin-bottom-alt: auto; mso-pagination: widow-orphan; mso-outline-level: 3;" align="left"><B><SPAN style="FONT-FAMILY: 宋体; FONT-SIZE: 13.5pt; mso-bidi-font-family: 宋体; mso-font-kerning: 0pt;" lang="EN-US">0</SPAN></B><B><SPAN style="FONT-FAMILY: 宋体; FONT-SIZE: 13.5pt; mso-bidi-font-family: 宋体; mso-font-kerning: 0pt;">、<SPAN lang="EN-US">big endian</SPAN>和<SPAN lang="EN-US">little endian</SPAN></SPAN></B></P>  <P style="TEXT-ALIGN: left; MARGIN: 0cm 0cm 0pt; mso-margin-top-alt: auto; mso-margin-bottom-alt: auto; mso-pagination: widow-orphan;" align="left"><SPAN style="FONT-FAMILY: 宋体; FONT-SIZE: 12pt; mso-bidi-font-family: 宋体; mso-font-kerning: 0pt;" lang="EN-US">big endian</SPAN><SPAN style="FONT-FAMILY: 宋体; FONT-SIZE: 12pt; mso-bidi-font-family: 宋体; mso-font-kerning: 0pt;">和<SPAN lang="EN-US">little endian</SPAN>是<SPAN lang="EN-US">CPU</SPAN>处理多字节数的不同方式。例如<SPAN lang="EN-US">“</SPAN>汉<SPAN lang="EN-US">”</SPAN>字的<SPAN lang="EN-US">Unicode</SPAN>编码是<SPAN lang="EN-US">6C49</SPAN>。那么写到文件里时，究竟是将<SPAN lang="EN-US">6C</SPAN>写在前面，还是将<SPAN lang="EN-US">49</SPAN>写在前面？如果将<SPAN lang="EN-US">6C</SPAN>写在前面，就是<SPAN lang="EN-US">big endian</SPAN>。如果将<SPAN lang="EN-US">49</SPAN>写在前面，就是<SPAN lang="EN-US">little endian</SPAN>。<SPAN lang="EN-US"></SPAN></SPAN></P>  <P style="TEXT-ALIGN: left; MARGIN: 0cm 0cm 0pt; mso-margin-top-alt: auto; mso-margin-bottom-alt: auto; mso-pagination: widow-orphan;" align="left"><SPAN style="FONT-FAMILY: 宋体; FONT-SIZE: 12pt; mso-bidi-font-family: 宋体; mso-font-kerning: 0pt;" lang="EN-US">“endian”</SPAN><SPAN style="FONT-FAMILY: 宋体; FONT-SIZE: 12pt; mso-bidi-font-family: 宋体; mso-font-kerning: 0pt;">这个词出自《格列佛游记》。小人国的内战就源于吃鸡蛋时是究竟从大头<SPAN lang="EN-US">(Big-Endian)</SPAN>敲开还是从小头<SPAN lang="EN-US">(Little-Endian)</SPAN>敲开，由此曾发生过六次叛乱，一个皇帝送了命，另一个丢了王位。<SPAN lang="EN-US"></SPAN></SPAN></P>  <P style="TEXT-ALIGN: left; MARGIN: 0cm 0cm 0pt; mso-margin-top-alt: auto; mso-margin-bottom-alt: auto; mso-pagination: widow-orphan;" align="left"><SPAN style="FONT-FAMILY: 宋体; FONT-SIZE: 12pt; mso-bidi-font-family: 宋体; mso-font-kerning: 0pt;">我们一般将<SPAN lang="EN-US">endian</SPAN>翻译成<SPAN lang="EN-US">“</SPAN>字节序<SPAN lang="EN-US">”</SPAN>，将<SPAN lang="EN-US">big endian</SPAN>和<SPAN lang="EN-US">little endian</SPAN>称作<SPAN lang="EN-US">“</SPAN>大尾<SPAN lang="EN-US">”</SPAN>和<SPAN lang="EN-US">“</SPAN>小尾<SPAN lang="EN-US">”</SPAN></SPAN></P>  <P style="TEXT-ALIGN: left; MARGIN: 0cm 0cm 0pt; mso-margin-top-alt: auto; mso-margin-bottom-alt: auto; mso-pagination: widow-orphan;" align="left"><SPAN style="FONT-FAMILY: 宋体; FONT-SIZE: 12pt; mso-bidi-font-family: 宋体; mso-font-kerning: 0pt;"><SPAN lang="EN-US"></SPAN></SPAN>&nbsp;</P>  <P style="TEXT-ALIGN: left; MARGIN: 0cm 0cm 0pt; mso-margin-top-alt: auto; mso-margin-bottom-alt: auto; mso-pagination: widow-orphan; mso-outline-level: 3;" align="left"><B><SPAN style="FONT-FAMILY: 宋体; FONT-SIZE: 13.5pt; mso-bidi-font-family: 宋体; mso-font-kerning: 0pt;" lang="EN-US">1</SPAN></B><B><SPAN style="FONT-FAMILY: 宋体; FONT-SIZE: 13.5pt; mso-bidi-font-family: 宋体; mso-font-kerning: 0pt;">、字符编码、内码，顺带介绍汉字编码<SPAN lang="EN-US"></SPAN></SPAN></B></P>  <P style="TEXT-ALIGN: left; MARGIN: 0cm 0cm 0pt; mso-margin-top-alt: auto; mso-margin-bottom-alt: auto; mso-pagination: widow-orphan;" align="left"><SPAN style="FONT-FAMILY: 宋体; FONT-SIZE: 12pt; mso-bidi-font-family: 宋体; mso-font-kerning: 0pt;">字符必须编码后才能被计算机处理。计算机使用的缺省编码方式就是计算机的内码。早期的计算机使用<SPAN lang="EN-US">7</SPAN>位的<SPAN lang="EN-US">ASCII</SPAN>编码，为了处理汉字，程序员设计了用于简体中文的<SPAN lang="EN-US">GB2312</SPAN>和用于繁体中文的<SPAN lang="EN-US">big5</SPAN>。<SPAN lang="EN-US"></SPAN></SPAN></P>  <P style="TEXT-ALIGN: left; MARGIN: 0cm 0cm 0pt; mso-margin-top-alt: auto; mso-margin-bottom-alt: auto; mso-pagination: widow-orphan;" align="left"><SPAN style="FONT-FAMILY: 宋体; FONT-SIZE: 12pt; mso-bidi-font-family: 宋体; mso-font-kerning: 0pt;" lang="EN-US">GB2312(1980</SPAN><SPAN style="FONT-FAMILY: 宋体; FONT-SIZE: 12pt; mso-bidi-font-family: 宋体; mso-font-kerning: 0pt;">年<SPAN lang="EN-US">)</SPAN>一共收录了<SPAN lang="EN-US">7445</SPAN>个字符，包括<SPAN lang="EN-US">6763</SPAN>个汉字和<SPAN lang="EN-US">682</SPAN>个其它符号。汉字区的内码范围高字节从<SPAN lang="EN-US">B0-F7</SPAN>，低字节从<SPAN lang="EN-US">A1-FE</SPAN>，占用的码位是<SPAN lang="EN-US">72*94=6768</SPAN>。其中有<SPAN lang="EN-US">5</SPAN>个空位是<SPAN lang="EN-US">D7FA-D7FE</SPAN>。<SPAN lang="EN-US"></SPAN></SPAN></P>  <P style="TEXT-ALIGN: left; MARGIN: 0cm 0cm 0pt; mso-margin-top-alt: auto; mso-margin-bottom-alt: auto; mso-pagination: widow-orphan;" align="left"><SPAN style="FONT-FAMILY: 宋体; FONT-SIZE: 12pt; mso-bidi-font-family: 宋体; mso-font-kerning: 0pt;" lang="EN-US">GB2312</SPAN><SPAN style="FONT-FAMILY: 宋体; FONT-SIZE: 12pt; mso-bidi-font-family: 宋体; mso-font-kerning: 0pt;">支持的汉字太少。<SPAN lang="EN-US">1995</SPAN>年的汉字扩展规范<SPAN lang="EN-US">GBK1.0</SPAN>收录了<SPAN lang="EN-US">21886</SPAN>个符号，它分为汉字区和图形符号区。汉字区包括<SPAN lang="EN-US">21003</SPAN>个字符。<SPAN lang="EN-US"></SPAN></SPAN></P>  <P style="TEXT-ALIGN: left; MARGIN: 0cm 0cm 0pt; mso-margin-top-alt: auto; mso-margin-bottom-alt: auto; mso-pagination: widow-orphan;" align="left"><SPAN style="FONT-FAMILY: 宋体; FONT-SIZE: 12pt; mso-bidi-font-family: 宋体; mso-font-kerning: 0pt;">从<SPAN lang="EN-US">ASCII</SPAN>、<SPAN lang="EN-US">GB2312</SPAN>到<SPAN lang="EN-US">GBK</SPAN>，这些编码方法是向下兼容的，即同一个字符在这些方案中总是有相同的编码，后面的标准支持更多的字符。在这些编码中，英文和中文可以统一地处理。区分中文编码的方法是高字节的最高位不为<SPAN lang="EN-US">0</SPAN>。按照程序员的称呼，<SPAN lang="EN-US">GB2312</SPAN>、<SPAN lang="EN-US">GBK</SPAN>都属于双字节字符集<SPAN lang="EN-US"> (DBCS)</SPAN>。<SPAN lang="EN-US"></SPAN></SPAN></P>  <P style="TEXT-ALIGN: left; MARGIN: 0cm 0cm 0pt; mso-margin-top-alt: auto; mso-margin-bottom-alt: auto; mso-pagination: widow-orphan;" align="left"><SPAN style="FONT-FAMILY: 宋体; FONT-SIZE: 12pt; mso-bidi-font-family: 宋体; mso-font-kerning: 0pt;" lang="EN-US">2000</SPAN><SPAN style="FONT-FAMILY: 宋体; FONT-SIZE: 12pt; mso-bidi-font-family: 宋体; mso-font-kerning: 0pt;">年的<SPAN lang="EN-US">GB18030</SPAN>是取代<SPAN lang="EN-US">GBK1.0</SPAN>的正式国家标准。该标准收录了<SPAN lang="EN-US">27484</SPAN>个汉字，同时还收录了藏文、蒙文、维吾尔文等主要的少数民族文字。从汉字字汇上说，<SPAN lang="EN-US">GB18030</SPAN>在<SPAN lang="EN-US">GB13000.1</SPAN>的<SPAN lang="EN-US">20902</SPAN>个汉字的基础上增加了<SPAN lang="EN-US">CJK</SPAN>扩展<SPAN lang="EN-US">A</SPAN>的<SPAN lang="EN-US">6582</SPAN>个汉字（<SPAN lang="EN-US">Unicode</SPAN>码<SPAN lang="EN-US"> 0x3400-0x4db5</SPAN>），一共收录了<SPAN lang="EN-US">27484</SPAN>个汉字。<SPAN lang="EN-US"></SPAN></SPAN></P>  <P style="TEXT-ALIGN: left; MARGIN: 0cm 0cm 0pt; mso-margin-top-alt: auto; mso-margin-bottom-alt: auto; mso-pagination: widow-orphan;" align="left"><SPAN style="FONT-FAMILY: 宋体; FONT-SIZE: 12pt; mso-bidi-font-family: 宋体; mso-font-kerning: 0pt;" lang="EN-US">CJK</SPAN><SPAN style="FONT-FAMILY: 宋体; FONT-SIZE: 12pt; mso-bidi-font-family: 宋体; mso-font-kerning: 0pt;">就是中日韩的意思。<SPAN lang="EN-US">Unicode</SPAN>为了节省码位，将中日韩三国语言中的文字统一编码。<SPAN lang="EN-US">GB13000.1</SPAN>就是<SPAN lang="EN-US">ISO/IEC 10646-1</SPAN>的中文版，相当于<SPAN lang="EN-US">Unicode 1.1</SPAN>。<SPAN lang="EN-US"></SPAN></SPAN></P>  <P style="TEXT-ALIGN: left; MARGIN: 0cm 0cm 0pt; mso-margin-top-alt: auto; mso-margin-bottom-alt: auto; mso-pagination: widow-orphan;" align="left"><SPAN style="FONT-FAMILY: 宋体; FONT-SIZE: 12pt; mso-bidi-font-family: 宋体; mso-font-kerning: 0pt;" lang="EN-US">GB18030</SPAN><SPAN style="FONT-FAMILY: 宋体; FONT-SIZE: 12pt; mso-bidi-font-family: 宋体; mso-font-kerning: 0pt;">的编码采用单字节、双字节和<SPAN lang="EN-US">4</SPAN>字节方案。其中单字节、双字节和<SPAN lang="EN-US">GBK</SPAN>是完全兼容的。<SPAN lang="EN-US">4</SPAN>字节编码的码位就是收录了<SPAN lang="EN-US">CJK</SPAN>扩展<SPAN lang="EN-US">A</SPAN>的<SPAN lang="EN-US">6582</SPAN>个汉字。例如：<SPAN lang="EN-US">UCS</SPAN>的<SPAN lang="EN-US">0x3400</SPAN>在<SPAN lang="EN-US">GB18030</SPAN>中的编码应该是<SPAN lang="EN-US">8139EF30</SPAN>，<SPAN lang="EN-US">UCS</SPAN>的<SPAN lang="EN-US">0x3401</SPAN>在<SPAN lang="EN-US">GB18030</SPAN>中的编码应该是<SPAN lang="EN-US">8139EF31</SPAN>。<SPAN lang="EN-US"></SPAN></SPAN></P>  <P style="TEXT-ALIGN: left; MARGIN: 0cm 0cm 0pt; mso-margin-top-alt: auto; mso-margin-bottom-alt: auto; mso-pagination: widow-orphan;" align="left"><SPAN style="FONT-FAMILY: 宋体; FONT-SIZE: 12pt; mso-bidi-font-family: 宋体; mso-font-kerning: 0pt;">微软提供了<SPAN lang="EN-US">GB18030</SPAN>的升级包，但这个升级包只是提供了一套支持<SPAN lang="EN-US">CJK</SPAN>扩展<SPAN lang="EN-US">A</SPAN>的<SPAN lang="EN-US">6582</SPAN>个汉字的新字体：新宋体<SPAN lang="EN-US">-18030</SPAN>，并不改变内码。<SPAN lang="EN-US">Windows </SPAN>的内码仍然是<SPAN lang="EN-US">GBK</SPAN>。<SPAN lang="EN-US"></SPAN></SPAN></P>  <P style="TEXT-ALIGN: left; MARGIN: 0cm 0cm 0pt; mso-margin-top-alt: auto; mso-margin-bottom-alt: auto; mso-pagination: widow-orphan;" align="left"><SPAN style="FONT-FAMILY: 宋体; FONT-SIZE: 12pt; mso-bidi-font-family: 宋体; mso-font-kerning: 0pt;">这里还有一些细节：<SPAN lang="EN-US"></SPAN></SPAN></P>  <UL type="disc">  <LI style="TEXT-ALIGN: left; MARGIN: 0cm 0cm 0pt; mso-margin-top-alt: auto; mso-margin-bottom-alt: auto; mso-pagination: widow-orphan; mso-list: l0 level1 lfo1; tab-stops: list 36.0pt;"><SPAN style="FONT-FAMILY: 宋体; FONT-SIZE: 12pt; mso-bidi-font-family: 宋体; mso-font-kerning: 0pt;" lang="EN-US">GB2312</SPAN><SPAN style="FONT-FAMILY: 宋体; FONT-SIZE: 12pt; mso-bidi-font-family: 宋体; mso-font-kerning: 0pt;">的原文还是区位码，从区位码到内码，需要在高字节和低字节上分别加上<SPAN lang="EN-US">A0</SPAN>。<SPAN lang="EN-US"></SPAN></SPAN></LI>  <LI style="TEXT-ALIGN: left; MARGIN: 0cm 0cm 0pt; mso-margin-top-alt: auto; mso-margin-bottom-alt: auto; mso-pagination: widow-orphan; mso-list: l0 level1 lfo1; tab-stops: list 36.0pt;"><SPAN style="FONT-FAMILY: 宋体; FONT-SIZE: 12pt; mso-bidi-font-family: 宋体; mso-font-kerning: 0pt;">对于任何字符编码，编码单元的顺序是由编码方案指定的，与<SPAN lang="EN-US">endian</SPAN>无关。例如<SPAN lang="EN-US">GBK</SPAN>的编码单元是字节，用两个字节表示一个汉字。 这两个字节的顺序是固定的，不受<SPAN lang="EN-US">CPU</SPAN>字节序的影响。<SPAN lang="EN-US">UTF-16</SPAN>的编码单元是<SPAN lang="EN-US">word</SPAN>（双字节），<SPAN lang="EN-US">word</SPAN>之间的顺序是编码方案指定的，<SPAN lang="EN-US">word</SPAN>内部的字节排列才会受到<SPAN lang="EN-US">endian</SPAN>的影响。后面还会介绍<SPAN lang="EN-US">UTF-16</SPAN>。<SPAN lang="EN-US"></SPAN></SPAN></LI>  <LI style="TEXT-ALIGN: left; MARGIN: 0cm 0cm 0pt; mso-margin-top-alt: auto; mso-margin-bottom-alt: auto; mso-pagination: widow-orphan; mso-list: l0 level1 lfo1; tab-stops: list 36.0pt;"><SPAN style="FONT-FAMILY: 宋体; FONT-SIZE: 12pt; mso-bidi-font-family: 宋体; mso-font-kerning: 0pt;" lang="EN-US">GB2312</SPAN><SPAN style="FONT-FAMILY: 宋体; FONT-SIZE: 12pt; mso-bidi-font-family: 宋体; mso-font-kerning: 0pt;">的两个字节的最高位都是<SPAN lang="EN-US">1</SPAN>。但符合这个条件的码位只有<SPAN lang="EN-US">128*128=16384</SPAN>个。所以<SPAN lang="EN-US">GBK</SPAN>和<SPAN lang="EN-US">GB18030</SPAN>的低字节最高 位都可能不是<SPAN lang="EN-US">1</SPAN>。不过这不影响<SPAN lang="EN-US">DBCS</SPAN>字符流的解析：在读取<SPAN lang="EN-US">DBCS</SPAN>字符流时，只要遇到高位为<SPAN lang="EN-US">1</SPAN>的字节，就可以将下两个字节作为一个双字节编码，而不用管 低字节的高位是什么。</SPAN></LI></UL>  <P style="TEXT-ALIGN: left; MARGIN: 0cm 0cm 0pt; mso-margin-top-alt: auto; mso-margin-bottom-alt: auto; mso-pagination: widow-orphan; mso-list: l0 level1 lfo1; tab-stops: list 36.0pt;"><SPAN style="FONT-FAMILY: 宋体; FONT-SIZE: 12pt; mso-bidi-font-family: 宋体; mso-font-kerning: 0pt;"></SPAN>&nbsp;</P>  <P style="TEXT-ALIGN: left; MARGIN: 0cm 0cm 0pt; mso-margin-top-alt: auto; mso-margin-bottom-alt: auto; mso-pagination: widow-orphan; mso-outline-level: 3;" align="left"><B><SPAN style="FONT-FAMILY: 宋体; FONT-SIZE: 13.5pt; mso-bidi-font-family: 宋体; mso-font-kerning: 0pt;" lang="EN-US">2</SPAN></B><B><SPAN style="FONT-FAMILY: 宋体; FONT-SIZE: 13.5pt; mso-bidi-font-family: 宋体; mso-font-kerning: 0pt;">、<SPAN lang="EN-US">Unicode</SPAN>、<SPAN lang="EN-US">UCS</SPAN>和<SPAN lang="EN-US">UTF</SPAN></SPAN></B></P>  <P style="TEXT-ALIGN: left; MARGIN: 0cm 0cm 0pt; mso-margin-top-alt: auto; mso-margin-bottom-alt: auto; mso-pagination: widow-orphan;" align="left"><SPAN style="FONT-FAMILY: 宋体; FONT-SIZE: 12pt; mso-bidi-font-family: 宋体; mso-font-kerning: 0pt;">前面提到从<SPAN lang="EN-US">ASCII</SPAN>、<SPAN lang="EN-US">GB2312</SPAN>、<SPAN lang="EN-US">GBK</SPAN>到<SPAN lang="EN-US">GB18030</SPAN>的编码方法是向下兼容的。而<SPAN lang="EN-US">Unicode</SPAN>只与<SPAN lang="EN-US">ASCII</SPAN>兼容（更准确地说，是与<SPAN lang="EN-US">ISO-8859-1</SPAN>兼容），与<SPAN lang="EN-US">GB</SPAN>码不兼容。例如<SPAN lang="EN-US">“</SPAN>汉<SPAN lang="EN-US">”</SPAN>字的<SPAN lang="EN-US">Unicode</SPAN>编码是<SPAN lang="EN-US">6C49</SPAN>，而<SPAN lang="EN-US">GB</SPAN>码是<SPAN lang="EN-US">BABA</SPAN>。<SPAN lang="EN-US"></SPAN></SPAN></P>  <P style="TEXT-ALIGN: left; MARGIN: 0cm 0cm 0pt; mso-margin-top-alt: auto; mso-margin-bottom-alt: auto; mso-pagination: widow-orphan;" align="left"><SPAN style="FONT-FAMILY: 宋体; FONT-SIZE: 12pt; mso-bidi-font-family: 宋体; mso-font-kerning: 0pt;" lang="EN-US">Unicode</SPAN><SPAN style="FONT-FAMILY: 宋体; FONT-SIZE: 12pt; mso-bidi-font-family: 宋体; mso-font-kerning: 0pt;">也是一种字符编码方法，不过它是由国际组织设计，可以容纳全世界所有语言文字的编码方案。<SPAN lang="EN-US">Unicode</SPAN>的学名是<SPAN lang="EN-US">"Universal Multiple-Octet Coded Character Set"</SPAN>，简称为<SPAN lang="EN-US">UCS</SPAN>。<SPAN lang="EN-US">UCS</SPAN>可以看作是<SPAN lang="EN-US">"Unicode Character Set"</SPAN>的缩写。<SPAN lang="EN-US"></SPAN></SPAN></P>  <P style="TEXT-ALIGN: left; MARGIN: 0cm 0cm 0pt; mso-margin-top-alt: auto; mso-margin-bottom-alt: auto; mso-pagination: widow-orphan;" align="left"><SPAN style="FONT-FAMILY: 宋体; FONT-SIZE: 12pt; mso-bidi-font-family: 宋体; mso-font-kerning: 0pt;">根据维基百科全书<SPAN lang="EN-US">(http://zh.wikipedia.org/wiki/)</SPAN>的记载：历史上存在两个试图独立设计<SPAN lang="EN-US">Unicode</SPAN>的组织，即国际标准化组织（<SPAN lang="EN-US">ISO</SPAN>）和一个软件制造商的协会（<SPAN lang="EN-US">unicode.org</SPAN>）。<SPAN lang="EN-US">ISO</SPAN>开发了<SPAN lang="EN-US">ISO 10646</SPAN>项目，<SPAN lang="EN-US">Unicode</SPAN>协会开发了<SPAN lang="EN-US">Unicode</SPAN>项目。<SPAN lang="EN-US"></SPAN></SPAN></P>  <P style="TEXT-ALIGN: left; MARGIN: 0cm 0cm 0pt; mso-margin-top-alt: auto; mso-margin-bottom-alt: auto; mso-pagination: widow-orphan;" align="left"><SPAN style="FONT-FAMILY: 宋体; FONT-SIZE: 12pt; mso-bidi-font-family: 宋体; mso-font-kerning: 0pt;">在<SPAN lang="EN-US">1991</SPAN>年前后，双方都认识到世界不需要两个不兼容的字符集。于是它们开始合并双方的工作成果，并为创立一个单一编码表而协同工作。从<SPAN lang="EN-US">Unicode2.0</SPAN>开始，<SPAN lang="EN-US">Unicode</SPAN>项目采用了与<SPAN lang="EN-US">ISO 10646-1</SPAN>相同的字库和字码。<SPAN lang="EN-US"></SPAN></SPAN></P>  <P style="TEXT-ALIGN: left; MARGIN: 0cm 0cm 0pt; mso-margin-top-alt: auto; mso-margin-bottom-alt: auto; mso-pagination: widow-orphan;" align="left"><SPAN style="FONT-FAMILY: 宋体; FONT-SIZE: 12pt; mso-bidi-font-family: 宋体; mso-font-kerning: 0pt;">目前两个项目仍都存在，并独立地公布各自的标准。<SPAN lang="EN-US">Unicode</SPAN>协会现在的最新版本是<SPAN lang="EN-US">2005</SPAN>年的<SPAN lang="EN-US">Unicode 4.1.0</SPAN>。<SPAN lang="EN-US">ISO</SPAN>的最新标准是<SPAN lang="EN-US">ISO 10646-3:2003</SPAN>。<SPAN lang="EN-US"></SPAN></SPAN></P>  <P style="TEXT-ALIGN: left; MARGIN: 0cm 0cm 0pt; mso-margin-top-alt: auto; mso-margin-bottom-alt: auto; mso-pagination: widow-orphan;" align="left"><SPAN style="FONT-FAMILY: 宋体; FONT-SIZE: 12pt; mso-bidi-font-family: 宋体; mso-font-kerning: 0pt;" lang="EN-US">UCS</SPAN><SPAN style="FONT-FAMILY: 宋体; FONT-SIZE: 12pt; mso-bidi-font-family: 宋体; mso-font-kerning: 0pt;">只是规定如何编码，并没有规定如何传输、保存这个编码。例如<SPAN lang="EN-US">“</SPAN>汉<SPAN lang="EN-US">”</SPAN>字的<SPAN lang="EN-US">UCS</SPAN>编码是<SPAN lang="EN-US">6C49</SPAN>，我可以用<SPAN lang="EN-US">4</SPAN>个<SPAN lang="EN-US">ascii</SPAN>数字来传输、保存这个编码；也可以用<SPAN lang="EN-US">utf-8</SPAN>编码<SPAN lang="EN-US">:3</SPAN>个连续的字节<SPAN lang="EN-US">E6 B1 89</SPAN>来表示它。关键在于通信双方都要认可。<SPAN lang="EN-US">UTF-8</SPAN>、<SPAN lang="EN-US">UTF-7</SPAN>、<SPAN lang="EN-US">UTF-16</SPAN>都是被广泛接受的方案。<SPAN lang="EN-US">UTF-8</SPAN>的一个特别的好处是它与<SPAN lang="EN-US">ISO-8859-1</SPAN>完全兼容。<SPAN lang="EN-US">UTF</SPAN>是<SPAN lang="EN-US">“UCS Transformation Format”</SPAN>的缩写。<SPAN lang="EN-US"></SPAN></SPAN></P>  <P style="TEXT-ALIGN: left; MARGIN: 0cm 0cm 0pt; mso-margin-top-alt: auto; mso-margin-bottom-alt: auto; mso-pagination: widow-orphan;" align="left"><SPAN style="FONT-FAMILY: 宋体; FONT-SIZE: 12pt; mso-bidi-font-family: 宋体; mso-font-kerning: 0pt;" lang="EN-US">IETF</SPAN><SPAN style="FONT-FAMILY: 宋体; FONT-SIZE: 12pt; mso-bidi-font-family: 宋体; mso-font-kerning: 0pt;">的<SPAN lang="EN-US">RFC2781</SPAN>和<SPAN lang="EN-US">RFC3629</SPAN>以<SPAN lang="EN-US">RFC</SPAN>的一贯风格，清晰、明快又不失严谨地描述了<SPAN lang="EN-US">UTF-16</SPAN>和<SPAN lang="EN-US">UTF-8</SPAN>的编码方法。我总是记不得<SPAN lang="EN-US">IETF</SPAN>是<SPAN lang="EN-US">Internet Engineering Task Force</SPAN>的缩写。但<SPAN lang="EN-US">IETF</SPAN>负责维护的<SPAN lang="EN-US">RFC</SPAN>是<SPAN lang="EN-US">Internet</SPAN>上一切规范的基础。</SPAN></P>  <P style="TEXT-ALIGN: left; MARGIN: 0cm 0cm 0pt; mso-margin-top-alt: auto; mso-margin-bottom-alt: auto; mso-pagination: widow-orphan;" align="left"><SPAN style="FONT-FAMILY: 宋体; FONT-SIZE: 12pt; mso-bidi-font-family: 宋体; mso-font-kerning: 0pt;"><SPAN lang="EN-US"></SPAN></SPAN>&nbsp;</P>  <P style="TEXT-ALIGN: left; MARGIN: 0cm 0cm 0pt; mso-margin-top-alt: auto; mso-margin-bottom-alt: auto; mso-pagination: widow-orphan; mso-outline-level: 4;" align="left"><B><SPAN style="FONT-FAMILY: 宋体; FONT-SIZE: 12pt; mso-bidi-font-family: 宋体; mso-font-kerning: 0pt;" lang="EN-US">2.1</SPAN></B><B><SPAN style="FONT-FAMILY: 宋体; FONT-SIZE: 12pt; mso-bidi-font-family: 宋体; mso-font-kerning: 0pt;">、内码和<SPAN lang="EN-US">code page</SPAN></SPAN></B></P>  <P style="TEXT-ALIGN: left; MARGIN: 0cm 0cm 0pt; mso-margin-top-alt: auto; mso-margin-bottom-alt: auto; mso-pagination: widow-orphan;" align="left"><SPAN style="FONT-FAMILY: 宋体; FONT-SIZE: 12pt; mso-bidi-font-family: 宋体; mso-font-kerning: 0pt;">目前<SPAN lang="EN-US">Windows</SPAN>的内核已经支持<SPAN lang="EN-US">Unicode</SPAN>字符集，这样在内核上可以支持全世界所有的语言文字。但是由于现有的大量程序和文档都采用了某种特定语言的编码，例如<SPAN lang="EN-US">GBK</SPAN>，<SPAN lang="EN-US">Windows</SPAN>不可能不支持现有的编码，而全部改用<SPAN lang="EN-US">Unicode</SPAN>。<SPAN lang="EN-US"></SPAN></SPAN></P>  <P style="TEXT-ALIGN: left; MARGIN: 0cm 0cm 0pt; mso-margin-top-alt: auto; mso-margin-bottom-alt: auto; mso-pagination: widow-orphan;" align="left"><SPAN style="FONT-FAMILY: 宋体; FONT-SIZE: 12pt; mso-bidi-font-family: 宋体; mso-font-kerning: 0pt;" lang="EN-US">Windows</SPAN><SPAN style="FONT-FAMILY: 宋体; FONT-SIZE: 12pt; mso-bidi-font-family: 宋体; mso-font-kerning: 0pt;">使用代码页<SPAN lang="EN-US">(code page)</SPAN>来适应各个国家和地区。<SPAN lang="EN-US">code page</SPAN>可以被理解为前面提到的内码。<SPAN lang="EN-US">GBK</SPAN>对应的<SPAN lang="EN-US">code page</SPAN>是<SPAN lang="EN-US">CP936</SPAN>。微软也为<SPAN lang="EN-US">GB18030</SPAN>定义了<SPAN lang="EN-US">code page</SPAN>：<SPAN lang="EN-US">CP54936</SPAN>。</SPAN></P>  <P style="TEXT-ALIGN: left; MARGIN: 0cm 0cm 0pt; mso-margin-top-alt: auto; mso-margin-bottom-alt: auto; mso-pagination: widow-orphan;" align="left"><SPAN style="FONT-FAMILY: 宋体; FONT-SIZE: 12pt; mso-bidi-font-family: 宋体; mso-font-kerning: 0pt;"><SPAN lang="EN-US"></SPAN></SPAN>&nbsp;</P>  <P style="TEXT-ALIGN: left; MARGIN: 0cm 0cm 0pt; mso-margin-top-alt: auto; mso-margin-bottom-alt: auto; mso-pagination: widow-orphan; mso-outline-level: 3;" align="left"><B><SPAN style="FONT-FAMILY: 宋体; FONT-SIZE: 13.5pt; mso-bidi-font-family: 宋体; mso-font-kerning: 0pt;" lang="EN-US">3</SPAN></B><B><SPAN style="FONT-FAMILY: 宋体; FONT-SIZE: 13.5pt; mso-bidi-font-family: 宋体; mso-font-kerning: 0pt;">、<SPAN lang="EN-US">UCS-2</SPAN>、<SPAN lang="EN-US">UCS-4</SPAN>、<SPAN lang="EN-US">BMP</SPAN></SPAN></B></P>  <P style="TEXT-ALIGN: left; MARGIN: 0cm 0cm 0pt; mso-margin-top-alt: auto; mso-margin-bottom-alt: auto; mso-pagination: widow-orphan;" align="left"><SPAN style="FONT-FAMILY: 宋体; FONT-SIZE: 12pt; mso-bidi-font-family: 宋体; mso-font-kerning: 0pt;" lang="EN-US">UCS</SPAN><SPAN style="FONT-FAMILY: 宋体; FONT-SIZE: 12pt; mso-bidi-font-family: 宋体; mso-font-kerning: 0pt;">有两种格式：<SPAN lang="EN-US">UCS-2</SPAN>和<SPAN lang="EN-US">UCS-4</SPAN>。顾名思义，<SPAN lang="EN-US">UCS-2</SPAN>就是用两个字节编码，<SPAN lang="EN-US">UCS-4</SPAN>就是用<SPAN lang="EN-US">4</SPAN>个字节（实际上只用了<SPAN lang="EN-US">31</SPAN>位，最高位必须为<SPAN lang="EN-US">0</SPAN>）编码。下面让我们做一些简单的数学游戏：<SPAN lang="EN-US"></SPAN></SPAN></P>  <P style="TEXT-ALIGN: left; MARGIN: 0cm 0cm 0pt; mso-margin-top-alt: auto; mso-margin-bottom-alt: auto; mso-pagination: widow-orphan;" align="left"><SPAN style="FONT-FAMILY: 宋体; FONT-SIZE: 12pt; mso-bidi-font-family: 宋体; mso-font-kerning: 0pt;" lang="EN-US">UCS-2</SPAN><SPAN style="FONT-FAMILY: 宋体; FONT-SIZE: 12pt; mso-bidi-font-family: 宋体; mso-font-kerning: 0pt;">有<SPAN lang="EN-US">2^16=65536</SPAN>个码位，<SPAN lang="EN-US">UCS-4</SPAN>有<SPAN lang="EN-US">2^31=2147483648</SPAN>个码位。<SPAN lang="EN-US"></SPAN></SPAN></P>  <P style="TEXT-ALIGN: left; MARGIN: 0cm 0cm 0pt; mso-margin-top-alt: auto; mso-margin-bottom-alt: auto; mso-pagination: widow-orphan;" align="left"><SPAN style="FONT-FAMILY: 宋体; FONT-SIZE: 12pt; mso-bidi-font-family: 宋体; mso-font-kerning: 0pt;" lang="EN-US">UCS-4</SPAN><SPAN style="FONT-FAMILY: 宋体; FONT-SIZE: 12pt; mso-bidi-font-family: 宋体; mso-font-kerning: 0pt;">根据最高位为<SPAN lang="EN-US">0</SPAN>的最高字节分成<SPAN lang="EN-US">2^7=128</SPAN>个<SPAN lang="EN-US">group</SPAN>。每个<SPAN lang="EN-US">group</SPAN>再根据次高字节分为<SPAN lang="EN-US">256</SPAN>个<SPAN lang="EN-US">plane</SPAN>。每个<SPAN lang="EN-US">plane</SPAN>根据第<SPAN lang="EN-US">3</SPAN>个字节分为<SPAN lang="EN-US">256</SPAN>行<SPAN lang="EN-US"> (rows)</SPAN>，每行包含<SPAN lang="EN-US">256</SPAN>个<SPAN lang="EN-US">cells</SPAN>。当然同一行的<SPAN lang="EN-US">cells</SPAN>只是最后一个字节不同，其余都相同。<SPAN lang="EN-US"></SPAN></SPAN></P>  <P style="TEXT-ALIGN: left; MARGIN: 0cm 0cm 0pt; mso-margin-top-alt: auto; mso-margin-bottom-alt: auto; mso-pagination: widow-orphan;" align="left"><SPAN style="FONT-FAMILY: 宋体; FONT-SIZE: 12pt; mso-bidi-font-family: 宋体; mso-font-kerning: 0pt;" lang="EN-US">group 0</SPAN><SPAN style="FONT-FAMILY: 宋体; FONT-SIZE: 12pt; mso-bidi-font-family: 宋体; mso-font-kerning: 0pt;">的<SPAN lang="EN-US">plane 0</SPAN>被称作<SPAN lang="EN-US">Basic Multilingual Plane, </SPAN>即<SPAN lang="EN-US">BMP</SPAN>。或者说<SPAN lang="EN-US">UCS-4</SPAN>中，高两个字节为<SPAN lang="EN-US">0</SPAN>的码位被称作<SPAN lang="EN-US">BMP</SPAN>。<SPAN lang="EN-US"></SPAN></SPAN></P>  <P style="TEXT-ALIGN: left; MARGIN: 0cm 0cm 0pt; mso-margin-top-alt: auto; mso-margin-bottom-alt: auto; mso-pagination: widow-orphan;" align="left"><SPAN style="FONT-FAMILY: 宋体; FONT-SIZE: 12pt; mso-bidi-font-family: 宋体; mso-font-kerning: 0pt;">将<SPAN lang="EN-US">UCS-4</SPAN>的<SPAN lang="EN-US">BMP</SPAN>去掉前面的两个零字节就得到了<SPAN lang="EN-US">UCS-2</SPAN>。在<SPAN lang="EN-US">UCS-2</SPAN>的两个字节前加上两个零字节，就得到了<SPAN lang="EN-US">UCS-4</SPAN>的<SPAN lang="EN-US">BMP</SPAN>。而目前的<SPAN lang="EN-US">UCS-4</SPAN>规范中还没有任何字符被分配在<SPAN lang="EN-US">BMP</SPAN>之外。</SPAN></P>  <P style="TEXT-ALIGN: left; MARGIN: 0cm 0cm 0pt; mso-margin-top-alt: auto; mso-margin-bottom-alt: auto; mso-pagination: widow-orphan;" align="left"><SPAN style="FONT-FAMILY: 宋体; FONT-SIZE: 12pt; mso-bidi-font-family: 宋体; mso-font-kerning: 0pt;"><SPAN lang="EN-US"></SPAN></SPAN>&nbsp;</P>  <P style="TEXT-ALIGN: left; MARGIN: 0cm 0cm 0pt; mso-margin-top-alt: auto; mso-margin-bottom-alt: auto; mso-pagination: widow-orphan; mso-outline-level: 3;" align="left"><B><SPAN style="FONT-FAMILY: 宋体; FONT-SIZE: 13.5pt; mso-bidi-font-family: 宋体; mso-font-kerning: 0pt;" lang="EN-US">4</SPAN></B><B><SPAN style="FONT-FAMILY: 宋体; FONT-SIZE: 13.5pt; mso-bidi-font-family: 宋体; mso-font-kerning: 0pt;">、<SPAN lang="EN-US">UTF</SPAN>编码<SPAN lang="EN-US"></SPAN></SPAN></B></P>  <P style="TEXT-ALIGN: left; MARGIN: 0cm 0cm 0pt; mso-margin-top-alt: auto; mso-margin-bottom-alt: auto; mso-pagination: widow-orphan;" align="left"><SPAN style="FONT-FAMILY: 宋体; FONT-SIZE: 12pt; mso-bidi-font-family: 宋体; mso-font-kerning: 0pt;" lang="EN-US">UTF-8</SPAN><SPAN style="FONT-FAMILY: 宋体; FONT-SIZE: 12pt; mso-bidi-font-family: 宋体; mso-font-kerning: 0pt;">就是以<SPAN lang="EN-US">8</SPAN>位为单元对<SPAN lang="EN-US">UCS</SPAN>进行编码。从<SPAN lang="EN-US">UCS-2</SPAN>到<SPAN lang="EN-US">UTF-8</SPAN>的编码方式如下：<SPAN lang="EN-US"></SPAN></SPAN></P>  <TABLE style="WIDTH: 75%; mso-cellspacing: 1.5pt; mso-yfti-tbllook: 1184;" border="1" cellPadding="0" width="75%">  <TBODY>  <TR style="mso-yfti-irow: 0; mso-yfti-firstrow: yes;">  <TD style="BORDER-BOTTOM: #f0f0f0; BORDER-LEFT: #f0f0f0; PADDING-BOTTOM: 0.75pt; BACKGROUND-COLOR: transparent; PADDING-LEFT: 0.75pt; PADDING-RIGHT: 0.75pt; BORDER-TOP: #f0f0f0; BORDER-RIGHT: #f0f0f0; PADDING-TOP: 0.75pt;">  <P style="TEXT-ALIGN: left; MARGIN: 0cm 0cm 0pt; mso-pagination: widow-orphan;" align="left"><SPAN style="FONT-FAMILY: 宋体; FONT-SIZE: 12pt; mso-bidi-font-family: 宋体; mso-font-kerning: 0pt;" lang="EN-US">UCS-2</SPAN><SPAN style="FONT-FAMILY: 宋体; FONT-SIZE: 12pt; mso-bidi-font-family: 宋体; mso-font-kerning: 0pt;">编码<SPAN lang="EN-US">(16</SPAN>进制<SPAN lang="EN-US">)</SPAN></SPAN></P></TD>  <TD style="BORDER-BOTTOM: #f0f0f0; BORDER-LEFT: #f0f0f0; PADDING-BOTTOM: 0.75pt; BACKGROUND-COLOR: transparent; PADDING-LEFT: 0.75pt; PADDING-RIGHT: 0.75pt; BORDER-TOP: #f0f0f0; BORDER-RIGHT: #f0f0f0; PADDING-TOP: 0.75pt;">  <P style="TEXT-ALIGN: left; MARGIN: 0cm 0cm 0pt; mso-pagination: widow-orphan;" align="left"><SPAN style="FONT-FAMILY: 宋体; FONT-SIZE: 12pt; mso-bidi-font-family: 宋体; mso-font-kerning: 0pt;" lang="EN-US">UTF-8 </SPAN><SPAN style="FONT-FAMILY: 宋体; FONT-SIZE: 12pt; mso-bidi-font-family: 宋体; mso-font-kerning: 0pt;">字节流<SPAN lang="EN-US">(</SPAN>二进制<SPAN lang="EN-US">)</SPAN></SPAN></P></TD></TR>  <TR style="mso-yfti-irow: 1;">  <TD style="BORDER-BOTTOM: #f0f0f0; BORDER-LEFT: #f0f0f0; PADDING-BOTTOM: 0.75pt; BACKGROUND-COLOR: transparent; PADDING-LEFT: 0.75pt; PADDING-RIGHT: 0.75pt; BORDER-TOP: #f0f0f0; BORDER-RIGHT: #f0f0f0; PADDING-TOP: 0.75pt;">  <P style="TEXT-ALIGN: left; MARGIN: 0cm 0cm 0pt; mso-pagination: widow-orphan;" align="left"><SPAN style="FONT-FAMILY: 宋体; FONT-SIZE: 12pt; mso-bidi-font-family: 宋体; mso-font-kerning: 0pt;" lang="EN-US">0000 - 007F</SPAN></P></TD>  <TD style="BORDER-BOTTOM: #f0f0f0; BORDER-LEFT: #f0f0f0; PADDING-BOTTOM: 0.75pt; BACKGROUND-COLOR: transparent; PADDING-LEFT: 0.75pt; PADDING-RIGHT: 0.75pt; BORDER-TOP: #f0f0f0; BORDER-RIGHT: #f0f0f0; PADDING-TOP: 0.75pt;">  <P style="TEXT-ALIGN: left; MARGIN: 0cm 0cm 0pt; mso-pagination: widow-orphan;" align="left"><SPAN style="FONT-FAMILY: 宋体; FONT-SIZE: 12pt; mso-bidi-font-family: 宋体; mso-font-kerning: 0pt;" lang="EN-US">0xxxxxxx</SPAN></P></TD></TR>  <TR style="mso-yfti-irow: 2;">  <TD style="BORDER-BOTTOM: #f0f0f0; BORDER-LEFT: #f0f0f0; PADDING-BOTTOM: 0.75pt; BACKGROUND-COLOR: transparent; PADDING-LEFT: 0.75pt; PADDING-RIGHT: 0.75pt; BORDER-TOP: #f0f0f0; BORDER-RIGHT: #f0f0f0; PADDING-TOP: 0.75pt;">  <P style="TEXT-ALIGN: left; MARGIN: 0cm 0cm 0pt; mso-pagination: widow-orphan;" align="left"><SPAN style="FONT-FAMILY: 宋体; FONT-SIZE: 12pt; mso-bidi-font-family: 宋体; mso-font-kerning: 0pt;" lang="EN-US">0080 - 07FF</SPAN></P></TD>  <TD style="BORDER-BOTTOM: #f0f0f0; BORDER-LEFT: #f0f0f0; PADDING-BOTTOM: 0.75pt; BACKGROUND-COLOR: transparent; PADDING-LEFT: 0.75pt; PADDING-RIGHT: 0.75pt; BORDER-TOP: #f0f0f0; BORDER-RIGHT: #f0f0f0; PADDING-TOP: 0.75pt;">  <P style="TEXT-ALIGN: left; MARGIN: 0cm 0cm 0pt; mso-pagination: widow-orphan;" align="left"><SPAN style="FONT-FAMILY: 宋体; FONT-SIZE: 12pt; mso-bidi-font-family: 宋体; mso-font-kerning: 0pt;" lang="EN-US">110xxxxx 10xxxxxx</SPAN></P></TD></TR>  <TR style="mso-yfti-irow: 3; mso-yfti-lastrow: yes;">  <TD style="BORDER-BOTTOM: #f0f0f0; BORDER-LEFT: #f0f0f0; PADDING-BOTTOM: 0.75pt; BACKGROUND-COLOR: transparent; PADDING-LEFT: 0.75pt; PADDING-RIGHT: 0.75pt; BORDER-TOP: #f0f0f0; BORDER-RIGHT: #f0f0f0; PADDING-TOP: 0.75pt;">  <P style="TEXT-ALIGN: left; MARGIN: 0cm 0cm 0pt; mso-pagination: widow-orphan;" align="left"><SPAN style="FONT-FAMILY: 宋体; FONT-SIZE: 12pt; mso-bidi-font-family: 宋体; mso-font-kerning: 0pt;" lang="EN-US">0800 - FFFF</SPAN></P></TD>  <TD style="BORDER-BOTTOM: #f0f0f0; BORDER-LEFT: #f0f0f0; PADDING-BOTTOM: 0.75pt; BACKGROUND-COLOR: transparent; PADDING-LEFT: 0.75pt; PADDING-RIGHT: 0.75pt; BORDER-TOP: #f0f0f0; BORDER-RIGHT: #f0f0f0; PADDING-TOP: 0.75pt;">  <P style="TEXT-ALIGN: left; MARGIN: 0cm 0cm 0pt; mso-pagination: widow-orphan;" align="left"><SPAN style="FONT-FAMILY: 宋体; FONT-SIZE: 12pt; mso-bidi-font-family: 宋体; mso-font-kerning: 0pt;" lang="EN-US">1110xxxx 10xxxxxx 10xxxxxx</SPAN></P></TD></TR></TABLE>  <P style="TEXT-ALIGN: left; MARGIN: 0cm 0cm 0pt; mso-margin-top-alt: auto; mso-margin-bottom-alt: auto; mso-pagination: widow-orphan;" align="left"><SPAN style="FONT-FAMILY: 宋体; FONT-SIZE: 12pt; mso-bidi-font-family: 宋体; mso-font-kerning: 0pt;">例如<SPAN lang="EN-US">“</SPAN>汉<SPAN lang="EN-US">”</SPAN>字的<SPAN lang="EN-US">Unicode</SPAN>编码是<SPAN lang="EN-US">6C49</SPAN>。<SPAN lang="EN-US">6C49</SPAN>在<SPAN lang="EN-US">0800-FFFF</SPAN>之间，所以肯定要用<SPAN lang="EN-US">3</SPAN>字节模板了：<SPAN style="COLOR: blue;" lang="EN-US">1110</SPAN><SPAN lang="EN-US">xxxx <SPAN style="COLOR: blue;">10</SPAN>xxxxxx <SPAN style="COLOR: blue;">10</SPAN>xxxxxx</SPAN>。将<SPAN lang="EN-US">6C49</SPAN>写成二进制是：<SPAN lang="EN-US">0110 110001 001001</SPAN>， 用这个比特流依次代替模板中的<SPAN lang="EN-US">x</SPAN>，得到：<SPAN style="COLOR: blue;" lang="EN-US">1110</SPAN><SPAN lang="EN-US">0110 <SPAN style="COLOR: blue;">10</SPAN>110001 <SPAN style="COLOR: blue;">10</SPAN>001001</SPAN>，即<SPAN lang="EN-US">E6 B1 89</SPAN>。<SPAN lang="EN-US"></SPAN></SPAN></P>  <P style="TEXT-ALIGN: left; MARGIN: 0cm 0cm 0pt; mso-margin-top-alt: auto; mso-margin-bottom-alt: auto; mso-pagination: widow-orphan;" align="left"><SPAN style="FONT-FAMILY: 宋体; FONT-SIZE: 12pt; mso-bidi-font-family: 宋体; mso-font-kerning: 0pt;">读者可以用记事本测试一下我们的编码是否正确。需要注意，<SPAN lang="EN-US">UltraEdit</SPAN>在打开<SPAN lang="EN-US">utf-8</SPAN>编码的文本文件时会自动转换为<SPAN lang="EN-US">UTF-16</SPAN>，可能产生混淆。你可以在设置中关掉这个选项。更好的工具是<SPAN lang="EN-US">Hex Workshop</SPAN>。<SPAN lang="EN-US"></SPAN></SPAN></P>  <P style="TEXT-ALIGN: left; MARGIN: 0cm 0cm 0pt; mso-margin-top-alt: auto; mso-margin-bottom-alt: auto; mso-pagination: widow-orphan;" align="left"><SPAN style="FONT-FAMILY: 宋体; FONT-SIZE: 12pt; mso-bidi-font-family: 宋体; mso-font-kerning: 0pt;" lang="EN-US">UTF-16</SPAN><SPAN style="FONT-FAMILY: 宋体; FONT-SIZE: 12pt; mso-bidi-font-family: 宋体; mso-font-kerning: 0pt;">以<SPAN lang="EN-US">16</SPAN>位为单元对<SPAN lang="EN-US">UCS</SPAN>进行编码。对于小于<SPAN lang="EN-US">0x10000</SPAN>的<SPAN lang="EN-US">UCS</SPAN>码，<SPAN lang="EN-US">UTF-16</SPAN>编码就等于<SPAN lang="EN-US">UCS</SPAN>码对应的<SPAN lang="EN-US">16</SPAN>位无符号整数。对于不小于<SPAN lang="EN-US">0x10000</SPAN>的<SPAN lang="EN-US">UCS</SPAN>码，定义了一个算法。不过由于实际使用的<SPAN lang="EN-US">UCS2</SPAN>，或者<SPAN lang="EN-US">UCS4</SPAN>的<SPAN lang="EN-US">BMP</SPAN>必然小于<SPAN lang="EN-US">0x10000</SPAN>，所以就目前而言，可以认为<SPAN lang="EN-US"> UTF-16</SPAN>和<SPAN lang="EN-US">UCS-2</SPAN>基本相同。但<SPAN lang="EN-US">UCS-2</SPAN>只是一个编码方案，<SPAN lang="EN-US">UTF-16</SPAN>却要用于实际的传输，所以就不得不考虑字节序的问题。</SPAN></P>  <P style="TEXT-ALIGN: left; MARGIN: 0cm 0cm 0pt; mso-margin-top-alt: auto; mso-margin-bottom-alt: auto; mso-pagination: widow-orphan;" align="left"><SPAN style="FONT-FAMILY: 宋体; FONT-SIZE: 12pt; mso-bidi-font-family: 宋体; mso-font-kerning: 0pt;"><SPAN lang="EN-US"></SPAN></SPAN>&nbsp;</P>  <P style="TEXT-ALIGN: left; MARGIN: 0cm 0cm 0pt; mso-margin-top-alt: auto; mso-margin-bottom-alt: auto; mso-pagination: widow-orphan; mso-outline-level: 3;" align="left"><B><SPAN style="FONT-FAMILY: 宋体; FONT-SIZE: 13.5pt; mso-bidi-font-family: 宋体; mso-font-kerning: 0pt;" lang="EN-US">5</SPAN></B><B><SPAN style="FONT-FAMILY: 宋体; FONT-SIZE: 13.5pt; mso-bidi-font-family: 宋体; mso-font-kerning: 0pt;">、<SPAN lang="EN-US">UTF</SPAN>的字节序和<SPAN lang="EN-US">BOM</SPAN></SPAN></B></P>  <P style="TEXT-ALIGN: left; MARGIN: 0cm 0cm 0pt; mso-margin-top-alt: auto; mso-margin-bottom-alt: auto; mso-pagination: widow-orphan;" align="left"><SPAN style="FONT-FAMILY: 宋体; FONT-SIZE: 12pt; mso-bidi-font-family: 宋体; mso-font-kerning: 0pt;" lang="EN-US">UTF-8</SPAN><SPAN style="FONT-FAMILY: 宋体; FONT-SIZE: 12pt; mso-bidi-font-family: 宋体; mso-font-kerning: 0pt;">以字节为编码单元，没有字节序的问题。<SPAN lang="EN-US">UTF-16</SPAN>以两个字节为编码单元，在解释一个<SPAN lang="EN-US">UTF-16</SPAN>文本前，首先要弄清楚每个编码单元的字节序。例如<SPAN lang="EN-US">“</SPAN>奎<SPAN lang="EN-US">”</SPAN>的<SPAN lang="EN-US">Unicode</SPAN>编码是<SPAN lang="EN-US">594E</SPAN>，<SPAN lang="EN-US">“</SPAN>乙<SPAN lang="EN-US">”</SPAN>的<SPAN lang="EN-US">Unicode</SPAN>编码是<SPAN lang="EN-US">4E59</SPAN>。如果我们收到<SPAN lang="EN-US">UTF-16</SPAN>字节流<SPAN lang="EN-US">“594E”</SPAN>，那么这是<SPAN lang="EN-US">“</SPAN>奎<SPAN lang="EN-US">” </SPAN>还是<SPAN lang="EN-US">“</SPAN>乙<SPAN lang="EN-US">”</SPAN>？<SPAN lang="EN-US"></SPAN></SPAN></P>  <P style="TEXT-ALIGN: left; MARGIN: 0cm 0cm 0pt; mso-margin-top-alt: auto; mso-margin-bottom-alt: auto; mso-pagination: widow-orphan;" align="left"><SPAN style="FONT-FAMILY: 宋体; FONT-SIZE: 12pt; mso-bidi-font-family: 宋体; mso-font-kerning: 0pt;" lang="EN-US">Unicode</SPAN><SPAN style="FONT-FAMILY: 宋体; FONT-SIZE: 12pt; mso-bidi-font-family: 宋体; mso-font-kerning: 0pt;">规范中推荐的标记字节顺序的方法是<SPAN lang="EN-US">BOM</SPAN>。<SPAN lang="EN-US">BOM</SPAN>不是<SPAN lang="EN-US">“Bill Of Material”</SPAN>的<SPAN lang="EN-US">BOM</SPAN>表，而是<SPAN lang="EN-US">Byte Order Mark</SPAN>。<SPAN lang="EN-US">BOM</SPAN>是一个有点小聪明的想法：<SPAN lang="EN-US"></SPAN></SPAN></P>  <P style="TEXT-ALIGN: left; MARGIN: 0cm 0cm 0pt; mso-margin-top-alt: auto; mso-margin-bottom-alt: auto; mso-pagination: widow-orphan;" align="left"><SPAN style="FONT-FAMILY: 宋体; FONT-SIZE: 12pt; mso-bidi-font-family: 宋体; mso-font-kerning: 0pt;">在<SPAN lang="EN-US">UCS</SPAN>编码中有一个叫做<SPAN lang="EN-US">"ZERO WIDTH NO-BREAK SPACE"</SPAN>的字符，它的编码是<SPAN lang="EN-US">FEFF</SPAN>。而<SPAN lang="EN-US">FFFE</SPAN>在<SPAN lang="EN-US">UCS</SPAN>中是不存在的字符，所以不应该出现在实际传输中。<SPAN lang="EN-US">UCS</SPAN>规范建议我们在传输字节流前，先传输字符<SPAN lang="EN-US">"ZERO WIDTH NO-BREAK SPACE"</SPAN>。<SPAN lang="EN-US"></SPAN></SPAN></P>  <P style="TEXT-ALIGN: left; MARGIN: 0cm 0cm 0pt; mso-margin-top-alt: auto; mso-margin-bottom-alt: auto; mso-pagination: widow-orphan;" align="left"><SPAN style="FONT-FAMILY: 宋体; FONT-SIZE: 12pt; mso-bidi-font-family: 宋体; mso-font-kerning: 0pt;">这样如果接收者收到<SPAN lang="EN-US">FEFF</SPAN>，就表明这个字节流是<SPAN lang="EN-US">Big-Endian</SPAN>的；如果收到<SPAN lang="EN-US">FFFE</SPAN>，就表明这个字节流是<SPAN lang="EN-US">Little-Endian</SPAN>的。因此字符<SPAN lang="EN-US">"ZERO WIDTH NO-BREAK SPACE"</SPAN>又被称作<SPAN lang="EN-US">BOM</SPAN>。<SPAN lang="EN-US"></SPAN></SPAN></P>  <P style="TEXT-ALIGN: left; MARGIN: 0cm 0cm 0pt; mso-margin-top-alt: auto; mso-margin-bottom-alt: auto; mso-pagination: widow-orphan;" align="left"><SPAN style="FONT-FAMILY: 宋体; FONT-SIZE: 12pt; mso-bidi-font-family: 宋体; mso-font-kerning: 0pt;" lang="EN-US">UTF-8</SPAN><SPAN style="FONT-FAMILY: 宋体; FONT-SIZE: 12pt; mso-bidi-font-family: 宋体; mso-font-kerning: 0pt;">不需要<SPAN lang="EN-US">BOM</SPAN>来表明字节顺序，但可以用<SPAN lang="EN-US">BOM</SPAN>来表明编码方式。字符<SPAN lang="EN-US">"ZERO WIDTH NO-BREAK SPACE"</SPAN>的<SPAN lang="EN-US">UTF-8</SPAN>编码是<SPAN lang="EN-US">EF BB BF</SPAN>（读者可以用我们前面介绍的编码方法验证一下）。所以如果接收者收到以<SPAN lang="EN-US">EF BB BF</SPAN>开头的字节流，就知道这是<SPAN lang="EN-US">UTF-8</SPAN>编码了。<SPAN lang="EN-US"></SPAN></SPAN></P>  <P style="TEXT-ALIGN: left; MARGIN: 0cm 0cm 0pt; mso-margin-top-alt: auto; mso-margin-bottom-alt: auto; mso-pagination: widow-orphan;" align="left"><SPAN style="FONT-FAMILY: 宋体; FONT-SIZE: 12pt; mso-bidi-font-family: 宋体; mso-font-kerning: 0pt;" lang="EN-US">Windows</SPAN><SPAN style="FONT-FAMILY: 宋体; FONT-SIZE: 12pt; mso-bidi-font-family: 宋体; mso-font-kerning: 0pt;">就是使用<SPAN lang="EN-US">BOM</SPAN>来标记文本文件的编码方式的。</SPAN></P>  <P style="TEXT-ALIGN: left; MARGIN: 0cm 0cm 0pt; mso-margin-top-alt: auto; mso-margin-bottom-alt: auto; mso-pagination: widow-orphan;" align="left"><SPAN style="FONT-FAMILY: 宋体; FONT-SIZE: 12pt; mso-bidi-font-family: 宋体; mso-font-kerning: 0pt;"><SPAN lang="EN-US"></SPAN></SPAN>&nbsp;</P>  <P style="TEXT-ALIGN: left; MARGIN: 0cm 0cm 0pt; mso-margin-top-alt: auto; mso-margin-bottom-alt: auto; mso-pagination: widow-orphan; mso-outline-level: 3;" align="left"><B><SPAN style="FONT-FAMILY: 宋体; FONT-SIZE: 13.5pt; mso-bidi-font-family: 宋体; mso-font-kerning: 0pt;" lang="EN-US">6</SPAN></B><B><SPAN style="FONT-FAMILY: 宋体; FONT-SIZE: 13.5pt; mso-bidi-font-family: 宋体; mso-font-kerning: 0pt;">、进一步的参考资料<SPAN lang="EN-US"></SPAN></SPAN></B></P>  <P style="TEXT-ALIGN: left; MARGIN: 0cm 0cm 0pt; mso-margin-top-alt: auto; mso-margin-bottom-alt: auto; mso-pagination: widow-orphan;" align="left"><SPAN style="FONT-FAMILY: 宋体; FONT-SIZE: 12pt; mso-bidi-font-family: 宋体; mso-font-kerning: 0pt;">本文主要参考的资料是<SPAN lang="EN-US"> "Short overview of ISO-IEC 10646 and Unicode" (http://www.nada.kth.se/i18n/ucs/unicode-iso10646-oview.html)</SPAN>。<SPAN lang="EN-US"></SPAN></SPAN></P>  <P style="TEXT-ALIGN: left; MARGIN: 0cm 0cm 0pt; mso-margin-top-alt: auto; mso-margin-bottom-alt: auto; mso-pagination: widow-orphan;" align="left"><SPAN style="FONT-FAMILY: 宋体; FONT-SIZE: 12pt; mso-bidi-font-family: 宋体; mso-font-kerning: 0pt;">我还找了两篇看上去不错的资料，不过因为我开始的疑问都找到了答案，所以就没有看：<SPAN lang="EN-US"></SPAN></SPAN></P>  <OL type="1">  <LI style="TEXT-ALIGN: left; MARGIN: 0cm 0cm 0pt; mso-margin-top-alt: auto; mso-margin-bottom-alt: auto; mso-pagination: widow-orphan; mso-list: l1 level1 lfo2; tab-stops: list 36.0pt;"><SPAN style="FONT-FAMILY: 宋体; FONT-SIZE: 12pt; mso-bidi-font-family: 宋体; mso-font-kerning: 0pt;" lang="EN-US">"Understanding Unicode A general introduction to the Unicode Standard" (http://scripts.sil.org/cms/scripts/page.php?site_id=nrsi&amp;item_id=IWS-Chapter04a)</SPAN></LI>  <LI style="TEXT-ALIGN: left; MARGIN: 0cm 0cm 0pt; mso-margin-top-alt: auto; mso-margin-bottom-alt: auto; mso-pagination: widow-orphan; mso-list: l1 level1 lfo2; tab-stops: list 36.0pt;"><SPAN style="FONT-FAMILY: 宋体; FONT-SIZE: 12pt; mso-bidi-font-family: 宋体; mso-font-kerning: 0pt;" lang="EN-US">"Character set encoding basics Understanding character set encodings and legacy encodings" (http://scripts.sil.org/cms/scripts/page.php?site_id=nrsi&amp;item_id=IWS-Chapter03)</SPAN></LI></OL>  <P style="TEXT-ALIGN: left; MARGIN: 0cm 0cm 0pt; mso-margin-top-alt: auto; mso-margin-bottom-alt: auto; mso-pagination: widow-orphan;" align="left"><SPAN style="FONT-FAMILY: 宋体; FONT-SIZE: 12pt; mso-bidi-font-family: 宋体; mso-font-kerning: 0pt;">我写过<SPAN lang="EN-US">UTF-8</SPAN>、<SPAN lang="EN-US">UCS-2</SPAN>、<SPAN lang="EN-US">GBK</SPAN>相互转换的软件包，包括使用<SPAN lang="EN-US">Windows API</SPAN>和不使用<SPAN lang="EN-US">Windows API</SPAN>的版本。以后有时间的话，我会整理一下放到我的个人主页上<SPAN lang="EN-US">(http://www.fmddlmyy.cn)</SPAN>。<SPAN lang="EN-US"></SPAN></SPAN></P>  <P style="TEXT-ALIGN: left; MARGIN: 0cm 0cm 0pt; mso-margin-top-alt: auto; mso-margin-bottom-alt: auto; mso-pagination: widow-orphan;" align="left"><SPAN style="FONT-FAMILY: 宋体; FONT-SIZE: 12pt; mso-bidi-font-family: 宋体; mso-font-kerning: 0pt;">我是想清楚所有问题后才开始写这篇文章的，原以为一会儿就能写好。没想到考虑措辞和查证细节花费了很长时间，竟然从下午<SPAN lang="EN-US">1:30</SPAN>写到<SPAN lang="EN-US">9:00</SPAN>。希望有读者能从中受益。</SPAN></P>  <P style="TEXT-ALIGN: left; MARGIN: 0cm 0cm 0pt; mso-margin-top-alt: auto; mso-margin-bottom-alt: auto; mso-pagination: widow-orphan;" align="left"><SPAN style="FONT-FAMILY: 宋体; FONT-SIZE: 12pt; mso-bidi-font-family: 宋体; mso-font-kerning: 0pt;"><SPAN lang="EN-US"></SPAN></SPAN>&nbsp;</P>  <P style="TEXT-ALIGN: left; MARGIN: 0cm 0cm 0pt; mso-margin-top-alt: auto; mso-margin-bottom-alt: auto; mso-pagination: widow-orphan; mso-outline-level: 3;" align="left"><B><SPAN style="FONT-FAMILY: 宋体; FONT-SIZE: 13.5pt; mso-bidi-font-family: 宋体; mso-font-kerning: 0pt;">附录<SPAN lang="EN-US">1 </SPAN>再说说区位码、<SPAN lang="EN-US">GB2312</SPAN>、内码和代码页<SPAN lang="EN-US"></SPAN></SPAN></B></P>  <P style="TEXT-ALIGN: left; MARGIN: 0cm 0cm 0pt; mso-margin-top-alt: auto; mso-margin-bottom-alt: auto; mso-pagination: widow-orphan;" align="left"><SPAN style="FONT-FAMILY: 宋体; FONT-SIZE: 12pt; mso-bidi-font-family: 宋体; mso-font-kerning: 0pt;">有的朋友对文章中这句话还有疑问：<SPAN lang="EN-US"><BR>“GB2312</SPAN>的原文还是区位码，从区位码到内码，需要在高字节和低字节上分别加上<SPAN lang="EN-US">A0</SPAN>。<SPAN lang="EN-US">”</SPAN></SPAN></P>  <P style="TEXT-ALIGN: left; MARGIN: 0cm 0cm 0pt; mso-margin-top-alt: auto; mso-margin-bottom-alt: auto; mso-pagination: widow-orphan;" align="left"><SPAN style="FONT-FAMILY: 宋体; FONT-SIZE: 12pt; mso-bidi-font-family: 宋体; mso-font-kerning: 0pt;">我再详细解释一下：<SPAN lang="EN-US"></SPAN></SPAN></P>  <P style="TEXT-ALIGN: left; MARGIN: 0cm 0cm 0pt; mso-margin-top-alt: auto; mso-margin-bottom-alt: auto; mso-pagination: widow-orphan;" align="left"><SPAN style="FONT-FAMILY: 宋体; FONT-SIZE: 12pt; mso-bidi-font-family: 宋体; mso-font-kerning: 0pt;" lang="EN-US">“GB2312</SPAN><SPAN style="FONT-FAMILY: 宋体; FONT-SIZE: 12pt; mso-bidi-font-family: 宋体; mso-font-kerning: 0pt;">的原文<SPAN lang="EN-US">”</SPAN>是指国家<SPAN lang="EN-US">1980</SPAN>年的一个标准《中华人民共和国国家标准信息交换用汉字编码字符集基本集<SPAN lang="EN-US"> GB 2312-80</SPAN>》。这个标准用两个数来编码汉字和中文符号。第一个数称为<SPAN lang="EN-US">“</SPAN>区<SPAN lang="EN-US">”</SPAN>，第二个数称为<SPAN lang="EN-US">“</SPAN>位<SPAN lang="EN-US">”</SPAN>。所以也称为区位码。<SPAN lang="EN-US">1-9</SPAN>区是中文符号，<SPAN lang="EN-US">16-55 </SPAN>区是一级汉字，<SPAN lang="EN-US">56-87</SPAN>区是二级汉字。现在<SPAN lang="EN-US">Windows</SPAN>也还有区位输入法，例如输入<SPAN lang="EN-US">1601</SPAN>得到<SPAN lang="EN-US">“</SPAN>啊<SPAN lang="EN-US">”</SPAN>。（这个区位输入法可以自动识别<SPAN lang="EN-US">16</SPAN>进制的<SPAN lang="EN-US"> GB2312</SPAN>和<SPAN lang="EN-US">10</SPAN>进制的区位码，也就是说输入<SPAN lang="EN-US">B0A1</SPAN>同样会得到<SPAN lang="EN-US">“</SPAN>啊<SPAN lang="EN-US">”</SPAN>。）<SPAN lang="EN-US"></SPAN></SPAN></P>  <P style="TEXT-ALIGN: left; MARGIN: 0cm 0cm 0pt; mso-margin-top-alt: auto; mso-margin-bottom-alt: auto; mso-pagination: widow-orphan;" align="left"><SPAN style="FONT-FAMILY: 宋体; FONT-SIZE: 12pt; mso-bidi-font-family: 宋体; mso-font-kerning: 0pt;">内码是指操作系统内部的字符编码。早期操作系统的内码是与语言相关的。现在的<SPAN lang="EN-US">Windows</SPAN>在系统内部支持<SPAN lang="EN-US">Unicode</SPAN>，然后用代码页适应各种语言，<SPAN lang="EN-US">“</SPAN>内码<SPAN lang="EN-US">”</SPAN>的概念就比较模糊了。微软一般将缺省代码页指定的编码说成是内码。<SPAN lang="EN-US"></SPAN></SPAN></P>  <P style="TEXT-ALIGN: left; MARGIN: 0cm 0cm 0pt; mso-margin-top-alt: auto; mso-margin-bottom-alt: auto; mso-pagination: widow-orphan;" align="left"><SPAN style="FONT-FAMILY: 宋体; FONT-SIZE: 12pt; mso-bidi-font-family: 宋体; mso-font-kerning: 0pt;">内码这个词汇，并没有什么官方的定义，代码页也只是微软这个公司的叫法。作为程序员，我们只要知道它们是什么东西，没有必要过多地考证这些名词。<SPAN lang="EN-US"></SPAN></SPAN></P>  <P style="TEXT-ALIGN: left; MARGIN: 0cm 0cm 0pt; mso-margin-top-alt: auto; mso-margin-bottom-alt: auto; mso-pagination: widow-orphan;" align="left"><SPAN style="FONT-FAMILY: 宋体; FONT-SIZE: 12pt; mso-bidi-font-family: 宋体; mso-font-kerning: 0pt;" lang="EN-US">Windows</SPAN><SPAN style="FONT-FAMILY: 宋体; FONT-SIZE: 12pt; mso-bidi-font-family: 宋体; mso-font-kerning: 0pt;">中有缺省代码页的概念，即缺省用什么编码来解释字符。例如<SPAN lang="EN-US">Windows</SPAN>的记事本打开了一个文本文件，里面的内容是字节流：<SPAN lang="EN-US">BA</SPAN>、<SPAN lang="EN-US">BA</SPAN>、<SPAN lang="EN-US">D7</SPAN>、<SPAN lang="EN-US">D6</SPAN>。<SPAN lang="EN-US">Windows</SPAN>应该去怎么解释它呢？<SPAN lang="EN-US"></SPAN></SPAN></P>  <P style="TEXT-ALIGN: left; MARGIN: 0cm 0cm 0pt; mso-margin-top-alt: auto; mso-margin-bottom-alt: auto; mso-pagination: widow-orphan;" align="left"><SPAN style="FONT-FAMILY: 宋体; FONT-SIZE: 12pt; mso-bidi-font-family: 宋体; mso-font-kerning: 0pt;">是按照<SPAN lang="EN-US">Unicode</SPAN>编码解释、还是按照<SPAN lang="EN-US">GBK</SPAN>解释、还是按照<SPAN lang="EN-US">BIG5</SPAN>解释，还是按照<SPAN lang="EN-US">ISO8859-1</SPAN>去解释？如果按<SPAN lang="EN-US">GBK</SPAN>去解释，就会得到<SPAN lang="EN-US">“</SPAN>汉 字<SPAN lang="EN-US">”</SPAN>两个字。按照其它编码解释，可能找不到对应的字符，也可能找到错误的字符。所谓<SPAN lang="EN-US">“</SPAN>错误<SPAN lang="EN-US">”</SPAN>是指与文本作者的本意不符，这时就产生了乱码。<SPAN lang="EN-US"></SPAN></SPAN></P>  <P style="TEXT-ALIGN: left; MARGIN: 0cm 0cm 0pt; mso-margin-top-alt: auto; mso-margin-bottom-alt: auto; mso-pagination: widow-orphan;" align="left"><SPAN style="FONT-FAMILY: 宋体; FONT-SIZE: 12pt; mso-bidi-font-family: 宋体; mso-font-kerning: 0pt;">答案是<SPAN lang="EN-US">Windows</SPAN>按照当前的缺省代码页去解释文本文件里的字节流。缺省代码页可以通过控制面板的区域选项设置。记事本的另存为中有一项<SPAN lang="EN-US">ANSI</SPAN>，其实就是按照缺省代码页的编码方法保存。<SPAN lang="EN-US"></SPAN></SPAN></P>  <P style="TEXT-ALIGN: left; MARGIN: 0cm 0cm 0pt; mso-margin-top-alt: auto; mso-margin-bottom-alt: auto; mso-pagination: widow-orphan;" align="left"><SPAN style="FONT-FAMILY: 宋体; FONT-SIZE: 12pt; mso-bidi-font-family: 宋体; mso-font-kerning: 0pt;" lang="EN-US">Windows</SPAN><SPAN style="FONT-FAMILY: 宋体; FONT-SIZE: 12pt; mso-bidi-font-family: 宋体; mso-font-kerning: 0pt;">的内码是<SPAN lang="EN-US">Unicode</SPAN>，它在技术上可以同时支持多个代码页。只要文件能说明自己使用什么编码，用户又安装了对应的代码页，<SPAN lang="EN-US">Windows</SPAN>就能正确显示，例如在<SPAN lang="EN-US">HTML</SPAN>文件中就可以指定<SPAN lang="EN-US">charset</SPAN>。<SPAN lang="EN-US"></SPAN></SPAN></P>  <P style="TEXT-ALIGN: left; MARGIN: 0cm 0cm 0pt; mso-margin-top-alt: auto; mso-margin-bottom-alt: auto; mso-pagination: widow-orphan;" align="left"><SPAN style="FONT-FAMILY: 宋体; FONT-SIZE: 12pt; mso-bidi-font-family: 宋体; mso-font-kerning: 0pt;">有的<SPAN lang="EN-US">HTML</SPAN>文件作者，特别是英文作者，认为世界上所有人都使用英文，在文件中不指定<SPAN lang="EN-US">charset</SPAN>。如果他使用了<SPAN lang="EN-US">0x80-0xff</SPAN>之间的字符， 中文<SPAN lang="EN-US">Windows</SPAN>又按照缺省的<SPAN lang="EN-US">GBK</SPAN>去解释，就会出现乱码。这时只要在这个<SPAN lang="EN-US">html</SPAN>文件中加上指定<SPAN lang="EN-US">charset</SPAN>的语句，例如：<SPAN lang="EN-US"><BR>&lt;meta http-equiv="Content-Type" content="text/html; charset=ISO8859-1"&gt;<BR></SPAN>如果原作者使用的代码页和<SPAN lang="EN-US">ISO8859-1</SPAN>兼容，就不会出现乱码了。<SPAN lang="EN-US"></SPAN></SPAN></P>  <P style="TEXT-ALIGN: left; MARGIN: 0cm 0cm 0pt; mso-margin-top-alt: auto; mso-margin-bottom-alt: auto; mso-pagination: widow-orphan;" align="left"><SPAN style="FONT-FAMILY: 宋体; FONT-SIZE: 12pt; mso-bidi-font-family: 宋体; mso-font-kerning: 0pt;">再说区位码，啊的区位码是<SPAN lang="EN-US">1601</SPAN>，写成<SPAN lang="EN-US">16</SPAN>进制是<SPAN lang="EN-US">0x10,0x01</SPAN>。这和计算机广泛使用的<SPAN lang="EN-US">ASCII</SPAN>编码冲突。为了兼容<SPAN lang="EN-US">00-7f</SPAN>的<SPAN lang="EN-US">ASCII </SPAN>编码，我们在区位码的高、低字节上分别加上<SPAN lang="EN-US">A0</SPAN>。这样<SPAN lang="EN-US">“</SPAN>啊<SPAN lang="EN-US">”</SPAN>的编码就成为<SPAN lang="EN-US">B0A1</SPAN>。我们将加过两个<SPAN lang="EN-US">A0</SPAN>的编码也称为<SPAN lang="EN-US">GB2312</SPAN>编码，虽然<SPAN lang="EN-US">GB2312</SPAN>的 原文根本没提到这一点。 <SPAN lang="EN-US"></SPAN></SPAN></P>
</body></html>