<html><head><meta http-equiv="Content-Type" content="text/html; charset=utf8"><title>163 blogs的博客：C++ 异常处理笔记（Visual C++）</title>
<style type="text/css">
a{color: #000000;text-decoration : none;font-size: 10pt;}
a:hover {color: red;text-decoration : underline;}
.replyBox{padding:4px;border:1px solid #D8D8D8;}
</style></head><body><h2>C++ 异常处理笔记（Visual C++）</h2>
<p align="right">发布时间：2010-12-20 23:14
<br>分类名称：SEH</p><br>
<p><span lang="EN-US" style="font-size:11.0pt;font-family:"Tahoma","sans-serif";">Visual
C++ </span><span style="font-size:11.0pt;font-family:宋体;mso-ascii-font-family: Tahoma;mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast; mso-hansi-font-family:Tahoma;mso-bidi-font-family:Tahoma;">支持</span><span lang="EN-US" style="font-size:11.0pt;font-family:"Tahoma","sans-serif";">3</span><span style="font-size:11.0pt;font-family:宋体;mso-ascii-font-family:Tahoma;mso-fareast-font-family: 宋体;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:Tahoma; mso-bidi-font-family:Tahoma;">种类型的异常处理：</span></p>

<p class="MsoListParagraph" style="margin-top:7.8pt;margin-right:0cm;margin-bottom: 0cm;margin-left:18.75pt;margin-bottom:.0001pt;mso-para-margin-top:.5gd; mso-para-margin-right:0cm;mso-para-margin-bottom:0cm;mso-para-margin-left:18.75pt; mso-para-margin-bottom:.0001pt;text-indent:-18.75pt;mso-char-indent-count:-1.7; mso-list:l0 level1 lfo1;"><b style="mso-bidi-font-weight: normal;"><span lang="EN-US" style="font-size:11.0pt;font-family:"Tahoma","sans-serif"; mso-fareast-font-family:Tahoma;"><span style="mso-list:Ignore;">1.<span style="font:7.0pt "Times New Roman";">&nbsp;&nbsp;&nbsp; </span></span></span></b><b style="mso-bidi-font-weight:normal;"><span lang="EN-US" style="font-size:11.0pt; font-family:"Tahoma","sans-serif";">C++ exception handling</span></b></p>

<p class="MsoListParagraph" style="margin-left:18.0pt;text-indent:0cm;mso-char-indent-count: 0;"><span lang="EN-US" style="font-size:11.0pt;font-family:"Tahoma","sans-serif";">C++</span><span style="font-size:11.0pt;font-family:宋体;mso-ascii-font-family:Tahoma;mso-fareast-font-family: 宋体;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:Tahoma; mso-bidi-font-family:Tahoma;">标准规范中指定的异常处理机制。</span><span lang="EN-US" style="font-size:11.0pt;font-family:"Tahoma","sans-serif";">C++</span><span style="font-size:11.0pt;font-family:宋体;mso-ascii-font-family:Tahoma;mso-fareast-font-family: 宋体;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:Tahoma; mso-bidi-font-family:Tahoma;">编程，使用该机制。</span><span lang="EN-US" style="font-size: 11.0pt;font-family:"Tahoma","sans-serif";"></span></p>

<p class="MsoListParagraph" style="margin-left:18.0pt;text-indent:0cm;mso-char-indent-count: 0;"><span style="font-size:11.0pt;font-family:宋体;mso-ascii-font-family:Tahoma; mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family: Tahoma;mso-bidi-font-family:Tahoma;">关键字：</span><span lang="EN-US" style="font-size:11.0pt;font-family:"Tahoma","sans-serif";">try, catch, throw</span></p>

<p class="MsoListParagraph" style="margin-top:7.8pt;margin-right:0cm;margin-bottom: 0cm;margin-left:18.75pt;margin-bottom:.0001pt;mso-para-margin-top:.5gd; mso-para-margin-right:0cm;mso-para-margin-bottom:0cm;mso-para-margin-left:18.75pt; mso-para-margin-bottom:.0001pt;text-indent:-18.75pt;mso-char-indent-count:-1.7; mso-list:l0 level1 lfo1;"><b style="mso-bidi-font-weight: normal;"><span lang="EN-US" style="font-size:11.0pt;font-family:"Tahoma","sans-serif"; mso-fareast-font-family:Tahoma;"><span style="mso-list:Ignore;">2.<span style="font:7.0pt "Times New Roman";">&nbsp;&nbsp;&nbsp; </span></span></span></b><b style="mso-bidi-font-weight:normal;"><span lang="EN-US" style="font-size:11.0pt; font-family:"Tahoma","sans-serif";">Structured exception handling</span></b></p>

<p class="MsoListParagraph" style="margin-left:18.0pt;text-indent:0cm;mso-char-indent-count: 0;"><span lang="EN-US" style="font-size:11.0pt;font-family:"Tahoma","sans-serif";">Windows
</span><span style="font-size:11.0pt;font-family:宋体;mso-ascii-font-family:Tahoma; mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family: Tahoma;mso-bidi-font-family:Tahoma;">特有的异常处理机制（</span><span lang="EN-US" style="font-size:11.0pt;font-family:"Tahoma","sans-serif";">SEH</span><span style="font-size:11.0pt;font-family:宋体;mso-ascii-font-family:Tahoma;mso-fareast-font-family: 宋体;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:Tahoma; mso-bidi-font-family:Tahoma;">）。</span><span lang="EN-US" style="font-size:11.0pt; font-family:"Tahoma","sans-serif";">It is not recommended for C++ or MFC
programming. Use SEH only in non-MFC C programs. </span></p>

<p class="MsoListParagraph" style="margin-left:18.0pt;text-indent:0cm;mso-char-indent-count: 0;"><span style="font-size:11.0pt;font-family:宋体;mso-ascii-font-family:Tahoma; mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family: Tahoma;mso-bidi-font-family:Tahoma;">关键字：</span><span lang="EN-US" style="font-size:11.0pt;font-family:"Tahoma","sans-serif";">__try, __except, __</span><span><span lang="EN-US" style="mso-bidi-font-size:10.0pt; font-family:"Tahoma","sans-serif";color:black;">leave, </span></span><span lang="EN-US" style="font-size:11.0pt;font-family:"Tahoma","sans-serif";">__Finally,
</span></p>

<p class="MsoListParagraph" style="margin-top:7.8pt;margin-right:0cm;margin-bottom: 0cm;margin-left:18.75pt;margin-bottom:.0001pt;mso-para-margin-top:.5gd; mso-para-margin-right:0cm;mso-para-margin-bottom:0cm;mso-para-margin-left:18.75pt; mso-para-margin-bottom:.0001pt;text-indent:-18.75pt;mso-char-indent-count:-1.7; mso-list:l0 level1 lfo1;"><b style="mso-bidi-font-weight: normal;"><span lang="EN-US" style="font-size:11.0pt;font-family:"Tahoma","sans-serif"; mso-fareast-font-family:Tahoma;"><span style="mso-list:Ignore;">3.<span style="font:7.0pt "Times New Roman";">&nbsp;&nbsp;&nbsp; </span></span></span></b><b style="mso-bidi-font-weight:normal;"><span lang="EN-US" style="font-size:11.0pt; font-family:"Tahoma","sans-serif";">MFC exception</span></b></p>

<p style="margin-left:17.9pt;"><span lang="EN-US" style="font-size:11.0pt;font-family:"Tahoma","sans-serif";">Since version 3.0,
MFC has used C++ exceptions but still supports its older exception handling
macros, which are similar to C++ exceptions in form. The older MFC exception
handling macros have been supported since version 1.0. Although these macros
are not recommended for new programming, they are still supported for backward
compatibility. In programs that already use the macros, you can freely use C++
exceptions as well. During preprocessing, the macros evaluate to the exception
handling keywords defined in the Visual C++ implementation of the C++ language
as of Visual C++ version 2.0. You can leave existing exception macros in place
while you begin to use C++ exceptions.</span></p>

<p style="margin-left:17.9pt;"><span lang="EN-US" style="font-size:11.0pt;font-family:"Tahoma","sans-serif";">MFC </span><span style="font-size:11.0pt;font-family:宋体;mso-ascii-font-family:Tahoma;mso-fareast-font-family: 宋体;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:Tahoma; mso-bidi-font-family:Tahoma;">使用的也就是</span><span lang="EN-US" style="font-size: 11.0pt;font-family:"Tahoma","sans-serif";">C++ exception handling.</span><span style="font-size:11.0pt;font-family:宋体;mso-ascii-font-family:Tahoma;mso-fareast-font-family: 宋体;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:Tahoma; mso-bidi-font-family:Tahoma;">只是</span><span lang="EN-US" style="font-size:11.0pt; font-family:"Tahoma","sans-serif";">MFC</span><span style="font-size:11.0pt; font-family:宋体;mso-ascii-font-family:Tahoma;mso-fareast-font-family:宋体; mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:Tahoma;mso-bidi-font-family: Tahoma;">历史悠久，比发明异常处理都久，所以第一代</span><span lang="EN-US" style="font-size:11.0pt; font-family:"Tahoma","sans-serif";">MFC</span><span style="font-size:11.0pt; font-family:宋体;mso-ascii-font-family:Tahoma;mso-fareast-font-family:宋体; mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:Tahoma;mso-bidi-font-family: Tahoma;">使用宏，自己来实现异常处理。</span><span lang="EN-US" style="font-size:11.0pt; font-family:"Tahoma","sans-serif";"></span></p>

<p><span lang="EN-US" style="font-size:11.0pt;font-family:"Tahoma","sans-serif";">&nbsp;</span></p>

<p><span lang="EN-US" style="font-size:11.0pt;font-family:"Tahoma","sans-serif";">Visual
C++ </span><span style="font-size:11.0pt;font-family:宋体;mso-ascii-font-family: Tahoma;mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast; mso-hansi-font-family:Tahoma;mso-bidi-font-family:Tahoma;">针对这俩张不同的异常处理，制定了两种模型：</span><span lang="EN-US" style="font-size:11.0pt;font-family:"Tahoma","sans-serif";"></span></p>

<p class="MsoListParagraph" style="margin-top:0cm;margin-right:0cm;margin-bottom: 7.8pt;margin-left:22.0pt;mso-para-margin-top:0cm;mso-para-margin-right:0cm; mso-para-margin-bottom:.5gd;mso-para-margin-left:22.0pt;text-indent:-22.0pt; mso-char-indent-count:-2.0;mso-list:l1 level1 lfo2;"><span lang="EN-US" style="font-size:11.0pt;font-family:Wingdings;mso-fareast-font-family: Wingdings;mso-bidi-font-family:Wingdings;"><span style="mso-list:Ignore;">n<span style="font:7.0pt "Times New Roman";">&nbsp; </span></span></span><span lang="EN-US" style="font-size:11.0pt;font-family:"Tahoma","sans-serif";">synchronous
exception handling model (C++ exception handling without structured exception
handling exceptions)</span></p>

<p class="MsoListParagraph" style="margin-left:21.0pt;text-indent:-21.0pt; mso-char-indent-count:0;mso-list:l1 level1 lfo2;"><span lang="EN-US" style="font-size:11.0pt;font-family:Wingdings;mso-fareast-font-family: Wingdings;mso-bidi-font-family:Wingdings;"><span style="mso-list:Ignore;">n<span style="font:7.0pt "Times New Roman";">&nbsp; </span></span></span><span lang="EN-US" style="font-size:11.0pt;font-family:"Tahoma","sans-serif";">asynchronous
exception handling model ((C++ exception handling with structured exception
handling exceptions)</span></p>

<p><span style="font-size:11.0pt;font-family:宋体;mso-ascii-font-family: Tahoma;mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast; mso-hansi-font-family:Tahoma;mso-bidi-font-family:Tahoma;">有编译选项：</span><span lang="EN-US" style="font-size:11.0pt;font-family:"Tahoma","sans-serif";">/EH{s|a}[c][-]
</span><span style="font-size:11.0pt;font-family:宋体;mso-ascii-font-family:Tahoma; mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family: Tahoma;mso-bidi-font-family:Tahoma;">来控制。</span><span lang="EN-US" style="font-size:11.0pt;font-family:"Tahoma","sans-serif";"></span></p>

<p><span lang="EN-US" style="font-size:11.0pt;font-family:"Tahoma","sans-serif";">&nbsp;</span></p>

<p><span style="font-size:11.0pt;font-family:宋体;mso-ascii-font-family: Tahoma;mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast; mso-hansi-font-family:Tahoma;mso-bidi-font-family:Tahoma;">然而同步模型在</span><span lang="EN-US" style="font-size:11.0pt;font-family:"Tahoma","sans-serif";">VC6 ~ VC
.NET 2003</span><span style="font-size:11.0pt;font-family:宋体;mso-ascii-font-family: Tahoma;mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast; mso-hansi-font-family:Tahoma;mso-bidi-font-family:Tahoma;">之间，存在</span><span lang="EN-US" style="font-size:11.0pt;font-family:"Tahoma","sans-serif";">Bug</span><span style="font-size:11.0pt;font-family:宋体;mso-ascii-font-family:Tahoma;mso-fareast-font-family: 宋体;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:Tahoma; mso-bidi-font-family:Tahoma;">，支持不完善，所以会出现在此模型中，可以获取</span><span lang="EN-US" style="font-size:11.0pt;font-family:"Tahoma","sans-serif";">SE</span><span style="font-size:11.0pt;font-family:宋体;mso-ascii-font-family:Tahoma;mso-fareast-font-family: 宋体;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:Tahoma; mso-bidi-font-family:Tahoma;">错误（系统级别的错误，不是</span><span lang="EN-US" style="font-size:11.0pt;font-family:"Tahoma","sans-serif";">throw</span><span style="font-size:11.0pt;font-family:宋体;mso-ascii-font-family:Tahoma;mso-fareast-font-family: 宋体;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:Tahoma; mso-bidi-font-family:Tahoma;">语句抛出的，比如说除零）。例如在没有被优化的代码中（如</span><span lang="EN-US" style="font-size:11.0pt;font-family:"Tahoma","sans-serif";">Debug</span><span style="font-size:11.0pt;font-family:宋体;mso-ascii-font-family:Tahoma;mso-fareast-font-family: 宋体;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:Tahoma; mso-bidi-font-family:Tahoma;">版本）或你编译的代码虽然被优化，但是优化器无法判断一段代码是否会抛出异常。例如</span><span lang="EN-US" style="font-size:11.0pt;font-family:"Tahoma","sans-serif";">VC5</span><span style="font-size:11.0pt;font-family:宋体;mso-ascii-font-family:Tahoma;mso-fareast-font-family: 宋体;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:Tahoma; mso-bidi-font-family:Tahoma;">中，如果在</span><span lang="EN-US" style="font-size: 11.0pt;font-family:"Tahoma","sans-serif";">try</span><span style="font-size: 11.0pt;font-family:宋体;mso-ascii-font-family:Tahoma;mso-fareast-font-family: 宋体;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:Tahoma; mso-bidi-font-family:Tahoma;">块中调用函数，那么编译器就断定此函数会抛出异常。而到了</span><span lang="EN-US" style="font-size:11.0pt;font-family:"Tahoma","sans-serif";">VC6</span><span style="font-size:11.0pt;font-family:宋体;mso-ascii-font-family:Tahoma;mso-fareast-font-family: 宋体;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:Tahoma; mso-bidi-font-family:Tahoma;">，如果这个函数在其他的</span><span lang="EN-US" style="font-size:11.0pt;font-family:"Tahoma","sans-serif";">cpp</span><span style="font-size:11.0pt;font-family:宋体;mso-ascii-font-family:Tahoma;mso-fareast-font-family: 宋体;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:Tahoma; mso-bidi-font-family:Tahoma;">文件中实现的，结果可能无法预料。到了</span><span lang="EN-US" style="font-size:11.0pt;font-family:"Tahoma","sans-serif";">VC .NET 2005</span><span style="font-size:11.0pt;font-family:宋体;mso-ascii-font-family:Tahoma;mso-fareast-font-family: 宋体;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:Tahoma; mso-bidi-font-family:Tahoma;">，就修正这个问题。</span><span lang="EN-US" style="font-size: 11.0pt;font-family:"Tahoma","sans-serif";"></span></p>

<p><span lang="EN-US" style="font-size:11.0pt;font-family:"Tahoma","sans-serif";">&nbsp;</span></p>

<p><span lang="EN-US" style="font-size:11.0pt;font-family:"Tahoma","sans-serif";">C++</span><span style="font-size:11.0pt;font-family:宋体;mso-ascii-font-family:Tahoma;mso-fareast-font-family: 宋体;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:Tahoma; mso-bidi-font-family:Tahoma;">异常和</span><span lang="EN-US" style="font-size:11.0pt; font-family:"Tahoma","sans-serif";">Win32</span><span style="font-size:11.0pt; font-family:宋体;mso-ascii-font-family:Tahoma;mso-fareast-font-family:宋体; mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:Tahoma;mso-bidi-font-family: Tahoma;">异常是俩个不同的异常。</span><span style="font-size:11.0pt;font-family:"Tahoma","sans-serif";">
</span><span style="font-size:11.0pt;font-family:宋体;mso-ascii-font-family:Tahoma; mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family: Tahoma;mso-bidi-font-family:Tahoma;">当可以同时获取系统异常和</span><span lang="EN-US" style="font-size:11.0pt;font-family:"Tahoma","sans-serif";">C++</span><span style="font-size:11.0pt;font-family:宋体;mso-ascii-font-family:Tahoma;mso-fareast-font-family: 宋体;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:Tahoma; mso-bidi-font-family:Tahoma;">异常时，会有些问题。</span><span lang="EN-US" style="font-size:11.0pt;font-family:"Tahoma","sans-serif";"></span></p>

<p class="MsoListParagraph" style="margin-top:7.8pt;margin-right:0cm;margin-bottom: 0cm;margin-left:18.7pt;margin-bottom:.0001pt;mso-para-margin-top:.5gd; mso-para-margin-right:0cm;mso-para-margin-bottom:0cm;mso-para-margin-left:18.7pt; mso-para-margin-bottom:.0001pt;text-indent:-18.7pt;mso-char-indent-count:-1.7; mso-list:l2 level1 lfo3;"><span lang="EN-US" style="font-size:11.0pt;font-family:"Tahoma","sans-serif";mso-fareast-font-family: Tahoma;"><span style="mso-list:Ignore;">1.<span style="font:7.0pt "Times New Roman";">&nbsp;&nbsp;&nbsp;
</span></span></span><span style="font-size:11.0pt;font-family:宋体; mso-ascii-font-family:Tahoma;mso-fareast-font-family:宋体;mso-fareast-theme-font: minor-fareast;mso-hansi-font-family:Tahoma;mso-bidi-font-family:Tahoma;">如果</span><span lang="EN-US" style="font-size:11.0pt;font-family:"Tahoma","sans-serif";">catch (…)</span><span style="font-size:11.0pt;font-family:宋体;mso-ascii-font-family:Tahoma;mso-fareast-font-family: 宋体;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:Tahoma; mso-bidi-font-family:Tahoma;">可以捕获</span><span lang="EN-US" style="font-size:11.0pt; font-family:"Tahoma","sans-serif";">SEs</span><span style="font-size:11.0pt; font-family:宋体;mso-ascii-font-family:Tahoma;mso-fareast-font-family:宋体; mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:Tahoma;mso-bidi-font-family: Tahoma;">，下面的代码中：</span><span lang="EN-US" style="font-size:11.0pt;font-family: "Tahoma","sans-serif";"></span></p>

<p class="MsoListParagraph" style="margin-left:18.0pt;text-indent:0cm;mso-char-indent-count: 0;"><span lang="EN-US" style="font-size:11.0pt;font-family:"Tahoma","sans-serif";"><span style="mso-spacerun:yes;">&nbsp;</span>// Begin exception-free code</span></p>

<p class="MsoListParagraph" style="margin-left:18.0pt;text-indent:0cm;mso-char-indent-count: 0;"><span lang="EN-US" style="font-size:11.0pt;font-family:"Tahoma","sans-serif";"><span style="mso-spacerun:yes;">&nbsp;</span>... Update critical data structure</span></p>

<p class="MsoListParagraph" style="margin-left:18.0pt;text-indent:0cm;mso-char-indent-count: 0;"><span lang="EN-US" style="font-size:11.0pt;font-family:"Tahoma","sans-serif";"><span style="mso-spacerun:yes;">&nbsp;</span>// End exception-free code</span></p>

<p class="MsoListParagraph" style="margin-left:18.0pt;text-indent:0cm;mso-char-indent-count: 0;"><span lang="EN-US" style="font-size:11.0pt;font-family:"Tahoma","sans-serif";">catch
(…) </span><span style="font-size:11.0pt;font-family:宋体;mso-ascii-font-family: Tahoma;mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast; mso-hansi-font-family:Tahoma;mso-bidi-font-family:Tahoma;">语句捕获到</span><span lang="EN-US" style="font-size:11.0pt;font-family:"Tahoma","sans-serif";">SE</span><span style="font-size:11.0pt;font-family:宋体;mso-ascii-font-family:Tahoma;mso-fareast-font-family: 宋体;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:Tahoma; mso-bidi-font-family:Tahoma;">，那么程序将处于无法预料的状态中。程序可能卡住一段时间。如果你比较幸运，接下的没有被捕获到的</span><span lang="EN-US" style="font-size:11.0pt;font-family:"Tahoma","sans-serif";">SE</span><span style="font-size:11.0pt;font-family:宋体;mso-ascii-font-family:Tahoma;mso-fareast-font-family: 宋体;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:Tahoma; mso-bidi-font-family:Tahoma;">会在没有产生很严重破坏的时候结束。这使得调试起来很困难，第二个</span><span lang="EN-US" style="font-size:11.0pt;font-family:"Tahoma","sans-serif";">SE</span><span style="font-size:11.0pt;font-family:宋体;mso-ascii-font-family:Tahoma;mso-fareast-font-family: 宋体;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:Tahoma; mso-bidi-font-family:Tahoma;">和第一个</span><span lang="EN-US" style="font-size:11.0pt; font-family:"Tahoma","sans-serif";">SE</span><span style="font-size:11.0pt; font-family:宋体;mso-ascii-font-family:Tahoma;mso-fareast-font-family:宋体; mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:Tahoma;mso-bidi-font-family: Tahoma;">可能代码可能离得很远。</span><span lang="EN-US" style="font-size:11.0pt;font-family: "Tahoma","sans-serif";"></span></p>

<p class="MsoListParagraph" style="margin-top:7.8pt;margin-right:0cm;margin-bottom: 0cm;margin-left:18.7pt;margin-bottom:.0001pt;mso-para-margin-top:.5gd; mso-para-margin-right:0cm;mso-para-margin-bottom:0cm;mso-para-margin-left:18.7pt; mso-para-margin-bottom:.0001pt;text-indent:-18.7pt;mso-char-indent-count:-1.7; mso-list:l2 level1 lfo3;"><span lang="EN-US" style="font-size:11.0pt;font-family:"Tahoma","sans-serif";mso-fareast-font-family: Tahoma;"><span style="mso-list:Ignore;">2.<span style="font:7.0pt "Times New Roman";">&nbsp;&nbsp;&nbsp;
</span></span></span><span style="font-size:11.0pt;font-family:宋体; mso-ascii-font-family:Tahoma;mso-fareast-font-family:宋体;mso-fareast-theme-font: minor-fareast;mso-hansi-font-family:Tahoma;mso-bidi-font-family:Tahoma;">下面的代码让人不能确信是否正确：</span><span lang="EN-US" style="font-size:11.0pt;font-family:"Tahoma","sans-serif";"></span></p>

<p style="text-indent:20.9pt;mso-char-indent-count:1.9;"><span lang="EN-US" style="font-size:11.0pt;font-family:"Tahoma","sans-serif";">try</span></p>

<p style="text-indent:20.9pt;"><span lang="EN-US" style="font-size:11.0pt;font-family:"Tahoma","sans-serif";">{</span></p>

<p style="text-indent:42.45pt;mso-char-indent-count:3.86;"><span lang="EN-US" style="font-size:11.0pt;font-family:"Tahoma","sans-serif";">TheFastButResourceHungryWay();</span></p>

<p style="text-indent:21.0pt;"><span lang="EN-US" style="font-size:11.0pt;font-family:"Tahoma","sans-serif";">}</span></p>

<p style="text-indent:20.9pt;mso-char-indent-count:1.9;"><span lang="EN-US" style="font-size:11.0pt;font-family:"Tahoma","sans-serif";">catch
(...)</span></p>

<p style="text-indent:20.9pt;mso-char-indent-count:1.9;"><span lang="EN-US" style="font-size:11.0pt;font-family:"Tahoma","sans-serif";">{</span></p>

<p style="text-indent:42.45pt;mso-char-indent-count:3.86;"><span lang="EN-US" style="font-size:11.0pt;font-family:"Tahoma","sans-serif";">TheSlowButSureWay();</span></p>

<p class="MsoListParagraph" style="margin-left:7.45pt;mso-para-margin-left:.71gd; text-indent:10.55pt;mso-char-indent-count:0;"><span lang="EN-US" style="font-size: 11.0pt;font-family:"Tahoma","sans-serif";">}</span></p>

<p class="MsoListParagraph" style="margin-left:17.95pt;mso-para-margin-left:1.71gd; text-indent:0cm;mso-char-indent-count:0;"><span style="font-size:11.0pt; font-family:宋体;mso-ascii-font-family:Tahoma;mso-fareast-font-family:宋体; mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:Tahoma;mso-bidi-font-family: Tahoma;">如果在</span><span lang="EN-US" style="font-size:11.0pt;font-family:"Tahoma","sans-serif";">TheFastButResourceHungryWay</span><span style="font-size:11.0pt;font-family:宋体;mso-ascii-font-family:Tahoma;mso-fareast-font-family: 宋体;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:Tahoma; mso-bidi-font-family:Tahoma;">中，产生非法访问，</span><span lang="EN-US" style="font-size: 11.0pt;font-family:"Tahoma","sans-serif";">catch</span><span style="font-size: 11.0pt;font-family:宋体;mso-ascii-font-family:Tahoma;mso-fareast-font-family: 宋体;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:Tahoma; mso-bidi-font-family:Tahoma;">却捕获到错误，使得你失去发现错误的机会，或者只是出现程序运行时有点莫名其妙的缓慢现象。（可能你并察觉不到）。而如果</span><span lang="EN-US" style="font-size:11.0pt;font-family:"Tahoma","sans-serif";">catch</span><span style="font-size:11.0pt;font-family:宋体;mso-ascii-font-family:Tahoma;mso-fareast-font-family: 宋体;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:Tahoma; mso-bidi-font-family:Tahoma;">不捕获的话，操作系统就会蹦出一个框，你就发现错误存在的地方了。</span><span lang="EN-US" style="font-size:11.0pt;font-family:"Tahoma","sans-serif";"></span></p>

<p class="MsoListParagraph" style="margin-top:7.8pt;margin-right:0cm;margin-bottom: 0cm;margin-left:18.7pt;margin-bottom:.0001pt;mso-para-margin-top:.5gd; mso-para-margin-right:0cm;mso-para-margin-bottom:0cm;mso-para-margin-left:18.7pt; mso-para-margin-bottom:.0001pt;text-indent:-18.7pt;mso-char-indent-count:-1.7; mso-list:l2 level1 lfo3;"><span lang="EN-US" style="font-size:11.0pt;font-family:"Tahoma","sans-serif";mso-fareast-font-family: Tahoma;"><span style="mso-list:Ignore;">3.<span style="font:7.0pt "Times New Roman";">&nbsp;&nbsp;&nbsp;
</span></span></span><span lang="EN-US" style="font-size:11.0pt; font-family:"Tahoma","sans-serif";">The normal operation of the system is
impaired. </span></p>

<p class="MsoListParagraph" style="margin-left:18.0pt;text-indent:0cm;mso-char-indent-count: 0;"><span lang="EN-US" style="font-size:11.0pt;font-family:"Tahoma","sans-serif";">For
example, the MFC CPropertySheet::DoModal () documentation describes a scenario
in which you should not use catch(...). The exception raised by the <b style="mso-bidi-font-weight:normal;">DebugBreak</b> API can be caught by catch (...),
rendering <b style="mso-bidi-font-weight:normal;">DebugBreak</b> useless. Also,
if you're using <b style="mso-bidi-font-weight:normal;">__try/__except</b> to
handle SEs properly, you may have trouble if an <b style="mso-bidi-font-weight: normal;">interior</b> catch (...) is present, even if it rethrows. You almost
certainly will have trouble if your SE handler resumes execution with the
faulting instruction. You may find the catch (...) block was entered and local
variables destroyed, which is very bad if execution is resumed in its
complementary try block. And if that try block subsequently throws a C++
exception, you may find yourself in an infinite loop with your SE filter
function. </span></p>

<p class="MsoListParagraph" style="margin-top:7.8pt;margin-right:0cm;margin-bottom: 0cm;margin-left:18.7pt;margin-bottom:.0001pt;mso-para-margin-top:.5gd; mso-para-margin-right:0cm;mso-para-margin-bottom:0cm;mso-para-margin-left:18.7pt; mso-para-margin-bottom:.0001pt;text-indent:-18.7pt;mso-char-indent-count:-1.7; mso-list:l2 level1 lfo3;"><span lang="EN-US" style="font-size:11.0pt;font-family:"Tahoma","sans-serif";mso-fareast-font-family: Tahoma;"><span style="mso-list:Ignore;">4.<span style="font:7.0pt "Times New Roman";">&nbsp;&nbsp;&nbsp;
</span></span></span><span lang="EN-US" style="font-size:11.0pt; font-family:"Tahoma","sans-serif";">Application frameworks are taking a chance
if they guard your code with catch(...), which they normally should do. For example,
MFC does not use catch(...), and as a result, an uncaught C++ exception
terminates an MFC application Asdf</span></p>

<p><span lang="EN-US" style="font-size:11.0pt;font-family:"Tahoma","sans-serif";">&nbsp;</span></p>

<p><span style="font-size:11.0pt;font-family:宋体;mso-ascii-font-family: Tahoma;mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast; mso-hansi-font-family:Tahoma;mso-bidi-font-family:Tahoma;">所以在</span><span lang="EN-US" style="font-size:11.0pt;font-family:"Tahoma","sans-serif";">Vistual
C++ 5 </span><span style="font-size:11.0pt;font-family:宋体;mso-ascii-font-family: Tahoma;mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast; mso-hansi-font-family:Tahoma;mso-bidi-font-family:Tahoma;">到</span><span lang="EN-US" style="font-size:11.0pt;font-family:"Tahoma","sans-serif";">2003</span><span style="font-size:11.0pt;font-family:宋体;mso-ascii-font-family:Tahoma;mso-fareast-font-family: 宋体;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:Tahoma; mso-bidi-font-family:Tahoma;">中，避免使用</span><span lang="EN-US" style="font-size: 11.0pt;font-family:"Tahoma","sans-serif";">catch (…).<span style="mso-tab-count: 1;"> </span></span><span style="font-size:11.0pt;font-family:宋体;mso-ascii-font-family: Tahoma;mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast; mso-hansi-font-family:Tahoma;mso-bidi-font-family:Tahoma;">除非你觉得上面说的对你来说都不是什么问题。如果使用</span><span lang="EN-US" style="font-size:11.0pt;font-family:"Tahoma","sans-serif";">2005</span><span style="font-size:11.0pt;font-family:宋体;mso-ascii-font-family:Tahoma;mso-fareast-font-family: 宋体;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:Tahoma; mso-bidi-font-family:Tahoma;">以上的版本，</span><span lang="EN-US" style="font-size: 11.0pt;font-family:"Tahoma","sans-serif";"> /EHs</span><span style="font-size: 11.0pt;font-family:宋体;mso-ascii-font-family:Tahoma;mso-fareast-font-family: 宋体;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:Tahoma; mso-bidi-font-family:Tahoma;">已经很好解决了这个问题，在</span><span lang="EN-US" style="font-size:11.0pt;font-family:"Tahoma","sans-serif";">synchronous exception
handling model</span><span style="font-size:11.0pt;font-family:宋体;mso-ascii-font-family: Tahoma;mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast; mso-hansi-font-family:Tahoma;mso-bidi-font-family:Tahoma;">中，</span><span lang="EN-US" style="font-size:11.0pt;font-family:"Tahoma","sans-serif";">catch (…)</span><span style="font-size:11.0pt;font-family:宋体;mso-ascii-font-family:Tahoma;mso-fareast-font-family: 宋体;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:Tahoma; mso-bidi-font-family:Tahoma;">，是不会捕获到</span><span lang="EN-US" style="font-size: 11.0pt;font-family:"Tahoma","sans-serif";">SEs</span><span style="font-size: 11.0pt;font-family:宋体;mso-ascii-font-family:Tahoma;mso-fareast-font-family: 宋体;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:Tahoma; mso-bidi-font-family:Tahoma;">的。</span><span lang="EN-US" style="font-size:11.0pt; font-family:"Tahoma","sans-serif";"></span></p><br><wbr>
</body></html>