<html><head><meta http-equiv="Content-Type" content="text/html; charset=utf8"><title>163 blogs的博客：COM重用-包容和集合</title>
<style type="text/css">
a{color: #000000;text-decoration : none;font-size: 10pt;}
a:hover {color: red;text-decoration : underline;}
.replyBox{padding:4px;border:1px solid #D8D8D8;}
</style></head><body><h2>COM重用-包容和集合</h2>
<p align="right">发布时间：2011-3-12 11:40
<br>分类名称：COM</p><br>
  <div><img title="COM重用-包容和集合 - Dsliu - Dspace"  alt="COM重用-包容和集合 - Dsliu - Dspace"  style="margin:0 10px 0 0;"  src="pic/img533.ph.126.net_tLDCu2XZoZyGwEmechT6fg==_2593228960436498249.png"  ><br><div align="center"  >包容<br></div></div>&nbsp;<br><br><div><img title="COM重用-包容和集合 - Dsliu - Dspace"  alt="COM重用-包容和集合 - Dsliu - Dspace"  style="margin:0 10px 0 0;"  src="pic/img852.ph.126.net_7Yw1onYprv6xvBRMBisr-A==_2725803674467023558.png"  ><br><div align="center"  >聚合<br></div></div>&nbsp;<br><br><p style="text-align:left;"  align="left"  ><span style="font-family: 宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-font-family: 宋体;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:Calibri; mso-hansi-theme-font:minor-latin;"  >对象</span><span lang="EN-US"  >A</span><span style="font-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin; mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family: Calibri;mso-hansi-theme-font:minor-latin;"  >是已经被实现好的</span><span lang="EN-US"  >COM</span><span style="font-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin; mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family: Calibri;mso-hansi-theme-font:minor-latin;"  >对象。</span><span lang="EN-US"  ></span></p>  <p style="text-align:left;"  align="left"  ><span style="font-family: 宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-font-family: 宋体;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:Calibri; mso-hansi-theme-font:minor-latin;"  >包容：</span><span lang="EN-US"  ></span></p>  <p style="text-align:left;"  align="left"  ><span lang="EN-US"  >B</span><span style="font-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin; mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family: Calibri;mso-hansi-theme-font:minor-latin;"  >实现</span><span lang="EN-US"  >ISomeInterface</span><span style="font-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin; mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family: Calibri;mso-hansi-theme-font:minor-latin;"  >和</span><span lang="EN-US"  >IOtherInterface</span><span style="font-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin; mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family: Calibri;mso-hansi-theme-font:minor-latin;"  >接口，然后在</span><span lang="EN-US"  >ISomeInterface</span><span style="font-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin; mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family: Calibri;mso-hansi-theme-font:minor-latin;"  >的实现中调用</span><span lang="EN-US"  >A</span><span style="font-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin; mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family: Calibri;mso-hansi-theme-font:minor-latin;"  >对象提供的服务。一般的，</span><span lang="EN-US"  >A</span><span style="font-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin; mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family: Calibri;mso-hansi-theme-font:minor-latin;"  >的生存期在</span><span lang="EN-US"  >B</span><span style="font-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin; mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family: Calibri;mso-hansi-theme-font:minor-latin;"  >生存期内。</span><span lang="EN-US"  ></span></p>  <p style="text-align:left;"  align="left"  ><span lang="EN-US"  >&nbsp;</span></p>  <p style="text-align:left;"  align="left"  ><span style="font-family: 宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-font-family: 宋体;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:Calibri; mso-hansi-theme-font:minor-latin;"  >聚合：</span><span lang="EN-US"  ></span></p>  <p style="text-align:left;"  align="left"  ><span lang="EN-US"  >B</span><span style="font-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin; mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family: Calibri;mso-hansi-theme-font:minor-latin;"  >只实现了</span><span lang="EN-US"  >IOtherInterface</span><span style="font-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin; mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family: Calibri;mso-hansi-theme-font:minor-latin;"  >，当客户要求</span><span lang="EN-US"  >B</span><span style="font-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin; mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family: Calibri;mso-hansi-theme-font:minor-latin;"  >对象提供</span><span lang="EN-US"  >ISomeInterface</span><span style="font-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin; mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family: Calibri;mso-hansi-theme-font:minor-latin;"  >时，由于</span><span lang="EN-US"  >A</span><span style="font-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin; mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family: Calibri;mso-hansi-theme-font:minor-latin;"  >被聚合到了</span><span lang="EN-US"  >B</span><span style="font-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin; mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family: Calibri;mso-hansi-theme-font:minor-latin;"  >中，</span><span lang="EN-US"  >B</span><span style="font-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin; mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family: Calibri;mso-hansi-theme-font:minor-latin;"  >可以提供此服务。一般的，</span><span lang="EN-US"  >A</span><span style="font-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin; mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family: Calibri;mso-hansi-theme-font:minor-latin;"  >的生存期在</span><span lang="EN-US"  >B</span><span style="font-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin; mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family: Calibri;mso-hansi-theme-font:minor-latin;"  >生存期内。</span><span lang="EN-US"  ></span></p>  <p style="text-align:left;"  align="left"  ><span lang="EN-US"  >&nbsp;</span></p>  <p style="text-align:left;"  align="left"  ><span style="font-family: 宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-font-family: 宋体;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:Calibri; mso-hansi-theme-font:minor-latin;"  >聚合的复杂性在于，</span><span lang="EN-US"  >B</span><span style="font-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin; mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family: Calibri;mso-hansi-theme-font:minor-latin;"  >虽然知道</span><span lang="EN-US"  >A</span><span style="font-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin; mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family: Calibri;mso-hansi-theme-font:minor-latin;"  >实现了什么接口，但</span><span lang="EN-US"  >A</span><span style="font-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin; mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family: Calibri;mso-hansi-theme-font:minor-latin;"  >不知道</span><span lang="EN-US"  >B</span><span style="font-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin; mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family: Calibri;mso-hansi-theme-font:minor-latin;"  >实现了什么接口。这样就导致通过</span><span lang="EN-US"  >B</span><span style="font-family:宋体;mso-ascii-font-family:Calibri; mso-ascii-theme-font:minor-latin;mso-fareast-font-family:宋体;mso-fareast-theme-font: minor-fareast;mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin;"  >获取到</span><span lang="EN-US"  >A</span><span style="font-family:宋体;mso-ascii-font-family:Calibri; mso-ascii-theme-font:minor-latin;mso-fareast-font-family:宋体;mso-fareast-theme-font: minor-fareast;mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin;"  >的实例指针后，通过此指针调用的</span><span lang="EN-US"  >QueryInterface</span><span style="font-family:宋体;mso-ascii-font-family: Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-font-family:宋体;mso-fareast-theme-font: minor-fareast;mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin;"  >是</span><span lang="EN-US"  >A</span><span style="font-family:宋体;mso-ascii-font-family:Calibri; mso-ascii-theme-font:minor-latin;mso-fareast-font-family:宋体;mso-fareast-theme-font: minor-fareast;mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin;"  >的，也就无法</span><span lang="EN-US"  >Query</span><span style="font-family:宋体;mso-ascii-font-family:Calibri; mso-ascii-theme-font:minor-latin;mso-fareast-font-family:宋体;mso-fareast-theme-font: minor-fareast;mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin;"  >出</span><span lang="EN-US"  >B</span><span style="font-family:宋体;mso-ascii-font-family:Calibri; mso-ascii-theme-font:minor-latin;mso-fareast-font-family:宋体;mso-fareast-theme-font: minor-fareast;mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin;"  >中实现的接口来。而且</span><span lang="EN-US"  >A</span><span style="font-family:宋体;mso-ascii-font-family:Calibri; mso-ascii-theme-font:minor-latin;mso-fareast-font-family:宋体;mso-fareast-theme-font: minor-fareast;mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin;"  >和</span><span lang="EN-US"  >B</span><span style="font-family:宋体;mso-ascii-font-family:Calibri; mso-ascii-theme-font:minor-latin;mso-fareast-font-family:宋体;mso-fareast-theme-font: minor-fareast;mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin;"  >的接口继承于俩个不同的</span><span lang="EN-US"  >IUnknown</span><span style="font-family:宋体;mso-ascii-font-family: Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-font-family:宋体;mso-fareast-theme-font: minor-fareast;mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin;"  >，获取回的指针也不一样。这样就违背了</span><span lang="EN-US"  >QueryInterface</span><span style="font-family:宋体;mso-ascii-font-family: Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-font-family:宋体;mso-fareast-theme-font: minor-fareast;mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin;"  >需要遵循的原则。</span><span lang="EN-US"  ></span></p>  <p style="text-align:left;"  align="left"  ><span lang="EN-US"  >&nbsp;</span></p>  <p style="text-align:left;"  align="left"  ><span style="font-family: 宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-font-family: 宋体;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:Calibri; mso-hansi-theme-font:minor-latin;"  >解决聚合复杂性的办法，在</span><span lang="EN-US"  >A</span><span style="font-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin; mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family: Calibri;mso-hansi-theme-font:minor-latin;"  >中留下一个</span><span lang="EN-US"  >IUnknown </span><span style="font-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font: minor-latin;mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast; mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin;"  >指针，通过外部（例如</span><span lang="EN-US"  >B</span><span style="font-family:宋体;mso-ascii-font-family:Calibri; mso-ascii-theme-font:minor-latin;mso-fareast-font-family:宋体;mso-fareast-theme-font: minor-fareast;mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin;"  >）将其</span><span lang="EN-US"  >IUnknown</span><span style="font-family:宋体;mso-ascii-font-family: Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-font-family:宋体;mso-fareast-theme-font: minor-fareast;mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin;"  >传入给</span><span lang="EN-US"  >A</span><span style="font-family:宋体;mso-ascii-font-family:Calibri; mso-ascii-theme-font:minor-latin;mso-fareast-font-family:宋体;mso-fareast-theme-font: minor-fareast;mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin;"  >，</span><span lang="EN-US"  >A</span><span style="font-family:宋体;mso-ascii-font-family:Calibri; mso-ascii-theme-font:minor-latin;mso-fareast-font-family:宋体;mso-fareast-theme-font: minor-fareast;mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin;"  >就可以利用此接口来代理</span><span lang="EN-US"  >B </span><span style="font-family:宋体;mso-ascii-font-family:Calibri; mso-ascii-theme-font:minor-latin;mso-fareast-font-family:宋体;mso-fareast-theme-font: minor-fareast;mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin;"  >来做</span><span lang="EN-US"  >Query Interface</span><span style="font-family:宋体;mso-ascii-font-family: Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-font-family:宋体;mso-fareast-theme-font: minor-fareast;mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin;"  >了。</span><span lang="EN-US"  ></span></p>  <p style="text-align:left;"  align="left"  ><span lang="EN-US"  >&nbsp;</span></p>  <p style="text-align:left;"  align="left"  ><span style="font-family: 宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-font-family: 宋体;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:Calibri; mso-hansi-theme-font:minor-latin;"  >实现：</span><span lang="EN-US"  ></span></p>  <p style="text-align:left;"  align="left"  ><span lang="EN-US"  >class CB : public IOtherInterface</span></p>  <p style="text-align:left;"  align="left"  ><span lang="EN-US"  >{</span></p>  <p style="text-align:left;"  align="left"  ><span lang="EN-US"  ><span style="mso-tab-count:1;"  >&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>......</span></p>  <p style="text-align:left;"  align="left"  ><span lang="EN-US"  >private:</span></p>  <p style="text-align:left;"  align="left"  ><span lang="EN-US"  ><span style="mso-tab-count:1;"  >&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>IUnknown *m_pUnknownInner; // Point to A's IUnknown</span></p>  <p style="text-align:left;"  align="left"  ><span lang="EN-US"  ><span style="mso-tab-count:1;"  >&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>......</span></p>  <p style="text-align:left;"  align="left"  ><span lang="EN-US"  >}</span></p>  <p style="text-align:left;"  align="left"  ><span lang="EN-US"  >&nbsp;</span></p>  <p style="text-align:left;"  align="left"  ><span lang="EN-US"  >CB::QueryInterface(...)</span></p>  <p style="text-align:left;"  align="left"  ><span lang="EN-US"  >{</span></p>  <p style="text-align:left;"  align="left"  ><span lang="EN-US"  ><span style="mso-tab-count:1;"  >&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>......</span></p>  <p style="text-align:left;"  align="left"  ><span lang="EN-US"  ><span style="mso-tab-count:1;"  >&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>if (iid == IID_SomeInterface)</span></p>  <p style="text-align:left;"  align="left"  ><span lang="EN-US"  ><span style="mso-tab-count:2;"  >&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>return m_pUnknownInner-&gt;QueryInterface(iid, ppv);</span></p>  <p style="text-align:left;"  align="left"  ><span lang="EN-US"  ><span style="mso-tab-count:1;"  >&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>......</span></p>  <p style="text-align:left;"  align="left"  ><span lang="EN-US"  >}</span></p>  <p style="text-align:left;"  align="left"  ><span lang="EN-US"  >&nbsp;</span></p>  <p style="text-align:left;"  align="left"  ><span lang="EN-US"  >A </span><span style="font-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin; mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family: Calibri;mso-hansi-theme-font:minor-latin;"  >分被聚合和未被聚合俩种情况。</span><span lang="EN-US"  ></span></p>  <p style="text-align:left;"  align="left"  ><span style="font-family: 宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-font-family: 宋体;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:Calibri; mso-hansi-theme-font:minor-latin;"  >如果被聚合，</span><span lang="EN-US"  >A</span><span style="font-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin; mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family: Calibri;mso-hansi-theme-font:minor-latin;"  >就使用内部这个指针（即</span><span lang="EN-US"  >B</span><span style="font-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin; mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family: Calibri;mso-hansi-theme-font:minor-latin;"  >传入的自己实例指针）来</span><span lang="EN-US"  >Query Interface</span><span style="font-family:宋体;mso-ascii-font-family:Calibri; mso-ascii-theme-font:minor-latin;mso-fareast-font-family:宋体;mso-fareast-theme-font: minor-fareast;mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin;"  >，相当于是</span><span lang="EN-US"  >B</span><span style="font-family:宋体;mso-ascii-font-family:Calibri; mso-ascii-theme-font:minor-latin;mso-fareast-font-family:宋体;mso-fareast-theme-font: minor-fareast;mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin;"  >在</span><span lang="EN-US"  >Query Interface</span><span style="font-family:宋体;mso-ascii-font-family: Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-font-family:宋体;mso-fareast-theme-font: minor-fareast;mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin;"  >，获取的</span><span lang="EN-US"  >IUnknown</span><span style="font-family:宋体;mso-ascii-font-family: Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-font-family:宋体;mso-fareast-theme-font: minor-fareast;mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin;"  >都是</span><span lang="EN-US"  >B</span><span style="font-family:宋体;mso-ascii-font-family:Calibri; mso-ascii-theme-font:minor-latin;mso-fareast-font-family:宋体;mso-fareast-theme-font: minor-fareast;mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin;"  >的。而且不存在</span><span lang="EN-US"  >A</span><span style="font-family:宋体;mso-ascii-font-family:Calibri; mso-ascii-theme-font:minor-latin;mso-fareast-font-family:宋体;mso-fareast-theme-font: minor-fareast;mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin;"  >找不到</span><span lang="EN-US"  >B</span><span style="font-family:宋体;mso-ascii-font-family:Calibri; mso-ascii-theme-font:minor-latin;mso-fareast-font-family:宋体;mso-fareast-theme-font: minor-fareast;mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin;"  >的</span><span lang="EN-US"  >Interface</span><span style="font-family:宋体;mso-ascii-font-family: Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-font-family:宋体;mso-fareast-theme-font: minor-fareast;mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin;"  >。</span><span lang="EN-US"  ></span></p>  <p style="text-align:left;"  align="left"  ><span lang="EN-US"  >&nbsp;</span></p>  <p style="text-align:left;"  align="left"  ><span style="font-family: 宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-font-family: 宋体;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:Calibri; mso-hansi-theme-font:minor-latin;"  >如果未被聚合，那么就什么都不做，不使用这个指针。</span><span lang="EN-US"  ></span></p>  <p style="text-align:left;"  align="left"  ><span lang="EN-US"  >&nbsp;</span></p>  <p style="text-align:left;"  align="left"  ><span lang="EN-US"  >CoCreateInstance</span><span style="font-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin; mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family: Calibri;mso-hansi-theme-font:minor-latin;"  >有一个参数，叫</span><span lang="EN-US"  >IUnknown *pUnknownOuter</span><span style="font-family:宋体;mso-ascii-font-family:Calibri; mso-ascii-theme-font:minor-latin;mso-fareast-font-family:宋体;mso-fareast-theme-font: minor-fareast;mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin;"  >，这个指针，就是</span><span lang="EN-US"  >A</span><span style="font-family:宋体;mso-ascii-font-family:Calibri; mso-ascii-theme-font:minor-latin;mso-fareast-font-family:宋体;mso-fareast-theme-font: minor-fareast;mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin;"  >中要保存的</span><span lang="EN-US"  >B</span><span style="font-family:宋体;mso-ascii-font-family:Calibri; mso-ascii-theme-font:minor-latin;mso-fareast-font-family:宋体;mso-fareast-theme-font: minor-fareast;mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin;"  >实例指针。</span><span lang="EN-US"  ></span></p>  <p style="text-align:left;"  align="left"  ><span lang="EN-US"  >&nbsp;</span></p>  <p style="text-align:left;"  align="left"  ><span lang="EN-US"  >A</span><span style="font-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin; mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family: Calibri;mso-hansi-theme-font:minor-latin;"  >内部，为了区分聚合和非聚合，定了了俩个</span><span lang="EN-US"  >IUnknown</span><span style="font-family:宋体;mso-ascii-font-family: Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-font-family:宋体;mso-fareast-theme-font: minor-fareast;mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin;"  >（</span><span lang="EN-US"  >delegating unknown, undelegating unknown).</span><span style="font-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin; mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family: Calibri;mso-hansi-theme-font:minor-latin;"  >这个俩个委托和非委托名词，曾经困扰了我很久，后来发现是因为这俩个词语本身的语义对我的误导。如果要以我自己的方式区分，我将其区分为一个</span><span lang="EN-US"  >IUnknown</span><span style="font-family:宋体;mso-ascii-font-family: Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-font-family:宋体;mso-fareast-theme-font: minor-fareast;mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin;"  >是</span><span lang="EN-US"  >Proxy</span><span style="font-family:宋体;mso-ascii-font-family:Calibri; mso-ascii-theme-font:minor-latin;mso-fareast-font-family:宋体;mso-fareast-theme-font: minor-fareast;mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin;"  >（代理），一个</span><span lang="EN-US"  >IUnknown</span><span style="font-family:宋体;mso-ascii-font-family: Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-font-family:宋体;mso-fareast-theme-font: minor-fareast;mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin;"  >是正常的</span><span lang="EN-US"  >IUnknown</span><span style="font-family:宋体;mso-ascii-font-family: Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-font-family:宋体;mso-fareast-theme-font: minor-fareast;mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin;"  >。代理只是个中转站，负责分发，其内部其实就是一个判断，如果</span><span lang="EN-US"  >A</span><span style="font-family:宋体;mso-ascii-font-family:Calibri; mso-ascii-theme-font:minor-latin;mso-fareast-font-family:宋体;mso-fareast-theme-font: minor-fareast;mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin;"  >的</span><span lang="EN-US"  >pUnknownOuter</span><span style="font-family:宋体;mso-ascii-font-family: Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-font-family:宋体;mso-fareast-theme-font: minor-fareast;mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin;"  >为</span><span lang="EN-US"  >NULL</span><span style="font-family:宋体;mso-ascii-font-family:Calibri; mso-ascii-theme-font:minor-latin;mso-fareast-font-family:宋体;mso-fareast-theme-font: minor-fareast;mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin;"  >，那么就转发给正常的</span><span lang="EN-US"  >IUnknown</span><span style="font-family:宋体;mso-ascii-font-family: Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-font-family:宋体;mso-fareast-theme-font: minor-fareast;mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin;"  >。如果</span><span lang="EN-US"  >pUnknownOuter</span><span style="font-family:宋体;mso-ascii-font-family: Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-font-family:宋体;mso-fareast-theme-font: minor-fareast;mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin;"  >不为</span><span lang="EN-US"  >NULL</span><span style="font-family:宋体;mso-ascii-font-family:Calibri; mso-ascii-theme-font:minor-latin;mso-fareast-font-family:宋体;mso-fareast-theme-font: minor-fareast;mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin;"  >，那么就调用它自身的接口函数。</span><span lang="EN-US"  ></span></p>  <p style="text-align:left;"  align="left"  ><span lang="EN-US"  >&nbsp;</span></p>  <p style="text-align:left;"  align="left"  ><span lang="EN-US"  >class INondelegationUnknown</span></p>  <p style="text-align:left;"  align="left"  ><span lang="EN-US"  >{</span></p>  <p style="text-align:left;"  align="left"  ><span lang="EN-US"  >public:</span></p>  <p style="text-align:left;"  align="left"  ><span lang="EN-US"  ><span style="mso-tab-count:1;"  >&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>virtual HRESULT _stdcall NondelegationQueryInterface(...) = 0;</span></p>  <p style="text-align:left;"  align="left"  ><span lang="EN-US"  ><span style="mso-tab-count:1;"  >&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>virtual ULONG _stdcall NondelegationAddRef() = 0;</span></p>  <p style="text-align:left;"  align="left"  ><span lang="EN-US"  ><span style="mso-tab-count:1;"  >&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>virtual ULONG _stdcall NondelegationRelease() = 0;</span></p>  <p style="text-align:left;"  align="left"  ><span lang="EN-US"  >};</span></p>  <p style="text-align:left;"  align="left"  ><span lang="EN-US"  >class CA : public ISomeInterface, public INondelegationUnknown</span></p>  <p style="text-align:left;"  align="left"  ><span lang="EN-US"  >{</span></p>  <p style="text-align:left;"  align="left"  ><span lang="EN-US"  ><span style="mso-tab-count:1;"  >&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>......</span></p>  <p style="text-align:left;"  align="left"  ><span lang="EN-US"  >public:</span></p>  <p style="text-align:left;"  align="left"  ><span lang="EN-US"  ><span style="mso-tab-count:1;"  >&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>NondelegationQueryInterface(...);</span></p>  <p style="text-align:left;"  align="left"  ><span lang="EN-US"  ><span style="mso-tab-count:1;"  >&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>NondelegationAddRef();</span></p>  <p style="text-align:left;"  align="left"  ><span lang="EN-US"  ><span style="mso-tab-count:1;"  >&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>NondelegationRelease();</span></p>  <p style="text-align:left;"  align="left"  ><span lang="EN-US"  ><span style="mso-tab-count:1;"  >&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span></p>  <p style="text-align:left;"  align="left"  ><span lang="EN-US"  ><span style="mso-tab-count:1;"  >&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>QueryInterface(...);</span></p>  <p style="text-align:left;"  align="left"  ><span lang="EN-US"  ><span style="mso-tab-count:1;"  >&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>AddRef();</span></p>  <p style="text-align:left;"  align="left"  ><span lang="EN-US"  ><span style="mso-tab-count:1;"  >&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>Release();</span></p>  <p style="text-align:left;"  align="left"  ><span lang="EN-US"  ><span style="mso-tab-count:1;"  >&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>......</span></p>  <p style="text-align:left;"  align="left"  ><span lang="EN-US"  >private:</span></p>  <p style="text-align:left;"  align="left"  ><span lang="EN-US"  ><span style="mso-tab-count:1;"  >&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>IUnknown *m_pUnknownOuter;</span></p>  <p style="text-align:left;"  align="left"  ><span lang="EN-US"  ><span style="mso-tab-count:1;"  >&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>......</span></p>  <p style="text-align:left;"  align="left"  ><span lang="EN-US"  >}</span><span style="font-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin; mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family: Calibri;mso-hansi-theme-font:minor-latin;"  >；</span><span lang="EN-US"  ></span></p>  <p style="text-align:left;"  align="left"  ><span lang="EN-US"  >&nbsp;</span></p>  <p style="text-align:left;"  align="left"  ><span lang="EN-US"  >CA::NondelegationQueryInterface(...)</span></p>  <p style="text-align:left;"  align="left"  ><span lang="EN-US"  >{ </span><span style="font-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin; mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family: Calibri;mso-hansi-theme-font:minor-latin;"  >正常</span><span lang="EN-US"  >Query</span><span style="font-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin; mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family: Calibri;mso-hansi-theme-font:minor-latin;"  >，就像什么都没发生过</span><span lang="EN-US"  > }</span></p>  <p style="text-align:left;"  align="left"  ><span lang="EN-US"  >&nbsp;</span></p>  <p style="text-align:left;"  align="left"  ><span lang="EN-US"  >CA::NondelegationAddRef()</span></p>  <p style="text-align:left;"  align="left"  ><span lang="EN-US"  >{ </span><span style="font-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin; mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family: Calibri;mso-hansi-theme-font:minor-latin;"  >正常</span><span lang="EN-US"  >AddRef</span><span style="font-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin; mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family: Calibri;mso-hansi-theme-font:minor-latin;"  >，就像什么都没发生过</span><span lang="EN-US"  > }</span></p>  <p style="text-align:left;"  align="left"  ><span lang="EN-US"  >&nbsp;</span></p>  <p style="text-align:left;"  align="left"  ><span lang="EN-US"  >CA::NondelegationRelease()</span></p>  <p style="text-align:left;"  align="left"  ><span lang="EN-US"  >{ </span><span style="font-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin; mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family: Calibri;mso-hansi-theme-font:minor-latin;"  >正常</span><span lang="EN-US"  >Release</span><span style="font-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin; mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family: Calibri;mso-hansi-theme-font:minor-latin;"  >，就像什么都没发生过</span><span lang="EN-US"  > }</span></p>  <p style="text-align:left;"  align="left"  ><span lang="EN-US"  >&nbsp;</span></p>  <p style="text-align:left;"  align="left"  ><span lang="EN-US"  >CA::QueryInterface(...){</span></p>  <p style="text-align:left;"  align="left"  ><span lang="EN-US"  ><span style="mso-tab-count:1;"  >&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>if (NULL == m_pUnknownOuter) // </span><span style="font-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin; mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family: Calibri;mso-hansi-theme-font:minor-latin;"  >转发</span><span lang="EN-US"  ></span></p>  <p style="text-align:left;"  align="left"  ><span lang="EN-US"  ><span style="mso-tab-count:2;"  >&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>Call NondelegationQueryInterface</span></p>  <p style="text-align:left;"  align="left"  ><span lang="EN-US"  ><span style="mso-tab-count:1;"  >&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>else</span></p>  <p style="text-align:left;"  align="left"  ><span lang="EN-US"  ><span style="mso-tab-count:2;"  >&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>Call m_pUnknownOuter-&gt;QueryInterface</span></p>  <p style="text-align:left;"  align="left"  ><span lang="EN-US"  >}</span></p>  <p style="text-align:left;"  align="left"  ><span lang="EN-US"  >CA::AddRef(){</span></p>  <p style="text-align:left;"  align="left"  ><span lang="EN-US"  >if (NULL == m_pUnknownOuter) // </span><span style="font-family:宋体;mso-ascii-font-family: Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-font-family:宋体;mso-fareast-theme-font: minor-fareast;mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin;"  >转发</span><span lang="EN-US"  ></span></p>  <p style="text-align:left;"  align="left"  ><span lang="EN-US"  ><span style="mso-tab-count:2;"  >&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>Call NondelegationAddRef</span></p>  <p style="text-align:left;"  align="left"  ><span lang="EN-US"  ><span style="mso-tab-count:1;"  >&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>else</span></p>  <p style="text-align:left;"  align="left"  ><span lang="EN-US"  ><span style="mso-tab-count:2;"  >&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>Call m_pUnknownOuter-&gt;AddRef</span></p>  <p style="text-align:left;"  align="left"  ><span lang="EN-US"  >}</span></p>  <p style="text-align:left;"  align="left"  ><span lang="EN-US"  >CA::Release(){</span></p>  <p style="text-align:left;"  align="left"  ><span lang="EN-US"  >if (NULL == m_pUnknownOuter) // </span><span style="font-family:宋体;mso-ascii-font-family: Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-font-family:宋体;mso-fareast-theme-font: minor-fareast;mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin;"  >转发</span><span lang="EN-US"  ></span></p>  <p style="text-align:left;"  align="left"  ><span lang="EN-US"  ><span style="mso-tab-count:2;"  >&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>Call NondelegationRelease</span></p>  <p style="text-align:left;"  align="left"  ><span lang="EN-US"  ><span style="mso-tab-count:1;"  >&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>else</span></p>  <p style="text-align:left;"  align="left"  ><span lang="EN-US"  ><span style="mso-tab-count:2;"  >&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>Call m_pUnknownOuter-&gt;AddRef</span></p>  <p style="text-align:left;"  align="left"  ><span lang="EN-US"  >}</span></p>  <p style="text-align:left;"  align="left"  ><span lang="EN-US"  >&nbsp;</span></p>  <p style="text-align:left;"  align="left"  ><span style="font-family: 宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-font-family: 宋体;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:Calibri; mso-hansi-theme-font:minor-latin;"  >再看看</span><span lang="EN-US"  >B</span><span style="font-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin; mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family: Calibri;mso-hansi-theme-font:minor-latin;"  >何时将它自己的指针传递给</span><span lang="EN-US"  >A</span><span style="font-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin; mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family: Calibri;mso-hansi-theme-font:minor-latin;"  >：</span><span lang="EN-US"  ></span></p>  <p style="text-align:left;"  align="left"  ><span lang="EN-US"  >HRESULT CB::Init()</span></p>  <p style="text-align:left;"  align="left"  ><span lang="EN-US"  >{</span></p>  <p style="text-align:left;"  align="left"  ><span lang="EN-US"  ><span style="mso-tab-count:1;"  >&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>IUnknown *pUnknownOuter = (IUnknown *) this;</span></p>  <p style="margin-left:21.0pt;text-align:left;"  align="left"  ><span lang="EN-US"  >HRESULT result = ::CoCreateInstance(CLSID_ComponetA, pUnknownOuter, CLSCTX_INPROC_SERVER, IID_IUnknown, (void **)&amp;m_pUnknownInner);</span></p>  <p style="margin-left:21.0pt;text-align:left;"  align="left"  ><span lang="EN-US"  >......</span></p>  <p style="margin-left:21.0pt;text-align:left;"  align="left"  ><span style="font-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin; mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family: Calibri;mso-hansi-theme-font:minor-latin;"  >传入</span><span lang="EN-US"  >pUnknownOuter</span><span style="font-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin; mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family: Calibri;mso-hansi-theme-font:minor-latin;"  >（既</span><span lang="EN-US"  >B</span><span style="font-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin; mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family: Calibri;mso-hansi-theme-font:minor-latin;"  >的</span><span lang="EN-US"  >this</span><span style="font-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin; mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family: Calibri;mso-hansi-theme-font:minor-latin;"  >），而且得到</span><span lang="EN-US"  >m_pUnknownInner</span><span style="font-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin; mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family: Calibri;mso-hansi-theme-font:minor-latin;"  >（</span><span lang="EN-US"  >A</span><span style="font-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin; mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family: Calibri;mso-hansi-theme-font:minor-latin;"  >的</span><span lang="EN-US"  >this</span><span style="font-family:宋体;mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin; mso-fareast-font-family:宋体;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family: Calibri;mso-hansi-theme-font:minor-latin;"  >）。</span><span lang="EN-US"  ></span></p>  <p style="text-align:left;"  align="left"  ><span lang="EN-US"  >}</span></p>
</body></html>